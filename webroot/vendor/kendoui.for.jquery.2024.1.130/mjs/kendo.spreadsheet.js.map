{"version":3,"file":"kendo.spreadsheet.js","names":["kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","$","window","LRUCache","Class","size","_size","_length","_map","put","key","value","map","entry","_head","_tail","newer","older","get","REPLACE_REGEX","normalizeText","text","String","replace","objectKey","object","parts","sort","join","hashKey","str","hash","i","charCodeAt","defaultMeasureBox","DEFAULT_OPTIONS","baselineMarkerSize","document","createElement","style","cssText","TextMetrics","_cache","measure","width","height","baseline","cacheKey","cachedResult","measureBox","box","baselineMarker","_baselineMarker","cloneNode","textStr","textContent","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","marker","current","measureText","jQuery","now","Date","getTime","renderPos","pos","result","toHyphens","split","renderSize","sqr","romanToArabic","r","toLowerCase","digits","v","x","l","c","d","m","prev","charAt","arabicToRoman","n","literals","values","roman","shift","memoize","f","cache","Object","create","id","arguments","apply","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","withExit","obj","Return","ex","RegExp","STRING","fromCharCode","ENTITIES","amp","lt","gt","quot","apos","nbsp","CODE","out","UCS2","code","START_CDATA","END_CDATA","END_COMMENT","START_COMMENT","END_SHORT_TAG","END_TAG","END_DECLARATION","QUESTION_MARK","LESS_THAN","GREATER_THAN","SEMICOLON","EQUAL","AMPERSAND","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","EXIT","parse$2","data","callbacks","index","is","selector","j","$tag","exit","readChar","croak","msg","Error","readWhile","pred","a","readAsciiWhile","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlTag","name","attrs","xmlName","xmlAttrs","xmlComment","xmlEntity","xmlContent","pop","xmlString","quote","parseInt","isNaN","undefined","what","thing","arg1","arg2","tmp","parseXML","COMMAND_TYPES","Command","spreadsheet","_workbook","workbook","_property","property","_state","range","_setRange","_range","select","exec","setState","getState","state","rejectState","validationState","title","message","reason","type","_forEachCell","callback","_ref","forEach","ref","sheet","toRangeRef","bind","usesImage","DrawingUpdateCommand","_sheet","_drawing","drawing","_orig","clone","_previous","previous","reset","_activeDrawing","triggerChange","layout","img","image","DrawingCommand","InsertImageCommand","_blob","blob","_width","_height","aspect","Math","min","addDrawing","topLeftCell","topLeft","offsetX","offsetY","opacity","addImage","removeDrawing","DeleteDrawingCommand","ReorderDrawingsCommand","_origIndex","_drawings","indexOf","splice","_newIndex","_reorder","drawings","BringToFrontCommand","SendToBackCommand","TargetValueCommand","_target","target","_value","ColumnWidthCommand","columnWidth","RowHeightCommand","rowHeight","HyperlinkCommand","_link","link","_prevLink","_prevUnderline","underline","_hasSetValue","GridLinesChangeCommand","showGridLines","PropertyChangeCommand","prototype","skipHiddenCells","enable","ClearContentCommand","rowValues","nullValues","currentRange","canEditArrayFormula","refs","concat","row","changeType","clearContent","_getValidationState","cell","EditCommand","_editRange","arrayFormula","activeCellSelection","withCultureDecimals","_exec","editRange","input","wrap","_adjustRowHeight","calc","ParseError","InsertCommentCommand","TextWrapCommand","forEachRow","_rowHeight","AdjustDecimalsCommand","_delta","delta","formatting","batch","forEachCell","col","format","adjustDecimals","BorderChangeCommand","_type","border","_style","color","_batch","self","noBorders","insideBorders","outsideBorders","allBorders","leftBorder","leftColumn","borderLeft","rightBorder","rightColumn","borderRight","topBorder","topRow","borderTop","bottomBorder","bottomRow","borderBottom","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","recalc","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","parse","_event","event","_clipboardContent","_content","activeSheet","selection","pasteRef","_targetRangeRefs","UnionRef","status","canPaste","menuInvoked","pasteOnMerged","pasteOnDisabled","preventDefault","clipboardContent","_processPaste","_adjustPasteTarget","multipliers","sourceRows","sourceCols","refToSelect","rangeToSelect","multiplier","that","targetRangeRefs","RangeRef","cols","b","topLeftA","topLeftB","sourceData","_targetRanges","bottomRight","_rows","_count","_columns","resize","max","_populateTargetRange","_targetRangeDimensions","targetRangeRows","targetRangeCols","rowsMultiplier","colsMultiplier","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","support","paste","_view","focus","execCommand","CutCommand","_eventType","currentRow","canCopy","multiSelection","cut","copy","CopyCommand","noop","ToolbarCopyCommand","AutoFillCommand","origin","_origin","autoFillData","intersectingArrayFormula","_previewFillFrom","props","dest","_properties","Range","FillError","ToolbarCutCommand","cannotUndo","FilterCommand","filter","hasFilter","SortCommand","column","ascending","expandRange","cantSort","_sheetRef","ApplyFilterCommand","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","element","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","DeleteCommand","_expandedRange","_expand","_indexes","_undoOne","_restoreModifiedFormulas","formulas","isValue","DeleteRowCommand","left","Infinity","right","deleteSelectedRows","insertRow","DeleteColumnCommand","top","bottom","deleteSelectedColumns","insertColumn","AddCommand","_pos","count","base","AddColumnCommand","addColumnLeft","addColumnRight","deleteColumn","AddRowCommand","addRowAbove","addRowBelow","deleteRow","EditValidationCommand","validation","OpenCommand","match","fromFile","then","errors","excelImportErrors","openDialog","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","NameCommand","_name","nameDefinition","DefineNameCommand","defineName","DeleteNameCommand","undefineName","FormulaBar","ui","Widget","addClass","classNames","wrapper","icon","prependTo","formulaBarWidth","formulaInput","FormulaInput","appendTo","messages","destroy","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","formulaInputTitle","attr","css","autoScale","on","scale","_highlightedRefs","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","_paste","filterOperator","scalePadding","minLength","removeAttr","toggleClass","getPos","div","sel","getSelection","lookup","focusNode","focusOffset","anchorNode","anchorOffset","begin","end","collapsed","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","setPos","eiv","createRange","setStart","setEnd","getRangeAt","startOffset","endOffset","startContainer","endContainer","removeAllRanges","addRange","len","el","home","runtime","FUNCS","toUpperCase","formulaSource","DataSource","listId","guid","list","StaticList","listWrapper","insertAfter","aria","role","itemRole","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","template","e","tokenCtx","_tokenContext","_mute","activeToken","token","completion","ctx","nextToken","_replaceAt","popup","close","formulaInputEl","Popup","anchor","open","ev","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_sync","_focusTimeout","browser","msie","clipboardData","getData","originalEvent","val","substr","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","point","tok","tokens","tokenize","touches","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","_span","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","field","operator","hide","rectangle","canInsertRef","isKeyboardAction","_canInsertRef","strictMode","canReplace","afterPoint","canInsertBetween","isOpenParen","refAtPoint","simplify","relative","isMerged","setSheet","print","newValue","rest","syncWith","iehandler","eventName","handler","off","horizontalBorders","context","html","outerHeight","innerText","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","isMatchingParen","reverse","htmlEncode","substring","insertNewline","eof","Mac","navigator","platform","EventListener","observer","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","touchProxy","touch","threshold","_pressLocation","documentElement","altKey","handleEvent","isAlphaNum","rightClick","which","button","pageX","y","pageY","dx","dy","sqrt","eventKey","mod","metaKey","ctrlKey","shiftKey","catchAllHandler","RangeTreeNode","level","NilNode","skew","temp","insert","start","remove","diff","heir","intersects","RangeTree","root","findrange","intersecting","ranges","tree","first","last","RangeList","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","Iterator","toJSON","fromJSON","unique","at","SparseRangeList","_defaultValue","lastRangeStart","ValueRange","Property","set","dst","JsonProperty","JSON","stringify","ValueProperty","formats","dateToNumber","culture","calendar","patterns","limitPrecision","cloneFormulaValue","deepClone","cloneFormulaTree","PropertyBag","specs","sortable","serializable","depends","rowCount","columnCount","defaultValues","cellCount","properties","lists","spec","formula","_resize","new_rows","new_cols","old_rows","cell_count","scaleIndex","scaleNode","si","prop","iter","iterators","reduce","ret","hBorders","leftBorders","rightBorders","addBorder","forEachProperty","ALL_PROPERTIES","spreadsheet$8","Class$2","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","isFinite","Ref$4","hasSheet","_hasSheet","absolute","adjust","toString","intersect","NULL$1","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","r1","r2","CellRef$5","RangeRef$4","UnionRef$3","single","refs1","refs2","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","valid","renameSheet","oldSheetName","newSheetName","display","NameRef$3","trow","tcol","abs","arow","acol","forRow","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","limit","num","move","tr","u","empty","theRef","newRefs","NULLREF","SHEETREF","FIRSTREF","Ref","NameRef","CellRef","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","lower","further","bottomLeft","topRight","EdgeNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","SheetNavigator","autoFillCalculator","colEdge","columnRange","rowEdge","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","selectDrawingForContextMenu","modifySelection","action","scrollInto","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","nextUntil","makeWordMovement","prevUntil","newSelection","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","selTopLeft","selBottomRight","isFirstCell","isLastCell","setSelection","currentNavigationRange","done","navigatedAway","singleCellSelection","focusNextElement","nextNavigationRange","find","previousNavigationRange","shouldSkip","extendSelection","resizeAutoFill","isHiddenRow","isHiddenColumn","forEachMergedCell","merged","hint","_autoFillOrigin","punch","preview","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","isCol","firstVal","advanced","hidden","AxisManager","forEachSelectedColumn","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","indexes","_saveModifiedFormulas","hideColumn","hasRight","hasLeft","hideRow","hasBottom","hasTop","unhideColumn","unhideRow","selectedRows","Clipboard","_externalContent","_internalContent","iframe","className","setAttribute","_uid","intersectsMerged","origRef","plain","destination","originActiveCell","rowDelta","colDelta","external","isExternal","_isInternal","newState","setStateData","ri","ci","parseTSV","doc","contentWindow","write","table","querySelector","richState","Matrix","vBorders","td","rowSpan","colSpan","getAttribute","ignoreColspan","cellState","mergedCells","dr","dc","parseHTML","rowData","colData","internalHTML","internalPlain","foreign","stripStyle","getComputedStyle","borders","borderObject","fontSize","background","textAlign","verticalAlign","txtElem","italic","bold","PROPERTIES","skipHiddenRows","skipHiddenCols","_normalize","partition","_set","noTrigger","topLeftRef","_get","_resizedRef","existingFormat","compile","existingFormatType","currency","editorChange","isInEditMode","OUT","t1","numberToDate","_useCultureDecimals","numberFormat","_","__","setArrayFormulaRange","_forFormulas","arrayFormulaRange","intersection","_validation","_merge","mergedRef","vi","isAutofill","setProp","propName","propValue","isFilteredRow","includes","clearAll","contentsOnly","formatOnly","keepBorders","clearFormat","isSortable","mc","_getMergedCells","primary","secondary","cant","hasMerged","_sortBy","isFilterable","clearFilters","_filterBy","_filter","intersectingMerged","propertyName","Formula","Validation","internalClipboard","externalClipboard","sum","textHeight","getTextHeight","fontFamily","hasValue","defStyle","_defaultCellStyle","flag","draw","predicate","each","calc$4","spreadsheet$7","exports$2","Class$1","Ref$3","CellRef$4","RangeRef$3","UnionRef$2","NULL","CalcError$2","Context","ss","parent","resolve","resolveCells","_resolve","error","isArray","asMatrix","maybeRoundFloatErrors","_arrayArg","onFormula","add","getRefCells","pending","cellValues","wantNulls","getRefData","Matrix$1","fetchName","nameValue","Formula$1","ValidationFormulaContext","force","func","fname","args","bool","line","h","isRange","Number","hiddenInfo","getNA","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","t","inverse","augment","imax","argmax","printer","absrefs","onReady","forceRefs","lcsheet","parentContext","next","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","prevRefs","newRef","sameRef","prevRange","constructor","DEFER_INIT","compileArgumentChecks","functionName","forced","arrayArgs","main","haveForced","canBeArrayArg","hasArrayArgs","comp","cond","allowError","typeCheck","Function","limitPrecision$1","forceNum","round","err","toPrecision","withErrorHandling","makeSyncFunction","check","doit","xargs","arrays","makeAsyncFunction","makeCallback","loadDeferred","deferInit","cb","defineFunction$2","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear$1","co","th","comatrix","thmatrix","elmatrix","BASE_DATE","DAYS_IN_MONTH","yr","daysInYear$2","daysInMonth$2","mo","validDate","da","unpackDate$2","serial","packDate$2","MS_IN_MIN","MS_IN_HOUR","MS_IN_DAY","unpackTime","frac","ms","hours","minutes","seconds","milliseconds","serialToDate","packTime","hh","mm","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","makeDateFormat","parseExactDate","CalcError","packDate","unpackDate","daysInMonth","isLeapYear","daysInYear","defineFunction","defineAlias","alias","orig","kendoSpreadsheetAliases","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","equals","binaryCompare","pow","$$2","spreadsheet$6","exports$1","calc$3","TRANSPOSE_FORMAT","DATE_FORMAT","compileValidation","validationHandler","from","dataType","fromIsListValue","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","to_value","allowNulls","from_value","_getListData","showButton","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","array","_getOptions","compareValue","compareFormat","getValue","calculateFromCallBack","prevFrom","prevTo","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","MODIFIED_FORMULAS","Selection","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","triggerSelect","pane","_currentView","Sheet","_reinit","headerHeight","headerWidth","defaultCellStyle","Axis","_filteredRows","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","newRows","newCols","oldRows","oldCols","_resizeAddRow","_resizeAddColumn","_resizeDeleteRow","_resizeDeleteColumn","_resizeForJSON","colCount","_selectionState","_inEdit","_navigator","_axisManager","_sheetName","accessor","_field","suspendChanges","_valueChanged","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","wb","sheetByName","cellRefIndex","_adjustReferences","_sheets","_forValidations","adjustNames","skipDataSourceInsert","nextRef","isEnabledRow","skipDataSourceDelete","isEnabledColumn","_filterRow","gridLinesColor","numRows","numColumns","parseReference","cellRef","forEachFilterHeader","columnRef","forEachRange","doIt","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","draggingInProgress","_draggingInProgress","completeResizing","hintPosition","resizeHintPosition","handlePosition","resizeHandlePosition","_visualRange","_renderComment","comment","_commentRef","_resizeHandlePosition","location","_resizeHintPosition","overElement","removeResizeHandle","positionResizeHandle","startDragging","completeDragging","drag","drawingBoundingBox","indexVisible","refBox","refBoundingBox","dragging","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","selectedHeaders","allCols","allRows","maxRow","maxCol","rowState","colState","rowSelection","colSelection","all","isInEdit","_setFormulaSelections","_viewActiveCell","positions","viewSelection","hyperlinks","clearDefaultStyle","src","parseColor","toCss","json","_sort","_compileFormula","_compileValidation","Drawing","activeCellRef","Filter","_refreshFilter","logToConsole","_refresh","resetFormulas","resetValidations","revalidate","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","useCultureDecimals","dot","withDecimalSeparator","Rectangle","drw","outerWidth","_outerWidth","DOT","EMPTYCHAR","SheetsBar","sheetsBarWrapper","_openDialog","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","sheetsBarRemove","_onSheetRemove","_onSheetSelect","sheetsBarActive","_createEditor","sheetsBarAdd","_onAddSelect","scrollable","distance","_editor","_renderSheets","_selectedIndex","sheetsBarEditor","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","_onSheetRename","renderSheets","sheets","selectedIndex","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","sheetsBarScrollable","sheetsBarSheetsWrapper","_toggleScrollButtons","ul","_sheetsGroup","scrollLeft","sheetsBarPrev","sheetsBarNext","scrollWidth","scrollPrevButton","scrollNextButton","sheetsWrapper","stopPropagation","_nowScrollingSheets","_scrollSheetsByDelta","renderScrollButtons","idx","sheetElements","isSelectedSheet","sheetsBarKItem","elementContent","sheetsBarKActive","sheetsBarInactive","sheetsBarKTextbox","maxlength","sheetsBarKLink","deleteIcon","sheetsBarXIcon","itemsWrapper","childrenElements","sheetsBarKReset","baseButtonClass","sheetsBarKButton","sheetsBarKButtonBare","ariaHidden","sheetsBarArrowWIcon","iconClass","sheetsBarArrowEIcon","children","sheetsBarItems","Sortable","container","animation","ignore","draggable","sheetsBarHintWrapper","sheetsBarKResetItems","closest","oldIndex","newIndex","removedSheetName","closeCallback","sender","isConfirmed","confirmation","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","sheetsBarKButtonDefaults","sheetsBarPlusIcon","item","itemPosition","sheetsGroup","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","finish","animate","scrLeft","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKSprite","util$2","spreadsheet$5","Ref$2","RangeRef$2","CellRef$3","NameRef$2","exports","runtime$4","OPERATORS_STANDARD","OPERATORS_COMMA","ops","op","OPERATORS","SEPARATORS","DEC","ARG","COL","setDecimalSeparator","sep","_separators","TRUE","FALSE","getcol","getrow","parseReference$1","noThrow","stream","TokenStream$1","ast","parseExpression","addReference","allowEOF","peek","commas","maybeBinary","exp","parseAtom","parseFuncall","parseArray","upper","maybePercent","my_prec","his_prec","parseNameDefinition","def","nameRef","defAST","makeFormula","makeClosure","makePrinter","prec","withParens","parenthesize","arg","needParens","toCPS","GENSYM","cps","makeContinuation","cpsNameRef","cpsAtom","cpsRef","cpsUnary","cpsBinary","thenK","gensym","elseK","vars","cpsIf","cpsAnd","cpsOr","cpsFunc","cont","cpsLambda","cpsMatrix","elements","isMatrix","FORMULA_CACHE","js","jsArray","identity","ahead","RawTokenStream","InputStream","fixCell","addPos","forEditor","startToken","endToken","readNext","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","g","space","EOF","isIdStart","isId","symbol","getRC","has_dot","number","readEscaped","parseFloat","lookingAt","readSymbol","isOpChar","isPunc","escaped","rx","forward","FORMAT_PARSERS","registerFormatParser","p","parseSqref","monthFirst","comma","rxnum","getNumberRegexp","rxcur","suffix","has_currency","has_percent","repeat","NUMBER_FORMAT_RX","$$1","MAP_EXCEL_OPERATOR","greaterThanOrEqual","lessThanOrEqual","ERROR_LOG","readExcel","file","deferred","reader","FileReader","onload","async","JSZip","loadAsync","readWorkbook","zip","readAsArrayBuffer","SEL_CELL","SEL_COL","SEL_DEFINED_NAME","SEL_FORMULA","SEL_MERGE","SEL_PANE","SEL_ROW","SEL_SELECTION","SEL_SHEET","SEL_STRING","SEL_TEXT","SEL_SHARED_STRING","SEL_VALUE","SEL_VIEW","SEL_SHEET_VIEW","SEL_HYPERLINK","SEL_PROTECTION","SEL_VALIDATION","SEL_VALIDATION_FORMULA1","SEL_VALIDATION_FORMULA2","SEL_VALIDATION_INSANE","SEL_VALIDATION_SQREF_INSANE","SEL_VALIDATION_FORMULA1_INSANE","SEL_VALIDATION_FORMULA2_INSANE","SEL_COMMENT","SEL_AUTHOR","SEL_COMMENT_TEXT","xl","progress","strings","readStrings","relationships","readRelationships","theme","readTheme","byType","readStyles","items","parse$1","enter","tag","relId","byId","dim","sheetDimensions","bytes","activeTab","integer","vbProcedure","localSheetId","withErrorLog","loading","Deferred","notify","recalcSheets","loadSheets","ready","insertSheet","promise","queueSheet","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","pts","formulaRange","isArrayFormula","formula1","formula2","customFilterLogic","customFilterCriteria","valueFilterBlanks","valueFilterValues","sharedFormulas","nCols","prevCellRef","relsFile","filters","deferredStyles","closed","percent","styleIndex","sty","stop","ht","acRef","xSplit","ySplit","addAutoFilter","colId","and","getCustomFilter","DynamicFilter","dynamicFilterType","TopFilter","getFilterVal","blank","leave","sqref","showErrorMessage","allowBlank","showDropDown","errorTitle","logic","criteria","blanks","applyStyle","comments","commentFile","relative_file","readComments","drawingFile","readDrawings","getContentType","filename","jpg","jpeg","png","gif","wmf","getFileName","cdr","sel_two_cell_anchor","sel_ext","sel_one_cell_anchor","sel_from","sel_to","sel_row","sel_col","sel_row_offset","sel_col_offset","sel_blip","relkeys","edge","Blob","File","excelToPixels","cx","cy","colOffset","rowOffset","brCell","brX","brY","author","authors","authorId","ourOp","equal","notEqual","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","BORDER_WIDTHS","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","DEFAULT_FORMATS","xf","inlineStyles","shouldSet","applyName","xfId","namedStyles","side","up","down","setBorder","setFont","fonts","indent","fills","formatCode","setFormat","numFmts","protection","locked","Promise","Id","Target","Type","entries","names","promises","SEL_BORDER","SEL_FILL","SEL_FONT","SEL_INLINE_STYLE","SEL_NAMED_STYLE","SEL_NUM_FMT","INDEXED_COLORS","toCSSColor","font","fill","getXf","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","addBool","getColor","defaultThemeColor","rgb","indexed","themeColor","colorScheme","tint","toHSL","toCssRgba","patternType","diagonalUp","diagonalDown","diagonal","horizontal","vertical","wrapText","SEL_SCHEME_RGBCLR","SEL_SCHEME_SYSCLR","scheme","swap","arr","part","_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","defaultSheetName","Workbook","_images","_imgID","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","_names","unbind","_sheetChanging","_sheetChange","_sheetInsertRow","_sheetInsertColumn","_sheetDeleteRow","_sheetDeleteColumn","_sheetHideRow","_sheetHideColumn","_sheetUnhideRow","_sheetUnhideColumn","_sheetSelect","_sheetDataBinding","_sheetDataBound","_sheetProgress","_sheetCommandRequest","_inputForRef","execute","commandOptions","cleanupImages","refresh","moveSheetToIndex","toIndex","fromIndex","sheetSelection","sheetName","insertIndex","getUniqueSheetName","sheetNameSuffix","_bindSheetEvents","sheetByIndex","forEachName","nameref","removeSheet","newSheet","_clearSheets","images","url","sheetParamsFromJSON","localName","saveJSON","ids","readAsDataURL","reject","excel","xhr","XMLHttpRequest","response","getResponseHeader","onerror","responseType","send","ooxml","saveOptions","proxyURL","forceProxy","saveAs","dataURI","toBlob","toDataURLAsync","group","nameForRef","imageUrl","URL","createObjectURL","revokeObjectURL","or","PDFMixin","_drawPDF","exportPDF","exportPDFToBlob","proxyTarget","fail","area","spreadsheet$4","CellRef$2","RangeRef$1","UnionRef$1","NameRef$1","Ref$1","fsheet","frow","fcol","states","_displayString","arrayRange","tlRow","tlCol","vrow","vcol","_formulaContextRefresh","alphaNumRegExp","ACTIONS","pageup","pagedown","ENTRY_ACTIONS","tab","delete","backspace","CONTAINER_EVENTS","wheel","contextmenu","mousemove","CLIPBOARD_EVENTS","mouseup","EDITOR_EVENTS","esc","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","rowheader","columnheader","topcorner","autofill","toActionSelector","selectors","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","drawingContextMenu","scroller","tabstrip","sheetsbar","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","onMouseDown","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_execute","editorClose","_preventNavigation","deactivate","showError","activateEditor","_lastEditorValue","_activeTooltip","activeSheetName","clientHeight","isEditorDisabled","resetEditorValue","scroll","onWheel","deltaX","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","casual","onShiftAction","appendSelection","onMouseMove","objectAt","originFrame","_startResizingDrawing","win","widgetInstance","modal","startBox","onEditorEsc","openCustomEditor","_selectionMode","openFilterMenu","handle","translateCoords","startX","startY","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","_dragDrawing","onMouseDrag","clientX","clientY","selectToLocation","frame","scrollTop","startAutoScroll","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","clipBoardValue","_pasteImage","Image","onPaste","files","hasHTML","hasPlainText","DOMStringList","types","kind","getAsFile","onCopy","scrollRight","getBoundingClientRect","noDrawing","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","_saveEditorValue","onEditorArrayFormula","onEditorBarFocus","rect","activeCellRectangle","onEditorCellFocus","onEditorBlur","isFiltered","onEditorAction","_casualEditing","deactivateEditor","onEditorShiftAction","additionalOptions","pdfExport","excelExport","viewClassNames","fixedContainer","editContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonSelected","horizontalResize","verticalResize","iconFilterDefault","sheetsBar","cellBorder","asURL","drawCell","collection","showGrid","maybeLink","textDecoration","href","shouldDraw","dBorders","defaultBorder","toHSV","outline","fontStyle","fontWeight","overflowWrap","wordWrap","__dataType","applyIndent","paneClassNames","nameBox","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","insertRowBelowLastRow","insertColAfterLastCol","tabs","menus","bringToFront","sendToBack","HtmlTable","trs","addColumn","addRow","addCell","Node","toDomTree","offset","ContextMenu","within","View","_chrome","_dialogs","append","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","contextMenuConfig","showOn","enableClipboard","isClipboardDeactivated","actionBar","formulaBar","parents","_outerHeight","tabstripHeight","formulaBarHeight","sheetsBarHeight","quickAccessAdjust","NameEditor","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","_headerWidth","frozen","locate","w","RESIZE_HANDLE_WIDTH","isRowResizer","_headerHeight","isFilterIcon","theGrid","filterIconRect","isAutoFill","isEditButton","activeCellCustomEditor","_editorInLastColumn","drawingAt","drx","dry","clientWidth","paneAt","selecting","containingPane","refreshTools","totalHeight","totalWidth","_pane","_destroyFilterMenu","FilterMenu","_filterMenu","selectClipboardContents","selectNodeContents","selectElementContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","edit","alignLeft","dialog","dialogs","reopenEditor","currentDialogs","errorMessages","hasOpenedError","focusButton","ESC","onClose","dlg","_retry","registered","dialogOptions","_filterMenuColumn","scrollbarSize","scrollbar","contentWidth","contentHeight","resizeDirection","toplevelElements","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","rangeDimensions","primaryMergedCells","secondaryMergedCells","backgroundColor","borderRightColor","borderBottomColor","sdval","sdnum","sibling","cellBefore","borderLeftColor","prevRow","cellAbove","borderTopColor","mergedCell","colspan","rowspan","vaxis","haxis","vborder","hborder","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","selectionHighlight","isVisible","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","headerClassName","hasColumnHeader","columnOffset","renderResizeHandle","paneClasses","itemSelection","allHeaders","doLayout","forScreen","xCoords","borderColor","yCoords","Borders","activeCellRange","absRow","absCol","_activeFormulaColor","_directionClasses","vert","rendered","borderWidth","transform","horiz","renderDrawings","toDiv","backgroundImage","drawingResizeHandles","_start","_addDiv","iconName","filtered","classes","selections","selectionClasses","_renderCustomEditorButton","autoFillRectangle","cssClass","_axis","ed","btnClass","isLastColumn","_buttonOutOfVisiblePane","btn","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","EDITORS","registerEditor","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","setOptions","Calendar","fromValidation","toValidation","_rowAndColPresent","disableDates","kendoStaticList","getKendoStaticList","read","intersectsRect","total","PaneGrid","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","defaultValue","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startSegment","endSegment","lastPage","_pixelValues","startIndex","endIndex","nowCount","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","dayOfWeek","secondWeek","_values","_dates","_blanks","dates","_logic","_criteria","expression","Query","filterExpr","accentFoldingFiltering","_matches","criterionValue","criterionType","valueType","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","util$1","calc$2","RX_COLORS","RX_CONDITION","decimalPart","sections","haveConditional","sec","readSection","maybeColor","readFormat","maybeFraction","fraction","decimal","am","pm","maybeCondition","printToken","fmt","padLeft","adjusted","TokenStream","restart","compileFormatPart","hasDate","hasTime","hasAmpm","percentCount","scaleCount","separeThousands","declen","intFormat","decFormat","condition","preamble","checkComma","TEXT","runtime$3","section","found","calendars","standard","days","namesAbbr","ampm","fraclen","toFixed","eltime","formatInt","lastPart","shouldInsertMinus","iv","skipMinus","chf","formatDec","decimals","digNumber","intpart","decpart","padRight","span","textAndColor","spreadsheet$3","calc$1","runtime$2","defineFunction$1","CalcError$1","CellRef$1","daysInMonth$1","packDate$1","unpackDate$1","daysInYear$1","_days_360$1","method","d1","d2","_days_360","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","matrix","parseCriteria","PI","rad","deg","cos","sin","atan","tan","ceil","mult","numbers","prod","coef","seen","ARGS_COUNTIFS","m1","ARGS_SUMIFS","numericPredicate","ARGS_SUMIF","fetchSumRange","continuation","sumRange","_avg","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","nth","descending","res","discard","bins","asc","variance","stddev","ARGS_PERCENTRANK","_covariance","ax","ay","significance","_fact","fact","_combinations","f1","f2","p1","p2","_percentile","rank","_percentile_inc","_percentile_exc","AGGREGATE_FUNCS","fetchValuesForAggregate","fetchValues","_binom_dist","cumulative","weeksInYear","funcId","ignoreHidden","alpha","s2","a1","approx","resultCol","areanum","colRange","cmp","resultRow","fw","sy","dow","wk","holidays","inc","random","rom","radix","minLen","RX_NON_PRINTABLE","Hyperlink","dec","denomitator","string","noCommas","newText","oldText","valueIfError","RXCACHE","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","spreadsheet$2","runtime$1","ll","ERF","ERFC","GAMMALN","GAMMA","GAMMA_DIST","GAMMA_INV","NORM_S_DIST","NORM_S_INV","NORM_DIST","NORM_INV","BETADIST","BETA_DIST","BETA_INV","chisq_left","chisq_right","chisq_left_inv","chisq_right_inv","ac","chisq_test","expon","poisson","Fdist","Fdist_right","Finv","Finv_right","Ftest","fisher","fisherinv","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","confidence_t","confidence_norm","gauss","phi","lognorm_dist","lognorm_inv","prob","slope","intercept","pearson","rsq","steyx","forecast","linest","logest","trend","growth","FV","PV","PMT","NPER","RATE","IPMT","PPMT","CUMPRINC","CUMIPMT","NPV","IRR","EFFECT","NOMINAL","XNPV","XIRR","ISPMT","DB","DDB","SLN","SYD","VDB","COUPS_ARGS","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","ACCRINTM","ACCRINT","DISC","INTRATE","RECEIVED","PRICE","PRICEDISC","MAX_IT","EPS","FP_MIN","f_abs","S","an","cof","ser","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","aj","bj","M","ab","q","plow","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qam","qap","betastd_inv","cdf","cds","obsv","expect","eij","lnf","_mean","me","_var_sq","arr1","arr2","n1","n2","va1","va2","e2","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","z","x_","p_","lw","y_","mx","my","b1","b2","whipNumberArrays","s1","s3","t2","_mat_mean","Mat","_mat_devsq","mean","sq","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","W","new_X","root_newton","guess","max_it","eps","f_d","rate","nper","pmt","pv","h1","fv","h2","per","ipmt","tn","ts","te","monthlyPayment","cip","flows","npv","npv1","nominal_rate","npery","effect_rate","cost","salvage","life","period","db","factor","prior","dep","no_switch","interest","_getGDA","gda","oldValue","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","frequency","settl","matur","mat","issue","par","year_days","brace","prev1","next1","nrc","accr","annual","_numCoupons","pr","redemption","investment","discount","yld","N","beg_settl","settl_end","beg_end","den","yf","BORDER_TYPES","BORDER_TYPES_ICONS","BORDER_PALETTE_MESSAGES","borderPalette","colorPickerPalette","BorderPalette","_borderTypePalette","_borderColorPalette","colorChooser","class","kendoToggleButton","_toggle","FlatColorPicker","buttons","palette","_change","_apply","_cancel","siblings","checked","getDefaultToolElement","firstIconName","ToolBar","MESSAGES","alignment","alignmentButtons","justifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","formatTypes","automatic","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","insertComment","insertImage","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","toggleGridlines","sortButtons","sortRangeAsc","sortRangeDesc","textColor","textWrap","hyperlink","defaultFormats","COLOR_PICKER_MESSAGES","colorPicker","customColor","cancel","toolDefaults","separator","extensions","overflow","togglable","component","overflowComponent","componentOptions","attributes","commandOn","toolIcon","clearButton","sample","itemTemplate","popupComponent","formatCells","selected","SpreadsheetToolBar","showText","tools","toolbarName","parentMessages","defaultTools","handleClick","_click","click","commandType","resizable","_tools","tool","isFunction","_updateTool","toArray","_getItem","enabled","label","toolbarEl","widget","menuItem","removeClass","_quickAccessButtons","toolbars","contentElements","_toolbar","contentElement","_tabIndex","quickAccessToolBar","hasOwnProperty","buttonTemplate","insertBefore","currentTarget","tabGroup","ObservableObject","retry","revert","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","confirmationDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","defaultFileName","xlsx","description","paper","a2","a3","a4","a5","b3","b4","b5","folio","legal","tabloid","executive","margin","normal","narrow","wide","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","center","modifyMergedDialog","errorMessage","rangeDisabledDialog","intersectsArrayDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","removeLink","insertCommentDialog","removeComment","insertImageDialog","info","typeError","registry","register","dialogClass","SpreadsheetDialog","translate","autoFocus","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","kendoWindow","_action","formattedValue","FormatCellsViewModel","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","_currency","iso","convert","categoryFilter","uniqueBy","inArray","pattern","abbr","FormatCellsDialog","defaultOptions","_generateFormats","currenciesFrom","numberFormats","dateFormats","calendarPatterns","viewModel","currencyFilter","roleSelector","MessageDialog","messageId","getter","ConfirmationDialog","confirm","_confirmed","ValidationErrorDialog","FontFamilyDialog","_list","defaultFont","default","fetch","FontSizeDialog","sizes","defaultSize","BordersDialog","_borderPalette","observable","ColorChooser","ColorPickerDialog","_colorPalette","colorPalette","kendoColorPalette","CustomColorDialog","one","_colorPicker","kendoFlatColorPicker","AlignmentDialog","dataItem","MergeDialog","FreezeDialog","ValidationViewModel","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","defaultComparers","text_comparers","defaultHintMessage","isAny","isNumber","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","update","fromValidationObject","useCustomMessages","toValidationObject","ValidationDialog","errorTemplate","validatable","Validator","validateOnBlur","validate","ExportAsDialog","fileFormats","autoPrint","subject","keywords","creator","fitWidth","areas","paperSizes","landscape","hCenter","vCenter","basicErrorDialog","ImportErrorDialog","UseKeyboardDialog","HyperlinkDialog","model","InsertCommentDialog","InsertImageDialog","okEnabled","hasImage","isHovered","_url","_image","stopEvent","drop","selectFile","dataTransfer","dragEnter","dragLeave","Localizable","path","trans","o","_normalizeColumns","_dataSource","_header","_boundRowsCount","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetInsertRowHandler","fields","getters","normalizedRef","normalizedRefs","setValues","record","valueIndex","colValueIndex","currentValue","_skipRebind","_changeHandler","_progressHandler","_errorHandler","_requestStart","_error","_progress","getterIdx","details","detailsSummary","detailsContent","iconCollapseName","iconExpandName","iconSearchName","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","sortAscending","sortDescending","search","addToCurrent","operatorNone","operators","doesnotcontain","startswith","endswith","doesnotmatch","neq","gte","lte","Details","_summary","_icon","_container","fx","expand","binders","spreadsheetFilterValue","Binder","bindings","templates","query","hasVisibleChildren","HierarchicalDataSource","toLocaleLowerCase","itemVisible","anyVisibleChildren","filterSpread","uncheckAll","hasChildren","FilterMenuViewModel","valuesChange","valuesDataSource","appendToSearch","lastIndexOf","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","flattenOperators","FilterMenuController","valuesTree","distinctValues","filterType","filterForColumn","topValue","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","hasClass","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","barInput","cellInput","_triggerUpdate","activeElement","viewWidth","scrollerElement","scrollbarWidth","viewElement","_rect","noChange","inputType","oldRect","newRect","spreadsheet$1","ERR_INCOMPATIBLE","ERR_NO_DIRECTION","linearRegression","findSeries","forEachSeries","findStep","clone$1","getType","lst","findStringList","stringLists","strl","srcRange","destRange","srcIdx","fillFrom","CLASS_NAMES","comboBoxTitle","transport","success","comboElement","combo","kendoComboBox","ignoreCase","_on_listChange","noDataTemplate","getKendoComboBox","_on_keyDown","_on_focus","_deleteItem","_prevValue","CONT","kdrw","geo","geometry","GUIDELINE_WIDTH","distributeCoords","heights","pageHeight","maxEmpty","headerRows","headerCoords","curr","header","wholeRect","rowHeights","colWidths","relrow","relcol","rh","cw","nonEmpty","shouldDrawCell","emptyCells","pageWidth","scaleFactor","hyCoords","boxWidth","boxHeight","headerCells","orlast","orderCoords","orderCells","assign","sameBorder","drawLayout","ncols","nrows","addPage","endbottom","endright","isInside","page","Group","clip","Path","fromRect","Rect","multiplyCopy","moveTo","lineTo","stroke","guideColor","bordersGroup","r2d2","drawText","paddingLeft","paddingRight","boxSizing","lineHeight","padding","makeFontDef","createTextNode","vtrans","text_group","drawDOM","getPaperOptions","multiPage","Container","addVert","addHoriz","pb","drawTabularData","headerBackground","headerColor","oddBackground","evenBackground","useGridFormat","defineFont","getFontFaces","charWidth","charWidthFunction","textWidth","mkCell","columnTitles","columnWidths","CACHE_CHAR_WIDTH","widths","__meta__","undefined$1","version","F11","I","U","H","A","DELETE","R","NS","Spreadsheet","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_keyDown","_showWatermarkOverlay","F10","_workbookChanging","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","_workbookExcelExport","_workbookExcelImport","_initProgress","kendoProgressBar","chunkCount","always","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","_workbookDataBinding","_workbookDataBound","_workbookProgress","plugin","kendo$1"],"sources":["kendo.spreadsheet.js"],"mappings":"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","sourcesContent":["import './kendo.core.js';\nimport './kendo.excel.js';\nimport './kendo.progressbar.js';\nimport './kendo.pdf.js';\nimport './kendo.binder.js';\nimport './kendo.window.js';\nimport './kendo.list.js';\nimport './kendo.tabstrip.js';\nimport './kendo.icons.js';\nimport './kendo.color.js';\nimport './kendo.sortable.js';\nimport './kendo.menu.js';\nimport './kendo.popup.js';\nimport './kendo.calendar.js';\nimport './kendo.listview.js';\nimport './kendo.data.js';\nimport './kendo.dom.js';\nimport './kendo.toolbar.js';\nimport './kendo.colorpicker.js';\nimport './kendo.combobox.js';\nimport './kendo.dropdownlist.js';\nimport './kendo.togglebutton.js';\nimport './kendo.validator.js';\nimport './kendo.treeview.js';\nimport './kendo.numerictextbox.js';\nimport './kendo.datepicker.js';\nimport './kendo.datetimepicker.js';\n\n(function(kendo) {\n    var UndoRedoStack = kendo.Observable.extend({\n        init: function(options) {\n            kendo.Observable.fn.init.call(this, options);\n            this.clear();\n        },\n        events: [ \"undo\", \"redo\" ],\n        push: function (command) {\n            this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n            this.currentCommandIndex = this.stack.push(command) - 1;\n        },\n        undo: function () {\n            if (this.canUndo()) {\n                var command = this.stack[this.currentCommandIndex--];\n                command.undo();\n                this.trigger(\"undo\", { command: command });\n            }\n        },\n        redo: function () {\n            if (this.canRedo()) {\n                var command = this.stack[++this.currentCommandIndex];\n                command.redo();\n                this.trigger(\"redo\", { command: command });\n            }\n        },\n        clear: function() {\n            this.stack = [];\n            this.currentCommandIndex = -1;\n        },\n        canUndo: function () {\n            return this.currentCommandIndex >= 0;\n        },\n        canRedo: function () {\n            return this.currentCommandIndex != this.stack.length - 1;\n        }\n    });\n\n    kendo.deepExtend(kendo, {\n        util: {\n            UndoRedoStack: UndoRedoStack\n        }\n    });\n})(kendo);\n\n/***********************************************************************\n * WARNING: this file is auto-generated.  If you change it directly,\n * your modifications will eventually be lost.  The source code is in\n * `kendo-drawing` repository, you should make your changes there and\n * run `src-modules/sync.sh` in this repository.\n */\n\n(function($) {\n/* eslint-disable space-before-blocks, space-before-function-paren */\n\nwindow.kendo.util = window.kendo.util || {};\n\nvar LRUCache = kendo.Class.extend({\n    init: function(size) {\n\n        this._size = size;\n        this._length = 0;\n        this._map = {};\n    },\n\n    put: function(key, value) {\n        var map = this._map;\n        var entry = { key: key, value: value };\n\n        map[key] = entry;\n\n        if (!this._head) {\n            this._head = this._tail = entry;\n        } else {\n            this._tail.newer = entry;\n            entry.older = this._tail;\n            this._tail = entry;\n        }\n\n        if (this._length >= this._size) {\n            map[this._head.key] = null;\n            this._head = this._head.newer;\n            this._head.older = null;\n        } else {\n            this._length++;\n        }\n    },\n\n    get: function(key) {\n        var entry = this._map[key];\n\n        if (entry) {\n            if (entry === this._head && entry !== this._tail) {\n                this._head = entry.newer;\n                this._head.older = null;\n            }\n\n            if (entry !== this._tail) {\n                if (entry.older) {\n                    entry.older.newer = entry.newer;\n                    entry.newer.older = entry.older;\n                }\n\n                entry.older = this._tail;\n                entry.newer = null;\n\n                this._tail.newer = entry;\n                this._tail = entry;\n            }\n\n            return entry.value;\n        }\n    }\n});\n\nvar REPLACE_REGEX = /\\r?\\n|\\r|\\t/g;\nvar SPACE = ' ';\n\nfunction normalizeText(text) {\n    return String(text).replace(REPLACE_REGEX, SPACE);\n}\n\nfunction objectKey(object) {\n    var parts = [];\n    for (var key in object) {\n        parts.push(key + object[key]);\n    }\n\n    return parts.sort().join(\"\");\n}\n\n// Computes FNV-1 hash\n// See http://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function\nfunction hashKey(str) {\n    // 32-bit FNV-1 offset basis\n    // See http://isthe.com/chongo/tech/comp/fnv/#FNV-param\n    var hash = 0x811C9DC5;\n\n    for (var i = 0; i < str.length; ++i) {\n        hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n        hash ^= str.charCodeAt(i);\n    }\n\n    return hash >>> 0;\n}\n\nfunction zeroSize() {\n    return { width: 0, height: 0, baseline: 0 };\n}\n\nvar DEFAULT_OPTIONS = {\n    baselineMarkerSize: 1\n};\n\nvar defaultMeasureBox;\n\nif (typeof document !== \"undefined\") {\n    defaultMeasureBox = document.createElement(\"div\");\n    defaultMeasureBox.style.cssText = \"position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;\" +\n              \"padding: 0 !important; margin: 0 !important; border: 0 !important;\" +\n              \"line-height: normal !important; visibility: hidden !important; white-space: pre!important;\";\n}\n\nvar TextMetrics = kendo.Class.extend({\n    init: function(options) {\n\n        this._cache = new LRUCache(1000);\n        this.options = $.extend({}, DEFAULT_OPTIONS, options);\n    },\n\n    measure: function(text, style, options) {\n        if (options === void 0) { options = {}; }\n\n        if (typeof text === 'undefined' || text === null) {\n            return zeroSize();\n        }\n\n        var styleKey = objectKey(style);\n        var cacheKey = hashKey(text + styleKey);\n        var cachedResult = this._cache.get(cacheKey);\n\n        if (cachedResult) {\n            return cachedResult;\n        }\n\n        var size = zeroSize();\n        var measureBox = options.box || defaultMeasureBox;\n        var baselineMarker = this._baselineMarker().cloneNode(false);\n\n        for (var key in style) {\n            var value = style[key];\n            if (typeof value !== \"undefined\") {\n                measureBox.style[key] = value;\n            }\n        }\n\n        var textStr = options.normalizeText !== false ? normalizeText(text) : String(text);\n\n        measureBox.textContent = textStr;\n        measureBox.appendChild(baselineMarker);\n        document.body.appendChild(measureBox);\n\n        if (textStr.length) {\n            size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n            size.height = measureBox.offsetHeight;\n            size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n        }\n\n        if (size.width > 0 && size.height > 0) {\n            this._cache.put(cacheKey, size);\n        }\n\n        measureBox.parentNode.removeChild(measureBox);\n\n        return size;\n    },\n\n    _baselineMarker: function() {\n        var marker = document.createElement(\"div\");\n        marker.style.cssText = \"display: inline-block; vertical-align: baseline;width: \" +\n            this.options.baselineMarkerSize + \"px; height: \" + this.options.baselineMarkerSize + \"px;overflow: hidden;\";\n\n        return marker;\n    }\n});\n\nTextMetrics.current = new TextMetrics();\n\nfunction measureText(text, style, measureBox) {\n    return TextMetrics.current.measure(text, style, measureBox);\n}\n\nkendo.deepExtend(kendo.util, {\n    LRUCache: LRUCache,\n    TextMetrics: TextMetrics,\n    measureText: measureText,\n    objectKey: objectKey,\n    hashKey: hashKey,\n    normalizeText: normalizeText\n});\n\n})(window.kendo.jQuery);\n\n(function () {\r\n    // Imports ================================================================\r\n    var kendo = window.kendo,\r\n        deepExtend = kendo.deepExtend;\r\n\r\n    function sqr(value) {\r\n        return value * value;\r\n    }\r\n\r\n    var now = Date.now;\r\n    if (!now) {\r\n        now = function() {\r\n            return new Date().getTime();\r\n        };\r\n    }\r\n\r\n    // Template helpers =======================================================\r\n\r\n    function renderSize(size) {\r\n        if (typeof size !== \"string\") {\r\n            size += \"px\";\r\n        }\r\n\r\n        return size;\r\n    }\r\n\r\n    function renderPos(pos) {\r\n        var result = [];\r\n\r\n        if (pos) {\r\n            var parts = kendo.toHyphens(pos).split(\"-\");\r\n\r\n            for (var i = 0; i < parts.length; i++) {\r\n                result.push(\"k-pos-\" + parts[i]);\r\n            }\r\n        }\r\n\r\n        return result.join(\" \");\r\n    }\r\n\r\n    function arabicToRoman(n) {\r\n        var literals = {\r\n            1    : \"i\",       10   : \"x\",       100  : \"c\",\r\n            2    : \"ii\",      20   : \"xx\",      200  : \"cc\",\r\n            3    : \"iii\",     30   : \"xxx\",     300  : \"ccc\",\r\n            4    : \"iv\",      40   : \"xl\",      400  : \"cd\",\r\n            5    : \"v\",       50   : \"l\",       500  : \"d\",\r\n            6    : \"vi\",      60   : \"lx\",      600  : \"dc\",\r\n            7    : \"vii\",     70   : \"lxx\",     700  : \"dcc\",\r\n            8    : \"viii\",    80   : \"lxxx\",    800  : \"dccc\",\r\n            9    : \"ix\",      90   : \"xc\",      900  : \"cm\",\r\n            1000 : \"m\"\r\n        };\r\n        var values = [ 1000,\r\n                       900 , 800, 700, 600, 500, 400, 300, 200, 100,\r\n                       90  , 80 , 70 , 60 , 50 , 40 , 30 , 20 , 10 ,\r\n                       9   , 8  , 7  , 6  , 5  , 4  , 3  , 2  , 1 ];\r\n        var roman = \"\";\r\n        while (n > 0) {\r\n            if (n < values[0]) {\r\n                values.shift();\r\n            } else {\r\n                roman += literals[values[0]];\r\n                n -= values[0];\r\n            }\r\n        }\r\n        return roman;\r\n    }\r\n\r\n    function romanToArabic(r) {\r\n        r = r.toLowerCase();\r\n        var digits = {\r\n            i: 1,\r\n            v: 5,\r\n            x: 10,\r\n            l: 50,\r\n            c: 100,\r\n            d: 500,\r\n            m: 1000\r\n        };\r\n        var value = 0, prev = 0;\r\n        for (var i = 0; i < r.length; ++i) {\r\n            var v = digits[r.charAt(i)];\r\n            if (!v) {\r\n                return null;\r\n            }\r\n            value += v;\r\n            if (v > prev) {\r\n                value -= 2 * prev;\r\n            }\r\n            prev = v;\r\n        }\r\n        return value;\r\n    }\r\n\r\n    function memoize(f) {\r\n        var cache = Object.create(null);\r\n        return function() {\r\n            var id = \"\";\r\n            for (var i = arguments.length; --i >= 0;) {\r\n                id += \":\" + arguments[i];\r\n            }\r\n            return id in cache ? cache[id] : (cache[id] = f.apply(this, arguments));\r\n        };\r\n    }\r\n\r\n    function isUnicodeLetter(ch) {\r\n        return RX_UNICODE_LETTER.test(ch);\r\n    }\r\n\r\n    function withExit(f, obj) {\r\n        try {\r\n            return f.call(obj, function(value){\r\n                throw new Return(value);\r\n            });\r\n        } catch(ex) {\r\n            if (ex instanceof Return) {\r\n                return ex.value;\r\n            }\r\n            throw ex;\r\n        }\r\n        function Return(value) {\r\n            this.value = value;\r\n        }\r\n    }\r\n\r\n    // Exports ================================================================\r\n    deepExtend(kendo, {\r\n        util: {\r\n            now: now,\r\n            renderPos: renderPos,\r\n            renderSize: renderSize,\r\n            sqr: sqr,\r\n            romanToArabic: romanToArabic,\r\n            arabicToRoman: arabicToRoman,\r\n            memoize: memoize,\r\n            isUnicodeLetter: isUnicodeLetter,\r\n            withExit: withExit\r\n        }\r\n    });\r\n\r\n    var RX_UNICODE_LETTER = new RegExp(\"[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]\");\r\n\r\n})();\n\n\"use strict\";\n\n    // SAX-style XML parser ====================================================\n    var STRING = String.fromCharCode;\n\n    // XXX: add more here?\n    var ENTITIES = {\n        \"amp\"  : 38,\n        \"lt\"   : 60,\n        \"gt\"   : 62,\n        \"quot\" : 34,\n        \"apos\" : 39,\n        \"nbsp\" : 160\n    };\n\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n\n    function UCS2(out, code) {\n        if (code > 0xFFFF) {\n            code -= 0x10000;\n            out.push(code >>> 10 & 0x3FF | 0xD800,\n                     0xDC00 | code & 0x3FF);\n        } else {\n            out.push(code);\n        }\n    }\n\n    var START_CDATA     = CODE(\"<![CDATA[\");\n    var END_CDATA       = CODE(\"]]>\");\n    var END_COMMENT     = CODE(\"-->\");\n    var START_COMMENT   = CODE(\"!--\");\n    var END_SHORT_TAG   = CODE(\"/>\");\n    var END_TAG         = CODE(\"</\");\n    var END_DECLARATION = CODE(\"?>\");\n    var QUESTION_MARK   = CODE(\"?\");\n    var LESS_THAN       = CODE(\"<\");\n    var GREATER_THAN    = CODE(\">\");\n    var SEMICOLON       = CODE(\";\");\n    var EQUAL           = CODE(\"=\");\n    var AMPERSAND       = CODE(\"&\");\n    var QUOTE           = CODE('\"');\n    var APOSTROPHE      = CODE(\"'\");\n    var SHARP           = CODE(\"#\");\n    var LOWERCASE_X     = CODE(\"x\");\n    var UPPERCASE_X     = CODE(\"X\");\n\n    var EXIT = {};\n\n    function parse$2(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function(selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != \"*\") {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function() {\n                throw EXIT;\n            },\n            stack: stack\n        };\n\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 0xF0 ^ 0xF0)) {// 4 bytes\n                UCS2(body,\n                     ((code & 0x03) << 18) |\n                     ((data[index++] & 0x3F) << 12) |\n                     ((data[index++] & 0x3F) << 6) |\n                     (data[index++] & 0x3F));\n            } else if (!(code & 0xE0 ^ 0xE0)) {// 3 bytes\n                UCS2(body,\n                     ((code & 0x0F) << 12) |\n                     ((data[index++] & 0x3F) << 6) |\n                     (data[index++] & 0x3F));\n            } else if (!(code & 0xC0 ^ 0xC0)) {// 2 bytes\n                UCS2(body,\n                     ((code & 0x1F) << 6) |\n                     (data[index++] & 0x3F));\n            } else {\n                body.push(code);\n            }\n        }\n\n        function croak(msg) {\n            throw new Error(msg + \", at \" + index);\n        }\n\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n\n        function skip(code) {\n            if (!eat(code)) {\n                croak(\"Expecting \" + code.join(\", \"));\n            }\n        }\n\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n\n        function isHexDigit(code) {\n            return (code >= 48 && code <= 57) ||\n                   ((code|=32) >= 97 && code <= 102); // a..f or A..F\n        }\n\n        function isNameStart(code) {\n            return code == 58 ||                      // :\n                   code == 95 ||                      // _\n                   ((code|=32) >= 97 && code <= 122); // a..z or A..Z\n        }\n\n        function isName(code) {\n            return code == 45 ||                      // -\n                   isDigit(code) ||\n                   isNameStart(code);\n        }\n\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call(\"comment\", STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call(\"enter\", name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call(\"enter\", name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak(\"Bad closing tag\");\n                    }\n                    call(\"leave\", name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call(\"text\", STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call(\"text\", STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak(\"Unclosed tag \" + name);\n        }\n\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak(\"Expecting XML name\");\n            }\n            return readAsciiWhile(isName);\n        }\n\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak(\"Expecting string\");\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak(\"Unfinished string\");\n        }\n\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak(\"Bad numeric entity\");\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak(\"Unknown entity \" + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n\n        function xmlDecl() {\n            call(\"decl\", xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) { // ?, > or /\n                    break;\n                }\n                map[xmlName()] = ( skip(EQUAL), xmlString() );\n            }\n            return map;\n        }\n\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n\n        // skip BOM\n        var tmp = [];\n        readChar(tmp);\n        if (tmp[0] != 65279) {\n            index = 0;\n        }\n\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n\n    // Exports ================================================================\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse$2.apply(this, arguments);\n        } catch(ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n\n(function(kendo) {\n    var $ = kendo.jQuery;\n\n    var COMMAND_TYPES = {\n        AUTO_FILL: \"autoFill\",\n        CLEAR: \"clear\",\n        CUT: \"cut\",\n        EDIT: \"edit\",\n        PASTE: \"paste\",\n        VALIDATION: \"validation\"\n    };\n\n    var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n        init: function(options) {\n            this.options = options;\n            this._workbook = options.workbook;\n            this._property = options && options.property;\n            this._state = {};\n        },\n        range: function(range) {\n            if (range !== undefined) {\n                this._setRange(range);\n            }\n\n            return this._range;\n        },\n        _setRange: function(range) {\n            this._range = range;\n        },\n        redo: function() {\n            this.range().select();\n            this.exec();\n        },\n        undo: function() {\n            this.setState(this._state);\n        },\n        getState: function() {\n            this._state = this.range().getState(this._property);\n        },\n        setState: function(state) {\n            this.range().setState(state);\n        },\n        rejectState: function(validationState) {\n            this.undo();\n            return {\n                title: validationState.title,\n                body: validationState.message,\n                reason: \"error\",\n                type: \"validationError\"\n            };\n        },\n        _forEachCell: function(callback) {\n            var range = this.range();\n            var ref = range._ref;\n\n            ref.forEach(function(ref) {\n                range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n            }.bind(this));\n        },\n        usesImage: function(/* image id from workbook._images */) {\n            return false;\n        }\n    });\n\n    kendo.spreadsheet.DrawingUpdateCommand = Command.extend({\n        init: function(options) {\n            this._sheet = options.sheet;\n            this._drawing = options.drawing;\n            this._orig = this._drawing.clone();\n            this._previous = options.previous;\n        },\n        exec: function() {},\n        undo: function() {\n            this._drawing.reset(this._previous);\n            this._sheet._activeDrawing = this._drawing;\n            this._sheet.triggerChange({ layout: true });\n        },\n        redo: function() {\n            this._drawing.reset(this._orig);\n            this._sheet._activeDrawing = this._drawing;\n            this._sheet.triggerChange({ layout: true });\n        },\n        usesImage: function(img) {\n            return this._drawing.image === img\n                || this._orig.image === img\n                || this._previous.image === img;\n        }\n    });\n\n    var DrawingCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._drawing = options.drawing;\n        },\n        usesImage: function(img) {\n            return this._drawing.image === img;\n        }\n    });\n\n    kendo.spreadsheet.InsertImageCommand = DrawingCommand.extend({\n        init: function(options) {\n            DrawingCommand.fn.init.call(this, options);\n            this._blob = options.blob;\n            this._width = options.width;\n            this._height = options.height;\n        },\n        exec: function() {\n            var range = this.range();\n            var sheet = range.sheet();\n            var width = this._width;\n            var height = this._height;\n            var aspect = width / height;\n            if (width > height) {\n                width = Math.min(width, 300);\n                height = width / aspect;\n            } else {\n                height = Math.min(height, 300);\n                width = height * aspect;\n            }\n            this._drawing = sheet.addDrawing({\n                topLeftCell : range.topLeft(),\n                offsetX     : 5,\n                offsetY     : 5,\n                width       : width,\n                height      : height,\n                opacity     : 1,\n                image       : this._workbook.addImage(this._blob)\n            }, true);\n            this._blob = null;\n        },\n        undo: function() {\n            var sheet = this.range().sheet();\n            sheet._activeDrawing = null;\n            sheet.removeDrawing(this._drawing);\n        },\n        redo: function() {\n            var sheet = this.range().sheet();\n            sheet._activeDrawing = this._drawing;\n            sheet.addDrawing(this._drawing);\n        }\n    });\n\n    kendo.spreadsheet.DeleteDrawingCommand = DrawingCommand.extend({\n        exec: function() {\n            var sheet = this.range().sheet();\n            sheet._activeDrawing = null;\n            sheet.removeDrawing(this._drawing);\n        },\n        undo: function() {\n            var sheet = this.range().sheet();\n            sheet._activeDrawing = this._drawing;\n            sheet.addDrawing(this._drawing);\n        },\n        redo: function() {\n            this.exec();\n        }\n    });\n\n    var ReorderDrawingsCommand = DrawingCommand.extend({\n        exec: function() {\n            var sheet = this.range().sheet();\n            this._origIndex = sheet._drawings.indexOf(this._drawing);\n            sheet._drawings.splice(this._origIndex, 1);\n            this._newIndex = this._reorder();\n            sheet._drawings.splice(this._newIndex, 0, this._drawing);\n            sheet.triggerChange({ drawings: true });\n        },\n        undo: function() {\n            var sheet = this.range().sheet();\n            sheet._drawings.splice(this._newIndex, 1);\n            sheet._drawings.splice(this._origIndex, 0, this._drawing);\n            sheet.triggerChange({ drawings: true });\n        }\n    });\n\n    kendo.spreadsheet.BringToFrontCommand = ReorderDrawingsCommand.extend({\n        _reorder: function() {\n            return this.range().sheet()._drawings.length;\n        }\n    });\n\n    kendo.spreadsheet.SendToBackCommand = ReorderDrawingsCommand.extend({\n        _reorder: function() {\n            return 0;\n        }\n    });\n\n    var TargetValueCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._target = options.target;\n            this._value = options.value;\n        },\n        exec: function() {\n            this.getState();\n            this.setState(this._value);\n        }\n    });\n\n    kendo.spreadsheet.ColumnWidthCommand = TargetValueCommand.extend({\n        getState: function() {\n            this._state = this.range().sheet().columnWidth(this._target);\n        },\n        setState: function(state) {\n            this.range().sheet().columnWidth(this._target, state);\n        }\n    });\n\n    kendo.spreadsheet.RowHeightCommand = TargetValueCommand.extend({\n        getState: function() {\n            this._state = this.range().sheet().rowHeight(this._target);\n        },\n        setState: function(state) {\n            this.range().sheet().rowHeight(this._target, state);\n        }\n    });\n\n    kendo.spreadsheet.HyperlinkCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._link = options.link;\n        },\n        exec: function() {\n            var range = this.range();\n            this._prevLink = range.link();\n            this._prevUnderline = range.underline();\n            range.link(this._link);\n            range.underline(true);\n            if (range.value() == null) {\n                this._hasSetValue = true;\n                range.value(this._link);\n            }\n        },\n        undo: function() {\n            var range = this.range();\n            range.link(this._prevLink);\n            range.underline(this._prevUnderline);\n            if (this._hasSetValue) {\n                range.value(null);\n            }\n        }\n    });\n\n    kendo.spreadsheet.GridLinesChangeCommand = TargetValueCommand.extend({\n        getState: function() {\n            this._state = this._range.sheet().showGridLines();\n        },\n        setState: function(v) {\n            this._range.sheet().showGridLines(v);\n        }\n    });\n\n    var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n        _setRange: function(range) {\n            Command.prototype._setRange.call(this, range.skipHiddenCells());\n        },\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._value = options.value;\n        },\n        exec: function() {\n            var range = this.range();\n            if (range.enable()) {\n                this.getState();\n\n                if (this.options.property === \"format\") {\n                    this._workbook.trigger(\"changeFormat\", { range: range });\n                }\n\n                range[this._property](this._value);\n            }\n        }\n    });\n\n    kendo.spreadsheet.ClearContentCommand = Command.extend({\n        exec: function() {\n            var values = [], range, rowValues, nullValues, validationState, currentRange;\n            if (!this.range().enable()) {\n                return { reason: \"error\", type: \"cannotModifyDisabled\" };\n            }\n            if (!this.range().canEditArrayFormula()) {\n                return { reason: \"error\", type: \"intersectsArray\" };\n            }\n            this.getState();\n            range = this.range().skipHiddenCells();\n\n            if(range._ref.refs && range._ref.refs.length > 1) {\n                range._ref.refs.forEach(function(ref) {\n                    currentRange = range.sheet().range(ref);\n                    values = values.concat(currentRange.values());\n                });\n            } else {\n                values = range.values();\n            }\n            nullValues = [];\n            values.forEach(function(row) {\n                rowValues = [];\n                row.forEach(function() {\n                    rowValues.push(null);\n                });\n                nullValues.push(rowValues);\n            });\n            if (range.sheet().trigger(\"changing\", { data: nullValues, range: range, changeType: COMMAND_TYPES.CLEAR })) {\n                return;\n            }\n            range.clearContent();\n            validationState = range._getValidationState();\n            if (validationState) {\n                return this.rejectState(validationState);\n            }\n        },\n        undo: function() {\n            var range = this.range().skipHiddenCells();\n            var sheet = range.sheet();\n            var data = this._state.data;\n            var values = [];\n            var rowValues;\n            data.forEach(function(row) {\n                rowValues = [];\n                row.forEach(function(cell) {\n                    rowValues.push(cell.value);\n                });\n                values.push(rowValues);\n            });\n            if (sheet.trigger(\"changing\", { data: values, range: range, changeType: COMMAND_TYPES.CLEAR })) {\n                return;\n            }\n            this.setState(this._state);\n        }\n    });\n\n    kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n        init: function(options) {\n            options.property = options.property || \"input\";\n            PropertyChangeCommand.fn.init.call(this, options);\n        },\n        _setRange: function(range) {\n            PropertyChangeCommand.prototype._setRange.apply(this, arguments);\n            this._editRange = this.options.arrayFormula ? range : range.sheet().activeCellSelection();\n        },\n        getState: function() {\n            this._state = this.range().getState();\n        },\n        exec: function() {\n            return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n        },\n        undo: function() {\n            var editRange = this._editRange;\n            var state = this._state;\n            if (editRange.sheet().trigger(\"changing\", { data: state.data[0][0].value, range: editRange, changeType: COMMAND_TYPES.EDIT })) {\n                return;\n            }\n            this.setState(this._state);\n        },\n        _exec: function() {\n            var arrayFormula = this.options.arrayFormula;\n            var editRange = this._editRange;\n\n            if (!editRange.enable()) {\n                return { reason: \"error\", type: \"rangeDisabled\" };\n            }\n\n            if (!editRange.canEditArrayFormula()) {\n                return { reason: \"error\", type: \"intersectsArray\" };\n            }\n\n            var value = this._value;\n            this.getState();\n            if (this.range().sheet().trigger(\"changing\", { data: value, range: this._editRange, changeType: COMMAND_TYPES.EDIT })) {\n                return;\n            }\n\n            if (this._property == \"value\") {\n                editRange.value(value);\n                return;\n            }\n\n            try {\n                editRange.link(null);\n                if (value === \"\") {\n                    editRange.value(null);\n                } else {\n                    editRange.input(value, { arrayFormula: arrayFormula });\n                    if (/\\n/.test(editRange.value())) {\n                        editRange.wrap(true);\n                    }\n                }\n                editRange._adjustRowHeight();\n\n                var validationState = editRange._getValidationState();\n                if (validationState) {\n                    return this.rejectState(validationState);\n                }\n            } catch(ex) {\n                if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                    return {\n                        title : \"Error in formula\",\n                        body  : ex+\"\",\n                        reason: \"error\"\n                    };\n                } else {\n                    throw ex;\n                }\n            }\n        }\n    });\n\n    kendo.spreadsheet.InsertCommentCommand = PropertyChangeCommand.extend({\n        init: function(options) {\n            options.property = \"comment\";\n            PropertyChangeCommand.fn.init.call(this, options);\n        }\n    });\n\n    kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n        init: function(options) {\n            options.property = \"wrap\";\n            PropertyChangeCommand.fn.init.call(this, options);\n\n            this._value = options.value;\n        },\n        getState: function() {\n            var rowHeight = {};\n            this.range().forEachRow(function(range) {\n                var index = range.topLeft().row;\n\n                rowHeight[index] = range.sheet().rowHeight(index);\n            });\n\n            this._state = this.range().getState(this._property);\n            this._rowHeight = rowHeight;\n        },\n        undo: function() {\n            var sheet = this.range().sheet();\n            var rowHeight = this._rowHeight;\n\n            this.range().setState(this._state);\n\n            for (var row in rowHeight) {\n                sheet.rowHeight(row, rowHeight[row]);\n            }\n        }\n    });\n\n    kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n        init: function(options) {\n            this._delta = options.value;\n            options.property = \"format\";\n            Command.fn.init.call(this, options);\n        },\n        exec: function() {\n            var sheet = this.range().sheet();\n            var delta = this._delta;\n            var formatting = kendo.spreadsheet.formatting;\n\n            this.getState();\n\n            sheet.batch(function() {\n                this.range().forEachCell(function(row, col, cell) {\n                    var format = cell.format;\n\n                    if (!format) {\n                        var value = cell.value;\n                        if (typeof value == \"number\" && /\\./.test(value)) {\n                            format = \"0.\" + String(value).split(\".\")[1].replace(/\\d/g, \"0\");\n                        }\n                    }\n\n                    if (format || delta > 0) {\n                        format = formatting.adjustDecimals(format || \"0\", delta);\n                        sheet.range(row, col).format(format);\n                    }\n                });\n            }.bind(this));\n        }\n    });\n\n    kendo.spreadsheet.BorderChangeCommand = Command.extend({\n        init: function(options) {\n            options.property = \"border\";\n            Command.fn.init.call(this, options);\n            this._type = options.border || options.value.type;\n            this._style = options.style || { color: options.value.color, size: 1 };\n        },\n        _batch: function(f) {\n            return this.range().sheet().batch(f, {});\n        },\n        exec: function() {\n            var self = this;\n\n            if (!self._type) {\n                return;\n            }\n\n            self.getState();\n            self._batch(function(){\n                self[self._type](self._style);\n            });\n        },\n        noBorders: function() {\n            this.range().insideBorders(null);\n            this.outsideBorders(null);\n        },\n        allBorders: function(style) {\n            this.range().insideBorders(style);\n            this.outsideBorders(style);\n        },\n        leftBorder: function(style) {\n            this.range().leftColumn().borderLeft(style);\n        },\n        rightBorder: function(style) {\n            this.range().rightColumn().borderRight(style);\n        },\n        topBorder: function(style) {\n            this.range().topRow().borderTop(style);\n        },\n        bottomBorder: function(style) {\n            this.range().bottomRow().borderBottom(style);\n        },\n        outsideBorders: function(style) {\n            var range = this.range();\n            range.leftColumn().borderLeft(style);\n            range.topRow().borderTop(style);\n            range.rightColumn().borderRight(style);\n            range.bottomRow().borderBottom(style);\n        },\n        insideBorders: function(style) {\n            this.range().insideBorders(style);\n            this.outsideBorders(null);\n        },\n        insideHorizontalBorders: function(style) {\n            this.range().insideHorizontalBorders(style);\n        },\n        insideVerticalBorders: function(style) {\n            this.range().insideVerticalBorders(style);\n        }\n    });\n\n    kendo.spreadsheet.MergeCellCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._type = options.value;\n        },\n        exec: function() {\n            this.getState();\n            this[this._type]();\n            this.range().sheet().triggerChange({ recalc: true });\n        },\n        activate: function(ref) {\n            this.range().sheet().activeCell(ref);\n        },\n        getState: function() {\n            this._state = this.range().getState();\n        },\n        undo: function() {\n            if (this._type !== \"unmerge\") {\n                this.range().unmerge();\n                this.activate(this.range().topLeft());\n            }\n            this.range().setState(this._state);\n        },\n        cells: function() {\n            var range = this.range();\n            var ref = range._ref;\n\n            range.merge();\n            this.activate(ref);\n        },\n        horizontally: function() {\n            var ref = this.range().topRow()._ref;\n\n            this.range().forEachRow(function(range) {\n                range.merge();\n            });\n\n            this.activate(ref);\n        },\n        vertically: function() {\n            var ref = this.range().leftColumn()._ref;\n\n            this.range().forEachColumn(function(range) {\n                range.merge();\n            });\n\n            this.activate(ref);\n        },\n        unmerge: function() {\n            var range = this.range();\n            var ref = range._ref.topLeft;\n\n            range.unmerge();\n            this.activate(ref);\n        }\n    });\n\n    kendo.spreadsheet.FreezePanesCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._type = options.value;\n        },\n        exec: function() {\n            this.getState();\n            this._topLeft = this.range().topLeft();\n            this[this._type]();\n        },\n        getState: function() {\n            this._state = this.range().sheet().getState();\n        },\n        undo: function() {\n            this.range().sheet().setState(this._state);\n        },\n        panes: function() {\n            var topLeft = this._topLeft;\n            var sheet = this.range().sheet();\n\n            sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n        },\n        rows: function() {\n            var topLeft = this._topLeft;\n            var sheet = this.range().sheet();\n\n            sheet.frozenRows(topLeft.row);\n        },\n        columns: function() {\n            var topLeft = this._topLeft;\n            var sheet = this.range().sheet();\n\n            sheet.frozenColumns(topLeft.col);\n        },\n        unfreeze: function() {\n            var sheet = this.range().sheet();\n            sheet.frozenRows(0).frozenColumns(0);\n        }\n    });\n\n    kendo.spreadsheet.PasteCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._clipboard = options.workbook.clipboard();\n            this._clipboard.parse();\n            this._event = options.event;\n            this._clipboardContent = this._clipboard._content;\n            this._sheet = this._workbook.activeSheet();\n            this._range = this._sheet.selection ? this._sheet.selection() : this._sheet.range(this._clipboard.pasteRef());\n            this._state = this._range.getState();\n            this._targetRangeRefs = (this._range._ref instanceof kendo.spreadsheet.UnionRef ? this._range._ref.refs : [this._range._ref]).map(function(ref){\n                return ref.toRangeRef();\n            });\n        },\n        exec: function() {\n            return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n        },\n        undo: function() {\n            var sheet = this._sheet;\n            var range = this._range;\n\n            if (sheet.trigger(\"changing\", { data: this._state.data, range: range, changeType: COMMAND_TYPES.PASTE })) {\n                return;\n            }\n\n            this.setState(this._state);\n        },\n        _exec: function() {\n            var status = this._clipboard.canPaste();\n\n            if (!status.canPaste) {\n                if (status.menuInvoked) {\n                    return { reason: \"error\", type: \"useKeyboard\" };\n                }\n                if (status.pasteOnMerged) {\n                    return { reason: \"error\", type: \"modifyMerged\" };\n                }\n                if (status.pasteOnDisabled) {\n                    this._event.preventDefault();\n                    return { reason: \"error\", type: \"cannotModifyDisabled\" };\n                }\n                return { reason: \"error\" };\n            }\n\n            var sheet = this._sheet;\n            var range = this._range;\n\n            if(this._workbook.trigger(\"paste\", {range: range, clipboardContent: this._clipboardContent}) ||\n                sheet.trigger(\"changing\", { data: this._clipboardContent.data, range: range, changeType: COMMAND_TYPES.PASTE })) {\n                this._event.preventDefault();\n                return;\n            } else {\n                this._processPaste();\n            }\n        },\n        _adjustPasteTarget: function(multipliers, sourceRows, sourceCols) {\n            var that = this;\n            var targetRangeRefs = that._targetRangeRefs;\n            var sheet = that._sheet;\n            var RangeRef = kendo.spreadsheet.RangeRef;\n            var UnionRef = kendo.spreadsheet.UnionRef;\n            var refs = [];\n            var compare = function (a, b) {\n                var result = 0;\n                var topLeftA = a.topLeft;\n                var topLeftB = b.topLeft;\n\n                if (topLeftA.row > topLeftB.row) {\n                    result = 1;\n                } else if (topLeftA.row < topLeftB.row) {\n                    result = -1;\n                } else if (topLeftA.col > topLeftB.col) {\n                    result = 1;\n                } else if (topLeftA.col < topLeftB.col) {\n                    result = -1;\n                }\n\n                return result;\n            };\n\n            var refToSelect, rangeToSelect, ref, topLeft, multiplier, i, bottomRight;\n\n            for(i = 0; i < targetRangeRefs.length; i += 1) {\n                ref = targetRangeRefs[i];\n                multiplier = multipliers[i];\n                topLeft = ref.topLeft;\n                bottomRight = {\n                    row: multiplier.rows * sourceRows + topLeft.row - 1,\n                    col: multiplier.cols * sourceCols + topLeft.col - 1\n                };\n\n                refToSelect = new RangeRef(topLeft, bottomRight);\n                refs.push(refToSelect);\n            }\n\n            if(refs.length === 1) {\n                rangeToSelect = sheet.range(refToSelect);\n            } else {\n                refs.sort(compare);\n                rangeToSelect = sheet.range(new UnionRef(refs));\n            }\n\n            rangeToSelect.select();\n            that._range = rangeToSelect;\n            that._state = that._range.getState();\n        },\n        _processPaste: function() {\n            var that = this;\n            var sheet = that._sheet;\n            var clipboardContent = that._clipboardContent;\n            var range = that._range;\n            var sourceData = clipboardContent.data;\n            var sourceRows = sourceData.length;\n            var sourceCols = sourceData[0].length;\n            var targetRangeRefs = that._targetRangeRefs;\n            var multipliers = that._targetRanges(sourceRows, sourceCols);\n            var i;\n\n            var pasteRef = this._clipboard.pasteRef();\n            if (pasteRef.bottomRight.row >= sheet._rows._count || pasteRef.bottomRight.col >= sheet._columns._count) {\n                sheet.resize(\n                    Math.max(pasteRef.bottomRight.row + 1, sheet._rows._count),\n                    Math.max(pasteRef.bottomRight.col + 1, sheet._columns._count)\n                );\n            }\n\n            that._adjustPasteTarget(multipliers, sourceRows, sourceCols);\n\n            sheet.batch(function() {\n                for(i = 0; i < targetRangeRefs.length; i++) {\n                    that._populateTargetRange(targetRangeRefs[i], sourceRows, sourceCols, multipliers[i]);\n                }\n            }, {\n                recalc: true,\n                ref: that._range._ref\n            });\n\n            range._adjustRowHeight();\n        },\n        _populateTargetRange: function(ref, sourceRows, sourceCols, multipliers) {\n            var topLeft = ref.topLeft;\n            var range, i, j;\n\n            for(i = 0; i < multipliers.rows; i++) {\n                for(j = 0; j < multipliers.cols; j++) {\n                    range = this._sheet.range(topLeft.row + sourceRows * i, topLeft.col + sourceCols * j);\n                    range.setState(this._clipboardContent, this._clipboard);\n                }\n            }\n        },\n        _targetRangeDimensions: function(ref, sourceRows, sourceCols) {\n            var topLeft = ref.topLeft;\n            var bottomRight = ref.bottomRight;\n            var targetRangeRows = bottomRight.row - topLeft.row + 1;\n            var targetRangeCols = bottomRight.col - topLeft.col + 1;\n            var rowsMultiplier = 1;\n            var colsMultiplier = 1;\n\n            if((targetRangeRows % sourceRows === 0 && targetRangeCols % sourceCols === 0)) {\n                rowsMultiplier = targetRangeRows / sourceRows;\n                colsMultiplier = targetRangeCols / sourceCols;\n            }\n\n            return {\n                rows: rowsMultiplier,\n                cols: colsMultiplier\n            };\n        },\n        _targetRanges: function(sourceRows, sourceCols) {\n            var targetRangeRefs = this._targetRangeRefs;\n            var multipliers = [];\n            var i;\n\n            for(i = 0; i < targetRangeRefs.length; i++) {\n                multipliers.push(this._targetRangeDimensions(targetRangeRefs[i], sourceRows, sourceCols));\n            }\n\n            return multipliers;\n        }\n    });\n\n    kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n        exec: function() {\n            var options = this.options;\n            var sheet = this._workbook.activeSheet();\n            var range = options.range || sheet.range(options.rowIndex);\n\n            range._adjustRowHeight();\n        }\n    });\n\n    kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n        exec: function() {\n            if (kendo.support.clipboard.paste) {\n                this._workbook._view.clipboard.focus().select();\n                //reason : focusclipbord\n                document.execCommand('paste');\n            } else {\n                return { reason: \"error\", type: \"useKeyboard\" };\n            }\n        }\n    });\n\n    kendo.spreadsheet.CutCommand = Command.extend({\n        _eventType: \"cut\",\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._clipboard = options.workbook.clipboard();\n            this._event = options.event;\n        },\n        exec: function() {\n            var status = this._clipboard.canCopy();\n            var data = [], rangeValues, currentRow;\n            if (!status.canCopy) {\n                if (status.menuInvoked) {\n                    return { reason: \"error\", type: \"useKeyboard\" };\n                } else if (status.multiSelection) {\n                    return { reason: \"error\", type: \"unsupportedSelection\" };\n                }\n                return;\n            }\n            var range = this._workbook.activeSheet().selection();\n            if (this._eventType == \"cut\") {\n                if (!range.enable()) {\n                    this._event.preventDefault();\n                    return { reason: \"error\", type: \"cannotModifyDisabled\" };\n                }\n                this.getState();\n            }\n            if (this._workbook.trigger(this._eventType, { range: range })) {\n                this._event.preventDefault();\n            } else if (this._eventType == \"cut\") {\n                rangeValues = range.values();\n                rangeValues.forEach(function(row){\n                    currentRow = [];\n                    row.forEach(function(){\n                        currentRow.push({});\n                    });\n                    data.push(currentRow);\n                });\n                if (range.sheet().trigger(\"changing\", { data: data, range: range, changeType: COMMAND_TYPES.CUT })) {\n                    return;\n                }\n                this._clipboard.cut();\n            } else {\n                this._clipboard.copy();\n            }\n        },\n        undo: function() {\n            var range = this.range();\n            if (range.sheet().trigger(\"changing\", { data: this._state.data, range: range, changeType: COMMAND_TYPES.CUT })) {\n                return;\n            }\n            this.setState(this._state);\n        }\n    });\n\n    kendo.spreadsheet.CopyCommand = kendo.spreadsheet.CutCommand.extend({\n        _eventType: \"copy\",\n        undo: $.noop\n    });\n\n    // function copyToClipboard(html) {\n    //     var textarea = document.createElement('textarea');\n    //     $(textarea).addClass(\"k-spreadsheet-clipboard\")\n    //         .val(html)\n    //         .appendTo(document.body)\n    //         .trigger(\"focus\")\n    //         .select();\n\n    //     document.execCommand('copy');\n\n    //     $(textarea).remove();\n    // }\n\n    kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._clipboard = options.workbook.clipboard();\n        },\n        undo: $.noop,\n        exec: function() {\n            if (kendo.support.clipboard.copy) {\n                document.execCommand('copy');\n            } else {\n                return { reason: \"error\", type: \"useKeyboard\" };\n            }\n        }\n    });\n\n    kendo.spreadsheet.AutoFillCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n        },\n        origin: function(origin) {\n            this._origin = origin;\n        },\n        exec: function() {\n            var range = this.range(), autoFillData;\n            if (!range.enable()) {\n                return { reason: \"error\", type: \"rangeDisabled\" };\n            }\n            if (range.intersectingArrayFormula()) {\n                return { reason: \"error\", type: \"intersectsArray\" };\n            }\n            this.getState();\n            try {\n                autoFillData = range._previewFillFrom(this._origin);\n                if (range.sheet().trigger(\"changing\", { data: autoFillData.props, range: autoFillData.dest, changeType: COMMAND_TYPES.AUTO_FILL })) {\n                    return;\n                }\n                autoFillData.dest._properties(autoFillData.props, true);\n            } catch(ex) {\n                if (ex instanceof kendo.spreadsheet.Range.FillError) {\n                    return { reason: \"error\", type: ex.code };\n                }\n                throw ex;\n            }\n        },\n        undo: function() {\n            var range = this.range();\n            var state = this._state;\n            if (range.sheet().trigger(\"changing\", { data: state.data, range: range, changeType: COMMAND_TYPES.AUTO_FILL })) {\n                return;\n            }\n            this.setState(this._state);\n        }\n    });\n\n    kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n        cannotUndo: true,\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._clipboard = options.workbook.clipboard();\n        },\n        exec: function() {\n            if (kendo.support.clipboard.copy) {\n                document.execCommand('cut');\n            } else {\n                return { reason: \"error\", type: \"useKeyboard\" };\n            }\n        }\n    });\n\n    kendo.spreadsheet.FilterCommand = Command.extend({\n        undo: function() {\n            this.range().filter(this._state);\n        },\n        exec: function() {\n            var range = this.range();\n            this._state = range.hasFilter();\n            range.filter(!this._state);\n        }\n    });\n\n    kendo.spreadsheet.SortCommand = Command.extend({\n        undo: function() {\n            var sheet = this.range().sheet();\n            sheet.setState(this._state);\n        },\n        exec: function() {\n            var range = this.range();\n            var sheet = range.sheet();\n            var activeCell = sheet.activeCell();\n            var col = this.options.sheet ? activeCell.topLeft.col : (this.options.column || 0);\n            var ascending = this.options.value === \"asc\" ? true : false;\n\n            this._state = sheet.getState();\n\n            if (this.options.sheet) {\n                range = this.expandRange();\n            }\n\n            var reason = range.cantSort();\n            if (reason) {\n                return { reason: \"error\", type: reason.code };\n            }\n\n            range.sort({ column: col, ascending: ascending });\n        },\n        expandRange: function() {\n            var sheet = this.range().sheet();\n            return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n        }\n    });\n\n    var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n        column: function() {\n            return this.options.column || 0;\n        },\n        undo: function() {\n            var sheet = this.range().sheet();\n\n            sheet.clearFilter(this.column());\n\n            if (this._state.length) {\n                this.range().filter(this._state);\n            }\n        },\n        getState: function() {\n            var sheet = this.range().sheet();\n            var current = sheet.filter();\n\n            if (current) {\n                this._state = current.columns.filter(function(c) {\n                    return c.index == this.column();\n                }.bind(this));\n            }\n        },\n        exec: function() {\n            var range = this.range();\n            var column = this.column();\n            var current = range.sheet().filter();\n            var options;\n            var filterRule;\n            var exists = false;\n\n            if (this.options.valueFilter) {\n                filterRule = { column: column, filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter) };\n            } else if (this.options.customFilter) {\n                filterRule = { column: column, filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter) };\n            }\n\n            this.getState();\n\n            if (current && current.ref.eq(range._ref) && current.columns.length) {\n                current.columns.forEach(function(element) {\n                    if (element.index === column) {\n                        exists = true;\n                    }\n                });\n\n                options = current.columns.map(function(element) {\n                    return element.index === column ? filterRule : { column: element.index, filter: element.filter };\n                });\n\n                if (!exists) {\n                    options.push(filterRule);\n                }\n            } else {\n                options = filterRule;\n            }\n\n            range.filter(options);\n        }\n    });\n\n    kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n        exec: function() {\n            var range = this.range();\n            var column = this.column();\n\n            this.getState();\n            range.clearFilter(column);\n        }\n    });\n\n    kendo.spreadsheet.HideLineCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this.axis = options.axis;\n        },\n\n        undo: function() {\n            var sheet = this.range().sheet();\n            sheet.setAxisState(this._state);\n        },\n\n        exec: function() {\n            var sheet = this.range().sheet();\n            this._state = sheet.getAxisState();\n\n            if (this.axis == \"row\") {\n                sheet.axisManager().hideSelectedRows();\n            } else {\n                sheet.axisManager().hideSelectedColumns();\n            }\n        }\n    });\n\n    kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n        exec: function() {\n            var sheet = this.range().sheet();\n            this._state = sheet.getAxisState();\n\n            if (this.axis == \"row\") {\n                sheet.axisManager().unhideSelectedRows();\n            } else {\n                sheet.axisManager().unhideSelectedColumns();\n            }\n        }\n    });\n\n    var DeleteCommand = Command.extend({\n        exec: function() {\n            this._expandedRange = this._expand(this.range());\n            this._state = this._expandedRange.getState();\n            this._indexes = this._exec(this._expandedRange.sheet());\n        },\n        undo: function() {\n            var self = this;\n            var range = self._expandedRange;\n            var sheet = range.sheet();\n            sheet.batch(function(){\n                self._indexes.forEach(function(x){\n                    self._undoOne(sheet, x);\n                    sheet._restoreModifiedFormulas(x.formulas);\n                });\n                range.setState(self._state);\n            }, { layout: true, recalc: true, ref: range._ref, isValue: true });\n        }\n    });\n\n    kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n        _expand: function(range) {\n            return range.resize({ left: -Infinity, right: +Infinity });\n        },\n        _exec: function(sheet) {\n            return sheet.axisManager().deleteSelectedRows();\n        },\n        _undoOne: function(sheet, x) {\n            sheet.insertRow(x.index);\n            sheet.rowHeight(x.index, x.height);\n        }\n    });\n\n    kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n        _expand: function(range) {\n            return range.resize({ top: -Infinity, bottom: +Infinity });\n        },\n        _exec: function(sheet) {\n            return sheet.axisManager().deleteSelectedColumns();\n        },\n        _undoOne: function(sheet, x) {\n            sheet.insertColumn(x.index);\n            sheet.columnWidth(x.index, x.width);\n        }\n    });\n\n    var AddCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._value = options.value;\n        },\n        undo: function() {\n            var self = this;\n            var sheet = self.range().sheet();\n            sheet.batch(function(){\n                for (var i = self._pos.count; --i >= 0;) {\n                    self._undoOne(sheet, self._pos.base);\n                }\n            }, { layout: true, recalc: true });\n        }\n    });\n\n    kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n        exec: function() {\n            var value = this._value;\n            var sheet = this.range().sheet();\n\n            if (value === \"left\") {\n                this._pos = sheet.axisManager().addColumnLeft();\n            } else {\n                this._pos = sheet.axisManager().addColumnRight();\n            }\n        },\n        _undoOne: function(sheet, index) {\n            sheet.deleteColumn(index);\n        }\n    });\n\n    kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n        exec: function() {\n            var value = this._value;\n            var sheet = this.range().sheet();\n\n            if (value === \"above\") {\n                this._pos = sheet.axisManager().addRowAbove();\n            } else {\n                this._pos = sheet.axisManager().addRowBelow();\n            }\n        },\n        _undoOne: function(sheet, index) {\n            sheet.deleteRow(index);\n        }\n    });\n\n    kendo.spreadsheet.EditValidationCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._value = options.value;\n        },\n        exec: function() {\n            var self = this, sheet = self.range().sheet();\n            this.getState();\n            if (sheet.trigger(\"changing\", { data: self._value, range: self.range(), changeType: COMMAND_TYPES.VALIDATION })) {\n                return;\n            }\n            try {\n                sheet.withCultureDecimals(function(){\n                    self.range().validation(self._value);\n                });\n            } catch(ex) {\n                if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                    return {\n                        title : \"Error in formula\",\n                        body  : ex+\"\",\n                        reason: \"error\"\n                    };\n                } else {\n                    throw ex;\n                }\n            }\n        },\n        undo: function() {\n            var editRange = this.range();\n            var state = this._state;\n            if (editRange.sheet().trigger(\"changing\", { data: state.data[0][0].validation, range: editRange, changeType: COMMAND_TYPES.VALIDATION })) {\n                return;\n            }\n            this.setState(this._state);\n        }\n    });\n\n    kendo.spreadsheet.OpenCommand = Command.extend({\n        cannotUndo: true,\n        exec: function() {\n            var file = this.options.value;\n            if (file.name.match(/.xlsx$/i) === null) {\n                return { reason: \"error\", type: \"openUnsupported\" };\n            }\n\n            var workbook = this.options.workbook;\n            workbook.fromFile(this.options.value).then(function(){\n                var errors = workbook.excelImportErrors;\n                if (errors && errors.length) {\n                    workbook._view.openDialog(\"importError\", {\n                        errors: errors\n                    });\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.SaveAsCommand = Command.extend({\n        cannotUndo: true,\n        exec: function() {\n            var fileName = this.options.name + this.options.extension;\n            if (this.options.extension === \".xlsx\") {\n                this.options.workbook.saveAsExcel({\n                    fileName: fileName\n                });\n            } else if (this.options.extension === \".pdf\") {\n                this.options.workbook.saveAsPDF($.extend(this.options.pdf, {workbook: this.options.workbook, fileName: fileName}));\n            }\n        }\n    });\n\n    var NameCommand = Command.extend({\n        init: function(options) {\n            Command.fn.init.call(this, options);\n            this._name = options.name;\n            this._value = options.value;\n        },\n        getState: function() {\n            this._state = this._workbook.nameDefinition(this._name);\n        },\n        setState: function() {\n            this._workbook.nameDefinition(this._name, this._state);\n            this._workbook.trigger(\"change\", { recalc: true });\n        }\n    });\n\n    kendo.spreadsheet.DefineNameCommand = NameCommand.extend({\n        exec: function() {\n            this.getState();\n            try {\n                this._workbook.defineName(this._name, this._value);\n                this._workbook.trigger(\"change\", { recalc: true });\n            } catch(ex) {\n                return {\n                    title: \"Error\",\n                    body: ex+\"\",\n                    reason: \"error\"\n                };\n            }\n        }\n    });\n\n    kendo.spreadsheet.DeleteNameCommand = NameCommand.extend({\n        exec: function() {\n            this.getState();\n            this._workbook.undefineName(this._name);\n            this._workbook.trigger(\"change\", { recalc: true });\n        }\n    });\n\n})(kendo);\n\n(function(kendo) {\n\n    var $ = kendo.jQuery;\n\n    var classNames = {\n        wrapper: \"k-spreadsheet-formula-bar\"\n    };\n\n    var FormulaBar = kendo.ui.Widget.extend({\n        init: function(element, options) {\n            kendo.ui.Widget.call(this, element, options);\n\n            element = this.element.addClass(FormulaBar.classNames.wrapper);\n\n            $(kendo.ui.icon(\"formula-fx\")).prependTo(element);\n\n            var formulaBarWidth = element.width();\n\n            this.formulaInput = new kendo.spreadsheet.FormulaInput($(\"<div/>\")\n                .appendTo(element), { formulaBarWidth: formulaBarWidth, messages: (options || {}).messages });\n        },\n\n        destroy: function() {\n            if (this.formulaInput) {\n                this.formulaInput.destroy();\n            }\n            this.formulaInput = null;\n        }\n    });\n\n    kendo.spreadsheet.FormulaBar = FormulaBar;\n    $.extend(true, FormulaBar, { classNames: classNames });\n})(window.kendo);\n\n(function(kendo, window) {\n\n\n\n\n    var $ = kendo.jQuery;\n    var Widget = kendo.ui.Widget;\n    var ns = \".kendoFormulaInput\";\n    var keys = kendo.keys;\n    var classNames = {\n        wrapper: \"k-spreadsheet-formula-input\",\n        listWrapper: \"k-spreadsheet-formula-list\"\n    };\n    var styles = [\n        \"font-family\",\n        \"font-size\",\n        \"font-stretch\",\n        \"font-style\",\n        \"font-weight\",\n        \"letter-spacing\",\n        \"text-transform\",\n        \"line-height\"\n    ];\n\n    //move to core\n    var KEY_NAMES = {\n        27: 'esc',\n        37: 'left',\n        39: 'right',\n        35: 'end',\n        36: 'home',\n        32: 'spacebar'\n    };\n\n    var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n\n    var FormulaInput = Widget.extend({\n        init: function(element, options) {\n            Widget.call(this, element, options);\n            var formulaInputTitle = ((options || {}).messages || {}).formulaInput || \"Formula Input\";\n\n            element = this.element;\n\n            element.addClass(FormulaInput.classNames.wrapper)\n                .attr('aria-haspopup', 'menu')\n                .attr('role', 'combobox')\n                .attr('title', formulaInputTitle)\n                .attr('aria-expanded', false)\n                .attr(\"contenteditable\", true)\n                .attr(\"spellcheck\", false)\n                .css(\"white-space\", \"pre\");\n\n            if (options && options.formulaBarWidth) {\n                element.css(\"max-width\", options.formulaBarWidth - 16 + \"px\");\n            }\n\n            if (this.options.autoScale) {\n                element.on(\"input\", this.scale.bind(this));\n            }\n\n            this._highlightedRefs = [];\n\n            this._formulaSource();\n\n            this._formulaList();\n\n            this._popup();\n\n            this._tooltip();\n\n            element\n                .on(\"keydown\", this._keydown.bind(this))\n                .on(\"keyup\", this._keyup.bind(this))\n                .on(\"blur\", this._blur.bind(this))\n                .on(\"input click\", this._input.bind(this))\n                .on(\"focus\", this._focus.bind(this))\n                .on(\"paste\", this._paste.bind(this));\n        },\n\n        options: {\n            name: \"FormulaInput\",\n            autoScale: false,\n            filterOperator: \"startswith\",\n            scalePadding: 30,\n            minLength: 1,\n            formulaBarWidth: null\n        },\n\n        events: [\n            \"keyup\",\n            \"focus\"\n        ],\n\n        enable: function(enable) {\n            if (enable === undefined) {\n                return this.element.attr(\"contenteditable\") === \"true\";\n            }\n\n            if (enable) {\n                this.element.attr(\"contenteditable\", enable);\n            } else {\n                this.element.removeAttr(\"contenteditable\");\n            }\n\n            this.element.toggleClass(\"k-disabled\", !enable);\n        },\n\n        getPos: function() {\n            var div = this.element[0];\n            var sel = window.getSelection();\n            var a = lookup(sel.focusNode, sel.focusOffset);\n            var b = lookup(sel.anchorNode, sel.anchorOffset);\n            if (a != null && b != null) {\n                if (a > b) {\n                    var tmp = a;\n                    a = b;\n                    b = tmp;\n                }\n                return { begin: a, end: b, collapsed: a == b };\n            }\n            function lookup(lookupNode, pos) {\n                try {\n                    (function loop(node){\n                        if (node === lookupNode) {\n                            throw pos;\n                        } else if (node.nodeType == 1 /* Element */) {\n                            for (var i = node.firstChild; i; i = i.nextSibling) {\n                                loop(i);\n                            }\n                        } else if (node.nodeType == 3 /* Text */) {\n                            pos += node.nodeValue.length;\n                        }\n                    })(div);\n                } catch (index) {\n                    return index;\n                }\n            }\n        },\n\n        setPos: function(begin, end) {\n            var eiv = this.element[0];\n            begin = lookup(eiv, begin);\n            if (end != null) {\n                end = lookup(eiv, end);\n            } else {\n                end = begin;\n            }\n            if (begin && end) {\n                var range = document.createRange();\n                range.setStart(begin.node, begin.pos);\n                range.setEnd(end.node, end.pos);\n                var sel = window.getSelection();\n                var currentRange = sel.getRangeAt(0);\n                if (differ(range, currentRange))  {\n                    sel.removeAllRanges();\n                    sel.addRange(range);\n                }\n            }\n            function differ(a, b) {\n                return (\n                    a.startOffset != b.startOffset ||\n                    a.endOffset != b.endOffset ||\n                    a.startContainer != b.endContainer ||\n                    a.endContainer != b.endContainer\n                );\n            }\n            function lookup(node, pos) {\n                try {\n                    (function loop(node){\n                        if (node.nodeType == 3 /* Text */) {\n                            var len = node.nodeValue.length;\n                            if (len >= pos) {\n                                throw node;\n                            }\n                            pos -= len;\n                        } else if (node.nodeType == 1 /* Element */) {\n                            for (var i = node.firstChild; i; i = i.nextSibling) {\n                                loop(i);\n                            }\n                        }\n                    })(node);\n                } catch (el) {\n                    return { node: el, pos: pos };\n                }\n            }\n        },\n\n        end: function() {\n            this.setPos(this.length());\n        },\n\n        home: function() {\n            this.setPos(0);\n        },\n\n        select: function() {\n            this.setPos(0, this.length());\n        },\n\n        length: function() {\n            return this.value().length;\n        },\n\n        _formulaSource: function() {\n            var result = [];\n            var value;\n\n            for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                    value = key.toUpperCase();\n                    result.push({ value: value, text: value });\n                }\n            }\n\n            this.formulaSource = new kendo.data.DataSource({ data: result });\n        },\n\n        _formulaList: function() {\n            var listId = kendo.guid();\n            this.element.attr(\"aria-controls\", listId);\n            this.list = new kendo.ui.StaticList($(`<ul id=\"${listId}\" />`)\n                .addClass(FormulaInput.classNames.listWrapper)\n                .insertAfter(this.element), {\n                    aria: {\n                        role: 'menu',\n                        itemRole: 'menuitem'\n                    },\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: \"value\",\n                    template: \"#:data.value#\"\n                });\n\n            this.list.element.on(\"mousedown\", function(e) {\n                e.preventDefault();\n            });\n        },\n\n        _formulaListChange: function() {\n            var tokenCtx = this._tokenContext();\n\n            if (!tokenCtx || this._mute) {\n                return;\n            }\n\n            var activeToken = tokenCtx.token;\n            var completion = this.list.value()[0];\n            var ctx = {\n                replace: true,\n                token: activeToken,\n                end: activeToken.end\n            };\n\n            if (!tokenCtx.nextToken || tokenCtx.nextToken.value != \"(\") {\n                completion += \"(\";\n            }\n\n            this._replaceAt(ctx, completion);\n            this.popup.close();\n        },\n\n        _popup: function() {\n            var formulaInputEl = this.element;\n            this.popup = new kendo.ui.Popup(this.list.element, {\n                anchor: this.element,\n                open: function(ev) { formulaInputEl.attr(\"aria-expanded\", true); },\n                close: function(ev) { formulaInputEl.attr(\"aria-expanded\", false); }\n            });\n        },\n\n        _blur: function() {\n            this.popup.close();\n            clearTimeout(this._focusId);\n            this.trigger(\"blur\");\n        },\n\n        _isFormula: function() {\n            return /^=/.test(this.value());\n        },\n\n        _keydown: function(e) {\n            var key = e.keyCode;\n            var that = this;\n\n            if (KEY_NAMES[key]) {\n                that.popup.close();\n                that._navigated = true;\n            } else if (that._move(key)) {\n                that._navigated = true;\n                e.preventDefault();\n            }\n\n            that._keyDownTimeout = setTimeout(that._syntaxHighlight.bind(that));\n        },\n\n        _keyup: function() {\n            var popup = this.popup;\n            var value;\n\n            if (this._isFormula() && !this._navigated) {\n                value = ((this._tokenContext() || {}).token || {}).value;\n\n                this.filter(value);\n\n                if (!value || !this.formulaSource.view().length) {\n                    popup.close();\n                } else {\n                    popup[popup.visible() ? \"position\" : \"open\"]();\n                    this.list.focusFirst();\n                }\n            }\n\n            this._navigated = false;\n            this._syntaxHighlight();\n\n            this.trigger(\"keyup\");\n        },\n\n        _input: function() {\n            this._syntaxHighlight();\n        },\n\n        _focus: function() {\n            setTimeout(this._sync.bind(this));\n            this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n            this.trigger(\"focus\");\n        },\n\n        _paste: function(ev) {\n            ev.preventDefault();\n            var pos = this.getPos();\n            var text;\n            if (kendo.support.browser.msie) {\n                text = window.clipboardData.getData(\"Text\");\n            } else {\n                text = ev.originalEvent.clipboardData.getData(\"text/plain\");\n            }\n            var val = this.value();\n            val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n            this.value(val);\n            this.setPos(pos.begin + text.length);\n            this.scale();\n        },\n\n        _move: function(key) {\n            var list = this.list;\n            var popup = this.popup;\n            if (popup.visible()) {\n                if (key === keys.DOWN) {\n                    list.focusNext();\n                    if (!list.focus()) {\n                        list.focusFirst();\n                    }\n                    return true;\n                }\n                if (key === keys.UP) {\n                    list.focusPrev();\n                    if (!list.focus()) {\n                        list.focusLast();\n                    }\n                    return true;\n                }\n                if (key === keys.ENTER) {\n                    list.select(list.focus());\n                    popup.close();\n                    return true;\n                }\n                if (key === keys.TAB) {\n                    list.select(list.focus());\n                    popup.close();\n                    return true;\n                }\n                if (key === keys.PAGEUP) {\n                    list.focusFirst();\n                    return true;\n                }\n                if (key === keys.PAGEDOWN) {\n                    list.focusLast();\n                    return true;\n                }\n            }\n            return key === keys.ENTER || key === keys.TAB;\n        },\n\n        _tokenContext: function() {\n            var point = this.getPos();\n            var value = this.value();\n\n            if (!value || !point || !point.collapsed) {\n                return null;\n            }\n\n            var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n            var tok;\n\n            for (var i = 0; i < tokens.length; ++i) {\n                tok = tokens[i];\n                if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                    return { token: tok, nextToken: tokens[i + 1] };\n                }\n            }\n\n            return null;\n        },\n\n        _sync: function() {\n            if (this._editorToSync && this.isActive()) {\n                this._editorToSync.value(this.value());\n            }\n        },\n\n        _textContainer: function() {\n            var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n\n            computedStyles.position = \"absolute\";\n            computedStyles.visibility = \"hidden\";\n            computedStyles.whiteSpace = \"pre\";\n            computedStyles.top = -3333;\n            computedStyles.left = -3333;\n\n            this._span = $(\"<span style='white-space: pre'/>\").css(computedStyles).insertAfter(this.element);\n        },\n\n        _tooltip: function() {\n            this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n        },\n\n        tooltip: function(value) {\n            this._cellTooltip.text(value);\n        },\n\n        toggleTooltip: function(show) {\n            this._cellTooltip.toggle(show);\n        },\n\n        isActive: function() {\n            return this.element[0] === kendo._activeElement();\n        },\n\n        filter: function(value) {\n            if (!value || value.length < this.options.minLength) {\n                return;\n            }\n\n            this._mute = true;\n            this.list.select(-1);\n            this._mute = false;\n\n            this.formulaSource.filter({\n                field: this.list.options.dataValueField,\n                operator: this.options.filterOperator,\n                value: value\n            });\n        },\n\n        hide: function() {\n            this.enable(false);\n            this.element.hide();\n            this._cellTooltip.hide();\n        },\n\n        show: function() {\n            this.enable(true);\n            this.element.show();\n        },\n\n        row: function() {\n            if (this.activeCell) {\n                return this.activeCell.row;\n            }\n        },\n\n        col: function() {\n            if (this.activeCell) {\n                return this.activeCell.col;\n            }\n        },\n\n        position: function(rectangle) {\n            if (!rectangle) {\n                return;\n            }\n\n            this.show();\n\n            this.element\n                .css({\n                    \"top\": rectangle.top + 1 + \"px\",\n                    \"left\": rectangle.left + 1 + \"px\"\n                });\n\n            this._cellTooltip.css({\n                \"top\": (rectangle.top - this._cellTooltip.height() - 10) + \"px\",\n                \"left\": rectangle.left\n            });\n        },\n\n        resize: function(rectangle) {\n            if (!rectangle) {\n                return;\n            }\n\n            this.element.css({\n                width: rectangle.width - 1,\n                height: rectangle.height - 1\n            });\n        },\n\n        canInsertRef: function(isKeyboardAction) {\n            return this._canInsertRef(isKeyboardAction);\n        },\n\n        _canInsertRef: function(isKeyboardAction) {\n            if (this.popup.visible()) {\n                return null;\n            }\n            var strictMode = isKeyboardAction;\n            var point = this.getPos();\n            var tokens, tok;\n\n            if (point && this._isFormula()) {\n                if (point.begin === 0) {\n                    return null;\n                }\n\n                tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point)) {\n                        return canReplace(tok);\n                    }\n                    if (afterPoint(tok)) {\n                        return canInsertBetween(tokens[i-1], tok);\n                    }\n                }\n                return canInsertBetween(tok, null);\n            }\n\n            return null;\n\n            function afterPoint(tok) {\n                return tok.begin > point.begin;\n            }\n            function canReplace(tok) {\n                if (tok) {\n                    if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                        return { replace: true, token: tok, end: tok.end };\n                    }\n                    if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                        if (tok.end == point.end) {\n                            return canInsertBetween(tok, tokens[i+1]);\n                        }\n                        return canInsertBetween(tokens[i-1], tok);\n                    }\n                }\n            }\n            function canInsertBetween(left, right) {\n                if (left == null) {\n                    return null;\n                }\n                if (right == null) {\n                    if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                        return { token: left, end: point.end };\n                    }\n                    return null;\n                }\n                if (strictMode) {\n                    if (left.type == \"op\" && /^(?:punc|op)$/.test(right.type)) {\n                        return { token: left, end: point.end };\n                    }\n                } else {\n                    if (left.type == \"startexp\") {\n                        return { token: left, end: point.end };\n                    }\n                    if (/^(?:op|punc)$/.test(left.type) && /^[,;({]$/.test(left.value)) {\n                        return { token: left, end: point.end };\n                    }\n                    if (/^(?:ref|sym)/.test(left.type)) {\n                        return { token: left, replace: true, end: left.end };\n                    }\n                    if (/^(?:ref|sym)/.test(right.type)) {\n                        return { token: right, replace: true, end: right.end };\n                    }\n                }\n                return false;\n            }\n        },\n\n        refAtPoint: function(sheet) {\n            var x = this._canInsertRef();\n            if (x) {\n                var ref = sheet.selection()._ref.simplify().clone().relative(0, 0, 3);\n                if (sheet.isMerged(ref)) {\n                    ref = ref.topLeft;\n                }\n                if (sheet !== this.activeSheet) {\n                    ref = ref.setSheet(sheet.name(), true);\n                }\n                this._replaceAt(x, ref.print(0, 0));\n            }\n        },\n\n        _replaceAt: function(ctx, newValue) {\n            var value = this.value();\n            var tok = ctx.token;\n            var rest = value.substr(ctx.end);\n            value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n            var point = value.length;\n            value += rest;\n            this._value(value);\n            this.setPos(point);\n            this.scale();\n            this._syntaxHighlight();\n        },\n\n        syncWith: function(formulaInput) {\n            var self = this;\n\n            // IE does not support \"input\" event on elements with contenteditable\n            // https://developer.mozilla.org/en-US/docs/Web/Events/input#Browser_compatibility\n            var eventName = \"input\" + ns;\n            var handler = self._sync.bind(self), iehandler;\n            if (kendo.support.browser.msie) {\n                eventName = \"keydown\" + ns;\n                iehandler = function() {\n                    setTimeout(handler);\n                };\n            }\n\n            self._editorToSync = formulaInput;\n            self.element.off(eventName).on(eventName, iehandler || handler);\n        },\n\n        scale: function() {\n            var element = this.element;\n            var width, height;\n            var horizontalBorders = $(\".k-spreadsheet-haxis\", element.context);\n\n            if (!this._span) {\n                this._textContainer();\n            }\n\n            this._span.html(element.html());\n\n            width = this._span.width() + this.options.scalePadding;\n            height = this._span.height() - horizontalBorders.outerHeight();\n\n            if (width > element.width()) {\n                element.width(width);\n            }\n            if (height > element.height()) {\n                element.height(height);\n            }\n\n            this._sync();\n        },\n\n        _value: function(value) {\n            this.element.text(value);\n        },\n\n        value: function(value) {\n            if (value === undefined) {\n                // jQuery's .text() discards the newlines for some reason\n                var txt = this.element[0].innerText;\n                return txt.replace(/\\n$/, \"\");\n            }\n\n            this._value(value);\n            this._syntaxHighlight();\n        },\n\n        highlightedRefs: function() {\n            return this._highlightedRefs.slice();\n        },\n\n        _syntaxHighlight: function() {\n            var pos = this.getPos();\n            var value = this.value();\n            var refClasses = kendo.spreadsheet.Pane.classNames.series;\n            var highlightedRefs = [];\n            var refIndex = 0;\n            var parens = [];\n            var tokens = [];\n            var activeToken;\n\n            if (pos && !pos.collapsed) {\n                // Backward selection (hold shift, move right to left)\n                // will not work properly if we continuously re-set\n                // the HTML.  If the selection is on, presumably the\n                // text has already been highlighted, so stop here.\n                return;\n            }\n\n            if (!(/^=/.test(value))) {\n                // if an user deleted the initial =, reset the text to\n                // discard any highlighting.  Only do that once.\n                if (this._highlightedRefs.length) {\n                    this._highlightedRefs = [];\n                    this.element.text(value);\n                }\n\n                // also make sure the completion popup goes away\n                if (this.popup) {\n                    this.popup.close();\n                }\n\n                return; // avoid messing with the cursor position below\n            } else {\n                tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                tokens.forEach(function(tok){\n                    tok.active = false;\n                    tok.cls = [ \"k-syntax-\" + tok.type ];\n\n                    if (tok.type == \"ref\") {\n                        tok.colorClass = refClasses[(refIndex++) % refClasses.length];\n                        tok.cls.push(tok.colorClass);\n                        highlightedRefs.push(tok);\n                    }\n                    if (pos && tok.type == \"punc\") {\n                        if (isOpenParen(tok.value)) {\n                            parens.unshift(tok);\n                        } else if (isCloseParen(tok.value)) {\n                            var open = parens.shift();\n                            if (open) {\n                                if (isMatchingParen(tok.value, open.value)) {\n                                    if (touches(tok, pos) || touches(open, pos)) {\n                                        tok.cls.push(\"k-syntax-paren-match\");\n                                        open.cls.push(\"k-syntax-paren-match\");\n                                    }\n                                } else {\n                                    tok.cls.push(\"k-syntax-error\");\n                                    open.cls.push(\"k-syntax-error\");\n                                }\n                            } else {\n                                tok.cls.push(\"k-syntax-error\");\n                            }\n                        }\n                    }\n                    if (pos && touches(tok, pos)) {\n                        tok.cls.push(\"k-syntax-at-point\");\n                        tok.active = true;\n                        activeToken = tok;\n                    }\n                    if (tok.type == \"func\" && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                        tok.cls.push(\"k-syntax-error\");\n                    }\n                });\n                tokens.reverse().forEach(function(tok){\n                    var begin = tok.begin, end = tok.end;\n                    var text = kendo.htmlEncode(value.substring(begin, end));\n                    value = value.substr(0, begin) +\n                        \"<span class='\" + tok.cls.join(\" \") + \"'>\" + text + \"</span>\" +\n                        value.substr(end);\n                });\n                this.element.html(value);\n            }\n            if (pos) {\n                this.setPos(pos.begin, pos.end);\n            }\n\n            this._highlightedRefs = highlightedRefs;\n        },\n\n        destroy: function() {\n            this._editorToSync = null;\n\n            this.element.off(ns);\n\n            clearTimeout(this._focusTimeout);\n            clearTimeout(this._keyDownTimeout);\n\n            this._cellTooltip = null;\n            this._span = null;\n\n            this.popup.destroy();\n            this.popup = null;\n\n            if (this.list) {\n                this.list.destroy();\n            }\n\n            Widget.fn.destroy.call(this);\n        },\n\n        insertNewline: function() {\n            var val = this.value();\n            var pos = this.getPos();\n            var eof = pos.end == val.length;\n            val = val.substr(0, pos.begin) + (eof ? \"\\n\\n\" : \"\\n\" + val.substr(pos.end));\n            this.value(val);\n            this.setPos(pos.begin + 1);\n        }\n    });\n\n    function isOpenParen(ch) {\n        return ch == \"(\" || ch == \"[\" || ch == \"{\";\n    }\n\n    function isCloseParen(ch) {\n        return ch == \")\" || ch == \"]\" || ch == \"}\";\n    }\n\n    function isMatchingParen(close, open) {\n        return open == \"(\" ? close == \")\"\n            :  open == \"[\" ? close == \"]\"\n            :  open == \"{\" ? close == \"}\"\n            :  false;\n    }\n\n    function touches(pos, target) {\n        return pos.begin <= target.begin && pos.end >= target.end;\n    }\n\n    function knownFunction(name) {\n        return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n    }\n\n    kendo.spreadsheet.FormulaInput = FormulaInput;\n    $.extend(true, FormulaInput, { classNames: classNames });\n})(kendo, window);\n\n(function(kendo) {\n\n    var $ = kendo.jQuery;\n\n    var KEY_NAMES = {\n        8: 'backspace',\n        9: 'tab',\n        13: 'enter',\n        27: 'esc',\n        37: 'left',\n        38: 'up',\n        39: 'right',\n        40: 'down',\n        35: 'end',\n        36: 'home',\n        32: 'spacebar',\n        33: 'pageup',\n        34: 'pagedown',\n        46: 'delete',\n        113: ':edit'\n    };\n\n    var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n    var isAlphaNum = function(keyCode) {\n        if ((keyCode > 47 && keyCode < 58)   || // number keys\n            (keyCode > 64 && keyCode < 91)   || // letter keys\n            (keyCode > 95 && keyCode < 112)  || // numpad keys\n            (keyCode > 185 && keyCode < 193) || // ;=,-./` (in order)\n            (keyCode > 218 && keyCode < 223) || // [\\]' (in order)\n            (keyCode === 229)                   // combined key event?\n           ) {\n            return true;\n        }\n\n        return false;\n    };\n\n    var keyName = function(event) {\n        var keyCode = event.keyCode;\n        var name = KEY_NAMES[keyCode];\n\n        if (!name && isAlphaNum(keyCode)) {\n            name = \":alphanum\";\n        }\n\n        // https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key\n        //\n        // Fix for https://github.com/telerik/kendo-ui-core/issues/2284\n        // (starting editor with `=` on Firefox)\n        if (!name && event.key && event.key.length == 1) {\n            name = \":alphanum\";\n        }\n\n        return name;\n    };\n\n    var EventListener = kendo.Class.extend({\n        init: function(target, observer, handlers) {\n            this._handlers = {};\n            this.target = target;\n            this._observer = observer || window;\n\n            this.keyDownProxy = this.keyDown.bind(this);\n            this.mouseProxy = this.mouse.bind(this);\n            this.touchProxy = this.touch.bind(this);\n            this.threshold = 5;\n            this._pressLocation = null;\n\n            target.on(\"keydown\", this.keyDownProxy);\n            target.on(\"contextmenu mousedown cut copy paste scroll wheel click dblclick focus\", this.mouseProxy);\n            target.on(\"touchmove touchend\", this.touchProxy);\n\n            $(document.documentElement).on(\"mousemove mouseup\", this.mouseProxy);\n            $(document.documentElement).on(\"touchmove touchend\", this.touchProxy);\n\n            if (handlers) {\n                for (var key in handlers) {\n                    this.on(key, handlers[key]);\n                }\n            }\n        },\n\n        keyDown: function(e) {\n            // Do not handle keys for Toolbar Tab switch shortcuts\n            if (e.altKey && (e.key === \"n\" || e.key === \"h\" || e.key === \"a\")) {\n                return;\n            }\n\n            this.handleEvent(e, keyName(e.originalEvent));\n        },\n\n        touch: function(e) {\n            this.handleEvent(e, e.type);\n        },\n\n        mouse: function(e) {\n            var rightClick;\n\n            if (e.which) {\n                rightClick = (e.which == 3);\n            } else if (e.button) {\n                rightClick = (e.button == 2);\n            }\n\n            var type = e.type;\n\n            if (type === \"mousedown\") {\n                if (rightClick) {\n                   type = \"rightmousedown\";\n                } else {\n                    this._pressLocation = { x: e.pageX, y: e.pageY };\n                }\n            }\n\n            if (type === \"mouseup\") {\n                if (!rightClick) {\n                    this._pressLocation = null;\n                }\n            }\n\n            if (type === \"mousemove\" && this._pressLocation) {\n                var dx = this._pressLocation.x - e.pageX;\n                var dy = this._pressLocation.y - e.pageY;\n                var distance = Math.sqrt(dx*dx + dy*dy);\n\n                if (distance > this.threshold) {\n                    type = \"mousedrag\";\n                }\n            }\n\n            this.handleEvent(e, type);\n        },\n\n        handleEvent: function(e, name) {\n            var eventKey = \"\";\n\n            e.mod = Mac ? e.metaKey : (e.ctrlKey && !e.altKey);\n\n            if (e.altKey) {\n                eventKey += \"alt+\";\n            }\n\n            if (e.shiftKey) {\n                eventKey += \"shift+\";\n            }\n\n            if (e.ctrlKey) {\n                eventKey += \"ctrl+\";\n            }\n\n            eventKey += name;\n\n            var catchAllHandler = this._handlers['*+' + name];\n\n            if (catchAllHandler) {\n                catchAllHandler.call(this._observer, e, eventKey);\n            }\n\n            var handler = this._handlers[eventKey];\n\n            if (handler) {\n                handler.call(this._observer, e, eventKey);\n            }\n        },\n\n        on: function(event, callback) {\n            var handlers = this._handlers;\n\n            if (typeof callback === \"string\") {\n                callback = this._observer[callback];\n            }\n\n            if (typeof event === \"string\") {\n                event = event.split(\",\");\n            }\n\n            event.forEach(function(e) {\n                handlers[e] = callback;\n            });\n        },\n\n        destroy: function() {\n            this.target.off(\"keydown\", this.keyDownProxy);\n            this.target.off(\"keydown\", this.mouseProxy);\n            $(document.documentElement).off(\"mousemove mouseup\", this.mouseProxy);\n        }\n    });\n\n    kendo.spreadsheet.EventListener = EventListener;\n})(window.kendo);\n\n(function(kendo) {\n\n\n\n    var RangeTreeNode = kendo.Class.extend({\n        init: function Node(level, value, left, right) {\n            this.level = level;\n            this.value = value;\n            this.left = left;\n            this.right = right;\n        }\n    });\n\n    var NilNode = new (function NIL() { \n        this.left = this;\n        this.right = this;\n        this.level = 0;\n    })();\n\n    function skew(node) {\n        if (node.left.level === node.level) {\n            var temp = node;\n            node = node.left;\n            temp.left = node.right;\n            node.right = temp;\n        }\n\n        return node;\n    }\n\n    function split(node) {\n        if (node.right.right.level === node.level) {\n            var temp = node;\n            node = node.right;\n            temp.right = node.left;\n            node.left = temp;\n            node.level += 1;\n        }\n\n        return node;\n    }\n\n    function insert(node, value) {\n        if (node === NilNode) {\n            return new RangeTreeNode(1, value, NilNode, NilNode);\n        } else if (node.value.start > value.start) {\n            node.left = insert(node.left, value);\n        } else {\n            node.right = insert(node.right, value);\n        }\n\n        return split(skew(node));\n    }\n\n    function remove(node, value) {\n        if (node === NilNode) {\n            return node;\n        }\n\n        var diff = node.value.start - value.start;\n        if (diff === 0) {\n            if (node.left !== NilNode && node.right !== NilNode) {\n                var heir = node.left;\n\n                while (heir.right !== NilNode) {\n                    heir = heir.right;\n                }\n\n                node.value = heir.value;\n                node.left = remove(node.left, node.value);\n            } else if (node.left === NilNode) {\n                node = node.right;\n            } else {\n                node = node.left;\n            }\n        } else if (diff > 0) {\n            node.left = remove(node.left, value);\n        } else {\n            node.right = remove(node.right, value);\n        }\n\n        if (node.left.level < (node.level - 1) || node.right.level < (node.level - 1)) {\n            node.level -= 1;\n            if (node.right.level > node.level) {\n                node.right.level = node.level;\n            }\n\n            node = skew(node);\n            node.right = skew(node.right);\n            node.right.right = skew(node.right.right);\n            node = split(node);\n            node.right = split(node.right);\n        }\n\n        return node;\n    }\n\n    var Range = kendo.Class.extend({\n        init: function ValueRange(start, end, value) {\n            this.start = start;\n            this.end = end;\n            this.value = value;\n        },\n\n        intersects: function(range) {\n            return range.start <= this.end && range.end >= this.start;\n        },\n\n        clone: function() {\n            return new Range(this.start, this.end, this.value);\n        }\n    });\n\n    var RangeTree = kendo.Class.extend({\n        init: function RangeTree() {\n            this.root = NilNode;\n        },\n\n        insert: function(value) {\n            this.root = insert(this.root, value);\n        },\n\n        remove: function(value) {\n            this.root = remove(this.root, value);\n        },\n\n        findrange: function(value) {\n            var node = this.root;\n\n            while (node != NilNode) {\n                if (value < node.value.start) {\n                    node = node.left;\n                } else if (value > node.value.end) {\n                    node = node.right;\n                } else {\n                    return node.value;\n                }\n            }\n\n            return null;\n        },\n\n        values: function() {\n            var result = [];\n            values(this.root, result);\n            return result;\n        },\n\n        intersecting: function(start, end) {\n            var ranges = [];\n            intersecting(this.root, new Range(start, end), ranges);\n            return ranges;\n        },\n\n        map: function(callback) {\n            var tree = new RangeTree();\n            map(tree, this.root, callback);\n            return tree;\n        },\n\n        forEach: function(callback) {\n            forEach(this.root, callback);\n        },\n\n        clone: function() {\n            return this.map(function(value) {\n                return value.clone();\n            });\n        },\n\n        first: function() {\n            var first = this.root;\n            while(first.left != NilNode) {\n                first = first.left;\n            }\n\n            return first;\n        },\n\n        last: function() {\n            var last = this.root;\n            while(last.right != NilNode) {\n                last = last.right;\n            }\n\n            return last;\n        }\n    });\n\n    function values(node, result) {\n        if (node === NilNode) {\n            return;\n        }\n\n        values(node.left, result);\n        result.push(node.value);\n        values(node.right, result);\n    }\n\n    function intersecting(node, range, ranges) {\n        if (node === NilNode) {\n            return;\n        }\n\n        var value = node.value;\n\n        if (range.start < value.start) {\n            intersecting(node.left, range, ranges);\n        }\n\n        if (value.intersects(range)) {\n            ranges.push(value);\n        }\n\n        if (range.end > value.end) {\n            intersecting(node.right, range, ranges);\n        }\n    }\n\n    function map(tree, root, callback) {\n        if (root === NilNode) {\n            return;\n        }\n        map(tree, root.left, callback);\n        tree.insert(callback(root.value));\n        map(tree, root.right, callback);\n    }\n\n    function forEach(root, callback) {\n        if (root === NilNode) {\n            return;\n        }\n        forEach(root.left, callback);\n        callback(root.value);\n        forEach(root.right, callback);\n    }\n\n    var RangeList = kendo.Class.extend({\n        init: function RangeList(start, end, value) {\n            if (end === undefined) {\n                this.tree = start;\n            } else {\n                this.tree = new RangeTree();\n                this.tree.insert(new Range(start, end, value));\n            }\n        },\n\n        values: function() {\n            return this.tree.values();\n        },\n\n        map: function(callback) {\n            return new RangeList(this.tree.map(callback));\n        },\n\n        forEach: function(callback) {\n            this.tree.forEach(callback);\n        },\n\n        intersecting: function(start, end) {\n            return this.tree.intersecting(start, end);\n        },\n\n        first: function() {\n            return this.tree.first().value;\n        },\n\n        last: function() {\n            return this.tree.last().value;\n        },\n\n        insert: function(start, end, value) {\n            return this.tree.insert(new Range(start, end, value));\n        },\n\n        value: function(start, end, value) {\n            if (value === undefined) {\n                if (end === undefined) {\n                    end = start;\n                }\n                return this.intersecting(start, end)[0].value;\n            }\n\n            var ranges = this.tree.intersecting(start - 1, end + 1);\n\n            if (ranges.length) {\n                var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n\n                if (firstRange.end < start) {\n                    if (firstRange.value === value) {\n                        start = firstRange.start;\n                    } else {\n                        ranges.shift();\n                    }\n                }\n\n                if (lastRange.start > end) {\n                    if (lastRange.value === value) {\n                        end = lastRange.end;\n                    } else {\n                        ranges.pop();\n                    }\n                }\n\n                for (var i = 0, length = ranges.length; i < length; i++) {\n                    var range = ranges[i];\n                    var rangeValue = range.value;\n                    var rangeStart = range.start;\n                    var rangeEnd = range.end;\n\n                    this.tree.remove(range);\n\n                    if (rangeStart < start) {\n                        if (rangeValue !== value) {\n                            this.insert(rangeStart, start - 1, rangeValue);\n                        } else {\n                            start = rangeStart;\n                        }\n                    }\n\n                    if (rangeEnd > end) {\n                        if (rangeValue !== value) {\n                            this.insert(end + 1, rangeEnd, rangeValue);\n                        } else {\n                            end = rangeEnd;\n                        }\n                    }\n                }\n            }\n\n            this.insert(start, end, value);\n        },\n\n        expandedValues: function(start, end) {\n            var ranges = this.intersecting(start, end);\n            var result = [];\n\n            var rangeIndex = 0;\n\n            for (var i = start; i <= end; i++) {\n                if (ranges[rangeIndex].end < i) {\n                    rangeIndex ++;\n                }\n\n                result.push({ index: i - start, value: ranges[rangeIndex].value });\n            }\n\n            return result;\n        },\n\n        sortedIndices: function(start, end, valueComparer, indices) {\n            var result = this.expandedValues(start, end);\n\n            var comparer = function(a, b) {\n                if (a.value === b.value) {\n                    return a.index - b.index;\n                }\n\n                return valueComparer(a.value, b.value);\n            };\n\n            if (indices) {\n                comparer = function(a, b) {\n                    var x = indices[a.index];\n                    var y = indices[b.index];\n\n                    if (x.value === y.value) {\n                        return valueComparer(a.value, b.value);\n                    }\n\n                    return a.index - b.index;\n                };\n            }\n\n            result.sort(comparer);\n\n            return result;\n        },\n\n        sort: function(start, end, indices) {\n            if (this.intersecting(start, end).length === 1) {\n                return;\n            }\n\n            var values = this.expandedValues(start, end);\n\n            for (var i = 0, len = indices.length; i < len; i++) {\n                this.value(i + start, i + start, values[indices[i].index].value);\n            }\n        },\n\n        copy: function(sourceStart, sourceEnd, targetStart) {\n            var values = this.intersecting(sourceStart, sourceEnd);\n\n            var start = targetStart;\n            var end;\n\n            for (var i = 0, len = values.length; i < len; i++) {\n                var rangeStart = values[i].start;\n\n                if (rangeStart < sourceStart) {\n                    rangeStart = sourceStart;\n                }\n\n                var rangeEnd = values[i].end;\n\n                if (rangeEnd > sourceEnd) {\n                    rangeEnd = sourceEnd;\n                }\n\n                end = start + (rangeEnd - rangeStart);\n\n                this.value(start, end, values[i].value);\n\n                start = ++end;\n            }\n        },\n\n        iterator: function(start, end) {\n            return new Iterator(start, end, this.intersecting(start, end));\n        },\n\n        getState: function() {\n            return this.tree.clone();\n        },\n\n        setState: function(state) {\n            this.tree = state.clone();\n        },\n\n        toJSON: function() {\n            return this.values();\n        },\n\n        fromJSON: function(values) {\n            values.forEach(function(v){\n                this.value(v.start, v.end, v.value);\n            }, this);\n        }\n    });\n\n    var Iterator = kendo.Class.extend({\n        init: function(start, end, ranges) {\n            this.start = start;\n            this.end = end;\n            this.index = 0;\n            this.ranges = ranges;\n        },\n\n        unique: function() {\n            return this.ranges.map(function(range) {\n                return range.value;\n            });\n        },\n\n        at: function(index) {\n            while (this.ranges[this.index] && this.ranges[this.index].end < index) {\n                this.index ++;\n            }\n\n            return this.ranges[this.index] && this.ranges[this.index].value;\n        },\n\n        forEach: function(callback) {\n            for (var i = this.start; i <= this.end; i++) {\n                callback(this.at(i), i);\n            }\n\n            this.index = 0;\n        }\n    });\n\n    var SparseRangeList = RangeList.extend({\n        init: function(start, end, value) {\n            this._defaultValue = value;\n            this.tree = new RangeTree();\n            this.range = new Range(start, end, value);\n        },\n\n        intersecting: function(start, end) {\n            var ranges = this.tree.intersecting(start, end);\n            var result = [];\n            var range;\n\n            if (!ranges.length) {\n                return [this.range];\n            }\n\n            for (var i = 0, len = ranges.length; i < len; i++) {\n                range = ranges[i];\n                if (range.start > start) {\n                    result.push(new Range(start, range.start - 1, this.range.value));\n                }\n\n                result.push(range);\n                start = range.end + 1;\n            }\n\n            if (range.end < end) {\n                result.push(new Range(range.end + 1, end, this.range.value));\n            }\n\n            return result;\n        },\n\n        insert: function(start, end, value) {\n            if (value == null) {\n                value = this._defaultValue;\n            }\n            if (value !== this.range.value) {\n                this.tree.insert(new Range(start, end, value));\n            }\n        },\n\n        lastRangeStart: function() {\n            var node = this.tree.root;\n\n            if (node === NilNode) {\n                return this.range.start;\n            }\n\n            while(node.right !== NilNode) {\n                node = node.right;\n            }\n\n            return node.value.end + 1;\n        }\n    });\n\n\n    kendo.spreadsheet.RangeTree = RangeTree;\n    kendo.spreadsheet.RangeList = RangeList;\n    kendo.spreadsheet.SparseRangeList = SparseRangeList;\n    kendo.spreadsheet.ValueRange = Range;\n})(kendo);\n\n(function(kendo) {\n\n    var Property = kendo.Class.extend({\n        init: function(list) {\n            this.list = list;\n        },\n\n        get: function(index) {\n            return this.parse(this.list.value(index, index));\n        },\n\n        set: function(start, end, value) {\n            if (value === undefined) {\n                value = end;\n                end = start;\n            }\n\n            this.list.value(start, end, value);\n        },\n\n        parse: function(value) {\n            return value;\n        },\n\n        copy: function(start, end, dst) {\n            this.list.copy(start, end, dst);\n        },\n\n        iterator: function(start, end) {\n            return this.list.iterator(start, end);\n        }\n    });\n\n    var JsonProperty = Property.extend({\n        set: function(start, end, value) {\n            this.list.value(start, end, JSON.stringify(value));\n        },\n\n        parse: function(value) {\n            return JSON.parse(value);\n        }\n    });\n\n    var ValueProperty = Property.extend({\n        init: function(values, formats) {\n            Property.prototype.init.call(this, values);\n            this.formats = formats;\n        },\n\n        set: function(start, end, value) {\n            if (value instanceof Date) {\n                value = kendo.spreadsheet.dateToNumber(value);\n                if (!this.formats.value(start,end)) {\n                    this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                }\n            } else if (typeof value == \"number\") {\n                value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n            }\n\n            this.list.value(start, end, value);\n        }\n    });\n\n    function toExcelFormat(format) {\n        return format.replace(/M/g, \"m\").replace(/'/g, '\"').replace(/tt/, \"am/pm\");\n    }\n\n    kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n        specs: [\n            { property: Property, name: \"format\", value: null, sortable: true, serializable: true },\n            { property: ValueProperty, name: \"value\", value: null, sortable: true, serializable: true, depends: \"format\" },\n            { property: Property, name: \"formula\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"background\", value: null, sortable: true, serializable: true },\n            { property: JsonProperty, name: \"vBorders\", value: null, sortable: false, serializable: false },\n            { property: JsonProperty, name: \"hBorders\", value: null, sortable: false, serializable: false },\n            { property: JsonProperty, name: \"dBorders\", value: null, sortable: false, serializable: true },\n            { property: Property, name: \"color\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"fontFamily\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"underline\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"fontSize\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"italic\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"bold\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"textAlign\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"indent\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"verticalAlign\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"wrap\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"validation\", value: null, sortable: false, serializable: true },\n            { property: Property, name: \"enable\", value: null, sortable: false, serializable: true },\n            { property: Property, name: \"link\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"editor\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"comment\", value: null, sortable: true, serializable: true },\n            { property: Property, name: \"html\", value: null, sortable: true, serializable: true }\n        ],\n\n        init: function(rowCount, columnCount, defaultValues) {\n            defaultValues = defaultValues || {};\n            var cellCount = rowCount * columnCount - 1;\n\n            this.rowCount = rowCount;\n            this.columnCount = columnCount;\n            this.cellCount = cellCount;\n            this.properties = {};\n            this.lists = {};\n\n            this.specs.forEach(function(spec) {\n                var name = spec.name;\n                var value = defaultValues[name];\n                if (value === undefined) {\n                    value = spec.value;\n                }\n                this.lists[name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, value);\n                var prop = this.properties[name] = new spec.property(this.lists[name], this.lists[spec.depends]);\n                prop.spec = spec;\n            }, this);\n\n            // XXX: this is a hack but I have no better ideas at this\n            // point.  The getState() method in a SparseRangeList\n            // clones the tree (which just copies values over), but\n            // formulas are objects maintaining complex state.\n            // https://github.com/telerik/kendo-ui-core/issues/2816\n            this.lists.formula.tree.clone = cloneFormulaTree;\n            this.lists.validation.tree.clone = cloneFormulaTree;\n        },\n\n        _resize: function(new_rows, new_cols) {\n            var self = this;\n            var old_rows = self.rowCount;\n            var cell_count = new_rows * new_cols - 1;\n            function scaleIndex(index) {\n                var col = index / old_rows | 0;\n                var row = index % old_rows;\n                return col * new_rows + row;\n            }\n            function scaleNode(node) {\n                // node is a ValueRange from rangelist.js\n                // start/end are rowCount * col + row\n                node.start = scaleIndex(node.start);\n                node.end = scaleIndex(node.end);\n            }\n            Object.keys(self.lists).forEach(function(name) {\n                var list = self.lists[name];\n                if (new_rows != old_rows) {\n                    list.forEach(scaleNode);\n                }\n                list.range.end = cell_count;\n            });\n            self.rowCount = new_rows;\n            self.columnCount = new_cols;\n            self.cellCount = cell_count;\n        },\n\n        getState: function() {\n            var state = {};\n\n            this.specs.forEach(function(spec) {\n               state[spec.name] = this.lists[spec.name].getState();\n            }, this);\n\n            return state;\n        },\n\n        setState: function(state) {\n            this.specs.forEach(function(spec) {\n                this.lists[spec.name].setState(state[spec.name]);\n            }, this);\n        },\n\n        get: function(name, index) {\n            if (index === undefined) {\n                return this.lists[name];\n            }\n\n            switch (name) {\n              case \"borderRight\":\n                index += this.rowCount;\n                /* falls through */\n              case \"borderLeft\":\n                name = \"vBorders\";\n                break;\n\n              case \"borderBottom\":\n                index++;\n                /* falls through */\n              case \"borderTop\":\n                name = \"hBorders\";\n                break;\n            }\n            return index > this.cellCount ? null : this.properties[name].get(index);\n        },\n\n        set: function(name, start, end, value) {\n            switch (name) {\n              case \"borderRight\":\n                start += this.rowCount;\n                end += this.rowCount;\n                /* falls through */\n              case \"borderLeft\":\n                name = \"vBorders\";\n                break;\n\n              case \"borderBottom\":\n                start++;\n                end++;\n                /* falls through */\n              case \"borderTop\":\n                name = \"hBorders\";\n                break;\n            }\n            if (start <= end && end <= this.cellCount) {\n                this.properties[name].set(start, end, value);\n            }\n        },\n\n        fromJSON: function(index, value) {\n            for (var si = 0; si < this.specs.length; si++) {\n                var spec = this.specs[si];\n\n                if (spec.serializable) {\n                    if (value[spec.name] !== undefined) {\n                        this.set(spec.name, index, index, value[spec.name], false);\n                    }\n                }\n            }\n\n            [ \"borderLeft\", \"borderRight\", \"borderTop\", \"borderBottom\" ].forEach(function(b){\n                if (value[b] !== undefined) {\n                    this.set(b, index, index, value[b]);\n                }\n            }, this);\n        },\n\n        copy: function(sourceStart, sourceEnd, targetStart) {\n            this.specs.forEach(function(spec) {\n                this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n            }, this);\n        },\n\n        iterator: function(name, start, end) {\n            var prop = this.properties[name];\n            var iter = prop.iterator(start, end), at = iter.at;\n            var cellCount = this.cellCount;\n            iter.at = function(index) {\n                return index > cellCount ? null : prop.parse(at.call(iter, index));\n            };\n            iter.name = name;\n            iter.value = prop.spec.value;\n            return iter;\n        },\n\n        sortable: function() {\n            return this.specs.filter(function(spec) { return spec.sortable; })\n                .map(function(spec) {\n                    return this.lists[spec.name];\n                }, this);\n        },\n\n        iterators: function(start, end) {\n            return this.specs.reduce(function(ret, spec) {\n                if (spec.serializable) {\n                    ret.push(this.iterator(spec.name, start, end));\n                }\n                return ret;\n            }.bind(this), []);\n        },\n\n        forEach: function(start, end, callback) {\n            var iterators = this.iterators(start, end);\n            var hBorders = this.iterator(\"hBorders\", start, end + 1);\n            var leftBorders = this.iterator(\"vBorders\", start, end);\n            var rightBorders = this.iterator(\"vBorders\", start + this.rowCount, end + this.rowCount);\n            var values, index;\n\n            function addBorder(name, iterator, index) {\n                var val = iterator.at(index);\n                if (val !== iterator.value) {\n                    values[name] = val;\n                }\n            }\n\n            for (index = start; index <= end; index++) {\n                values = {};\n\n                for (var i = 0; i < iterators.length; i++) {\n                    var iterator = iterators[i];\n                    var value = iterator.at(index);\n\n                    if (value !== iterator.value) {\n                        values[iterator.name] = value;\n                    }\n                }\n\n                addBorder(\"borderLeft\", leftBorders, index);\n                addBorder(\"borderRight\", rightBorders, index + this.rowCount);\n                addBorder(\"borderTop\", hBorders, index);\n                if ((index + 1) % this.rowCount) {\n                    addBorder(\"borderBottom\", hBorders, index + 1);\n                }\n\n                callback(values);\n            }\n        },\n\n        forEachProperty: function(callback) {\n            for (var name in this.properties) {\n                callback(this.properties[name]);\n            }\n        }\n    });\n\n    function cloneFormulaValue(x) {\n        x = x.clone();\n        x.value = x.value.deepClone(); // x.value is Formula or Validation\n        return x;\n    }\n\n    function cloneFormulaTree() {\n        var tree = this.map(cloneFormulaValue);\n        tree.clone = cloneFormulaTree; // because it's a new RangeTree now\n        return tree;\n    }\n\n    kendo.spreadsheet.ALL_PROPERTIES = kendo.spreadsheet.PropertyBag.prototype.specs.reduce(function(a, spec) {\n        if (spec.serializable) {\n            a.push(spec.name);\n        }\n        return a;\n    }, [ \"borderTop\", \"borderRight\", \"borderBottom\", \"borderLeft\" ]);\n\n})(window.kendo);\n\n// -*- fill-column: 100 -*-\n    // WARNING: removing the following jshint declaration and turning\n    // == into === to make JSHint happy will break functionality.\n\n\n    \"use strict\";\n\n    var spreadsheet$8 = kendo.spreadsheet;\n    var Class$2 = kendo.Class;\n\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : \"\") + String.fromCharCode(65 + (colIndex % 26));\n    }\n\n    function displaySheet(sheet) {\n        if (/^[a-z_][a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return \"'\" + sheet.replace(/\\x27/g, \"\\\\'\") + \"'\";\n    }\n\n    function displayRef(sheet, row, col, rel) {\n        var aa = \"\";\n\n        ++row;\n\n        if (!isFinite(row)) {\n            row = \"\";\n        }\n        else if (rel != null && !(rel & 2)) {\n            row = \"$\" + row;\n        }\n\n        if (!isFinite(col)) {\n            col = \"\";\n        }\n        else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = \"$\" + aa;\n            }\n        }\n\n        if (sheet) {\n            return displaySheet(sheet) + \"!\" + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n\n    /* -----[ References ]----- */\n\n    var Ref$4 = Class$2.extend({\n        type: \"ref\",\n        sheet: \"\",\n        clone: function() {\n            return this;\n        },\n        hasSheet: function() {\n            return this._hasSheet;\n        },\n        simplify: function() {\n            return this;\n        },\n        setSheet: function(sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function(){\n            return this;\n        },\n        relative: function(){\n            return this;\n        },\n        adjust: function(){\n            return this;\n        },\n        toString: function() {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function(callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function(callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function(ref) {\n            return this.intersect(ref) !== NULL$1;\n        },\n        isCell: function() {\n            return false;\n        },\n        toRow: function() {\n            return this;\n        },\n        toColumn: function() {\n            return this;\n        },\n\n        // UnionRef overrides these, to access its subranges.\n        first: function() {\n            return this;\n        },\n        lastRange: function() {\n            return this;\n        },\n        size: function() {\n            return 1;\n        },\n        rangeAt: function() {\n            return this;\n        },\n        nextRangeIndex: function() {\n            return 0;\n        },\n        previousRangeIndex: function() {\n            return 0;\n        },\n        eq: function(reference) {\n            var r1 = this;\n            var r2 = reference;\n\n            if (r1 === NULL$1 || r2 === NULL$1) {\n                return r1 === r2;\n            }\n\n            // make positions consistent\n            if ((r2 instanceof CellRef$5) || (r2 instanceof RangeRef$4 && !(r1 instanceof CellRef$5))) {\n               r1 = reference;\n               r2 = this;\n            }\n\n            if (r1 instanceof CellRef$5) { // cell eq *\n                r2 = r2.simplify();\n                return r2 instanceof CellRef$5 && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            }\n            else if (r1 instanceof RangeRef$4) { // range eq range/union\n                if (r2 instanceof RangeRef$4) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef$3) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            }\n            else if (r1 instanceof UnionRef$3 && r2 instanceof UnionRef$3) { // union eq union\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                   return false;\n                }\n\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n\n                return true;\n            }\n\n            return r1 === r2;   // XXX: possibly NameRef when we'll support it.\n        },\n\n        concat: function(ref) {\n            return new UnionRef$3([this, ref]);\n        },\n\n        replaceAt: function(index, ref) {\n            return ref;\n        },\n\n        forEachColumnIndex: function(callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n\n        forEachRowIndex: function(callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n\n        forEachAxisIndex: function(axis, callback) {\n            var sorted = [];\n\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n\n            this[method](function(ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n\n            sorted.sort(function(a,b) {\n                return a > b ? 1 : (a < b ? -1 : 0);\n            }).forEach(callback);\n        },\n\n        valid: function() {\n            return false;\n        },\n\n        renameSheet: function(oldSheetName, newSheetName) {\n            if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n                this.sheet = newSheetName;\n                return true;\n            }\n        }\n    });\n\n    Ref$4.display = displayRef;\n\n    /* -----[ Null reference ]----- */\n\n    var NULL$1 = new (Ref$4.extend({\n        init: function NullRef(){},\n        print: function() {\n            return \"#NULL!\";\n        },\n        eq: function(ref) {\n            return ref === this;\n        },\n        forEach: function() {}\n    }))();\n\n    /* -----[ Name reference ]----- */\n\n    var NameRef$3 = Ref$4.extend({\n        ref: \"name\",\n        init: function NameRef(name){\n            this.name = name;\n        },\n        clone: function() {\n            return new NameRef$3(this.name)\n                .setSheet(this.sheet, this.hasSheet());\n        },\n        print: function() {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + \"!\" + ret;\n            }\n            return ret;\n        }\n    });\n\n    /* -----[ Cell reference ]----- */\n\n    var CellRef$5 = Ref$4.extend({\n        ref: \"cell\",\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function() {\n            return new CellRef$5(this.row, this.col, this.rel)\n                .setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function(ref) {\n            if (ref instanceof CellRef$5) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL$1;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function(trow, tcol, mod) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null && rel) {\n                var sheet = this.hasSheet() ? displaySheet(this.sheet) + \"!\" : \"\";\n                if (isFinite(col)) {\n                    col = rel & 1 ? (\"C[\" + col + \"]\") : (\"C\" + (col + 1));\n                } else {\n                    col = \"\";\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? (\"R[\" + row + \"]\") : (\"R\" + (row + 1));\n                } else {\n                    row = \"\";\n                }\n                return sheet + row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                if (mod) {\n                    // Hacks: see the big comment below in `absolute()`\n                    row = abs.row % 0x100000;\n                    col = abs.col % 0x4000;\n                    if (row < 0) {\n                        row += 0x100000;\n                    }\n                    if (col < 0) {\n                        col += 0x4000;\n                    }\n                    return displayRef(this._hasSheet && this.sheet, row, col, rel);\n                }\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : \"#REF!\";\n            }\n        },\n        absolute: function(arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;    // already absolute\n            }\n\n            // Hacks: we make coordinates modulo 0x4000 (max col) and 0x100000 (max row).  This\n            // fixes importing relative references in definedName-s from Excel.  Example in\n            // Excel: select cell E3, open the Name Manager (in Formula tab) and define name\n            // TEST with value Sheet1!A1:C3.  The serialization of this name in XLSX is:\n            //\n            //     <definedName name=\"TEST\">Sheet1!XFA1048575:XFC1</definedName>\n            //\n            // This is insane, of course, but oh well.  Excel.  If you type in E3 =SUM(TEST) it\n            // works (it actually sums the cells), but if you type =SUM(Sheet1!XFA1048575:XFC1)\n            // you get back zero.  Let's see why SUM(TEST) works:\n            //\n            //     XFA1048575:XFC1                   E3\n            //     (zero-based indexes below)\n            //\n            //     R[1048574]C[16380]:R[0]C[16382] + R2C4 = R1048576C16384:R2C16386\n            //                                            % (0x100000, 0x4000)\n            //                                            = R0C0:R2C2 (== A1:C3)\n            //\n            // So XFA1048575:XFC1 is relocated to E3 at evaluation time, and because we take\n            // rows modulo 0x100000 and cols modulo 0x4000, we get back the correct range.\n            //\n            // IMO Excel should disallow A1-style relative references in name definitions\n            // (simply because the meaning of the A1:C3 you type in Name Manager depends on the\n            // active cell) and only allow R1C1 notation  that's unambiguous.  But it doesn't.\n            // Moreover, R1C1-style refs in XLSX are explicitly forbidden by the spec, and the\n            // hacks above are not documented  how else could we have fun implementing a XLSX\n            // reader?\n            if (ret.rel & 1) {\n                // relative col, add anchor\n                ret.col = (ret.col + acol) % 0x4000;\n            }\n            if (ret.rel & 2) {\n                // relative row, add anchor\n                ret.row = (ret.row + arow) % 0x100000;\n            }\n\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function() {\n            return new RangeRef$4(this, this);\n        },\n        relative: function(arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef$5(row, col, rel)\n                .setSheet(this.sheet, this.hasSheet());\n        },\n        height: function() {\n            return 1;\n        },\n        width: function() {\n            return 1;\n        },\n        toString: function() {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function() {\n            return true;\n        },\n        leftColumn: function() {\n            return this;\n        },\n        rightColumn: function() {\n            return this;\n        },\n        topRow: function() {\n            return this;\n        },\n        bottomRow: function() {\n            return this;\n        },\n        forEachRow: function(callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function(callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function(row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL$1;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL$1;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function() {\n            if (this.rel) {\n                throw new Error(\"valid() called on relative reference\");\n            }\n            var col = this.col, row = this.row;\n            return !((isFinite(col) && col < 0) || (isFinite(row) && row < 0));\n        }\n    });\n\n    /* -----[ Range reference ]----- */\n\n    var RangeRef$4 = Ref$4.extend({\n        ref: \"range\",\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                // \"3D\" reference\n                this.endSheet = br.sheet;\n            }\n            // we want to drop any sheet information from the cells here.\n            this.topLeft = new CellRef$5(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef$5(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function() {\n            return new RangeRef$4(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function(range) {\n            return this._containsCell(range.topLeft)\n                && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function(cell) {\n            return cell.sheet == this.sheet\n                && cell.row >= this.topLeft.row\n                && cell.col >= this.topLeft.col\n                && cell.row <= this.bottomRight.row\n                && cell.col <= this.bottomRight.col;\n        },\n        contains: function(ref) {\n            if (ref instanceof Array) {\n                var that = this;\n\n                return ref.some(function(_ref) { return that.contains(_ref); });\n            }\n            if (ref instanceof CellRef$5) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef$4) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function(ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL$1;\n            }\n            var a_left    = this.topLeft.col;\n            var a_top     = this.topLeft.row;\n            var a_right   = this.bottomRight.col;\n            var a_bottom  = this.bottomRight.row;\n            var b_left    = ref.topLeft.col;\n            var b_top     = ref.topLeft.row;\n            var b_right   = ref.bottomRight.col;\n            var b_bottom  = ref.bottomRight.row;\n            if (a_left <= b_right &&\n                b_left <= a_right &&\n                a_top <= b_bottom &&\n                b_top <= a_bottom)\n            {\n                return new RangeRef$4(\n                    // topLeft\n                    new CellRef$5(Math.max(a_top, b_top),\n                                Math.max(a_left, b_left)),\n                    // bottomRight\n                    new CellRef$5(Math.min(a_bottom, b_bottom),\n                                Math.min(a_right, b_right))\n                ).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL$1;\n            }\n        },\n        intersect: function(ref) {\n            if (ref instanceof CellRef$5) {\n                return this._containsCell(ref) ? ref : NULL$1;\n            }\n            if (ref instanceof RangeRef$4) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef$3) {\n                return ref.intersect(this);\n            }\n            return NULL$1;        // can't handle NameRef-s here.\n        },\n        simplify: function() {\n            if (this.isCell()) {\n                return new CellRef$5(\n                    this.topLeft.row,\n                    this.topLeft.col,\n                    this.topLeft.rel\n                ).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function() {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            // do not attempt to normalize unless relativeness of rows and cols are the same.\n            // https://github.com/telerik/kendo-ui-core/issues/4278\n            if (rr1 === rr2 && rc1 === rc2) {\n                if (r1 > r2) {\n                    changes = true;\n                    tmp = r1; r1 = r2; r2 = tmp;\n                    tmp = rr1; rr1 = rr2; rr2 = tmp;\n                }\n                if (c1 > c2) {\n                    changes = true;\n                    tmp = c1; c1 = c2; c2 = tmp;\n                    tmp = rc1; rc1 = rc2; rc2 = tmp;\n                }\n                if (changes) {\n                    this.topLeft = new CellRef$5(r1, c1, rc1 | rr1);\n                    this.bottomRight = new CellRef$5(r2, c2, rc2 | rr2);\n                }\n            }\n            return this;\n        },\n        print: function(trow, tcol, mod) {\n            if (mod || this.absolute(trow, tcol).valid()) {\n                var ret = this.topLeft.print(trow, tcol, mod)\n                    + \":\"\n                    + this.bottomRight.print(trow, tcol, mod);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet)\n                        + (this.endSheet ? \":\" + displaySheet(this.endSheet) : \"\")\n                        + \"!\" + ret;\n                }\n                return ret;\n            }\n            return \"#REF!\";\n        },\n        absolute: function(arow, acol) {\n            return new RangeRef$4(\n                this.topLeft.absolute(arow, acol),\n                this.bottomRight.absolute(arow, acol)\n            ).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function(arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef$4(\n                this.topLeft.relative(arow, acol, relTL),\n                this.bottomRight.relative(arow, acol, relBR)\n            ).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function() {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error(\"Mixed relative/absolute references\");\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function() {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error(\"Mixed relative/absolute references\");\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function() {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function() {\n            return new RangeRef$4(this.topLeft, new CellRef$5(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function() {\n            return new RangeRef$4(new CellRef$5(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function() {\n            return new RangeRef$4(this.topLeft, new CellRef$5(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function() {\n            return new RangeRef$4(new CellRef$5(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function() {\n            return this;\n        },\n        toRow: function(row) {\n            row += Math.max(0, this.topLeft.row);\n            return new RangeRef$4(\n                new CellRef$5(row, this.topLeft.col),\n                new CellRef$5(row, this.bottomRight.col)\n            ).setSheet(this.sheet, this.hasSheet());\n        },\n        toColumn: function(col) {\n            col += Math.max(0, this.topLeft.col);\n            return new RangeRef$4(\n                new CellRef$5(this.topLeft.row, col),\n                new CellRef$5(this.bottomRight.row, col)\n            ).setSheet(this.sheet, this.hasSheet());\n        },\n        toCell: function(row, col) {\n            row += Math.max(0, this.topLeft.row);\n            col += Math.max(0, this.topLeft.col);\n            return new CellRef$5(row, col, 0)\n                .setSheet(this.sheet, this.hasSheet());\n        },\n        forEachRow: function(callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef$4(\n                    new CellRef$5(i, startCol),\n                    new CellRef$5(i, endCol)\n                ));\n            }\n        },\n        forEachColumn: function(callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef$4(\n                    new CellRef$5(startRow, i),\n                    new CellRef$5(endRow, i)\n                ));\n            }\n        },\n        intersecting: function(refs) {\n            return refs.filter(function(ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n\n        union: function(refs, callback) {\n            var intersecting = this.intersecting(refs);\n\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n\n            var modified = false;\n\n            intersecting.forEach(function(ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n\n                if (callback) {\n                    callback(ref);\n                }\n            });\n\n            var result = new RangeRef$4(\n                new CellRef$5(topLeftRow, topLeftCol),\n                new CellRef$5(bottomRightRow, bottomRightCol)\n            );\n\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function(options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) { return value || 0; }\n\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL$1;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef$4(new CellRef$5(limit(top), limit(left)),\n                                    new CellRef$5(limit(bottom), limit(right)));\n            } else {\n                return NULL$1;\n            }\n        },\n        move: function(rows, cols) {\n            return new RangeRef$4(\n                new CellRef$5(this.topLeft.row + rows,\n                            this.topLeft.col + cols),\n                new CellRef$5(this.bottomRight.row + rows,\n                            this.bottomRight.col + cols)\n            );\n        },\n        first: function() {\n            return this.topLeft.clone().setSheet(this.sheet, this.hasSheet());\n        },\n        isCell: function() {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function() {\n            return this.topLeft + \":\" + this.bottomRight;\n        },\n        adjust: function(row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL$1 && tr === NULL$1) {\n                return NULL$1;\n            }\n            if (tl === NULL$1) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            }\n            else if (tr === NULL$1) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef$4(tl, tr)\n                .setSheet(this.sheet, this.hasSheet())\n                .simplify();\n        },\n        valid: function() {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n\n    /* -----[ Union reference ]----- */\n\n    var UnionRef$3 = Ref$4.extend({\n        init: function UnionRef(refs){\n            this.refs = refs;\n            this.length = refs.length;\n        },\n        clone: function() {\n            return new UnionRef$3(this.refs.slice());\n        },\n        intersect: function(ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL$1) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef$3(a).simplify();\n            }\n            return NULL$1;\n        },\n        simplify: function() {\n            var u = new UnionRef$3(this.refs.reduce(function(a, ref){\n                ref = ref.simplify();\n                if (ref !== NULL$1) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL$1;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function(arow, acol) {\n            return new UnionRef$3(this.refs.map(function(ref){\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function(callback, obj) {\n            this.refs.forEach(function(ref){\n                if (ref instanceof UnionRef$3) {\n                    ref.forEach(callback, obj);\n                } else {\n                    callback.call(obj, ref);\n                }\n            }, obj);\n        },\n        toRangeRef: function() {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function(theRef) {\n            return this.refs.some(function(ref) { return ref.contains(theRef); });\n        },\n        map: function(callback, obj) {\n            var refs = [];\n            this.forEach(function(ref){\n                refs.push(callback.call(obj, ref));\n            });\n            return new UnionRef$3(refs);\n        },\n        first: function() {\n            return this.refs[0].first();\n        },\n        lastRange: function() {\n            return this.refs[this.length - 1];\n        },\n        size: function() {\n            return this.length;\n        },\n        single: function() {\n            return this.length == 1;\n        },\n        empty: function() {\n            return this.length === 0;\n        },\n        isCell: function() {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function(index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function(index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function(index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function(ref) {\n            return new UnionRef$3(this.refs.concat([ref]));\n        },\n        print: function(row, col, mod) {\n            return this.refs.map(function(ref) { return ref.print(row, col, mod); }).join(\",\");\n        },\n\n        replaceAt: function(index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef$3(newRefs);\n        },\n\n        leftColumn: function() {\n            return this.map(function(ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function() {\n            return this.map(function(ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function() {\n            return this.map(function(ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function() {\n            return this.map(function(ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function(callback) {\n            this.forEach(function(ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function(callback) {\n            this.forEach(function(ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function(row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function(ref){\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function() {\n            return this.refs.map(function(ref){\n                return ref.toString();\n            }).join(\", \");\n        },\n        valid: function() {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        },\n        renameSheet: function(oldSheetName, newSheetName) {\n            this.refs.forEach(function(ref){\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        }\n    });\n\n    /* -----[ exports ]----- */\n\n    spreadsheet$8.NULLREF = NULL$1;\n    spreadsheet$8.SHEETREF = new RangeRef$4(new CellRef$5(0, 0), new CellRef$5(Infinity, Infinity));\n    spreadsheet$8.FIRSTREF = new CellRef$5(0, 0);\n    spreadsheet$8.Ref = Ref$4;\n    spreadsheet$8.NameRef = NameRef$3;\n    spreadsheet$8.CellRef = CellRef$5;\n    spreadsheet$8.RangeRef = RangeRef$4;\n    spreadsheet$8.UnionRef = UnionRef$3;\n\n    spreadsheet$8.SHEETREF.print = function() {\n        return \"#SHEET\";\n    };\n\n(function(kendo) {\n\n    var RangeRef = kendo.spreadsheet.RangeRef;\n    var CellRef = kendo.spreadsheet.CellRef;\n\n    var AutoFillCalculator = kendo.Class.extend({\n        init: function(grid) {\n            this._grid = grid;\n        },\n\n        rectIsVertical: function(start, end, x, y) {\n            var startRect = this._grid.rectangle(start.toRangeRef());\n            var endRect = this._grid.rectangle(end.toRangeRef());\n            return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n        },\n\n        autoFillDest: function(selection, cursor) {\n            var topLeft = selection.topLeft;\n            var bottomRight = selection.bottomRight;\n\n            var quadrant;\n            var lower = cursor.row >= topLeft.row;\n            var further = cursor.col >= topLeft.col;\n\n            if (lower) {\n                quadrant = further ? 4 : 3;\n            } else {\n                quadrant = further ? 2 : 1;\n            }\n\n            var pivot, opposite, cornerResult, expanding;\n\n            if (quadrant === 4) {\n                pivot = topLeft;\n                opposite = bottomRight;\n\n                expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n\n                if (expanding) {\n                    cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                }\n\n                if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) { // vertical\n                    cornerResult = new CellRef(cursor.row, opposite.col);\n                } else {\n                    cornerResult = new CellRef(opposite.row, cursor.col);\n                }\n            } else if (quadrant === 3) {\n                var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n\n                if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) { // vertical\n                    pivot = topLeft;\n                    cornerResult = new CellRef(cursor.row, bottomRight.col);\n                } else {\n                    pivot = bottomRight;\n                    cornerResult = new CellRef(topLeft.row, cursor.col);\n                }\n            } else if (quadrant === 2){\n                var topRight = new CellRef(topLeft.row, bottomRight.col);\n\n                if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) { // horizontal\n                    pivot = topLeft;\n                    cornerResult = new CellRef(bottomRight.row, cursor.col);\n                } else {\n                    pivot = bottomRight;\n                    cornerResult = new CellRef(cursor.row, topLeft.col);\n                }\n            } else {\n                pivot = bottomRight;\n                if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) { // horizontal\n                    cornerResult = new CellRef(cursor.row, topLeft.col);\n                } else {\n                    cornerResult = new CellRef(topLeft.row, cursor.col);\n                }\n            }\n\n            return this._grid.normalize(new RangeRef(pivot, cornerResult));\n        }\n    });\n\n    kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n})(kendo);\n\n(function(kendo) {\n\n    var RangeRef = kendo.spreadsheet.RangeRef;\n    var CellRef = kendo.spreadsheet.CellRef;\n\n    var EdgeNavigator = kendo.Class.extend({\n        init: function(field, axis, rangeGetter, union) {\n            this.rangeGetter = rangeGetter;\n\n            this.prevLeft = function(index) {\n                var current = union(this.range(index));\n                var range = this.range(axis.prevVisible(current.topLeft[field]));\n                return union(range).topLeft[field];\n            };\n\n            this.nextRight = function(index) {\n                var current = union(this.range(index));\n                var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                return union(range).bottomRight[field];\n            };\n\n            // these two don't look like the other ones, as they \"shrink\"\n            this.nextLeft = function(index) {\n                var range = union(this.range(index));\n                return axis.nextVisible(range.bottomRight[field]);\n            };\n\n            this.prevRight = function(index) {\n                var range = union(this.range(index));\n                return axis.prevVisible(range.topLeft[field]);\n            };\n        },\n\n        boundary: function(top, bottom) {\n            this.top = top;\n            this.bottom = bottom;\n        },\n\n        range: function(index) {\n            return this.rangeGetter(index, this.top, this.bottom);\n        }\n    });\n\n    var SheetNavigator = kendo.Class.extend({\n        init: function(sheet) {\n            this._sheet = sheet;\n            this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n\n            this.colEdge = new EdgeNavigator(\"col\", this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n            this.rowEdge = new EdgeNavigator(\"row\", this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n        },\n\n        height: function(height) {\n            this._viewPortHeight = height;\n        },\n\n        union: function(ref) {\n            return this._sheet.unionWithMerged(ref);\n        },\n\n        columnRange: function(col, topRow, bottomRow) {\n            return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n        },\n\n        rowRange: function(row, leftCol, rightCol) {\n            return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n        },\n\n        selectionIncludesMergedCells: function() {\n            return this._sheet.select().contains(this._sheet._mergedCells);\n        },\n\n        setSelectionValue: function(value) {\n            var selection = this._sheet.selection();\n\n            setTimeout(function() {\n                selection.value(value());\n            });\n        },\n\n        selectAll: function() {\n            this._sheet.select(this._sheet._sheetRef);\n        },\n\n        select: function(ref, mode, addToExisting) {\n            ref = this.refForMode(ref, mode);\n\n            if (addToExisting) {\n                ref = this._sheet.select().concat(ref);\n            }\n\n            this._sheet.select(ref);\n        },\n\n        refForMode: function(ref, mode) {\n            var grid = this._sheet._grid;\n\n            switch(mode) {\n                case \"range\":\n                    ref = grid.normalize(ref);\n                    break;\n                case \"row\":\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case \"column\":\n                    ref = grid.colRef(ref.col);\n                    break;\n                case \"sheet\":\n                    ref = this._sheet._sheetRef;\n                    break;\n            }\n\n            return ref;\n        },\n\n        startSelection: function(ref, mode, addToExisting, shiftKey, view) {\n            if (mode == \"autofill\") {\n                this._sheet.startAutoFill();\n            } else if (shiftKey && mode == \"range\") {\n                var range = new RangeRef(this._sheet.activeCell().first(), ref);\n                this._sheet.select(range, false, false);\n                this._sheet.startSelection(view);\n            } else {\n                this._sheet.startSelection(view);\n                this.select(ref, mode, addToExisting);\n            }\n        },\n\n        completeSelection: function() {\n            this._sheet.completeSelection();\n        },\n\n        selectForContextMenu: function(ref, mode) {\n            var sheet = this._sheet;\n            sheet._activeDrawing = null;\n            if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                this.select(ref, mode);\n            }\n        },\n\n        selectDrawingForContextMenu: function(drawing) {\n            var sheet = this._sheet;\n            sheet._activeDrawing = drawing;\n            sheet.triggerChange({ selection: true });\n        },\n\n        modifySelection: function(action) {\n            var direction = this.determineDirection(action);\n\n            var sheet = this._sheet;\n            var viewPortHeight = this._viewPortHeight;\n            var rows = sheet._grid._rows;\n            var columns = sheet._grid._columns;\n\n            var originalSelection = sheet.currentOriginalSelectionRange();\n            var selection = sheet.select().toRangeRef();\n            var activeCell = sheet.activeCell();\n\n            var topLeft = originalSelection.topLeft.clone();\n            var bottomRight = originalSelection.bottomRight.clone();\n            var bottomLeft = new CellRef(bottomRight.row, topLeft.col);\n\n            var scrollInto;\n\n            this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n            this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n\n            switch (direction) {\n              case \"expand-left\": // <| |\n                topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                scrollInto = topLeft;\n                break;\n              case \"shrink-right\": // |>|\n                topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                scrollInto = topLeft;\n                break;\n              case \"expand-right\": // | |>\n                bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                scrollInto = bottomRight;\n                break;\n              case \"shrink-left\": // |<|\n                bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                scrollInto = bottomRight;\n                break;\n\n                // four actions below mirror the upper ones, on the vertical axis\n              case \"expand-up\":\n                topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                scrollInto = topLeft;\n                break;\n              case \"shrink-down\":\n                topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                scrollInto = topLeft;\n                break;\n              case \"expand-down\":\n                bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                scrollInto = bottomRight;\n                break;\n              case \"shrink-up\":\n                bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                scrollInto = bottomRight;\n                break;\n\n                // pageup/down - may need improvement\n              case \"expand-page-up\":\n                topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                break;\n              case \"shrink-page-up\":\n                bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                break;\n              case \"expand-page-down\":\n                bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                break;\n              case \"shrink-page-down\":\n                topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                break;\n\n              case \"first-col\":\n                topLeft.col = columns.firstVisible();\n                bottomRight.col = activeCell.bottomRight.col;\n                scrollInto = topLeft;\n                break;\n              case \"last-col\":\n                bottomRight.col = columns.lastVisible();\n                topLeft.col = activeCell.topLeft.col;\n                scrollInto = bottomRight;\n                break;\n              case \"first-row\":\n                topLeft.row = rows.firstVisible();\n                bottomRight.row = activeCell.bottomRight.row;\n                scrollInto = topLeft;\n                break;\n              case \"last-row\":\n                bottomRight.row = rows.lastVisible();\n                topLeft.row = activeCell.topLeft.row;\n                scrollInto = bottomRight;\n                break;\n              case \"last\":\n                bottomRight.row = rows.lastVisible();\n                bottomRight.col = columns.lastVisible();\n                topLeft = activeCell.topLeft;\n                scrollInto = bottomRight;\n                break;\n              case \"first\":\n                topLeft.row = rows.firstVisible();\n                topLeft.col = columns.firstVisible();\n                bottomRight = activeCell.bottomRight;\n                scrollInto = topLeft;\n                break;\n\n              case \"expand-word-right\":\n                bottomRight.col = columns.nextUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n                scrollInto = bottomRight;\n                break;\n              case \"shrink-word-right\":\n                topLeft.col = columns.nextUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n                scrollInto = topLeft;\n                break;\n              case \"expand-word-left\":\n                topLeft.col = columns.prevUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n                scrollInto = topLeft;\n                break;\n              case \"shrink-word-left\":\n                bottomRight.col = columns.prevUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n                scrollInto = bottomRight;\n                break;\n              case \"expand-word-up\":\n                topLeft.row = rows.prevUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n                scrollInto = topLeft;\n                break;\n              case \"shrink-word-up\":\n                bottomRight.row = rows.prevUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n                scrollInto = bottomRight;\n                break;\n              case \"expand-word-down\":\n                bottomRight.row = rows.nextUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n                scrollInto = bottomRight;\n                break;\n              case \"shrink-word-down\":\n                topLeft.row = rows.nextUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n                scrollInto = topLeft;\n                break;\n            }\n\n            var newSelection = new RangeRef(topLeft, bottomRight);\n\n            if (!this.union(newSelection).intersects(activeCell)) {\n                // throw new Error(newSelection.print() + \" does not contain \" + activeCell.print());\n                this.modifySelection(direction.replace(\"shrink\", \"expand\"));\n                return;\n            }\n\n            if (scrollInto) {\n                sheet.focus(scrollInto);\n            }\n\n            this.updateCurrentSelectionRange(newSelection);\n        },\n\n        moveActiveCell: function(direction) {\n            var sheet = this._sheet;\n            var activeCell = sheet.activeCell();\n            var topLeft = activeCell.topLeft;\n            var bottomRight = activeCell.bottomRight;\n\n            var cell = sheet.originalActiveCell();\n            var rows = sheet._grid._rows;\n            var columns = sheet._grid._columns;\n\n            var row = cell.row;\n            var column = cell.col;\n\n            switch (direction) {\n              case \"left\":\n                column = columns.prevVisible(topLeft.col);\n                break;\n              case \"up\":\n                row = rows.prevVisible(topLeft.row);\n                break;\n              case \"right\":\n                column = columns.nextVisible(bottomRight.col);\n                break;\n              case \"down\":\n                row = rows.nextVisible(bottomRight.row);\n                break;\n              case \"first-col\":\n                column = columns.firstVisible();\n                break;\n              case \"last-col\":\n                column = columns.lastVisible();\n                break;\n              case \"first-row\":\n                row = rows.firstVisible();\n                break;\n              case \"last-row\":\n                row = rows.lastVisible();\n                break;\n              case \"last\":\n                row = rows.lastVisible();\n                column = columns.lastVisible();\n                break;\n              case \"first\":\n                row = rows.firstVisible();\n                column = columns.firstVisible();\n                break;\n              case \"next-page\":\n                row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                break;\n              case \"prev-page\":\n                row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                break;\n\n              case \"word-right\":\n                column = columns.nextUntil(column, makeWordMovement(sheet, bottomRight, true));\n                break;\n              case \"word-left\":\n                column = columns.prevUntil(column, makeWordMovement(sheet, bottomRight, true));\n                break;\n              case \"word-up\":\n                row = rows.prevUntil(row, makeWordMovement(sheet, bottomRight, false));\n                break;\n              case \"word-down\":\n                row = rows.nextUntil(row, makeWordMovement(sheet, bottomRight, false));\n                break;\n            }\n\n            sheet.select(new CellRef(row, column));\n        },\n\n        navigateInSelection: function(direction) {\n            var sheet = this._sheet;\n            var activeCell = sheet.activeCell();\n            var topLeft = activeCell.topLeft;\n\n            var cell = sheet.originalActiveCell();\n            var rows = sheet._grid._rows;\n            var columns = sheet._grid._columns;\n\n            var row = cell.row;\n            var column = cell.col;\n\n            var isFirstCell = false;\n            var isLastCell = false;\n\n            var selTopLeft, selBottomRight;\n\n            var topLeftCol = topLeft.col;\n            var topLeftRow = topLeft.row;\n            var tmp;\n\n            function setSelection(sel) {\n                selTopLeft = sel.topLeft;\n                selBottomRight = sel.bottomRight;\n            }\n\n            setSelection(sheet.currentNavigationRange());\n\n            var done = false;\n            var navigatedAway = false;\n\n            while (!done && !navigatedAway) {\n                var current = new CellRef(row, column);\n                var isSingleCellSelected = sheet.singleCellSelection();\n\n                if(isSingleCellSelected) {\n                    isFirstCell = selTopLeft.eq(current) && sheet._sheetRef.topLeft.eq(current);\n                    isLastCell = selBottomRight.eq(current) && sheet._sheetRef.bottomRight.eq(current);\n\n                    if(!isFirstCell) {\n                        isFirstCell = columns.firstVisible() === column && rows.firstVisible() === row;\n                    }\n\n                    if(!isLastCell) {\n                        isLastCell = columns.lastVisible() === column && rows.lastVisible() === row;\n                    }\n                }\n\n                switch (direction) {\n                    case \"next\":\n                        if(isLastCell) {\n                            navigatedAway = true;\n                            kendo.focusNextElement();\n                        } else if (selBottomRight.eq(current)) {\n                            setSelection(sheet.nextNavigationRange());\n                            row = selTopLeft.row;\n                            column = selTopLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol);\n                            if (column == topLeftCol || column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                tmp = rows.nextVisible(row);\n                                if (tmp == row || tmp > selBottomRight.row) {\n                                    row = selTopLeft.row;\n                                } else {\n                                    row = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case \"previous\":\n                        if(isFirstCell) {\n                            navigatedAway = true;\n                            this._sheet._workbook._view.element.find('.k-spreadsheet-name-editor .k-input-inner').trigger(\"focus\");\n                        } else if (selTopLeft.eq(current)) {\n                            setSelection(sheet.previousNavigationRange());\n                            row = selBottomRight.row;\n                            column = selBottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol);\n                            if (column == topLeftCol || column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                tmp = rows.prevVisible(row);\n                                if (tmp == row || tmp < selTopLeft.row) {\n                                    row = selBottomRight.row;\n                                } else {\n                                    row = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case \"lower\":\n                        if (selBottomRight.eq(current)) {\n                            setSelection(sheet.nextNavigationRange());\n                            row = selTopLeft.row;\n                            column = selTopLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow);\n                            if (row == topLeftRow || row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                tmp = columns.nextVisible(column);\n                                if (tmp == column || tmp > selBottomRight.col) {\n                                    column = selTopLeft.col;\n                                } else {\n                                    column = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case \"upper\":\n                        if (selTopLeft.eq(current)) {\n                            setSelection(sheet.previousNavigationRange());\n                            row = selBottomRight.row;\n                            column = selBottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow);\n                            if (row == topLeftRow || row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                tmp = columns.prevVisible(column);\n                                if (tmp == column || tmp < selTopLeft.col) {\n                                    column = selBottomRight.col;\n                                } else {\n                                    column = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error(\"Unknown entry navigation: \" + direction);\n                }\n\n                done = !this.shouldSkip(row, column);\n                // if (!done) { console.log(\"skipping\", row, column); }\n                topLeftCol = column;\n                topLeftRow = row;\n            }\n\n            if(done) {\n                if (sheet.singleCellSelection()) {\n                    sheet.select(new CellRef(row, column));\n                } else {\n                    sheet.activeCell(new CellRef(row, column));\n                }\n            }\n        },\n\n        extendSelection: function(ref, mode) {\n            var sheet = this._sheet;\n            var grid = sheet._grid;\n\n            if (mode === \"autofill\") {\n               this.resizeAutoFill(ref);\n               return;\n            }\n            if (mode === \"range\") {\n                ref = grid.normalize(ref);\n            }\n            else if (mode === \"row\") {\n                ref = grid.rowRef(ref.row).bottomRight;\n            } else if (mode === \"column\") {\n                ref = grid.colRef(ref.col).bottomRight;\n            }\n\n            var activeCell = sheet.originalActiveCell().toRangeRef();\n\n            this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n        },\n\n        shouldSkip: function(row, col) {\n            if (this._sheet.isHiddenRow(row) || this._sheet.isHiddenColumn(col)) {\n                return true;\n            }\n            var ref = new CellRef(row, col);\n            var isMerged = false;\n            this._sheet.forEachMergedCell(function(merged) {\n                if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                    isMerged = true;\n                }\n            });\n\n            return isMerged;\n        },\n\n        resizeAutoFill: function(ref) {\n            var sheet = this._sheet;\n            var selection = sheet.select();\n            var origin = sheet._autoFillOrigin;\n            var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n\n            var punch = this.punch(selection, dest);\n            var hint, direction;\n\n            if (!punch) {\n                var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                if (preview) {\n                    direction = preview.direction;\n                    hint = preview.hint;\n                }\n            }\n\n            sheet.updateAutoFill(dest, punch, hint, direction);\n        },\n\n        determineDirection: function(action) {\n            var selection = this._sheet.currentSelectionRange();\n            var activeCell = this._sheet.activeCell();\n\n            // There may be a third, indeterminate state, caused by a merged cell.\n            // In this state, all key movements are treated as shrinks.\n            // The navigator will reverse them if it detects this it will cause the selection to exclude the active cell.\n            var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n            var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n            var topMode = activeCell.topLeft.row == selection.topLeft.row;\n            var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n\n            switch (action) {\n              case \"left\":\n                action = rightMode ? \"expand-left\" : \"shrink-left\";\n                break;\n              case \"right\":\n                action = leftMode ? \"expand-right\" : \"shrink-right\";\n                break;\n              case \"up\":\n                action = bottomMode ? \"expand-up\" : \"shrink-up\";\n                break;\n              case \"down\":\n                action = topMode ? \"expand-down\" : \"shrink-down\";\n                break;\n              case \"prev-page\":\n                action = bottomMode ? \"expand-page-up\" : \"shrink-page-up\";\n                break;\n              case \"next-page\":\n                action = topMode ? \"expand-page-down\" : \"shrink-page-down\";\n                break;\n              case \"word-left\":\n                action = rightMode ? \"expand-word-left\" : \"shrink-word-left\";\n                break;\n              case \"word-right\":\n                action = leftMode ? \"expand-word-right\" : \"shrink-word-right\";\n                break;\n              case \"word-up\":\n                action = bottomMode ? \"expand-word-up\" : \"shrink-word-up\";\n                break;\n              case \"word-down\":\n                action = topMode ? \"expand-word-down\" : \"shrink-word-down\";\n                break;\n            }\n\n            return action;\n        },\n\n        updateCurrentSelectionRange: function(ref) {\n            var sheet = this._sheet;\n            sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n        },\n\n        punch: function(selection, subset) {\n            var punch;\n            if (subset.topLeft.eq(selection.topLeft)) {\n                if (subset.bottomRight.row < selection.bottomRight.row) {\n                    var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n\n                    punch = new RangeRef(\n                        new CellRef(bottomRow, selection.topLeft.col),\n                        selection.bottomRight\n                    );\n                } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                    var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n\n                    punch = new RangeRef(\n                        new CellRef(selection.topLeft.row, bottomCol),\n                        selection.bottomRight\n                    );\n                }\n            }\n\n            return punch;\n        }\n    });\n\n    function makeWordMovement(sheet, pivot, isCol) {\n        // the general idea is:\n        //\n        // - if we start on a non-empty cell, we should select the\n        //   range of non-empty cells that follow it.  If, however,\n        //   the second cell is empty, then we don't stop there; we\n        //   should skip all the empty cells and stop at the first\n        //   non-empty cell (and select it).\n        //\n        // - if we start on an empty cell, then skip all empty cells\n        //   and select the first non-empty one.\n\n        var firstVal = sheet.range(pivot).value();\n        return function(pos, advanced, hidden) {\n            if (hidden) { return true; }   // skip hidden cells\n            var val = ( isCol ?\n                        sheet.range(pivot.row, pos) :\n                        sheet.range(pos, pivot.col) ).value();\n            if (firstVal === null) {\n                return val === null ? false : pos;\n            } else if (!advanced && val === null) {\n                firstVal = null; // switch to the other mode\n                return false;\n            } else {\n                return val === null;\n            }\n        };\n    }\n\n    kendo.spreadsheet.SheetNavigator = SheetNavigator;\n})(kendo);\n\n(function(kendo) {\n\n    var AxisManager = kendo.Class.extend({\n        init: function(sheet) {\n            this._sheet = sheet;\n        },\n\n        forEachSelectedColumn: function(callback) {\n            var sheet = this._sheet;\n\n            sheet.batch(function() {\n                sheet.select().forEachColumnIndex(function(index, i) {\n                    callback(sheet, index, i);\n                });\n            }, { layout: true, recalc: true });\n        },\n\n        forEachSelectedRow: function(callback) {\n            var sheet = this._sheet;\n\n            sheet.batch(function() {\n                sheet.select().forEachRowIndex(function(index, i) {\n                    callback(sheet, index, i);\n                });\n            }, { layout: true, recalc: true });\n        },\n\n        includesHiddenColumns: function(ref) {\n            return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n        },\n\n        includesHiddenRows: function(ref) {\n            return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n        },\n\n        selectionIncludesHiddenColumns: function() {\n            return this.includesHiddenColumns(this._sheet.select());\n        },\n\n        selectionIncludesHiddenRows: function() {\n            return this.includesHiddenRows(this._sheet.select());\n        },\n\n        deleteSelectedColumns: function() {\n            var indexes = [], delta = 0;\n            this.forEachSelectedColumn(function(sheet, index) {\n                index -= delta;\n                if (sheet.isHiddenColumn(index)) {\n                    return;\n                }\n                delta++;\n                var formulas = [];\n                indexes.unshift({\n                    index    : index,\n                    formulas : formulas,\n                    width    : sheet.columnWidth(index)\n                });\n                sheet._saveModifiedFormulas(formulas, function(){\n                    sheet.deleteColumn(index);\n                });\n            });\n            return indexes;\n        },\n\n        deleteSelectedRows: function() {\n            var indexes = [], delta = 0;\n            this.forEachSelectedRow(function(sheet, index) {\n                index -= delta;\n                if (sheet.isHiddenRow(index)) {\n                    return;\n                }\n                delta++;\n                var formulas = [];\n                indexes.unshift({\n                    index    : index,\n                    formulas : formulas,\n                    height   : sheet.rowHeight(index)\n                });\n                sheet._saveModifiedFormulas(formulas, function(){\n                    sheet.deleteRow(index);\n                });\n            });\n            return indexes;\n        },\n\n        hideSelectedColumns: function() {\n            this.forEachSelectedColumn(function(sheet, index) {\n                sheet.hideColumn(index);\n            });\n            var sheet = this._sheet;\n            var ref = sheet.select().toRangeRef();\n            var left = ref.topLeft.col;\n            var right = ref.bottomRight.col;\n            var sel = null;\n            while (true) {\n                var hasRight = right < sheet._columns._count;\n                var hasLeft = left >= 0;\n                if (!hasLeft && !hasRight) {\n                    break;\n                }\n                if (hasRight && !sheet.isHiddenColumn(right)) {\n                    sel = right;\n                    break;\n                }\n                if (hasLeft && !sheet.isHiddenColumn(left)) {\n                    sel = left;\n                    break;\n                }\n                left--;\n                right++;\n            }\n            if (sel !== null) {\n                ref = new kendo.spreadsheet.RangeRef(\n                    new kendo.spreadsheet.CellRef(0, sel),\n                    new kendo.spreadsheet.CellRef(sheet._rows._count - 1, sel)\n                );\n                sheet.range(ref).select();\n            }\n        },\n\n        hideSelectedRows: function() {\n            this.forEachSelectedRow(function(sheet, index) {\n                sheet.hideRow(index);\n            });\n            var sheet = this._sheet;\n            var ref = sheet.select().toRangeRef();\n            var top = ref.topLeft.row;\n            var bottom = ref.bottomRight.row;\n            var sel = null;\n            while (true) {\n                var hasBottom = bottom < sheet._rows._count;\n                var hasTop = top >= 0;\n                if (!hasTop && !hasBottom) {\n                    break;\n                }\n                if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                    sel = bottom;\n                    break;\n                }\n                if (hasTop && !sheet.isHiddenRow(top)) {\n                    sel = top;\n                    break;\n                }\n                top--;\n                bottom++;\n            }\n            if (sel !== null) {\n                ref = new kendo.spreadsheet.RangeRef(\n                    new kendo.spreadsheet.CellRef(sel, 0),\n                    new kendo.spreadsheet.CellRef(sel, sheet._columns._count - 1)\n                );\n                sheet.range(ref).select();\n            }\n        },\n\n        unhideSelectedColumns: function() {\n            this.forEachSelectedColumn(function(sheet, index) {\n                sheet.unhideColumn(index);\n            });\n        },\n\n        unhideSelectedRows: function() {\n            this.forEachSelectedRow(function(sheet, index) {\n                sheet.unhideRow(index);\n            });\n        },\n\n        addColumnLeft: function() {\n            var sheet = this._sheet;\n            var base, count = 0;\n            sheet.batch(function(){\n                sheet.select().forEachColumnIndex(function(index) {\n                    if (!base) {\n                        base = index;\n                    }\n                    sheet.insertColumn(base);\n                    ++count;\n                });\n            }, { recalc: true, layout: true });\n            return { base: base, count: count };\n        },\n\n        addColumnRight: function() {\n            var sheet = this._sheet;\n            var base, count = 0;\n            sheet.batch(function(){\n                sheet.select().forEachColumnIndex(function(index) {\n                    base = index + 1;\n                    ++count;\n                });\n                for (var i = 0; i < count; ++i) {\n                    sheet.insertColumn(base);\n                }\n            }, { recalc: true, layout: true });\n            return { base: base, count: count };\n        },\n\n        addRowAbove: function() {\n            var sheet = this._sheet;\n            var base, count = 0;\n            var selectedRows = sheet.select();\n\n            sheet.batch(function(){\n                selectedRows.forEachRowIndex(function(index) {\n                    if (!base) {\n                        base = index;\n                    }\n                    sheet.insertRow(base);\n                    ++count;\n                });\n            }, { recalc: true, layout: true });\n\n            return { base: base, count: count };\n        },\n\n        addRowBelow: function() {\n            var sheet = this._sheet;\n            var base, count = 0;\n\n            sheet.batch(function(){\n                sheet.select().forEachRowIndex(function(index) {\n                    base = index + 1;\n                    ++count;\n                });\n                for (var i = 0; i < count; ++i) {\n                    sheet.insertRow(base);\n                }\n            }, { recalc: true, layout: true });\n\n            return { base: base, count: count };\n        }\n    });\n\n    kendo.spreadsheet.AxisManager = AxisManager;\n})(kendo);\n\n(function(kendo) {\n\n    var $ = kendo.jQuery;\n    var CellRef = kendo.spreadsheet.CellRef;\n\n    var Clipboard = kendo.Class.extend({\n        init: function(workbook) {\n            this._content = {};\n            this._externalContent = {};\n            this._internalContent = {};\n            this.workbook = workbook;\n            this.origin = kendo.spreadsheet.NULLREF;\n            this.iframe = document.createElement(\"iframe\");\n            this.iframe.className = \"k-spreadsheet-clipboard-paste\";\n            this.iframe.setAttribute(\"title\", \"Spreadsheet clipboard iframe\");\n            this.menuInvoked = false;\n            this._uid = kendo.guid();\n            document.body.appendChild(this.iframe);\n        },\n\n        destroy: function() {\n            $(this.iframe).remove();\n        },\n\n        canCopy: function() {\n            var status = {canCopy: true};\n            var selection = this.workbook.activeSheet().select();\n            if (selection === kendo.spreadsheet.NULLREF) {\n                status.canCopy = false;\n            }\n            if (selection instanceof kendo.spreadsheet.UnionRef) {\n                status.canCopy = false;\n                status.multiSelection = true;\n            }\n            if (this.menuInvoked) {\n                status.canCopy = false;\n                status.menuInvoked = true;\n            }\n            return status;\n        },\n\n        canPaste: function() {\n            var sheet = this.workbook.activeSheet();\n            var ref = this.pasteRef();\n            var range = sheet.range(ref);\n            var status = { canPaste: true, pasteOnMerged: false, pasteOnDisabled: false };\n\n            if (!range.enable()) {\n                status.canPaste =  false;\n                status.pasteOnDisabled = true;\n            }\n            if (!ref.eq(sheet.unionWithMerged(ref))) {\n                status.canPaste = false;\n                status.pasteOnMerged = true;\n            }\n            if (this.menuInvoked) {\n                status.canPaste = false;\n                status.menuInvoked = true;\n            }\n            return status;\n        },\n\n        intersectsMerged: function() {\n            var sheet = this.workbook.activeSheet();\n            this.parse();\n            this.origin = this._content.origRef;\n            var ref = this.pasteRef();\n            return !ref.eq(sheet.unionWithMerged(ref));\n        },\n\n        copy: function() {\n            var sheet = this.workbook.activeSheet();\n            this.origin = sheet.select();\n            this._internalContent = sheet.selection().getState();\n            delete this._externalContent.html;\n            delete this._externalContent.plain;\n        },\n\n        cut: function() {\n            var sheet = this.workbook.activeSheet();\n            this.copy();\n            sheet.range(sheet.select()).clear();\n        },\n\n        pasteRef: function() {\n            var sheet = this.workbook.activeSheet();\n\n            // When pasting from an external source, origin will be\n            // NULLREF.  Just return the destination range.\n            // https://github.com/telerik/kendo-ui-core/issues/3486\n            if (this.origin === kendo.spreadsheet.NULLREF) {\n                return sheet.select();\n            }\n\n            var destination = sheet.activeCell().first();\n            var originActiveCell = this.origin.first();\n            var rowDelta = originActiveCell.row - destination.row;\n            var colDelta = originActiveCell.col - destination.col;\n\n            return this.origin.relative(rowDelta, colDelta, 3);\n        },\n\n        paste: function() {\n            var sheet = this.workbook.activeSheet();\n            var pasteRef = this.pasteRef();\n            if (pasteRef.bottomRight.row >= sheet._rows._count || pasteRef.bottomRight.col >= sheet._columns._count) {\n                sheet.resize(\n                    Math.max(pasteRef.bottomRight.row + 1, sheet._rows._count),\n                    Math.max(pasteRef.bottomRight.col + 1, sheet._columns._count)\n                );\n            }\n            sheet.range(pasteRef).setState(this._content, this);\n            sheet.triggerChange({ recalc: true, ref: pasteRef });\n        },\n\n        external: function(data) {\n            if (data && (data.html || data.plain)) {\n                this._externalContent = data;\n            } else {\n                return this._externalContent;\n            }\n        },\n\n        isExternal: function() {\n            return !this._isInternal();\n        },\n\n        parse: function() {\n            var state;\n\n            if (this._isInternal()) {\n                state = this._internalContent;\n            } else {\n                var data = this._externalContent;\n                state = data.plain ? parseTSV(data.plain) : newState();\n                if (data.html) {\n                    var doc = this.iframe.contentWindow.document;\n                    doc.open();\n                    doc.write(data.html);\n                    doc.close();\n                    var table = doc.querySelector(\"table\");\n                    if (table) {\n                        var richState = parseHTML(table);\n\n                        // fixup #### values that are sent by Excel when the column is too\n                        // narrow. It turns out that the plain text clipboard data contains the\n                        // actual values. https://github.com/telerik/kendo-ui-core/issues/5277\n                        richState.data.forEach(function(rowData, rowIndex){\n                            rowData.forEach(function(colData, colIndex){\n                                if (/^\\s*#+\\s*$/.test(colData.value)) {\n                                    colData.value = state.data[rowIndex][colIndex].value;\n                                }\n                            });\n                        });\n                        state = richState;\n                    }\n                }\n                this.origin = state.origRef;\n            }\n\n            this._content = state;\n        },\n\n        _isInternal: function() {\n            if (this._externalContent.html === undefined) {\n                return true;\n            }\n            var internalHTML = $(\"<div/>\").html(this._externalContent.html).find(\"table.kendo-clipboard-\"+ this._uid).length ? true : false;\n            var internalPlain = $(\"<div/>\").html(this._externalContent.plain).find(\"table.kendo-clipboard-\"+ this._uid).length ? true : false;\n            return (internalHTML || internalPlain);\n        }\n    });\n    kendo.spreadsheet.Clipboard = Clipboard;\n\n    function newState() {\n        var ref = new CellRef(0, 0, 0);\n        return {\n            ref         : ref,\n            mergedCells : [],\n            data        : [],\n            foreign     : true,\n            origRef     : ref.toRangeRef()\n        };\n    }\n\n    function setStateData(state, row, col, value) {\n        var data = state.data || (state.data = []);\n        if (!data[row]) {\n            data[row] = [];\n        }\n        data[row][col] = value;\n        var br = state.origRef.bottomRight;\n        br.row = Math.max(br.row, row);\n        br.col = Math.max(br.col, col);\n    }\n\n    function stripStyle(style) {\n        return style.replace(/^-(?:ms|moz|webkit)-/, \"\");\n    }\n\n    function borderObject(element, styles) {\n        // MS Office uses class name and writes borders in the <style> section, so for it we need to\n        // use the computed styles.  For Google Sheets / LibreOffice, however, the inline styles are\n        // more accurate.\n        if (!element.className) {\n            styles = element.style;\n        }\n        var obj = {};\n        [\n            \"borderBottom\",\n            \"borderRight\",\n            \"borderLeft\",\n            \"borderTop\"\n        ].forEach(function(key) {\n            var width = styles[key + \"Width\"];\n            if (width) {\n                width = parseInt(width, 10);\n            }\n            if (width) {\n                obj[key] = {\n                    size: width,\n                    color: styles[key + \"Color\"] || \"#000\"\n                };\n            }\n        });\n        return obj;\n    }\n\n    function cellState(row, col, element, hBorders, vBorders) {\n        var styles = window.getComputedStyle(element);\n        var value, format, formula;\n\n        // google sheets\n        if ((value = element.getAttribute(\"data-sheets-value\"))) {\n            value = JSON.parse(value);\n            value = value[value[1]];\n        }\n        if ((format = element.getAttribute(\"data-sheets-numberformat\"))) {\n            format = JSON.parse(format);\n            format = format[format[1]];\n        }\n        formula = element.getAttribute(\"data-sheets-formula\");\n\n        // libre office\n        if (value == null && format == null && formula == null) {\n            value = element.getAttribute(\"sdval\");\n            format = element.getAttribute(\"sdnum\");\n            if (format) {\n                // for ungoogable reasons, libreoffice prepends format strings with\n                // \"1033;\" and sometimes with \"1033;0;\". discard it below.\n                format = format.replace(/^1033;(?:0;)?/, \"\");\n            }\n        }\n\n        // note: Chrome 70 appends a \\t to a cell's text, which is actually mandated by the standard\n        // ([1] item 6).  We remove it below.  In [2] it's suggested they might switch back to\n        // previous behavior, but removing an eventual last TAB won't hurt anyway.\n        //\n        // [1] https://www.w3.org/TR/html53/dom.html#dom-htmlelement-innertext\n        // [2] https://bugs.chromium.org/p/chromium/issues/detail?id=897373\n        if (value == null) {\n            value = element.innerText.replace(/\\t$/, \"\");\n        }\n\n        var borders = borderObject(element, styles);\n        var state = {\n            value: value === \"\" ? null : value,\n            formula: formula,\n\n            borderTop    : borders.borderTop    || hBorders.get(row, col)     || null,\n            borderBottom : borders.borderBottom || hBorders.get(row + 1, col) || null,\n            borderLeft   : borders.borderLeft   || vBorders.get(row, col)     || null,\n            borderRight  : borders.borderRight  || vBorders.get(row, col + 1) || null,\n\n            fontSize : parseInt(styles[\"fontSize\"], 10)\n        };\n\n        if (format != null) {\n            state.format = format;\n        }\n\n        hBorders.set(row, col, state.borderTop);\n        hBorders.set(row + 1, col, state.borderBottom);\n        vBorders.set(row, col, state.borderLeft);\n        vBorders.set(row, col + 1, state.borderRight);\n\n        if (styles[\"backgroundColor\"] !== \"rgb(0, 0, 0)\" && styles[\"backgroundColor\"] !== \"rgba(0, 0, 0, 0)\") {\n            state.background = styles[\"backgroundColor\"];\n        }\n        if (stripStyle(styles[\"textAlign\"]) !== \"right\") {\n            state.textAlign = stripStyle(styles[\"textAlign\"]);\n        }\n        if (styles[\"verticalAlign\"] !== \"middle\") {\n            state.verticalAlign = styles[\"verticalAlign\"];\n        }\n        if (styles[\"wordWrap\"] !== \"normal\" ) {\n            state.wrap = true;\n        }\n\n        var txtElem = element.querySelector(\"font\"); // libre office\n        if (txtElem) {\n            styles = window.getComputedStyle(txtElem);\n        }\n\n        if (styles.color !== \"rgb(0, 0, 0)\" && styles.color !== \"rgba(0, 0, 0, 0)\") {\n            state.color = styles.color;\n        }\n        if (/^underline/.test(styles[\"textDecoration\"])) {\n            state.underline = true;\n        }\n        if (styles[\"fontStyle\"] == \"italic\") {\n            state.italic = true;\n        }\n        if (/^(?:bold|[67]00)$/i.test(styles[\"fontWeight\"])) {\n            state.bold = true;\n        }\n\n        return state;\n    }\n\n    function parseHTML(table) {\n        var state = newState();\n\n        var done = [], row = 0, col = 0;\n        for (var i = 0; i < table.rows.length; ++i) {\n            done.push([]);\n        }\n        var hBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n        var vBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n\n        for (var ri = 0; ri < table.rows.length; ++ri, ++row) {\n            var tr = table.rows[ri];\n            col = 0;\n            for (var ci = 0; ci < tr.cells.length; ++ci) {\n                var td = tr.cells[ci];\n                var rowSpan = td.rowSpan;\n                var colSpan = td.colSpan;\n                while (done[row][col]) {\n                    col++;\n                }\n\n                // A cell containing a long text overflowing the next (empty) cell will weirdly be\n                // reported as merged by Excel (has colspan=2).  Then, Excel informatively suggests\n                // us to ignore the colSpan by passing mso-ignore:colspan in the style.  Much thanks!\n                // https://github.com/telerik/kendo-ui-core/issues/3760\n                var style = td.getAttribute(\"style\");\n                var ignoreColspan = /mso-ignore:colspan/.test(style);\n\n                setStateData(state, row, col, cellState(row, col, td, hBorders, vBorders));\n                if (rowSpan > 1 || (colSpan > 1 && !ignoreColspan)) {\n                    state.mergedCells.push(\n                        new kendo.spreadsheet.RangeRef(\n                            new CellRef(row, col),\n                            new CellRef(row + rowSpan - 1, col + colSpan - 1)\n                        ).toString());\n                }\n                for (var dr = row + rowSpan; --dr >= row;) {\n                    for (var dc = col + colSpan; --dc >= col;) {\n                        if (dr < done.length) {\n                            done[dr][dc] = true;\n                            if (!(dr == row && dc == col)) {\n                                setStateData(state, dr, dc, {});\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        return state;\n    }\n\n    function parseTSV(data) {\n        var state = newState();\n        if (data.indexOf(\"\\t\") === -1 && data.indexOf(\"\\n\") == -1) {\n            setStateData(state, 0, 0, { value: data });\n        } else {\n            var rows = data.split(\"\\n\");\n            for (var ri = 0; ri < rows.length; ri++) {\n                var cols = rows[ri].split(\"\\t\");\n                for (var ci = 0; ci < cols.length; ci++) {\n                    setStateData(state, ri, ci, { value: cols[ci] });\n                }\n            }\n        }\n        return state;\n    }\n\n})(kendo);\n\n(function(kendo) {\n\n    var $ = kendo.jQuery;\n\n    var UnionRef = kendo.spreadsheet.UnionRef;\n    var CellRef = kendo.spreadsheet.CellRef;\n    var RangeRef = kendo.spreadsheet.RangeRef;\n\n    var PROPERTIES = [\n        \"color\", \"fontFamily\", \"underline\",\n        \"italic\", \"bold\", \"textAlign\", \"indent\",\n        \"verticalAlign\", \"background\", \"format\", \"link\", \"editor\",\n        \"borderTop\", \"borderRight\", \"borderBottom\", \"borderLeft\",\n        \"comment\", \"html\"\n    ];\n\n    var Range = kendo.Class.extend({\n        init: function(ref, sheet) {\n            this._sheet = sheet;\n            this._ref = ref;\n        },\n\n        clone: function() {\n            return new Range(this._ref.clone(), this._sheet);\n        },\n\n        skipHiddenCells: function() {\n            var refs = [];\n            var self = this, sheet = self._sheet;\n            var skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n            var skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n            self._ref.forEach(function(ref){\n                ref = self._normalize(ref.toRangeRef());\n                var tl = ref.topLeft, br = ref.bottomRight;\n                var rows = partition(tl.row, br.row, skipHiddenRows);\n                var cols = partition(tl.col, br.col, skipHiddenCols);\n                for (var i = 0; i < rows.length; ++i) {\n                    for (var j = 0; j < cols.length; ++j) {\n                        refs.push(new RangeRef(\n                            new CellRef(rows[i].begin, cols[j].begin),\n                            new CellRef(rows[i].end, cols[j].end)\n                        ));\n                    }\n                }\n            });\n            return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n        },\n\n        _normalize: function(ref) {\n            return this._sheet._grid.normalize(ref);\n        },\n\n        _set: function(name, value, noTrigger) {\n            var self = this;\n            var sheet = self._sheet;\n            self._ref.forEach(function(ref) {\n                var result = ref;\n                var valueProp = name === \"value\" || name === \"formula\" || name === \"link\";\n\n                // Set values/formulas/links only to the topLeft cell when merged\n                if(valueProp && ref.topLeft) {\n                    var topLeftRef = new CellRef(ref.topLeft.row, ref.topLeft.col);\n\n                    sheet.forEachMergedCell(function(f){\n                        if(f.intersects(topLeftRef)) {\n                            result = topLeftRef;\n                        }\n                    });\n                }\n\n                sheet._set(result.toRangeRef(), name, value);\n            });\n            if (!noTrigger) {\n                sheet.triggerChange({\n                    recalc  : name == \"formula\" || name == \"value\" || name == \"validation\",\n                    value   : value,\n                    range   : self,\n                    ref     : self._ref,\n                    isValue : name == \"value\"\n                });\n            }\n            return self;\n        },\n\n        _get: function(name) {\n            return this._sheet._get(this._ref.toRangeRef(), name);\n        },\n\n        _property: function(name, value) {\n            if (value === undefined) {\n                return this._get(name);\n            } else {\n                return this._set(name, value);\n            }\n        },\n\n        value: function(value) {\n            if (value !== undefined) {\n                // When value is set through the public API we must clear the\n                // formula.  Don't trigger change (third parameter), it'll be\n                // done when setting the value below\n                this._set(\"formula\", null, true);\n            }\n            return this._property(\"value\", value);\n        },\n\n        html: function(value) {\n            return this._property(\"html\", value);\n        },\n\n        resize: function(direction) {\n            var ref = this._resizedRef(direction);\n            return new Range(ref, this._sheet);\n        },\n\n        _resizedRef: function(direction) {\n            return this._ref.map(function(ref) {\n                return ref.toRangeRef().resize(direction);\n            });\n        },\n\n        input: function(value, options) {\n            options = $.extend({\n                arrayFormula: false\n            }, options);\n            var existingFormat = this._get(\"format\"), x;\n            if (value !== undefined) {\n                var tl = this._ref.toRangeRef().topLeft;\n                x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value, existingFormat);\n                this._sheet.batch(function() {\n                    var formula = null;\n                    if (x.type == \"exp\") {\n                        formula = kendo.spreadsheet.calc.compile(x);\n                    } else if (existingFormat != \"@\") {\n                        var existingFormatType = existingFormat &&\n                            kendo.spreadsheet.formatting.type(x.value, existingFormat);\n                        if (x.type == \"date\" && existingFormatType != \"date\") {\n                            this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                        } else if (x.type == \"percent\" && existingFormatType != \"percent\") {\n                            this.format(x.value*100 == (x.value*100|0) ? \"0%\" : \"0.00%\");\n                        } else if (x.format) {\n                            if (!existingFormat || x.currency ||\n                                (existingFormatType == \"number\" && x.type == \"number\" &&\n                                 x.format.length > existingFormat.length)) {\n                                this.format(x.format);\n                            }\n                        }\n                    } else if (x.type != \"string\") {\n                        x.value = value;\n                    }\n                    this.formula(formula, options.arrayFormula);\n                    if (!formula) {\n                        // value() will clear the formula.  Lucky for us,\n                        // x.value is undefined so it actually won't, but let's\n                        // be explicit and only set value if formula is not\n                        // present.\n                        this.value(x.value);\n                    }\n                }.bind(this), {\n                    recalc       : true,\n                    value        : value,\n                    ref          : this._ref,\n                    editorChange : this._sheet.isInEditMode(),\n                    isValue      : true\n                });\n\n                return this;\n            } else {\n                value = this._get(\"value\");\n                var formula = this._get(\"formula\");\n                var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n\n                if (formula) {\n                    // it's a Formula object which stringifies to the\n                    // formula as text (without the starting `=`).\n                    value = \"=\" + formula;\n                } else OUT: {\n                    if (existingFormat && type == \"date\") {\n                        // check if we could parse back the displayed value.\n                        // https://github.com/telerik/kendo/issues/5335\n                        var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                        x = kendo.spreadsheet.calc.parse(null, null, null, t1, existingFormat); // it's not a formula so we don't need sheet/row/col\n                        var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                        if (t1 == t2) {\n                            value = t1;\n                            break OUT;\n                        }\n                    }\n                    if (type === \"date\") {\n                        value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                    } else if (type === \"percent\") {\n                        value = kendo.spreadsheet.calc.runtime.limitPrecision(value * 100) + \"%\";\n                    } else if (typeof value == \"string\" &&\n                               (/^[=']/.test(value) ||\n                                (/^(?:true|false)$/i).test(value) ||\n                                looksLikeANumber(value))) {\n                        value = \"'\" + value;\n                    } else if (this._sheet._useCultureDecimals() &&\n                               typeof value == \"number\" &&\n                               value != Math.floor(value)) {\n                        value = String(value).replace(\".\", kendo.culture().numberFormat[\".\"]);\n                    }\n                }\n\n                return value;\n            }\n        },\n\n        enable: function(value) {\n            if (value === undefined) {\n                return !kendo.util.withExit(function(exit){\n                    this._sheet.forEach(this._ref, function(_, __, data) {\n                        if (data.enable === false) {\n                            exit(true);\n                        }\n                    });\n                }, this);\n            }\n\n            return this._property(\"enable\", value);\n        },\n\n        formula: function(value, arrayFormula) {\n            var self = this;\n            if (value === undefined) {\n                var f = self._get(\"formula\");\n                return f ? \"\" + f : null; // stringify if present\n            }\n            if (arrayFormula) {\n                // when setting an array formula, we want to set it on\n                // the first cell only, as it will fill the whole\n                // range.\n                var ref = this._ref.toRangeRef();\n                value = self._sheet.range(ref.topLeft)\n                    ._set(\"formula\", value)\n                    ._get(\"formula\"); // make sure we get the compiled Formula, not a string\n\n                if (value) {    // could be null.\n                    // this will be used in FormulaContext -- it's the\n                    // range that the formula must populate.\n                    value.setArrayFormulaRange(ref);\n                }\n            } else {\n                self._set(\"formula\", value);\n            }\n            return self;\n        },\n\n        intersectingArrayFormula: function() {\n            var ref = this._ref.clone().simplify().setSheet(this._sheet.name());\n            return kendo.util.withExit(function(exit){\n                this._sheet._forFormulas(function(f){\n                    var r = f.arrayFormulaRange;\n                    if (r && (r = ref.intersect(r)) !== kendo.spreadsheet.NULLREF) {\n                        exit({ formula: f, intersection: r });\n                    }\n                });\n            }, this);\n        },\n\n        canEditArrayFormula: function() {\n            var x = this.intersectingArrayFormula();\n            if (x) {\n                // we want to allow editing only when the new range is\n                // at least as big as the original range (i.e. no\n                // cells removed)\n                return x.formula.arrayFormulaRange.eq(x.intersection);\n            }\n            return true;\n        },\n\n        validation: function(value) {\n            //TODO: Accept objects only?\n\n            if (value === undefined) {\n                var f = this._get(\"validation\");\n\n                return f ? f.toJSON() : null; // stringify if present\n            }\n            return this._property(\"validation\", value);\n        },\n\n        _getValidationState: function() {\n            var ref = this._ref.toRangeRef();\n            var topLeftRow = ref.topLeft.row;\n            var topLeftCol = ref.topLeft.col;\n            var bottomRightRow = ref.bottomRight.row;\n            var bottomRightCol = ref.bottomRight.col;\n            var ci, ri;\n\n            for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                    var validation = this._sheet._validation(ri, ci);\n\n                    if (validation && validation.type === \"reject\" && validation.value === false) {\n                        return validation;\n                    }\n                }\n            }\n\n            return false;\n        },\n\n        merge: function() {\n            this._ref = this._sheet._merge(this._ref);\n            return this;\n        },\n\n        unmerge: function() {\n            var mergedCells = this._sheet._mergedCells;\n\n            this._ref.forEach(function(ref) {\n                ref.toRangeRef().intersecting(mergedCells).forEach(function(mergedRef) {\n                    mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                });\n            });\n\n            this._sheet.triggerChange({});\n\n            return this;\n        },\n\n        select: function() {\n            this._sheet.select(this._ref);\n\n            return this;\n        },\n\n        values: function(values) {\n            if (this._ref instanceof UnionRef) {\n                throw new Error(\"Unsupported for multiple ranges.\");\n            }\n\n            if (this._ref === kendo.spreadsheet.NULLREF) {\n                if (values !== undefined) {\n                    throw new Error(\"Unsupported for NULLREF.\");\n                } else {\n                    return [];\n                }\n            }\n\n            var ref = this._ref.toRangeRef();\n            var topLeftRow = ref.topLeft.row;\n            var topLeftCol = ref.topLeft.col;\n            var bottomRightRow = ref.bottomRight.row;\n            var bottomRightCol = ref.bottomRight.col;\n            var ci, ri;\n\n            if (values === undefined) {\n                values = new Array(ref.height());\n\n                for (var vi = 0; vi < values.length; vi++) {\n                    values[vi] = new Array(ref.width());\n                }\n\n                for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                        values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                    }\n                }\n\n                return values;\n            } else {\n                this._sheet._set(ref, \"formula\", null);\n\n                for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                        var row = values[ri - topLeftRow];\n\n                        if (row) {\n                            var value = row[ci - topLeftCol];\n\n                            if (value !== undefined) {\n                                this._sheet._value(ri, ci, value);\n                            }\n                        }\n                    }\n                }\n\n                this._sheet.triggerChange({ recalc: true, ref: ref });\n\n                return this;\n            }\n        },\n\n        _properties: function(props, isAutofill) {\n            if (this._ref instanceof UnionRef) {\n                throw new Error(\"Unsupported for multiple ranges.\");\n            }\n\n            if (this._ref === kendo.spreadsheet.NULLREF) {\n                if (props !== undefined) {\n                    throw new Error(\"Unsupported for NULLREF.\");\n                } else {\n                    return [];\n                }\n            }\n\n            var ref = this._ref.toRangeRef();\n            var topLeftRow = ref.topLeft.row;\n            var topLeftCol = ref.topLeft.col;\n            var bottomRightRow = ref.bottomRight.row;\n            var bottomRightCol = ref.bottomRight.col;\n            var ci, ri;\n            var sheet = this._sheet;\n\n            if (props === undefined) {\n                props = new Array(ref.height());\n                sheet.forEach(ref, function(row, col, data){\n                    row -= topLeftRow;\n                    col -= topLeftCol;\n                    var line = props[row] || (props[row] = []);\n                    line[col] = data;\n                });\n                return props;\n            }\n            else {\n                var data;\n                ref = ref.clone();\n                var setProp = function(propName) {\n                    var propValue = data[propName];\n                    ref.topLeft.row = ref.bottomRight.row = ri;\n                    ref.topLeft.col = ref.bottomRight.col = ci;\n\n                    if (propName == \"value\") {\n                        sheet._set(ref, \"formula\", null);\n                    }\n\n                    sheet._set(ref, propName, propValue);\n                };\n\n                var isValue = false;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                    if (!isAutofill && sheet.isHiddenColumn(ci)) {\n                        continue;\n                    }\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                        if (!isAutofill && sheet.isHiddenRow(ri)) {\n                            continue;\n                        }\n                        if (isAutofill && sheet.isFilteredRow(ri)) {\n                            continue;\n                        }\n                        var row = props[ri - topLeftRow];\n                        if (row) {\n                            data = row[ci - topLeftCol];\n                            if (data) {\n                                var keys = Object.keys(data);\n                                keys.forEach(setProp);\n                                isValue = isValue || keys.includes(\"value\");\n                            }\n                        }\n                    }\n                }\n                sheet.triggerChange({ recalc: true, ref: this._ref, isValue: isValue });\n                return this;\n            }\n        },\n\n        clear: function(options) {\n            options = options || {};\n            var clearAll = options.clearAll || !Object.keys(options).length;\n\n            var sheet = this._sheet;\n\n            var reason = {\n                recalc: clearAll || options.contentsOnly,\n                ref: this._ref,\n                isValue: true\n            };\n\n            sheet.batch(function() {\n\n                if (reason.recalc) {\n                    this.formula(null);\n                }\n\n                if (clearAll) {\n                    this.validation(null);\n                }\n\n                if (clearAll || options.formatOnly) {\n                    PROPERTIES.forEach(function(x) {\n                        if (!(options.keepBorders && /^border/i.test(x))) {\n                            this[x](null);\n                        }\n                    }.bind(this));\n                    this.fontSize(null);\n                    this.wrap(null);\n                    this.unmerge();\n                }\n\n            }.bind(this), reason);\n\n            return this;\n        },\n\n        clearContent: function() {\n            return this.clear({ contentsOnly: true });\n        },\n\n        clearFormat: function() {\n            return this.clear({ formatOnly: true });\n        },\n\n        isSortable: function() {\n            return !this.cantSort();\n        },\n\n        cantSort: function() {\n            if (this._ref instanceof UnionRef) {\n                return { code: \"cantSortMultipleSelection\",\n                         message: \"Unsupported for multiple ranges.\" };\n            }\n            if (this._ref === kendo.spreadsheet.NULLREF) {\n                return { code: \"cantSortNullRef\",\n                         message: \"Unsupported for NULLREF.\" };\n            }\n            var mc = this._sheet._getMergedCells(this._ref.toRangeRef());\n            var primary = mc.primary;\n            var secondary = mc.secondary;\n            var width = null, height = null;\n            var cant = {};\n            try {\n                this._sheet.forEach(this, function(row, col){\n                    var id = new CellRef(row, col).print();\n                    var merged = primary[id];\n                    if (merged) {\n                        if (width === null) {\n                            width = merged.width();\n                            height = merged.height();\n                        } else if (!(width == merged.width() && height == merged.height())) {\n                            throw cant;\n                        }\n                    }\n                    else if (!secondary[id] && mc.hasMerged) {\n                        throw cant;\n                    }\n                });\n            } catch(ex) {\n                if (ex !== cant) {\n                    throw ex;\n                }\n                return {\n                    code: \"cantSortMixedCells\",\n                    message: \"Unsupported for range containing cells of different shapes.\"\n                };\n            }\n            return false;\n        },\n\n        sort: function(spec) {\n            var reason = this.cantSort();\n            if (reason) {\n                throw new Error(reason.message);\n            }\n\n            if (spec === undefined) {\n                spec = { column: 0 };\n            }\n\n            spec = spec instanceof Array ? spec : [spec];\n\n            this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function(spec, index) {\n                if (typeof spec === \"number\") {\n                    spec = { column: spec };\n                }\n\n                return {\n                    index: spec.column === undefined ? index : spec.column,\n                    ascending: spec.ascending === undefined ? true : spec.ascending\n                };\n            }));\n\n            return this;\n        },\n\n        isFilterable: function() {\n            return !(this._ref instanceof UnionRef);\n        },\n\n        filter: function(spec) {\n            if (this._ref instanceof UnionRef) {\n                throw new Error(\"Unsupported for multiple ranges.\");\n            }\n\n            if (spec === false) {\n                this.clearFilters();\n            } else {\n                spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n\n                this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function(spec, index) {\n                    return {\n                        index: spec.column === undefined ? spec.index === undefined ? index : spec.index : spec.column,\n                        filter: spec.filter\n                    };\n                }));\n            }\n\n            return this;\n        },\n\n        clearFilter: function(spec) {\n            this._sheet.clearFilter(spec);\n        },\n\n        clearFilters: function() {\n            var filter = this._sheet.filter();\n            var spec = [];\n\n            if (filter) {\n                for (var i = 0; i < filter.columns.length; i++) {\n                    spec.push(filter.columns[i].index);\n                }\n\n                this._sheet.batch(function() {\n                    this.clearFilter(spec);\n                    this._filter = null;\n                }, { layout: true, filter: true });\n            }\n        },\n\n        hasFilter: function() {\n            var filter = this._sheet.filter();\n            return !!filter;\n        },\n\n        leftColumn: function() {\n            return new Range(this._ref.leftColumn(), this._sheet);\n        },\n\n        rightColumn: function() {\n            return new Range(this._ref.rightColumn(), this._sheet);\n        },\n\n        topRow: function() {\n            return new Range(this._ref.topRow(), this._sheet);\n        },\n\n        bottomRow: function() {\n            return new Range(this._ref.bottomRow(), this._sheet);\n        },\n\n        column: function(column) {\n            return new Range(this._ref.toColumn(column), this._sheet);\n        },\n\n        row: function(row) {\n            return new Range(this._ref.toRow(row), this._sheet);\n        },\n\n        forEachRow: function(callback) {\n            this._ref.forEachRow(function(ref) {\n                callback(new Range(ref, this._sheet));\n            }.bind(this));\n        },\n\n        forEachColumn: function(callback) {\n            this._ref.forEachColumn(function(ref) {\n                callback(new Range(ref, this._sheet));\n            }.bind(this));\n        },\n\n        sheet: function() {\n            return this._sheet;\n        },\n\n        topLeft: function() {\n            return this._ref.toRangeRef().topLeft;\n        },\n\n        intersectingMerged: function() {\n            var sheet = this._sheet;\n            var mergedCells = [];\n\n            sheet._mergedCells.forEach(function(ref) {\n                if (ref.intersects(this._ref)) {\n                    mergedCells.push(ref.toString());\n                }\n            }.bind(this));\n\n            return mergedCells;\n        },\n\n        getState: function(propertyName) {\n            var topLeft = this._ref.first();\n            var state = {\n                ref     : topLeft,\n                data    : [],\n                origRef : this._ref,\n\n                // save row heights\n                rows    : this._sheet._rows.getState()\n            };\n            var properties;\n            if (!propertyName) {\n                properties = kendo.spreadsheet.ALL_PROPERTIES;\n                state.mergedCells = this.intersectingMerged();\n            } else if (propertyName === \"input\") {\n                properties = [\"value\", \"formula\"];\n            } else if (propertyName === \"border\") {\n                properties = [\"borderLeft\", \"borderTop\", \"borderRight\", \"borderBottom\"];\n            } else {\n                properties = [propertyName];\n            }\n\n            var data = state.data;\n            this.forEachCell(function(row, col, cell) {\n                var cellState = {};\n                var dr = row - topLeft.row;\n                var dc = col - topLeft.col;\n                if (!data[dr]) {\n                    data[dr] = [];\n                }\n                data[dr][dc] = cellState;\n\n                properties.forEach(function(property) {\n                    var value = typeof cell[property] == \"undefined\" ? null : cell[property];\n                    if (value instanceof kendo.spreadsheet.calc.runtime.Formula ||\n                        value instanceof kendo.spreadsheet.validation.Validation)\n                    {\n                        value = value.deepClone();\n                    }\n                    cellState[property] = value;\n                });\n            });\n\n            return state;\n        },\n\n        setState: function(state, clipboard) {\n            var sheet = this._sheet;\n            var origin = this._ref.first();\n            var rowDelta = state.ref.row - origin.row;\n            var colDelta = state.ref.col - origin.col;\n            var internalClipboard = clipboard && !clipboard.isExternal();\n            var externalClipboard = clipboard && !internalClipboard;\n\n            sheet.batch(function() {\n                if (state.mergedCells) {\n                    this.unmerge();\n                }\n\n                if (!clipboard) {\n                    // restore row heights.  they won't be available\n                    // when this function is called from the clipboard\n                    // code.\n                    this._sheet._rows.setState(state.rows);\n                }\n\n                var row = origin.row;\n                var hasFilter = this.hasFilter();\n                state.data.forEach(function(data, dr){\n                    if (hasFilter && internalClipboard && sheet.isHiddenRow(state.ref.row + dr)) {\n                        return;\n                    }\n                    var col = origin.col;\n                    data.forEach(function(cellState, dc){\n                        if (hasFilter && internalClipboard && sheet.isHiddenColumn(state.ref.col + dc)) {\n                            return;\n                        }\n                        var range = clipboard ? sheet.range(row, col)\n                            : sheet.range(origin.row + dr, origin.col + dc);\n                        if (range.enable()) {\n                            for (var property in cellState) {\n                                if (property != \"value\") {\n                                    // make sure value comes last (after the loop),\n                                    // because if we set value here and get get to\n                                    // formula later and cellState.formula is null,\n                                    // it'll clear the value.\n\n                                    // when pasting, do not copy \"disabled\" state\n                                    if (!(clipboard && property == \"enable\")) {\n                                        range._set(property, cellState[property]);\n                                    }\n                                }\n                            }\n                            if (!cellState.formula) {\n                                // only need to set the value if we don't have a\n                                // formula.  Go through the lower level setter rather\n                                // than range.value(...), because range.value will clear\n                                // the formula!  chicken and egg issues.\n                                if (externalClipboard) {\n                                    // https://github.com/telerik/kendo-ui-core/issues/1688\n                                    // if we have a paste from external source, we should parse the\n                                    // value as if it were inputted.  This allows to treat numbers\n                                    // as numbers, or `=sum(a1:b2)` as formula (Google Sheets does\n                                    // the same).  A difference though is that we can't store an\n                                    // invalid Formula and display #ERROR, like G.S. does, so in\n                                    // case of a parse error we'll just set the value as string.\n                                    try {\n                                        if (cellState.value == null) {\n                                            range._set(\"value\", null);\n                                        } else {\n                                            range.input(cellState.value);\n                                        }\n                                    } catch(ex) {\n                                        range._set(\"value\", cellState.value);\n                                    }\n                                } else {\n                                    range._set(\"value\", cellState.value);\n                                }\n                            }\n                        }\n                        col++;\n                    });\n                    row++;\n                });\n\n                if (state.mergedCells) {\n                    state.mergedCells.forEach(function(merged) {\n                        merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                        sheet.range(merged).merge();\n                    }, this);\n                }\n            }.bind(this), { recalc: true, ref: this._ref });\n        },\n\n        _adjustRowHeight: function() {\n            var that = this;\n            var sheet = that._sheet;\n            var mc = sheet._getMergedCells(that._ref.toRangeRef());\n            var primary = mc.primary;\n            var secondary = mc.secondary;\n\n            sheet.batch(function() {\n                that.forEachRow(function(rowRange){\n                    var row = rowRange._ref.topLeft.row;\n                    var height = sheet.rowHeight(row);\n                    if (!height) {\n                        // do not adjust if hidden.\n                        // https://github.com/telerik/kendo-ui-core/issues/6272\n                        // (case 2)\n                        return;\n                    }\n                    rowRange.forEachCell(function(row, col, cell){\n                        var id = new CellRef(row, col).print();\n                        if (secondary[id]) {\n                            return;\n                        }\n                        var merged = primary[id];\n                        var width;\n                        if (merged) {\n                            width = sheet._columns.sum(merged.topLeft.col,\n                                                       merged.bottomRight.col);\n                        } else {\n                            width = sheet.columnWidth(col);\n                        }\n                        var data = cell.value;\n                        if (cell.format && data != null) {\n                            data = kendo.spreadsheet.formatting.format(data, cell.format);\n                        }\n                        var textHeight = kendo.spreadsheet.util.getTextHeight(\n                            data, width, cell.fontFamily, cell.fontSize, cell.wrap);\n                        height = Math.max(height, textHeight);\n                    });\n                    sheet.rowHeight(row, height);\n                });\n            }, { layout: true });\n        },\n\n        forEachCell: function(callback) {\n            this._ref.forEach(function(ref) {\n                this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n            }.bind(this));\n        },\n\n        hasValue: function() {\n            var defStyle = this._sheet._defaultCellStyle;\n            return kendo.util.withExit(function(exit){\n                this.forEachCell(function(row, col, cell) {\n                    // we must not consider cells that only have same values\n                    // as defaultCellStyle, or otherwise we will forbid\n                    // inserting rows/cols in an empty sheet.\n                    for (var key in cell) {\n                        var val = cell[key];\n                        if (val !== undefined && val !== null && val !== defStyle[key]) {\n                            exit(true);\n                        }\n                    }\n                });\n            }, this);\n        },\n\n        wrap: function(flag) {\n            if (flag === undefined) {\n                return !!this._property(\"wrap\");\n            }\n            this._property(\"wrap\", flag);\n            if (flag !== null) {\n                this._adjustRowHeight();\n            }\n            return this;\n        },\n\n        fontSize: function(size) {\n            if (size === undefined) {\n                return this._property(\"fontSize\");\n            }\n            this._property(\"fontSize\", size);\n            if (size !== null) {\n                this._adjustRowHeight();\n            }\n            return this;\n        },\n\n        draw: function(options, callback) {\n            this._sheet.draw(this, options, callback);\n        },\n\n        insideBorders: function(value) {\n            return this.insideVerticalBorders(value).insideHorizontalBorders(value);\n        },\n\n        insideVerticalBorders: function(value) {\n            this._ref.forEach(function(ref){\n                if (ref instanceof RangeRef && ref.width() > 1) {\n                    ref = ref.clone();\n                    ref.topLeft.col++;\n                    this._sheet.range(ref)._set(\"vBorders\", value);\n                }\n            }, this);\n            return this;\n        },\n\n        insideHorizontalBorders: function(value) {\n            this._ref.forEach(function(ref){\n                if (ref instanceof RangeRef && ref.height() > 1) {\n                    ref = ref.clone();\n                    ref.topLeft.row++;\n                    this._sheet.range(ref)._set(\"hBorders\", value);\n                }\n            }, this);\n            return this;\n        }\n    });\n\n    function partition(begin, end, predicate) {\n        while (begin <= end && predicate(begin)) {\n            begin++;\n        }\n        if (begin > end) {\n            return [];\n        }\n        for (var i = begin + 1; i <= end; ++i) {\n            if (predicate(i)) {\n                return [\n                    { begin: begin, end: i - 1 }\n                ].concat(partition(i + 1, end, predicate));\n            }\n        }\n        return [{ begin: begin, end: end }];\n    }\n\n    // use $.each instead of forEach to work in oldIE\n    $.each(PROPERTIES, function(i, property) {\n        Range.prototype[property] = function(value) {\n            return this._property(property, value);\n        };\n    });\n\n    function toExcelFormat(format) {\n        return format.replace(/M/g, \"m\").replace(/'/g, '\"').replace(/tt/, \"am/pm\");\n    }\n\n    function looksLikeANumber(str) {\n        // XXX: could do with just a regexp instead of calling parse.\n        return !(/^=/.test(str)) && (/number|percent/).test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n    }\n\n    var measureBox = $('<div></div>')[0];\n    measureBox.style.cssText = 'position: absolute !important; top: -4000px !important; height: auto !important;' +\n    'padding: 1px 3px !important; box-sizing: border-box; margin: 0 !important; border: 1px solid black !important;' +\n    'line-height: normal !important; visibility: hidden !important;' +\n    'white-space: pre-wrap;';\n\n    function getTextHeight(text, width, fontFamily, fontSize, wrap) {\n        var styles = {\n            \"baselineMarkerSize\" : 0,\n            \"width\" : (wrap === true) ? width + \"px\" : \"auto\",\n            \"font-size\" : (fontSize || 12) + \"px\",\n            \"font-family\" : fontFamily || \"Arial\",\n            \"white-space\" : (wrap === true) ? \"pre-wrap\" : \"pre\",\n            \"overflow-wrap\" : (wrap === true) ? \"break-word\" : \"normal\",\n            \"word-wrap\" : (wrap === true) ? \"break-word\" : \"normal\"\n        };\n\n        return kendo.util.measureText(text, styles, { box: measureBox, normalizeText: false }).height;\n    }\n\n    kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n    kendo.spreadsheet.Range = Range;\n})(window.kendo);\n\n// -*- fill-column: 100 -*-\n    \"use strict\";\n\n    // WARNING: removing the following jshint declaration and turning\n    // == into === to make JSHint happy will break functionality.\n\n    /* global console */\n\n\n    var calc$4 = {};\n    var spreadsheet$7 = kendo.spreadsheet;\n    spreadsheet$7.calc = calc$4;\n    var exports$2 = calc$4.runtime = {};\n    var Class$1 = kendo.Class;\n\n    var Ref$3 = spreadsheet$7.Ref;\n    var CellRef$4 = spreadsheet$7.CellRef;\n    var RangeRef$3 = spreadsheet$7.RangeRef;\n    var UnionRef$2 = spreadsheet$7.UnionRef;\n    var NULL = spreadsheet$7.NULLREF;\n\n    /* -----[ Errors ]----- */\n\n    function CalcError$2(code) {\n        if (code instanceof CalcError$2) {\n            return code;\n        }\n        this.code = code;\n    }\n\n    CalcError$2.prototype.toString = function() {\n        return \"#\" + this.code + (this.code == \"NAME\" ? \"?\" : \"!\");\n    };\n\n    /* -----[ Context ]----- */\n\n    var Context = Class$1.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n\n        resolve: function(val) {\n            var self = this;\n            if (val instanceof Ref$3) {\n                self.resolveCells([ val ], function(){\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n\n        error: function(val) {\n            return new CalcError$2(val);\n        },\n\n        _resolve: function(val) {\n            if (val === undefined) {\n                val = null;\n            } else if (Array.isArray(val)) {\n                val = this.asMatrix(val);\n            } else {\n                val = maybeRoundFloatErrors(val);\n            }\n            var f = this.formula;\n            if (f.arrayFormulaRange) {\n                // when this is an array formula, make sure we return a Matrix.  The value already\n                // *should* be a Matrix, so this won't incur speed penalty in normal cases.\n                val = this.asMatrix(val) || this.asMatrix([[ val ]]);\n            } else if (val instanceof RangeRef$3) {\n                val = this._arrayArg(val);\n            }\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n\n        resolveCells: function(a, f) {\n            var context = this, formulas = [];\n\n            (function loop(a){\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref$3) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        // make sure we resolve cells in literal matrices\n                        loop(x);\n                    }\n                }\n            })(a);\n\n            if (!formulas.length) {\n                return f.call(context);\n            }\n\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(formula) {\n                formula.exec(context.ss, function(){\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell.formula);\n                    }\n                }\n                return true;\n            }\n        },\n\n        cellValues: function(a, wantNulls) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref$3) {\n                    val = this.getRefData(val, wantNulls);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val, wantNulls));\n                } else if (val instanceof Matrix$1) {\n                    ret = ret.concat(this.cellValues(val.data, wantNulls));\n                } else {\n                    ret.push(val);\n                }\n            }\n            return ret;\n        },\n\n        fetchName: function(ref, callback) {\n            var f = this.formula;\n            var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n            if (val instanceof Formula$1) {\n                // clone and relocate to calling formula, so that relative references in a named\n                // formula would work as expected.\n                val = val.clone(f.sheet, f.row, f.col, true);\n\n                // XXX: I don't like this dependency here; basically we only need ss.onFormula to\n                // return true and do nothing else.\n                var ss = new spreadsheet$7.ValidationFormulaContext(this.ss.workbook);\n\n                val.exec(ss, callback, this);\n            } else {\n                if (val instanceof Ref$3) {\n                    // relocate for relative refs\n                    val = val.absolute(f.row, f.col);\n                    if (val instanceof RangeRef$3 && this.ss.isMerged(val)) {\n                        val = val.topLeft;\n                    }\n                    if (!val.sheet) {\n                        val.sheet = f.sheet;\n                    }\n                }\n                callback(val == null ? new CalcError$2(\"NAME\") : val);\n            }\n        },\n\n        force: function(val) {\n            if (val instanceof Ref$3) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n\n        func: function(fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError$2(\"NAME\"));\n        },\n\n        bool: function(val) {\n            if (val instanceof Ref$3) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == \"string\") {\n                return val.toLowerCase() == \"true\";\n            }\n            if (typeof val == \"number\") {\n                return val !== 0;\n            }\n            if (typeof val == \"boolean\") {\n                return val;\n            }\n            return val != null;\n        },\n\n        _arrayArg: function(ref) { // not necessarily a reference though\n            var f = this.formula;\n            if (!f.arrayFormulaRange && ref instanceof RangeRef$3) {\n                // if formula wasn't saved with Ctrl-Shift-Enter but a range is passed, Excel does\n                // something special:\n                //\n                // - if range is Wx1 (horizontal array) and current formula resides within the\n                //   horizontal bounds of the range, the appropriate cell is selected.  Example:\n                //   A1..D1 contain 1, 2, 3, 4 and we have in B2: =A1:D1, then B2 will get 2 (the\n                //   value in A2).  If the same formula is typed outside the horizontal span of the\n                //   range, say in E2: =A1:D1, then #VALUE! is returned.\n                //\n                // - similarly, if the range is 1xH (vertical array), the formula must reside within\n                //   the vertical bounds of the range and it gets the corresponding cell; otherwise,\n                //   #VALUE!.\n                if (ref.height() == 1 && f.col >= ref.topLeft.col && f.col <= ref.bottomRight.col) {\n                    return this.getRefData(new CellRef$4(ref.topLeft.row, f.col).setSheet(ref.sheet));\n                }\n                if (ref.width() == 1 && f.row >= ref.topLeft.row && f.row <= ref.bottomRight.row) {\n                    return this.getRefData(new CellRef$4(f.row, ref.topLeft.col).setSheet(ref.sheet));\n                }\n                return new CalcError$2(\"VALUE\");\n            } else {\n                return this.asMatrix(ref);\n            }\n        },\n\n        asMatrix: function(range) {\n            if (range instanceof Matrix$1) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef$3) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix$1(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function(cell){\n                    m.set(cell.row - top,\n                          cell.col - left,\n                          cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix$1(self), row = 0;\n                range.forEach(function(line){\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function(el){\n                        var isRange = el instanceof RangeRef$3;\n                        if (el instanceof Ref$3 && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix$1) {\n                            el.each(function(el, r, c){\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            if(typeof el === \"string\" && el.length && !isNaN(el)) {\n                                el = Number(el);\n                            }\n\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n\n        getRefCells: function(refs, hiddenInfo, wantNulls) {\n            var f = this.formula;\n            return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col, wantNulls);\n        },\n\n        getRefData: function(ref, wantNulls) {\n            var f = this.formula;\n            return this.ss.getData(ref, f.sheet, f.row, f.col, wantNulls);\n        },\n\n        workbook: function() {\n            return this.ss.workbook;\n        }\n    });\n\n    var Matrix$1 = Class$1.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function() {\n            var m = new Matrix$1(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function(row){ return row.slice(); });\n            return m;\n        },\n        get: function(row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref$3 ? this.context.getRefData(val) : val;\n        },\n        getNA: function(row, col) {\n            if (row < this.height && col < this.width) {\n                return this.get(row, col);\n            }\n            return new CalcError$2(\"N/A\");\n        },\n        set: function(row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function(f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function(f, includeEmpty) {\n            var m = new Matrix$1(this.context);\n            this.each(function(el, row, col){\n                // here `this` is actually the context\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function(f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function(f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function(f) {\n            var m = new Matrix$1(this.context);\n            this.eachRow(function(row){\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function(f) {\n            var m = new Matrix$1(this.context);\n            this.eachCol(function(col){\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function() {\n            return JSON.stringify(this.data);\n        },\n        transpose: function() {\n            var m = new Matrix$1(this.context);\n            this.each(function(el, row, col){\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function(n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function(b) {\n            var a = this, m = new Matrix$1(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != \"number\" || typeof vb != \"number\") {\n                            throw new CalcError$2(\"VALUE\");\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function(b, s) {\n            var a = this, m = new Matrix$1(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col),\n                        y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function() {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; (L < n) && (!a[L][C]); L++) {}\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C+1; i < n; i++) {\n                    for (k = C+1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function() {\n            var n = this.width;\n            var m = this.augment(new Matrix$1(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n\n            // Gaussian elimination\n            // https://en.wikipedia.org/wiki/Gaussian_elimination#Finding_the_inverse_of_a_matrix\n\n            // 1. Get zeros below main diagonal\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function(i){ return a[i][k]; });\n                if (!a[imax][k]) {\n                    return null; // singular matrix\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k+1; i < n; ++i) {\n                    for (var j = k+1; j < 2*n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n\n            // 2. Get 1-s on main diagonal, dividing by pivot\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2*n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n\n            // 3. Get zeros above main diagonal.  Actually, we only care to compute the right side\n            // here (that will be the inverse), so in the inner loop below we go while j >= n,\n            // instead of j >= k.\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2*n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n\n            return m.slice(0, n, n, n);\n        },\n        augment: function(m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function(val, row, col){\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function(row, col, height, width) {\n            var m = new Matrix$1(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n\n        // XXX: debug\n        // dump: function() {\n        //     this.data.forEach(function(row){\n        //         console.log(row.map(function(val){\n        //             var str = val.toFixed(3).replace(/\\.?0*$/, function(s){\n        //                 return [ \"\", \" \", \"  \", \"   \", \"    \" ][s.length];\n        //             });\n        //             if (val >= 0) { str = \" \" + str; }\n        //             return str;\n        //         }).join(\"  \"));\n        //     });\n        // }\n    });\n\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n\n    /* -----[ Formula ]----- */\n\n    var Formula$1 = Class$1.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col, arrayFormulaRange){\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n            this.arrayFormulaRange = arrayFormulaRange;\n        },\n        setArrayFormulaRange: function(ref) {\n            this.arrayFormulaRange = ref.clone().setSheet(this.sheet);\n        },\n        clone: function(sheet, row, col, forceRefs) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            var range = this.arrayFormulaRange;\n            if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function(ref){\n                    if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n                if (range) {\n                    range = range.clone().setSheet(sheet);\n                }\n            }\n            return new Formula$1(refs, this.handler, this.print, sheet, row, col, range);\n        },\n        deepClone: function() {\n            var refs = this.refs.map(function(ref){ return ref.clone(); });\n            return new Formula$1(refs, this.handler, this.print, this.sheet, this.row, this.col, this.arrayFormulaRange);\n        },\n        resolve: function(val) {\n            this.pending = false;\n            this.onReady.forEach(function(callback){\n                callback(val);\n            });\n        },\n        exec: function(ss, callback, parentContext) {\n            if (\"value\" in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                var level = 0;\n                // if the call chain leads back to this same formula, we have a circular dependency.\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError$2(\"CIRCULAR\"));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                    ++level;\n                }\n\n                // pending is still useful for ASYNC formulas\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n\n                var next = function() {\n                    // compute and cache the absolute references\n                    if (!this.absrefs) {\n                        this.absrefs = this.refs.map(function(ref){\n                            return ref.absolute(this.row, this.col);\n                        }, this);\n                    }\n\n                    // finally invoke the handler given to us by the compiler in calc.js\n                    this.handler.call(ctx);\n                }.bind(this);\n\n                if (level < 20) {\n                    next();\n                } else {\n                    setTimeout(next, 0);\n                }\n            }\n        },\n        reset: function() {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function(oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function(ref){\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        },\n        adjust: function(affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                // move formula if it's after the change point\n                if (operation == \"row\" && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == \"col\" && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            var prevRefs = this.refs;\n            var modified = formulaMoves;\n            this.refs = prevRefs.map(function(ref){\n                var newRef = adjust(ref);\n                if (!modified && !sameRef(newRef, ref)) {\n                    modified = true;\n                }\n                return newRef;\n            });\n\n            var prevRange = this.arrayFormulaRange;\n            if (prevRange) {\n                this.arrayFormulaRange = adjust(prevRange);\n                if (!modified && !sameRef(prevRange, this.arrayFormulaRange)) {\n                    modified = true;\n                }\n            }\n\n            if (modified) {\n                // return a clone of the original formula.  needed to undo operations like\n                // deleteRow, which can transform a reference into NULL.\n                return new Formula$1(prevRefs, this.handler, this.print, this.sheet, formulaRow, formulaCol, prevRange);\n            }\n\n            function adjust(ref){\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        // a reference to another sheet should still point to the same location\n                        // after adjustment; thus if row/col was removed before formula, relative\n                        // references must be adjusted by delta.\n                        if (operation == \"row\" && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == \"col\" && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(\n                    formulaRow, formulaCol,\n                    newFormulaRow, newFormulaCol,\n                    operation == \"row\",\n                    start, delta\n                );\n            }\n        },\n        toString: function() {\n            return this.print(this.row, this.col);\n        }\n    });\n\n    function sameRef(r1, r2) {\n        // note: r1.eq(r2) will not do, because it returns true for A1 and A1:A1 (CellRef\n        // vs. RangeRef).  To properly undo we need to assert that the references are exactly the\n        // same (including type).\n        if (r1.constructor !== r2.constructor) {\n            return false;\n        }\n        if (r1 instanceof CellRef$4) {\n            return r1.sheet == r2.sheet\n                && r1.row == r2.row\n                && r1.col == r2.col\n                && r1.rel == r2.rel;\n        }\n        if (r1 instanceof RangeRef$3) {\n            return sameRef(r1.topLeft     , r2.topLeft)\n                && sameRef(r1.bottomRight , r2.bottomRight)\n                && r1.endSheet == r2.endSheet;\n        }\n        if (r1 instanceof UnionRef$2) {\n            var i = r1.refs.length;\n            if (i != r2.refs.length) {\n                return false;\n            }\n            while (--i >= 0) {\n                if (!sameRef(r1.refs[i], r2.refs[i])) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n\n    // spreadsheet functions --------\n    var FUNCS = Object.create(null);\n    var DEFER_INIT = [];\n\n    FUNCS[\"if\"] = function(callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        // XXX: I don't like this resolveCells here.  We should try to declare IF with\n        // defineFunction.\n        this.resolveCells([ co ], function(){\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                // XXX: calling both branches in this case, since we'll typically need values from\n                // both.  We could optimize and call them only when first needed, but oh well.\n                th(function(th){\n                    el(function(el){\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function(val, row, col){\n                            if (val instanceof CalcError$2) {\n                                return val;\n                            } else if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                co = this.force(co);\n                if (co instanceof CalcError$2) {\n                    callback(co);\n                } else if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n\n    FUNCS[\"\"] = function(callback) {\n        callback((1+Math.sqrt(5))/2);\n    };\n\n    // Lasciate ogni speranza, voi ch'entrate.\n    //\n    // XXX: document this function.\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = \"function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; \";\n        var resolve = \"function resolve(args, callback) { var toResolve = [], i = 0; \";\n        var name, forced, main = \"'use strict'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE'; \", haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join(\"\");\n        main += \"if (i < args.length) return new CalcError('N/A'); \";\n        main += \"return xargs; } \";\n        arrayArgs += \"return { args: xargs, width: width, height: height, arrays: arrays }; } \";\n\n        var f;\n        if (haveForced) {\n            resolve += \"this.resolveCells(toResolve, callback); } \";\n            f = new Function(\"CalcError\", \"round\", main + resolve + arrayArgs + \" return { resolve: resolve, check: check, arrayArgs: arrayArgs };\");\n        } else {\n            f = new Function(\"CalcError\", \"round\", main + \" return { check: check };\");\n        }\n        f = f(CalcError$2, limitPrecision$1);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n\n        function comp(x) {\n            name = x[0];\n            var code = \"{ \";\n            if (Array.isArray(name)) {\n                arrayArgs += \"while (i < args.length) { \";\n                resolve += \"while (i < args.length) { \";\n                code += \"xargs.push(tmp = []); stack.push(xargs); xargs = tmp; \";\n                code += \"while (i < args.length) { \";\n                code += x.map(comp).join(\"\");\n                code += \"} \";\n                code += \"xargs = stack.pop(); \";\n                resolve += \"} \";\n                arrayArgs += \"} \";\n            } else if (name == \"+\") {\n                arrayArgs += \"while (i < args.length) { \";\n                resolve += \"while (i < args.length) { \";\n                code += \"if (i >= args.length) return new CalcError('N/A'); \";\n                code += \"xargs.push(tmp = []); stack.push(xargs); xargs = tmp; \";\n                code += \"do { \";\n                code += x.slice(1).map(comp).join(\"\");\n                code += \"} while (i < args.length); \";\n                code += \"xargs = stack.pop(); \";\n                resolve += \"} \";\n                arrayArgs += \"} \";\n            } else if (name == \"?\") {\n                // standalone assertion without a new argument\n                code += \"if (!(\" + cond(x[1]) + \")) return new CalcError(err); \";\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var wantNulls = /!$/.test(type[0]);\n                    var n = type[2];\n                    force();\n                    code += \"try {\"\n                        + \"var $\" + name + \" = this.cellValues(args.slice(i\";\n                    if (n) {\n                        code += \", i + \" + n;\n                    }\n                    code += \")\" + (wantNulls ? \",true\" : \"\") + \").reduce(function(ret, $\"+name+\"){ \";\n                    if (type[0].charAt(0) != \"#\") {\n                        code += \"if ($\"+name+\" instanceof CalcError) throw $\"+name+\"; \";\n                    }\n                    code += \"if (\" + cond(type[1]) + \") ret.push($\"+name+\"); \";\n                    code += \"return ret; \";\n                    code += \"}.bind(this), []); \";\n                    if (n) {\n                        code += \"i += \" + n + \"; \";\n                    } else {\n                        code += \"i = args.length; \";\n                    }\n                    code += \"xargs.push($\"+name+\")\"\n                        + \"} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } \";\n                    resolve += \"toResolve.push(args.slice(i)); \";\n                } else if (type == \"rest\") {\n                    code += \"xargs.push(args.slice(i)); i = args.length; \";\n                } else {\n                    if ((canBeArrayArg = /^\\*/.test(name))) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += \"var $\" + name + \" = args[i++]; \";\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += \"if ($\"+name+\" instanceof CalcError) return $\"+name+\"; \";\n                    }\n                    code += typeCheck(type, allowError) + \"xargs.push($\"+name+\"); \";\n                }\n            }\n            code += \"} \";\n            return code;\n        }\n\n        function force() {\n            if (forced) {\n                return \"$\"+name+\"\";\n            }\n            haveForced = true;\n            forced = true;\n            resolve += \"toResolve.push(args[i++]); \";\n            return \"($\"+name+\" = this.force($\"+name+\"))\";\n        }\n\n        function forceNum(round) {\n            return \"(\"\n                +     (round\n                       ? (\"(typeof \" + force() + \" == 'number' ? ($\"+name+\" = round($\"+name+\"), true) : false) || \")\n                       : (\"(typeof \" + force() + \" == 'number') || \"))\n                +     \"(typeof $\"+name+\" == 'boolean' ? ($\"+name+\" = +$\" + name + \", true) : false) || \"\n                +     \"(typeof $\"+name+\" == 'string' && !/^(?:=|true|false)/i.test($\"+name+\") ? (\"\n                +       \"tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $\"+name+\"), \"\n                +       \"/^date|number|percent$/.test(tmp.type) ? ($\"+name+\" = +tmp.value, true) : false\"\n                +     \") : false)\"\n                +  \")\";\n        }\n\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = \"if (!(\" + cond(type) + \")) { \";\n            if (forced && !allowError) {\n                ret += \" if ($\" + name + \" instanceof CalcError) return $\" + name + \"; \";\n            }\n            ret += \"return new CalcError(err); } \";\n            if (!forced) {\n                resolve += \"i++; \";\n            }\n            if (canBeArrayArg) {\n                arrayArgs += \"var $\" + name + \" = this._arrayArg(args[i]); \"\n                    + \"if ($\" + name + \") { \"\n                    + \"xargs.push($\" + name + \"); \"\n                    + \"width = Math.max(width, $\" + name + \".width); \"\n                    + \"height = Math.max(height, $\" + name + \".height); \"\n                    + \"arrays.push(true) } else { \"\n                    + \"xargs.push(args[i]); \"\n                    + \"arrays.push(false); } i++; \";\n            } else {\n                arrayArgs += \"xargs.push(args[i++]); arrays.push(false); \";\n            }\n            return ret;\n        }\n\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == \"or\") {\n                    return \"(\" + type.slice(1).map(cond).join(\") || (\") + \")\";\n                }\n                if (type[0] == \"and\") {\n                    return \"(\" + type.slice(1).map(cond).join(\") && (\") + \")\";\n                }\n                if (type[0] == \"values\") {\n                    return \"(\" + type.slice(1).map(function(val){\n                        return force() + \" === \" + val;\n                    }).join(\") || (\") + \")\";\n                }\n                if (type[0] == \"null\") {\n                    return \"(\" + cond(\"null\") + \" ? (($\"+name+\" = \" + type[1] + \"), true) : false)\";\n                }\n                if (type[0] == \"between\" || type[0] == \"[between]\") {\n                    return \"(\" + force() + \" >= \" + type[1] + \" && \" + \"$\"+name+\" <= \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                }\n                if (type[0] == \"(between)\") {\n                    return \"(\" + force() + \" > \" + type[1] + \" && \" + \"$\"+name+\" < \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                }\n                if (type[0] == \"(between]\") {\n                    return \"(\" + force() + \" > \" + type[1] + \" && \" + \"$\"+name+\" <= \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                }\n                if (type[0] == \"[between)\") {\n                    return \"(\" + force() + \" >= \" + type[1] + \" && \" + \"$\"+name+\" < \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                }\n                if (type[0] == \"assert\") {\n                    var err = type[2] || \"N/A\";\n                    return \"((\" + type[1] + \") ? true : (err = \" + JSON.stringify(err) + \", false))\";\n                }\n                if (type[0] == \"not\") {\n                    return \"!(\" + cond(type[1]) + \")\";\n                }\n                throw new Error(\"Unknown array type condition: \" + type[0]);\n            }\n            if (type == \"number\" || type == \"datetime\") {\n                return forceNum(true);\n            }\n            if (type == \"number!\") {\n                return \"(typeof \" + force() + \" == 'number' ? ($\"+name+\" = round($\"+name+\"), true) : false)\";\n            }\n            if (type == \"integer\" || type == \"date\") {\n                return \"(\" + forceNum() + \" && (($\"+name+\" |= 0), true))\";\n            }\n            if (type == \"divisor\") {\n                return \"(\" + forceNum(true) + \" && ($\"+name+\" == 0 ? ((err = 'DIV/0'), false) : true))\";\n            }\n            if (type == \"number+\") {\n                return \"(\" + forceNum(true) + \" && ($\"+name+\" >= 0 ? true : ((err = 'NUM'), false)))\";\n            }\n            if (type == \"integer+\") {\n                return \"(\" + forceNum() + \" && (($\"+name+\" |= 0) >= 0 ? true : ((err = 'NUM'), false)))\";\n            }\n            if (type == \"number++\") {\n                return \"(\" + forceNum(true) + \" && ($\"+name+\" > 0 ? true : ((err = 'NUM'), false)))\";\n            }\n            if (type == \"integer++\") {\n                return \"(\" + forceNum() + \" && (($\"+name+\" |= 0) > 0 ? true : ((err = 'NUM'), false)))\";\n            }\n            if (type == \"string\") {\n                return \"((typeof \" + force() + \" == 'string' || typeof $\"+name+\" == 'boolean' || typeof $\"+name+\" == 'number') ? ($\"+name+\" += '', true) : ($\"+name+\" === undefined ? (($\"+name+\" = ''), true) : false))\";\n            }\n            if (type == \"boolean\") {\n                return \"(typeof \" + force() + \" == 'boolean')\";\n            }\n            if (type == \"logical\") {\n                return \"(typeof \" + force() + \" == 'boolean' || (typeof $\"+name+\" == 'number' ? ($\"+name+\" = !!$\"+name+\", true) : false))\";\n            }\n            if (type == \"matrix\") {\n                force();\n                return \"((m = this.asMatrix($\"+name+\")) ? ($\"+name+\" = m) : false)\";\n            }\n            if (type == \"#matrix\") {\n                return \"((m = this.asMatrix($\"+name+\")) ? ($\"+name+\" = m) : false)\";\n            }\n            if (type == \"ref\") {\n                return \"($\"+name+\" instanceof kendo.spreadsheet.Ref)\";\n            }\n            if (type == \"area\") {\n                return \"($\"+name+\" instanceof kendo.spreadsheet.CellRef || $\"+name+\" instanceof kendo.spreadsheet.RangeRef)\";\n            }\n            if (type == \"cell\") {\n                return \"($\"+name+\" instanceof kendo.spreadsheet.CellRef)\";\n            }\n            if (type == \"null\") {\n                return \"(\" + force() + \" == null)\";\n            }\n            if (type == \"anyvalue\") {\n                return \"(\" + force() + \" != null && i <= args.length)\";\n            }\n            if (type == \"forced\") {\n                return \"(\" + force() + \", i <= args.length)\";\n            }\n            if (type == \"anything\") {\n                return \"(i <= args.length)\";\n            }\n            if (type == \"blank\") {\n                return \"(\" + force() + \" == null || $\"+name+\" === '')\";\n            }\n            throw new Error(\"Can't check for type: \" + type);\n        }\n    }\n\n    function limitPrecision$1(num, digits) {\n        return num === parseInt(num, 10) ? num : +num.toPrecision(digits || 16);\n    }\n\n    function maybeRoundFloatErrors(num, digits) {\n        if (typeof num == \"number\") {\n            return limitPrecision$1(num, digits);\n        } else {\n            return num;\n        }\n    }\n\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError$2) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch(ex) {\n            if (ex instanceof CalcError$2) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function(callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix$1(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].getNA(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function(callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix$1(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function(row, col) {\n                            return function(value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].getNA(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError$2) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError$2) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n\n    function loadDeferred() {\n        while(DEFER_INIT.length) {\n            DEFER_INIT.shift()();\n        }\n    }\n\n    function deferInit(cb) {\n        DEFER_INIT.push(cb);\n    }\n\n    function defineFunction$2(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function(args, log) {\n                var code = compileArgumentChecks(name, args);\n                // XXX: DEBUG\n                if (log) {\n                    if (code.arrayArgs) {console.log(code.arrayArgs.toString());}\n                    if (code.resolve) {console.log(code.resolve.toString());}\n                    if (code.check) {console.log(code.check.toString());}\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function(args, log) {\n                var code = compileArgumentChecks(name, args);\n                // XXX: DEBUG\n                if (log) {\n                    if (code.arrayArgs) {console.log(code.arrayArgs.toString());}\n                    if (code.resolve) {console.log(code.resolve.toString());}\n                    if (code.check) {console.log(code.check.toString());}\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n\n    /* -----[ date calculations ]----- */\n\n    // Julian days algorithms from http://www.hermetic.ch/cal_stud/jdn.htm#comp\n\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return ((1461 * (y + 4800 + ((m - 14) / 12 | 0))) / 4 | 0) +\n            ((367 * (m - 2 - 12 * ((m - 14) / 12 | 0))) / 12 | 0) -\n            ((3 * (((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0))) / 4 | 0) +\n            d - 32075;\n    }\n\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = (4 * l) / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = (4000 * (l + 1) / 1461001) | 0;\n        l = l - ((1461 * i) / 4 | 0) + 31;\n        j = (80 * l) / 2447 | 0;\n        d = l - ((2447 * j) / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - (12 * l);\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year  : y,\n            month : m,\n            date  : d,\n            day   : (jd + 1) % 7,\n            ord   : ORDINAL_ADD_DAYS[isLeapYear$1(y)][m] + d\n        };\n    }\n\n    // This uses the Google Spreadsheet approach: treat 1899-12-31 as day 1, allowing to avoid\n    // implementing the \"Leap Year Bug\" yet still be Excel compatible for dates starting 1900-03-01.\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n\n    var DAYS_IN_MONTH = [ 31, 28, 31,\n                          30, 31, 30,\n                          31, 31, 30,\n                          31, 30, 31 ];\n\n    var ORDINAL_ADD_DAYS = [\n        [ 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 ], // non-leap year\n        [ 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335 ]  // leap year\n    ];\n\n    function isLeapYear$1(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n\n    function daysInYear$2(yr) {\n        return isLeapYear$1(yr) ? 366 : 365;\n    }\n\n    function daysInMonth$2(yr, mo) {\n        return (isLeapYear$1(yr) && mo == 1) ? 29 : DAYS_IN_MONTH[mo];\n    }\n\n    function validDate(yr, mo, da) {\n        return mo >= 1 && mo <= 12 && da >= 1 && da <= daysInMonth$2(yr, mo - 1);\n    }\n\n    function unpackDate$2(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n\n    function packDate$2(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n\n    function unpackTime(serial) {\n        var frac = serial - (serial|0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n\n    function serialToDate(serial) {\n        var d = unpackDate$2(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date,\n                        t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n\n    function packTime(hh, mm, ss, ms) {\n        return (hh+(mm+(ss+ms/1000)/60)/60)/24;\n    }\n\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(),\n                            date.getMinutes(),\n                            date.getSeconds(),\n                            date.getMilliseconds());\n        date = packDate$2(date.getFullYear(),\n                        date.getMonth(),\n                        date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n\n    function parseDate(str, format) {\n        if (format) {\n            format = kendo.spreadsheet.formatting.makeDateFormat(format);\n        }\n        return kendo.parseExactDate(str, format)\n            || kendo.parseExactDate(str)\n            || kendo.parseExactDate(str, [\n                \"MMMM dd yyyy\",\n                \"MMMM dd yy\",\n                \"MMM dd yyyy\",\n                \"MMM dd yy\",\n                \"dd MMMM yyyy\",\n                \"dd MMMM yy\",\n                \"dd MMM yyyy\",\n                \"dd MMM yy\",\n                \"MMMM dd, yyyy\",\n                \"MMMM dd, yy\",\n                \"MMM dd, yyyy\",\n                \"MMM dd, yy\",\n                \"MMMM dd\",\n                \"MMM dd\",\n                \"MMMM yyyy\",\n                \"MMM yyyy\",\n                \"dd MMMM\",\n                \"dd MMM\"\n            ]);\n    }\n\n    /* -----[ exports ]----- */\n\n    exports$2.CalcError = CalcError$2;\n    exports$2.Formula = Formula$1;\n    exports$2.Matrix = Matrix$1;\n\n    exports$2.packDate = packDate$2;\n    exports$2.unpackDate = unpackDate$2;\n    exports$2.packTime = packTime;\n    exports$2.unpackTime = unpackTime;\n    exports$2.serialToDate = serialToDate;\n    exports$2.dateToSerial = dateToSerial;\n    exports$2.daysInMonth = daysInMonth$2;\n    exports$2.validDate = validDate;\n    exports$2.isLeapYear = isLeapYear$1;\n    exports$2.daysInYear = daysInYear$2;\n    exports$2.parseDate = parseDate;\n    exports$2.limitPrecision = limitPrecision$1;\n\n    spreadsheet$7.dateToNumber = dateToSerial;\n    spreadsheet$7.numberToDate = serialToDate;\n    spreadsheet$7.defineFunction = defineFunction$2;\n    spreadsheet$7.loadDeferred = loadDeferred;\n    spreadsheet$7.deferInit = deferInit;\n    spreadsheet$7.CalcError = CalcError$2;\n\n    exports$2.defineFunction = defineFunction$2;\n    exports$2.loadDeferred = loadDeferred;\n    exports$2.deferInit = deferInit;\n    exports$2.defineAlias = function(alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error(\"Function \" + name + \" is not yet defined\");\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [ name ];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports$2.FUNCS = FUNCS;\n\n    /* -----[ Excel operators ]----- */\n\n    var NUMBER_OR_ZERO = [ \"or\", \"number\", [ \"null\", 0 ] ];\n\n    var ARGS_NUMERIC = [\n        [ \"*a\", NUMBER_OR_ZERO ],\n        [ \"*b\", NUMBER_OR_ZERO ]\n    ];\n\n    var ARGS_ANYVALUE = [\n        [ \"*a\", \"forced\" ],\n        [ \"*b\", \"forced\" ]\n    ];\n\n    deferInit(() => {\n        defineFunction$2(\"binary+\", function(a, b){\n            return a + b;\n        }).args(ARGS_NUMERIC);\n\n        defineFunction$2(\"binary-\", function(a, b){\n            return a - b;\n        }).args(ARGS_NUMERIC);\n\n        defineFunction$2(\"binary*\", function(a, b){\n            return a * b;\n        }).args(ARGS_NUMERIC);\n\n        defineFunction$2(\"binary/\", function(a, b){\n            return a / b;\n        }).args([\n            [ \"*a\", NUMBER_OR_ZERO ],\n            [ \"*b\", \"divisor\" ]\n        ]);\n\n        defineFunction$2(\"binary^\", function(a, b){\n            return Math.pow(a, b);\n        }).args(ARGS_NUMERIC);\n\n        defineFunction$2(\"binary&\", function(a, b){\n            if (a == null) { a = \"\"; }\n            if (b == null) { b = \"\"; }\n            return \"\" + a + b;\n        }).args([\n            [ \"*a\", [ \"or\", \"number\", \"string\", \"boolean\", \"null\" ] ],\n            [ \"*b\", [ \"or\", \"number\", \"string\", \"boolean\", \"null\" ] ]\n        ]);\n    });\n\n    function equals(a, b){\n        a = typeof(a) === \"string\" ? a.toLowerCase() : a;\n        b = typeof(b) === \"string\" ? b.toLowerCase() : b;\n\n        // special cases\n        if (a === false && b == null) { return true; }\n        if (b === false && a == null) { return true; }\n        if (a === 0     && b == null) { return true; }\n        if (b === 0     && a == null) { return true; }\n        if (a === \"\"    && b == null) { return true; }\n        if (b === \"\"    && a == null) { return true; }\n\n        return a === b;\n    }\n\n    deferInit(() => {\n        defineFunction$2(\"binary=\", equals).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"binary<>\", function(a, b){\n            return !equals(a, b);\n        }).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"binary<\", binaryCompare(function(a, b){\n            return a < b;\n        })).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"binary<=\", binaryCompare(function(a, b){\n            return a <= b;\n        })).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"binary>\", binaryCompare(function(a, b){\n            return a > b;\n        })).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"binary>=\", binaryCompare(function(a, b){\n            return a >= b;\n        })).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"unary+\", function(a){\n            return a;\n        }).args([\n            [ \"*a\", NUMBER_OR_ZERO ]\n        ]);\n\n        defineFunction$2(\"unary-\", function(a){\n            return -a;\n        }).args([\n            [ \"*a\", NUMBER_OR_ZERO ]\n        ]);\n\n        defineFunction$2(\"unary%\", function(a){\n            return a / 100;\n        }).args([\n            [ \"*a\", NUMBER_OR_ZERO ]\n        ]);\n\n        // range operator\n        defineFunction$2(\"binary:\", function(a, b){\n            return new RangeRef$3(a, b)\n                .setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n        }).args([\n            [ \"a\", \"cell\" ],\n            [ \"b\", \"cell\" ]\n        ]);\n\n        // union operator\n        defineFunction$2(\"binary,\", function(a, b){\n            return new UnionRef$2([ a, b ]);\n        }).args([\n            [ \"a\", \"ref\" ],\n            [ \"b\", \"ref\" ]\n        ]);\n\n        // intersection operator\n        defineFunction$2(\"binary \", function(a, b){\n            return a.intersect(b);\n        }).args([\n            [ \"a\", \"ref\" ],\n            [ \"b\", \"ref\" ]\n        ]);\n\n        /* -----[ conditionals ]----- */\n\n        defineFunction$2(\"not\", function(a){\n            return !this.bool(a);\n        }).args([\n            [ \"*a\", [ \"or\", \"anyvalue\", [ \"null\", 0 ] ] ]\n        ]);\n\n        /* -----[ the IS* functions ]----- */\n\n        defineFunction$2(\"isblank\", function(val){\n            if (val instanceof CellRef$4) {\n                val = this.getRefData(val);\n                return val == null;\n            }\n            return false;\n        }).args([\n            [ \"*value\", \"anything!\" ]\n        ]);\n\n        defineFunction$2(\"iserror\", function(val){\n            return val instanceof CalcError$2;\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"iserr\", function(val){\n            return val instanceof CalcError$2 && val.code != \"N/A\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"isna\", function(val){\n            return val instanceof CalcError$2 && val.code == \"N/A\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"islogical\", function(val){\n            return typeof val == \"boolean\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"isnontext\", function(val){\n            return typeof val != \"string\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"istext\", function(val){\n            return typeof val == \"string\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"isnumber\", function(val){\n            return typeof val == \"number\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"isref\", function(val){\n            // apparently should return true only for cell and range\n            return val instanceof CellRef$4 || val instanceof RangeRef$3;\n        }).args([\n            [ \"*value\", \"anything!\" ]\n        ]);\n    });\n\n    /* -----[ resolve NameRef-s ]----- */\n\n    FUNCS[\",getname\"] = function(callback, args) {\n        this.fetchName(args[0], callback);\n    };\n\n    /// utils\n\n    function binaryCompare(func) {\n        return function(left, right){\n            if (typeof left == \"string\" && typeof right != \"string\") {\n                right = right == null ? \"\" : right + \"\";\n            }\n            if (typeof left != \"string\" && typeof right == \"string\") {\n                left = left == null ? \"\" : left + \"\";\n            }\n            if (typeof left == \"number\" && right == null) {\n                right = 0;\n            }\n            if (typeof right == \"number\" && left == null) {\n                left = 0;\n            }\n            if (typeof left == \"string\" && typeof right == \"string\") {\n                // string comparison is case insensitive\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                // for issue https://github.com/telerik/kendo-ui-core/issues/6879, limitPrecision\n                // digits got bumped to 16, but it's too much for the case 9.302 - 0.002 (issue\n                // https://github.com/telerik/kendo-ui-core/issues/7170).\n                left = maybeRoundFloatErrors(left, 15);\n                right = maybeRoundFloatErrors(right, 15);\n                return func(left, right);\n            } else {\n                return new CalcError$2(\"VALUE\");\n            }\n        };\n    }\n\n\"use strict\";\n\n    var $$2 = kendo.jQuery;\n\n    var spreadsheet$6 = kendo.spreadsheet;\n\n    var exports$1 = {};\n    spreadsheet$6.validation = exports$1;\n    var calc$3 = spreadsheet$6.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = \"_matrix({0})\";\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n\n    calc$3.runtime.deferInit(() => {\n        calc$3.runtime.defineFunction(\"_matrix\", function(m){\n            if (typeof m == \"string\") {\n                // for constant list validation, Excel includes a string\n                // with comma-separated values  make a Matrix from it.\n                m = this.asMatrix([ m.split(/\\s*,\\s*/) ]);\n            }\n            return m;\n        }).args([\n            [ \"m\", [ \"or\", \"matrix\", \"string\" ] ]\n        ]);\n    });\n\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n\n        if (typeof validation === \"string\") {\n            validation = JSON.parse(validation);\n        }\n\n        if (validation.from) {\n            if (validation.dataType === \"list\" && !validation.fromIsListValue) {\n                // We need to convert the {...} validation.from value to a string, so that it would work when exported to XLSX\n                if(validation.from.indexOf(\"{\") > -1) {\n                    validation.from = validation.from.replace(/\\\"/g,\"\").replace(\"{\",\"\\\"\").replace(\"}\", \"\\\"\");\n                }\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n                validation.fromIsListValue = true;\n            }\n\n            if (validation.dataType === \"date\") {\n                parsedFromDate = calc$3.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n\n            validation.from = calc$3.compile(calc$3.parseFormula(sheet, row, col, validation.from));\n        }\n\n        if (validation.to) {\n            if (validation.dataType === \"date\") {\n                parsedToDate = calc$3.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n\n            validation.to = calc$3.compile(calc$3.parseFormula(sheet, row, col, validation.to));\n        }\n\n        if (validation.dataType == \"custom\") {\n            comparer = exports$1.validationComparers.custom;\n        } else if (validation.dataType == \"list\") {\n            comparer = exports$1.validationComparers.list;\n        } else {\n            comparer = exports$1.validationComparers[validation.comparerType];\n        }\n\n        if (!comparer) {\n            throw kendo.format(\"'{0}' comparer is not implemented.\", validation.comparerType);\n        }\n\n        validationHandler = function (valueToCompare) { //add 'valueFormat' arg when add isDate comparer\n            var toValue = this.to && (this.to_value || this.to_value === 0) ? this.to_value : undefined;\n\n            if (valueToCompare === null || valueToCompare === \"\") {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == \"custom\") {\n                this.value = comparer(valueToCompare, this.from_value,  toValue);\n            } else if (this.dataType == \"list\") {\n                var data = this._getListData();\n\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                //TODO: TYPE CHECK IS REQUIRED ONLY FOR DATE TYPE WHEN SPECIAL COMPARER (ISDATE) IS USED\n                this.value = comparer(valueToCompare, this.from_value,  toValue);\n            }\n\n            return this.value;\n        };\n\n        return new kendo.spreadsheet.validation.Validation($$2.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n\n    var Validation = Class.extend({\n        init: function Validation(options){\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType; //date, time etc\n            this.comparerType =  options.comparerType; //greaterThan, EqaulTo etc\n            this.type = options.type ? options.type : \"warning\"; //info, warning, reject\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.showButton = options.showButton;\n            this.fromIsListValue = options.fromIsListValue ? true : false;\n\n            //TODO: address to be range / cell ref, and adjust it based on it\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n\n        _formatMessages: function(format) {\n            var from = this.from ? this.from_value : \"\";\n            var to = this.to ? this.to_value : \"\";\n\n            var fromFormula = this.from ? this.from.toString() : \"\";\n            var toFormula = this.to ? this.to.toString() : \"\";\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n\n        _setMessages: function() {\n            this.title = \"\";\n            this.message = \"\";\n\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n\n        _getListData: function() {\n            if (!this.from_value || !this.from_value.data) {\n                return [];\n            }\n\n            var cube = this.from_value.data;\n            var i;\n            var y;\n            var data = [];\n\n            for (i = 0; i < cube.length; i++ ) {\n                var array = cube[i];\n\n                if (array) {\n                    for (y = 0; y < array.length; y++ ) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n\n            return data;\n        },\n\n        clone: function(sheet, row, col) {\n            var options = this._getOptions();\n\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n\n            return new Validation($$2.extend(options,\n                { handler: this.handler },\n                { sheet: sheet, row: row, col: col }\n            ));\n        },\n\n        deepClone: function() {\n            var v = new Validation(this);\n            v.from = v.from.deepClone();\n            if (v.to) {\n                v.to = v.to.deepClone();\n            }\n            return v;\n        },\n\n        exec: function(ss, compareValue, compareFormat, callback) {\n            var self = this;\n\n            function getValue(val) {\n                if (val instanceof kendo.spreadsheet.Ref) {\n                    val = ss.getData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                }\n                return val;\n            }\n\n            var calculateFromCallBack = function(val) {\n                self.from_value = getValue(val);\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n\n            if (self.to) {\n                self.to.exec(ss, function(val) {\n                    self.to_value = getValue(val);\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n\n        reset: function() {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n\n        adjust: function(affectedSheet, operation, start, delta) {\n            var prevFrom, prevTo, modified;\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            if (this.from) {\n                prevFrom = this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                prevTo = this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                switch (operation) {\n                  case \"row\":\n                    if (formulaRow >= start) {\n                        modified = true;\n                        this.row += delta;\n                    }\n                    break;\n                  case \"col\":\n                    if (formulaCol >= start) {\n                        modified = true;\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n            if (modified || prevFrom || prevTo) {\n                var v = new Validation(this);\n                v.from = prevFrom;\n                v.to = prevTo;\n                v.row = formulaRow;\n                v.col = formulaCol;\n                return v;\n            }\n        },\n\n        toJSON: function() {\n            var options = this._getOptions();\n\n            if (options.from) {\n                options.from = options.from.toString();\n\n                if (options.dataType === \"list\") {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, \"$1\");\n                    delete options.fromIsListValue;\n                }\n\n                if (options.dataType === \"date\") {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, \"$1\");\n                        delete options.fromIsDateValue;\n                    }\n                }\n            }\n\n            if (options.to) {\n                options.to = options.to.toString();\n\n                if (options.dataType === \"date\") {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, \"$1\");\n                        delete options.toIsDateValue;\n                    }\n                }\n            }\n\n            return options;\n        },\n\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                fromIsListValue: this.fromIsListValue,\n                fromIsDateValue: this.fromIsDateValue,\n                toIsDateValue: this.toIsDateValue,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                //TODO: export generated messages instead?\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate,\n                showButton: this.showButton\n            };\n        }\n    });\n    exports$1.compile = compileValidation;\n    exports$1.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n\n        between: function (valueToCompare, from, to) {\n            return valueToCompare >= from && valueToCompare <= to;\n        },\n\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n\n    exports$1.Validation = Validation;\n\n(function(kendo) {\n\n\n\n    var RangeRef = kendo.spreadsheet.RangeRef;\n    var UnionRef = kendo.spreadsheet.UnionRef;\n    var CellRef = kendo.spreadsheet.CellRef;\n    var Range = kendo.spreadsheet.Range;\n\n    // This is a dynamic variable (see Greenspun's 10th rule).  It's\n    // bound to an array via sheet._saveModifiedFormulas (which see)\n    // while the callback runs.  The goal is to enable external code\n    // to get a list of formulas or validations that have been\n    // adjusted as an effect of an insert/delete row/column operation,\n    // to be able to undo it.\n    //\n    // The reason why simply saving the state via sheet.getState() or\n    // range.getState() won't suffice is that an insert or delete\n    // operation can have far-reaching effects, like adjusting\n    // formulas from another sheet.\n    var MODIFIED_FORMULAS;\n\n    var Selection = kendo.Class.extend({\n        init: function(sheet) {\n            this._sheet = sheet;\n            this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n            this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n            this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n            this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n        },\n\n        currentSelectionRange: function() {\n            return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n        },\n\n        currentOriginalNavigationRange: function() {\n            return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n        },\n\n        currentNavigationRange: function() {\n            if (this.singleCellSelection()) {\n                return this._sheet._sheetRef;\n            } else {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            }\n        },\n\n        nextNavigationRange: function() {\n            if (!this.singleCellSelection()) {\n                this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n            }\n\n            return this.currentNavigationRange();\n        },\n\n        previousNavigationRange: function() {\n            if (!this.singleCellSelection()) {\n                this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n            }\n\n            return this.currentNavigationRange();\n        },\n\n        activeCell: function(ref) {\n            if (ref) {\n                this.originalActiveCell = ref.first();\n                this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                this._sheet.focus(ref);\n                this._sheet.triggerChange({ activeCell: true, selection: true });\n            }\n\n            return this._activeCell;\n        },\n\n        select: function(ref, expanded, changeActiveCell, view) {\n            if (ref) {\n                if (ref.eq(this.originalSelection)) {\n                    return;\n                }\n\n                this._sheet.triggerSelect(new Range(ref, this._sheet));\n\n                this.originalSelection = ref;\n\n                this.selection = expanded;\n\n                if (changeActiveCell !== false) {\n                    if (ref.isCell()) {\n                        // when selecting part of a merged cell, i.e. A1:B2 is merged and select(B2)\n                        // is requested, mark A1 as the actually active cell.\n                        // https://github.com/telerik/kendo/issues/7698\n                        this._sheet.forEachMergedCell(ref, function(merged){\n                            ref = merged.topLeft;\n                        });\n                        this.activeCell(ref);\n                    } else {\n                        ref = this.selection.lastRange();\n                        if (view && view._sheet === this._sheet && view.panes[0]) {\n                            // we should intersect this ref with the range that's currently on\n                            // screen, so that the view doesn't scroll (that is, keep the activeCell\n                            // visible) - https://github.com/telerik/kendo-ui-core/issues/5182 \n                            // XXX: fiddling with View internals here is probably bad practice, but\n                            // this whole thing is a mess already, so it can be forgiven. :-/\n                            var panes = view.panes;\n                            var i, pane, rows, cols, visible, newRef;\n\n                            for (i = 0; i < panes.length; i++) {\n                                pane = panes[i];\n                                if (!pane._currentView) {\n                                    continue;\n                                }\n                                rows = pane._currentView.rows.values;\n                                cols = pane._currentView.columns.values;\n\n                                visible = new RangeRef(\n                                    new CellRef(rows.start, cols.start),\n                                    new CellRef(rows.end, cols.end)\n                                );\n\n                                newRef = ref.intersect(visible);\n\n                                if (newRef !== kendo.spreadsheet.NULLREF) {\n                                    break;\n                                }\n                            }\n\n                            if (newRef && newRef !== kendo.spreadsheet.NULLREF) {\n                                ref = newRef;\n                            }\n                        }\n                        this.activeCell(ref.first());\n                    }\n\n                    this.selectionRangeIndex = this.selection.size() - 1;\n                } else {\n                    this._sheet.triggerChange({ selection: true });\n                }\n            }\n\n            return this.selection;\n        },\n\n        singleCellSelection: function() {\n            return this._activeCell.eq(this.selection);\n        }\n    });\n\n    var Sheet = kendo.Observable.extend({\n        init: function() {\n            kendo.Observable.prototype.init.call(this);\n            this._reinit.apply(this, arguments);\n        },\n\n\n        events: [\n            \"changing\",\n            \"commandRequest\",\n            \"afterInsertRow\",\n            \"afterDeleteRow\",\n            \"insertRow\",\n            \"insertColumn\",\n            \"deleteRow\",\n            \"deleteColumn\",\n            \"hideRow\",\n            \"hideColumn\",\n            \"unhideRow\",\n            \"unhideColumn\",\n            \"select\",\n            \"dataBinding\",\n            \"dataBound\",\n            \"progress\"\n        ],\n\n        _reinit: function(rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n            defaultCellStyle = defaultCellStyle || {};\n\n            this._defaultCellStyle = {\n                background: defaultCellStyle.background,\n                color: defaultCellStyle.color,\n                fontFamily: defaultCellStyle.fontFamily,\n                fontSize: defaultCellStyle.fontSize,\n                italic: defaultCellStyle.italic,\n                bold: defaultCellStyle.bold,\n                underline: defaultCellStyle.underline,\n                wrap: defaultCellStyle.wrap,\n                verticalAlign: defaultCellStyle.verticalAlign,\n                textAlign: defaultCellStyle.textAlign\n            };\n\n            this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n            this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n            this._filteredRows = new kendo.spreadsheet.RangeList(0, rowCount - 1, false);\n            this._mergedCells = [];\n            this._frozenRows = 0;\n            this._frozenColumns = 0;\n            this._suspendChanges = false;\n            this._filter = null;\n            this._showGridLines = true;\n            this._gridLinesColor = null;\n            this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n            this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n            this._properties = new kendo.spreadsheet.PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n            this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n\n            this._viewSelection = new Selection(this);\n\n            this._editSelection = new Selection(this);\n\n            this._formulaSelections = [];\n            this._drawings = [];\n        },\n\n        resize: function(newRows, newCols) {\n            newRows = Math.max(newRows, 1);\n            newCols = Math.max(newCols, 1);\n            var oldRows = this._rows._count;\n            var oldCols = this._columns._count;\n            if (newRows < oldRows) {\n                this.range(newRows, 0, oldRows - newRows, oldCols).clear();\n            }\n            if (newCols < oldCols) {\n                this.range(0, newCols, oldRows, oldCols - newCols).clear();\n            }\n            this._rows._resize(newRows);\n            this._columns._resize(newCols);\n            this._grid._resize(newRows, newCols);\n            this._properties._resize(newRows, newCols);\n            this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n            if (newRows > oldRows) {\n                this.range(oldRows, 0, newRows - oldRows, newCols).clear();\n                this._filteredRows.value(oldRows, newRows - 1, false);\n            }\n            if (newCols > oldCols) {\n                this.range(0, oldCols, newRows, newCols - oldCols).clear();\n            }\n            this.triggerChange({ layout: true });\n        },\n\n        _resizeAddRow: function(count) {\n            this.resize(this._rows._count + (count || 1), this._columns._count);\n        },\n\n        _resizeAddColumn: function(count) {\n            this.resize(this._rows._count, this._columns._count + (count || 1));\n        },\n\n        _resizeDeleteRow: function(count) {\n            this._resizeAddRow(-(count || 1));\n        },\n\n        _resizeDeleteColumn: function(count) {\n            this._resizeAddColumn(-(count || 1));\n        },\n\n        _resizeForJSON: function(rows) {\n            var rowCount = rows.length, colCount = 0;\n            for (var ri = 0; ri < rows.length; ++ri) {\n                var row = rows[ri];\n                if (row.index != null) {\n                    rowCount = Math.max(rowCount, row.index + 1);\n                }\n                if (row.cells) {\n                    colCount = Math.max(colCount, row.cells.length);\n                    for (var ci = 0; ci < row.cells.length; ++ci) {\n                        var cell = row.cells[ci];\n                        if (cell.index != null) {\n                            colCount = Math.max(colCount, cell.index + 1);\n                        }\n                    }\n                }\n            }\n            this.resize(Math.max(rowCount, this._rows._count),\n                        Math.max(colCount, this._columns._count));\n        },\n\n        _selectionState: function() {\n            return this._inEdit ? this._editSelection : this._viewSelection;\n        },\n\n        navigator: function() {\n            if(!this._navigator) {\n                 this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n            }\n            return this._navigator;\n        },\n\n        axisManager: function() {\n            if(!this._axisManager) {\n                 this._axisManager = new kendo.spreadsheet.AxisManager(this);\n            }\n\n            return this._axisManager;\n        },\n\n        _name: function(value) {\n            if (!value) {\n                return this._sheetName;\n            }\n\n            this._sheetName = value;\n\n            return this;\n        },\n\n        name: function() {\n            return this._name();\n        },\n\n        _property: function(accessor, value, reason) {\n            if (value === undefined) {\n                return accessor();\n            } else {\n                accessor(value);\n\n                return this.triggerChange(reason);\n            }\n        },\n\n        _field: function(name, value, reason) {\n            if (value === undefined) {\n                return this[name];\n            } else {\n                this[name] = value;\n\n                return this.triggerChange(reason);\n            }\n        },\n\n        suspendChanges: function(value) {\n            if (value === undefined) {\n                return this._suspendChanges;\n            }\n\n            this._suspendChanges = value;\n\n            return this;\n        },\n\n        triggerChange: function(reason) {\n            if (!this._suspendChanges) {\n                this.trigger(\"change\", reason);\n            } else if (reason && reason.isValue) {\n                this._valueChanged = true;\n            }\n            return this;\n        },\n\n        triggerSelect: function(range) {\n            this.trigger(\"select\", { range: range });\n        },\n\n        setDataSource: function(dataSource, columns) {\n            if (this.dataSourceBinder) {\n                this.dataSourceBinder.destroy();\n            }\n\n            this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                dataSource: dataSource,\n                sheet: this,\n                columns: columns\n            });\n\n            this.dataSource = this.dataSourceBinder.dataSource;\n        },\n\n        hideColumn: function(columnIndex) {\n            if (this.trigger(\"hideColumn\", { index: columnIndex })) {\n                return;\n            }\n\n            return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n        },\n\n        unhideColumn: function(columnIndex) {\n            if (this.trigger(\"unhideColumn\", { index: columnIndex })) {\n                return;\n            }\n\n            return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n        },\n\n        isHiddenColumn: function(columnIndex) {\n            return this._grid._columns.hidden(columnIndex);\n        },\n\n        _copyRange: function(sourceRangeRef, targetRef) {\n            var grid = this._grid;\n            var rowCount = grid.rowCount;\n\n            var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n            var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n\n            var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n            var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n\n            var targetIndex = targetRef.col * rowCount + targetRef.row;\n\n            this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n        },\n\n        _saveModifiedFormulas: function(array, callback) {\n            var save = MODIFIED_FORMULAS;\n            MODIFIED_FORMULAS = array;\n            var ret = callback();\n            MODIFIED_FORMULAS = save;\n            return ret;\n        },\n\n        _restoreModifiedFormulas: function(array) {\n            var wb = this._workbook;\n            array.forEach(function(f){\n                var sheet = wb.sheetByName(f.sheet), index;\n                if (f instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                    index = sheet._grid.cellRefIndex(f); // f has row, col\n                    sheet._properties.set(\"formula\", index, index, f);\n                }\n                if (f instanceof kendo.spreadsheet.validation.Validation) {\n                    index = sheet._grid.cellRefIndex(f); // f has row, col\n                    sheet._properties.set(\"validation\", index, index, f);\n                }\n            });\n        },\n\n        _adjustReferences: function(operation, start, delta, mergedCells) {\n            this._mergedCells = mergedCells.reduce(function(a, ref){\n                ref = ref.adjust(null, null, null, null, operation == \"row\", start, delta);\n                if (ref instanceof RangeRef) {\n                    a.push(ref);\n                }\n                return a;\n            }, []);\n            if (this._workbook) {\n                var affectedSheet = this._name();\n                this._workbook._sheets.forEach(function(sheet){\n                    sheet._forFormulas(function(formula){\n                        var prev = formula.adjust(affectedSheet, operation, start, delta);\n                        if (prev && MODIFIED_FORMULAS) {\n                            // if formula.adjust returns non-null,\n                            // that means the formula was indeed\n                            // modified and the returned value is a\n                            // copy of the previous Formula, which we\n                            // can use for undoing the operation.\n                            MODIFIED_FORMULAS.push(prev);\n                        }\n                    });\n\n                    sheet._forValidations(function(validation){\n                        var prev = validation.adjust(affectedSheet, operation, start, delta);\n                        if (prev && MODIFIED_FORMULAS) {\n                            MODIFIED_FORMULAS.push(prev);\n                        }\n                    });\n                });\n                this._workbook.adjustNames(affectedSheet, operation == \"row\", start, delta);\n            }\n            var selection = this.select();\n            selection = selection.adjust(null, null, null, null, operation == \"row\", start, delta);\n            if (selection !== kendo.spreadsheet.NULLREF) {\n                this.select(selection);\n            }\n            // adjust column widths or row heights and hidden attribute\n            var axis = operation == \"col\" ? this._columns : this._rows;\n            axis.adjust(start, delta);\n\n            if (operation == \"row\") {\n                if (delta < 0) {\n                    this._filteredRows.copy(start - delta, this._rows._count - 1, start);\n                } else {\n                    this._filteredRows.copy(start, this._rows._count, start + delta);\n                    this._filteredRows.value(start, start + delta - 1, false);\n                }\n            }\n\n            // adjust drawing anchor cells\n            this._drawings.forEach(function(drawing){\n                if (drawing.topLeftCell) {\n                    drawing.topLeftCell = drawing.topLeftCell.adjust(null, null, null, null,\n                                                                     operation == \"row\", start, delta);\n                }\n            });\n        },\n\n        _forFormulas: function(callback) {\n            var props = this._properties;\n            var formulas = props.get(\"formula\").values();\n            var n = formulas.length;\n            formulas.forEach(function(f, i){\n                callback.call(this, f.value, i, n);\n            }, this);\n        },\n\n        _forValidations: function(callback) {\n            var props = this._properties;\n            props.get(\"validation\").values().forEach(function(v){\n                callback.call(this, v.value);\n            }, this);\n        },\n\n        insertRow: function(rowIndex, skipDataSourceInsert) {\n            if (this.trigger(\"insertRow\", { index: rowIndex })) {\n                return;\n            }\n\n            this.batch(function() {\n                this._resizeAddRow();\n\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n                var rowCount = grid.rowCount;\n\n                if (rowIndex + 1 == rowCount) {\n                    // we just inserted after the last one, no need to shift data\n                    return;\n                }\n\n                var frozenRows = this.frozenRows();\n\n                if (rowIndex < frozenRows) {\n                    this.frozenRows(frozenRows + 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = 0; ci < columnCount; ci++) {\n                    var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                    var topLeft = grid.normalize(ref.topLeft);\n                    var bottomRight = grid.normalize(ref.bottomRight);\n\n                    var nextRef = new RangeRef(\n                        new CellRef(topLeft.row, topLeft.col),\n                        new CellRef(rowCount - 2, bottomRight.col)\n                    );\n\n                    this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n\n                    new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n                }\n\n                this._adjustReferences(\"row\", rowIndex, 1, mergedCells);\n            }, {\n                recalc: true,\n                layout: true,\n                insertRow: { index: rowIndex },\n                ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n            });\n\n            if (!skipDataSourceInsert) {\n                this.trigger(\"afterInsertRow\", { index: rowIndex });\n            }\n\n            return this;\n        },\n\n        isEnabledRow: function(rowIndex) {\n            var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n            return new Range(ref, this).enable();\n        },\n\n        deleteRow: function(rowIndex, skipDataSourceDelete) {\n            if (!this.isEnabledRow(rowIndex)) {\n                return this;\n            }\n\n            if (this.trigger(\"deleteRow\", { index: rowIndex })) {\n                return;\n            }\n\n            this.batch(function() {\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n\n                var frozenRows = this.frozenRows();\n                if (rowIndex < frozenRows) {\n                    this.frozenRows(frozenRows - 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = 0; ci < columnCount; ci++) {\n                    var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                    new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                    var topLeft = grid.normalize(ref.topLeft);\n                    var bottomRight = grid.normalize(ref.bottomRight);\n\n                    var nextRef = new RangeRef(\n                        new CellRef(topLeft.row + 1, topLeft.col),\n                        new CellRef(Infinity, bottomRight.col)\n                    );\n\n                    this._copyRange(nextRef, topLeft);\n\n                    var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n\n                    new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                }\n\n                this._adjustReferences(\"row\", rowIndex, -1, mergedCells);\n\n                this._resizeDeleteRow();\n            }, {\n                recalc: true,\n                layout: true,\n                deleteRow: { index: rowIndex },\n                ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n            });\n\n            if (!skipDataSourceDelete) {\n                this.trigger(\"afterDeleteRow\", { index: rowIndex });\n            }\n\n            return this;\n        },\n\n        insertColumn: function(columnIndex) {\n            if (this.trigger(\"insertColumn\", { index: columnIndex })) {\n                return;\n            }\n\n            this.batch(function() {\n                this._resizeAddColumn();\n\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n\n                if (columnIndex + 1 == columnCount) {\n                    // we just inserted after the last one, no need to shift data\n                    return;\n                }\n\n                var frozenColumns = this.frozenColumns();\n\n                if (columnIndex < frozenColumns) {\n                    this.frozenColumns(frozenColumns + 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = columnCount; ci >= columnIndex; ci--) {\n                    var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                    new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                    if (ci == columnIndex) {\n                        break;\n                    }\n\n                    var topLeft = grid.normalize(ref.topLeft);\n                    var bottomRight = grid.normalize(ref.bottomRight);\n\n                    var nextRef = new RangeRef(\n                        new CellRef(topLeft.row, topLeft.col - 1),\n                        new CellRef(bottomRight.row, bottomRight.col - 1)\n                    );\n\n                    this._copyRange(nextRef, topLeft);\n                }\n\n                this._adjustReferences(\"col\", columnIndex, 1, mergedCells);\n            }, {\n                recalc: true,\n                layout: true,\n                insertColumn: { index: columnIndex },\n                ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n            });\n\n            return this;\n        },\n\n        isEnabledColumn: function(columnIndex) {\n            var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n            return new Range(ref, this).enable();\n        },\n\n        deleteColumn: function(columnIndex) {\n            if (!this.isEnabledColumn(columnIndex)) {\n                return this;\n            }\n\n            if (this.trigger(\"deleteColumn\", { index: columnIndex })) {\n                return;\n            }\n\n            this.batch(function() {\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n\n                var frozenColumns = this.frozenColumns();\n\n                if (columnIndex < frozenColumns) {\n                    this.frozenColumns(frozenColumns - 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = columnIndex; ci < columnCount; ci++) {\n                    var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                    new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                    if (ci == columnCount - 1) {\n                        break;\n                    }\n\n                    var topLeft = grid.normalize(ref.topLeft);\n                    var bottomRight = grid.normalize(ref.bottomRight);\n\n                    var nextRef = new RangeRef(\n                        new CellRef(topLeft.row, topLeft.col + 1),\n                        new CellRef(bottomRight.row, bottomRight.col + 1)\n                    );\n\n                    this._copyRange(nextRef, topLeft);\n                }\n\n                this._adjustReferences(\"col\", columnIndex, -1, mergedCells);\n\n                this._resizeDeleteColumn();\n            }, {\n                recalc: true,\n                layout: true,\n                deleteColumn: { index: columnIndex },\n                ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n            });\n\n            return this;\n        },\n\n        _filterRow: function(rowIndex) {\n            this._rows.hide(rowIndex);\n            this._filteredRows.value(rowIndex, rowIndex, true);\n            this.triggerChange({ layout: true });\n        },\n\n        hideRow: function(rowIndex) {\n            if (this.trigger(\"hideRow\", { index: rowIndex })) {\n                return;\n            }\n            return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n        },\n\n        unhideRow: function(rowIndex) {\n            if (this.trigger(\"unhideRow\", { index: rowIndex })) {\n                return;\n            }\n            return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n        },\n\n        isHiddenRow: function(rowIndex) {\n            return this._grid._rows.hidden(rowIndex);\n        },\n\n        isFilteredRow: function(rowIndex) {\n            return this._filteredRows.value(rowIndex);\n        },\n\n        columnWidth: function(columnIndex, width) {\n            return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n        },\n\n        rowHeight: function(rowIndex, height) {\n            return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n        },\n\n        frozenRows: function(value) {\n            return this._field(\"_frozenRows\", value, { layout: true });\n        },\n\n        frozenColumns: function(value) {\n            return this._field(\"_frozenColumns\", value, { layout: true });\n        },\n\n        showGridLines: function(value) {\n            return this._field(\"_showGridLines\", value, { layout: true });\n        },\n\n        gridLinesColor: function(value) {\n            return this._field(\"_gridLinesColor\", value, { layout: true });\n        },\n\n        _ref: function(row, column, numRows, numColumns) {\n            var ref = null;\n\n            if (row instanceof kendo.spreadsheet.Ref) {\n                return row;\n            }\n\n            if (row instanceof kendo.spreadsheet.Range) {\n                return row._ref.toRangeRef();\n            }\n\n            if (typeof row === \"string\") {\n                ref = kendo.spreadsheet.calc.parseReference(row);\n            } else {\n                if (!numRows) {\n                    numRows = 1;\n                }\n\n                if (!numColumns) {\n                    numColumns = 1;\n                }\n                ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n            }\n\n            return ref;\n        },\n\n        range: function(row, column, numRows, numColumns) {\n            return new Range(this._ref(row, column, numRows, numColumns), this);\n        },\n\n        _getMergedCells: function(range) {\n            var grid = this._grid;\n            var primary = {};\n            var secondary = {};\n            var hasMerged = false;\n\n            this.forEachMergedCell(range, function(ref) {\n                var topLeft = ref.topLeft;\n                grid.forEach(ref, function(cellRef) {\n                    if (topLeft.eq(cellRef)) {\n                        primary[cellRef.print()] = ref;\n                        hasMerged = true;\n                    } else if (range.contains(cellRef)) {\n                        secondary[cellRef.print()] = topLeft;\n                        hasMerged = true;\n                    }\n                });\n            });\n\n            return { primary: primary, secondary: secondary, hasMerged: hasMerged };\n        },\n\n        forEachMergedCell: function(ref, callback) {\n            var selectAll = false;\n\n            if (typeof callback === \"undefined\") {\n                callback = ref;\n                selectAll = true;\n            }\n\n            this._mergedCells.forEach(function(merged) {\n                if (selectAll || merged.intersects(ref)) {\n                    callback(merged);\n                }\n            });\n        },\n\n        forEachFilterHeader: function(ref, callback) {\n            var selectAll = false;\n\n            if (typeof callback === \"undefined\") {\n                callback = ref;\n                selectAll = true;\n            }\n\n            if (this._filter) {\n                var refs = [];\n\n                // get refs of all columns\n                this._filter.ref.forEachColumn(function(columnRef) {\n                    if (selectAll || columnRef.intersects(ref)) {\n                        refs.push(columnRef.topLeft);\n                    }\n                });\n\n                // filter out merged references\n                this._mergedCells.forEach(function(merged) {\n                    refs = refs.map(function(ref) {\n                        if (merged.intersects(ref)) {\n                            return merged;\n                        }\n\n                        return ref;\n                    });\n                });\n\n                // use only unique refs\n                refs.reduce(function unique(result, element) {\n                    if (result.indexOf(element) < 0) {\n                        result.push(element);\n                    }\n\n                    return result;\n                }, []).forEach(callback);\n            }\n        },\n\n        forEach: function(ref, callback) {\n            var self = this;\n            function forEachRange(ref) {\n                if (!(ref instanceof RangeRef)) {\n                    ref = ref.toRangeRef();\n                }\n                var topLeft = self._grid.normalize(ref.topLeft);\n                var bottomRight = self._grid.normalize(ref.bottomRight);\n                var ci, ri;\n\n                function doIt(value) {\n                    callback(ri++, ci, value);\n                }\n\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    ri = topLeft.row;\n                    var startCellIndex = self._grid.index(ri, ci);\n                    var endCellIndex = self._grid.index(bottomRight.row, ci);\n                    self._properties.forEach(startCellIndex, endCellIndex, doIt);\n                }\n            }\n\n            if (!(ref instanceof RangeRef)) {\n                ref = self._ref(ref);\n            }\n\n            if (ref instanceof UnionRef) {\n                // _ref() might still return a UnionRef, for instance, if\n                // `ref` happens to be one.  Probably an oversight, but it\n                // turns out to be useful.\n                ref.forEach(forEachRange);\n            } else {\n                forEachRange(ref);\n            }\n        },\n\n        startResizing: function(initialPosition) {\n            this._initialPosition = initialPosition;\n            this._resizeInProgress = true;\n        },\n\n        startAutoFill: function() {\n            this._autoFillInProgress = true;\n            var selection = this.select();\n            this._autoFillOrigin = selection;\n            this._autoFillDest = selection;\n            this.triggerChange({ selection: true });\n        },\n\n        updateAutoFill: function(dest, punch, hint, direction) {\n            this._autoFillDest = dest;\n            this._autoFillPunch = punch;\n            this._autoFillHint = hint;\n            this._autoFillDirection = direction;\n            this.triggerChange({ selection: true });\n        },\n\n        autoFillRef: function() {\n            return this._autoFillDest;\n        },\n\n        autoFillPunch: function() {\n            return this._autoFillPunch;\n        },\n\n        autoFillInProgress: function() {\n            return this._autoFillInProgress;\n        },\n\n        resizingInProgress: function() {\n            return this._resizeInProgress;\n        },\n\n        draggingInProgress: function() {\n            return this._draggingInProgress;\n        },\n\n        completeResizing: function() {\n            if (this._resizeInProgress) {\n                this._resizeInProgress = false;\n                var hintPosition = this.resizeHintPosition();\n\n                if (this._initialPosition && hintPosition) {\n                    var handlePosition = this.resizeHandlePosition();\n                    if (handlePosition.col !== -Infinity) {\n                        this.trigger(\"commandRequest\", {\n                            command: \"ColumnWidthCommand\",\n                            options: {\n                                target: handlePosition.col,\n                                value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                            }\n                        });\n                    } else {\n                        this.trigger(\"commandRequest\", {\n                            command: \"RowHeightCommand\",\n                            options: {\n                                target: handlePosition.row,\n                                value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                            }\n                        });\n                    }\n                } else {\n                    this.trigger(\"change\", { resize: true });\n                }\n            }\n        },\n\n        _visualRange: function(ref) {\n            var merged = this._mergedCells;\n            for (var i = merged.length; --i >= 0;) {\n                if (merged[i].intersects(ref)) {\n                    return this.range(merged[i]);\n                }\n            }\n            return this.range(ref);\n        },\n\n        _renderComment: function(ref) {\n            var comment = null;\n            if (ref) {\n                var range = this._visualRange(ref);\n                comment = range.comment();\n                ref = range._ref.toRangeRef().topLeft;\n            }\n            if (comment) {\n                if (!this._commentRef || !ref.eq(this._commentRef)) {\n                    this._commentRef = ref;\n                    this.trigger(\"change\", { comment: true });\n                }\n            } else {\n                if (this._commentRef) {\n                    this._commentRef = null;\n                    this.trigger(\"change\", { comment: true });\n                }\n            }\n        },\n\n        resizeHandlePosition: function() {\n            return this._resizeHandlePosition;\n        },\n\n        resizeHintPosition: function(location) {\n            if (location !== undefined) {\n                this._resizeHintPosition = location;\n                this.trigger(\"change\", { resize: true, overElement: true });\n            }\n            return this._resizeHintPosition;\n        },\n\n        removeResizeHandle: function() {\n            if (this._resizeHandlePosition) {\n                this._resizeHintPosition = undefined;\n                this._resizeHandlePosition = undefined;\n                this._initialPosition = undefined;\n                this.trigger(\"change\", { resize: true, overElement: true });\n            }\n        },\n\n        positionResizeHandle: function(ref) {\n            this._resizeHandlePosition = ref;\n            this.trigger(\"change\", { resize: true, overElement: true });\n        },\n\n        startDragging: function(data) {\n            this._draggingInProgress = data;\n        },\n\n        completeDragging: function() {\n            var drag = this._draggingInProgress;\n            if (drag) {\n                this._draggingInProgress = null;\n                var drawing = drag.drawing;\n                if (drawing.eq(drag.copy)) {\n                    return;\n                }\n                if (drawing.topLeftCell) {\n                    // adjust reference - in case the top-left corner\n                    // was moving, select the cell beneath it.\n                    var box = this.drawingBoundingBox(drawing);\n                    var row = this._rows.indexVisible(box.top);\n                    var col = this._columns.indexVisible(box.left);\n                    var ref = new CellRef(row, col);\n                    var refBox = this.refBoundingBox(ref);\n                    drawing.offsetX = box.left - refBox.left;\n                    drawing.offsetY = box.top - refBox.top;\n                    drawing.topLeftCell = ref;\n                    this.triggerChange({ dragging: true });\n                }\n                this.trigger(\"commandRequest\", {\n                    command: \"DrawingUpdateCommand\",\n                    options: {\n                        sheet    : this,\n                        drawing  : drawing,\n                        previous : drag.copy\n                    }\n                });\n            }\n        },\n\n        startSelection: function(view) {\n            if (this.frozenRows() || this.frozenColumns()) {\n                this._currentView = null;\n            } else if (view && view._sheet === this) {\n                this._currentView = view;\n            }\n            this._selectionInProgress = true;\n        },\n\n        completeSelection: function() {\n            if (this._selectionInProgress) {\n                this._selectionInProgress = false;\n                this._resizeHintPosition = undefined;\n                this.trigger(\"change\", { selection: true });\n            }\n            if (this._autoFillInProgress) {\n                this._autoFillInProgress = false;\n                var dest = this._autoFillDest;\n                var origin = this._autoFillOrigin;\n\n                if (this._autoFillPunch) { // we just clear data here\n                    this.trigger(\"commandRequest\", {\n                        command: \"ClearContentCommand\", options: { operatingRange: this.range(this._autoFillPunch) }\n                    });\n                } else {\n                    if (!dest.eq(origin)) {\n                        this.trigger(\"commandRequest\", {\n                            command: \"AutoFillCommand\", options: { operatingRange: this.range(dest), origin: this.range(origin) }\n                        });\n                    } else {\n                        this.triggerChange({ selection: true });\n                    }\n                }\n\n                this._autoFillDest = null;\n                this._autoFillPunch = null;\n                this._autoFillOrigin = null;\n\n                this.select(dest);\n            }\n        },\n\n        selectionInProgress: function() {\n            return this._selectionInProgress;\n        },\n\n        select: function(ref, changeActiveCell) {\n            var selectionState = this._selectionState();\n\n            var expandedRef;\n\n            if (ref) {\n                ref = this._ref(ref);\n                ref = this._grid.normalize(ref);\n                expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n            }\n\n            return selectionState.select(ref, expandedRef, changeActiveCell, this._currentView);\n        },\n\n        originalSelect: function() {\n            return this._selectionState().originalSelection;\n        },\n\n        currentSelectionRange: function() {\n            return this._selectionState().currentSelectionRange();\n        },\n\n        currentOriginalSelectionRange: function() {\n            return this._selectionState().currentOriginalNavigationRange();\n        },\n\n        currentNavigationRange: function() {\n            return this._selectionState().currentNavigationRange();\n        },\n\n        nextNavigationRange: function() {\n            return this._selectionState().nextNavigationRange();\n        },\n\n        previousNavigationRange: function() {\n            return this._selectionState().previousNavigationRange();\n        },\n\n        selectionRangeIndex: function() {\n            return this._selectionState().selectionRangeIndex;\n        },\n\n        activeCell: function(ref) {\n            return this._selectionState().activeCell(ref);\n        },\n\n        originalActiveCell: function() {\n            return this._selectionState().originalActiveCell;\n        },\n\n        singleCellSelection: function() {\n            return this._selectionState().singleCellSelection();\n        },\n\n        unionWithMerged: function(ref) {\n            var mergedCells = this._mergedCells;\n\n            return ref.map(function(ref) {\n                return ref.toRangeRef().union(mergedCells);\n            });\n        },\n\n        trim: function(ref) {\n            var trims = [];\n            var grid = this._grid;\n            this._properties.forEachProperty(function(property) {\n                trims.push(grid.trim(ref, property.list));\n            });\n            return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n        },\n\n        focus: function(ref) {\n            if (ref) {\n                this._focus = ref.toRangeRef();\n            } else {\n                var focus = this._focus;\n                this._focus = null;\n                return focus;\n            }\n        },\n\n        activeCellSelection: function() {\n            return new Range(this._grid.normalize(this.activeCell()), this);\n        },\n\n        selection: function() {\n            return new Range(this._grid.normalize(this._selectionState().selection), this);\n        },\n\n        selectedHeaders: function() {\n            var selection = this.select();\n\n            var rows = {};\n            var cols = {};\n            var allCols = false;\n            var allRows = false;\n            var maxRow = this._grid.rowCount - 1;\n            var maxCol = this._grid.columnCount - 1;\n\n            selection.forEach(function(ref) {\n                var i;\n                var rowState = \"partial\";\n                var colState = \"partial\";\n                ref = ref.toRangeRef();\n\n                var bottomRight = ref.bottomRight;\n                var topLeft = ref.topLeft;\n\n                var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n\n                if (colSelection) { //column selection\n                    allRows = true;\n                    colState = \"full\";\n                }\n\n                if (rowSelection) { //row selection\n                    allCols = true;\n                    rowState = \"full\";\n                }\n\n                if (!colSelection) { //column selection\n                    for (i = topLeft.row; i <= bottomRight.row; i++) {\n                        if (rows[i] !== \"full\") {\n                            rows[i] = rowState;\n                        }\n                    }\n                }\n\n                if (!rowSelection) {\n                    for (i = topLeft.col; i <= bottomRight.col; i++) {\n                        if (cols[i] !== \"full\") {\n                            cols[i] = colState;\n                        }\n                    }\n                }\n            });\n\n            return {\n                rows: rows,\n                cols: cols,\n                allRows: allRows,\n                allCols: allCols,\n                all: allRows && allCols\n            };\n        },\n\n        isInEditMode: function(isInEdit) {\n            if (isInEdit === undefined) {\n                return this._inEdit;\n            }\n\n            this._inEdit = isInEdit;\n\n            if (isInEdit) {\n                this._editSelection.selection = this._viewSelection.selection.clone();\n                this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n            }\n        },\n\n        _setFormulaSelections: function(selection) {\n            this._formulaSelections = (selection || []).slice();\n            this.triggerChange({ selection: true });\n        },\n\n        _viewActiveCell: function() {\n            return this._viewSelection._activeCell.toRangeRef();\n        },\n\n        toJSON: function() {\n            var positions = {};\n\n            var rows = this._rows.toJSON(\"height\", positions);\n            var columns = this._columns.toJSON(\"width\", {});\n            var viewSelection = this._viewSelection;\n            var hyperlinks = [];\n            var defaultCellStyle = this._defaultCellStyle || {};\n\n            function clearDefaultStyle(cell) {\n                Object.keys(defaultCellStyle).forEach(function(key){\n                    if (cell[key] === defaultCellStyle[key]) {\n                        delete cell[key];\n                    }\n                });\n            }\n\n            this.forEach(kendo.spreadsheet.SHEETREF, function(row, col, cell) {\n                clearDefaultStyle(cell);\n\n                if (Object.keys(cell).length === 0) {\n                    return;\n                }\n\n                if (cell.link) {\n                    hyperlinks.push({\n                        ref    : kendo.spreadsheet.Ref.display(null, row, col),\n                        target : cell.link\n                    });\n                }\n\n                var position = positions[row];\n\n                if (position === undefined) {\n                    position = rows.length;\n                    rows.push({ index: row });\n                    positions[row] = position;\n                }\n\n                row = rows[position];\n\n                cell.index = col;\n\n                if (row.cells === undefined) {\n                    row.cells = [];\n                }\n\n                if (cell.formula) {\n                    // stringify Formula object.\n                    if (cell.formula.arrayFormulaRange) {\n                        cell.formula = {\n                            src: cell.formula.toString(),\n                            ref: cell.formula.arrayFormulaRange.toString()\n                        };\n                    } else {\n                        cell.formula = cell.formula.toString();\n                    }\n                }\n\n                if (cell.validation) {\n                    cell.validation = cell.validation.toJSON();\n                }\n\n                if (cell.color) {\n                    cell.color = kendo.parseColor(cell.color).toCss();\n                }\n\n                if (cell.background) {\n                    cell.background = kendo.parseColor(cell.background).toCss();\n                }\n\n                if (cell.borderTop && cell.borderTop.color) {\n                    cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                }\n\n                if (cell.borderBottom && cell.borderBottom.color) {\n                    cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                }\n\n                if (cell.borderRight && cell.borderRight.color) {\n                    cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                }\n\n                if (cell.borderLeft && cell.borderLeft.color) {\n                    cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                }\n\n                row.cells.push(cell);\n            });\n\n            var json = {\n                name: this._name(),\n                rows: rows,\n                columns: columns,\n                selection: viewSelection.selection.toString(),\n                activeCell: viewSelection.activeCell().toString(),\n                frozenRows: this.frozenRows(),\n                frozenColumns: this.frozenColumns(),\n                showGridLines: this.showGridLines(),\n                gridLinesColor: this.gridLinesColor(),\n                mergedCells: this._mergedCells.map(function(ref) {\n                    return ref.toString();\n                }),\n                hyperlinks: hyperlinks,\n                defaultCellStyle: defaultCellStyle,\n                drawings: this._drawings.map(function(dr){\n                    return dr.toJSON();\n                })\n            };\n\n            if (this._sort) {\n               json.sort = {\n                   ref: this._sort.ref.toString(),\n                   columns: this._sort.columns.map(function(column) {\n                       return {\n                           index: column.index,\n                           ascending: column.ascending\n                       };\n                   })\n               };\n            }\n\n            if (this._filter) {\n               json.filter = {\n                   ref: this._filter.ref.toString(),\n                   columns: this._filter.columns.map(function(column) {\n                        var filter = column.filter.toJSON();\n                        filter.index = column.index;\n                        return filter;\n                   })\n               };\n            }\n\n            return json;\n        },\n\n        fromJSON: function(json) {\n            this.batch(function() {\n                if (json.name !== undefined) {\n                    this._name(json.name);\n                }\n\n                if (json.frozenColumns !== undefined) {\n                    this.frozenColumns(json.frozenColumns);\n                }\n\n                if (json.frozenRows !== undefined) {\n                    this.frozenRows(json.frozenRows);\n                }\n\n                if (json.columns !== undefined) {\n                    this._columns.fromJSON(\"width\", json.columns);\n                }\n\n                if (json.rows !== undefined) {\n                    this._resizeForJSON(json.rows);\n                    this._rows.fromJSON(\"height\", json.rows);\n\n                    for (var ri = 0; ri < json.rows.length; ri++) {\n                        var row = json.rows[ri];\n                        var rowIndex = row.index;\n\n                        if (rowIndex === undefined) {\n                            rowIndex = ri;\n                        }\n\n                        if (row.cells) {\n                            for (var ci = 0; ci < row.cells.length; ci++) {\n                                var cell = row.cells[ci];\n                                var columnIndex = cell.index;\n\n                                if (columnIndex === undefined) {\n                                    columnIndex = ci;\n                                }\n\n                                if (cell.formula) {\n                                    var isArray = typeof cell.formula != \"string\";\n                                    var src = isArray ? cell.formula.src : cell.formula;\n                                    var formula = this._compileFormula(rowIndex, columnIndex, src);\n                                    if (isArray) {\n                                        formula.setArrayFormulaRange(\n                                            kendo.spreadsheet.calc.parseReference(cell.formula.ref));\n                                    }\n                                    cell.formula = formula;\n                                }\n\n                                if (cell.validation) {\n                                    cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                }\n\n                                this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                            }\n                        }\n                    }\n                }\n\n                if (json.drawings) {\n                    this._drawings = json.drawings.map(Drawing.fromJSON);\n                }\n\n                if (json.selection) {\n                    this._viewSelection.selection =\n                        this._viewSelection.originalSelection = this._ref(json.selection);\n                }\n\n                if (json.activeCell) {\n                    var activeCellRef = this._ref(json.activeCell);\n\n                    this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                    this._viewSelection.originalActiveCell = activeCellRef.first();\n                }\n\n\n                if (json.mergedCells) {\n                    json.mergedCells.forEach(function(ref) {\n                       this.range(ref).merge();\n                    }, this);\n                }\n\n                if (json.filter) {\n                    var ref = json.filter.ref;\n                    var columns = json.filter.columns  === undefined ? [] : json.filter.columns;\n\n                    if (!ref) {\n                        kendo.logToConsole(\"Dropping filter for sheet '\" + json.name + \"' due to missing ref\");\n                    } else {\n                        this._filter = {\n                            ref: this._ref(ref),\n                            columns: columns.map(function(column) {\n                                return {\n                                    index: column.index,\n                                    filter: kendo.spreadsheet.Filter.create(column)\n                                };\n                            })\n                        };\n\n                        this._refreshFilter();\n                    }\n                }\n\n                if (json.showGridLines !== undefined) {\n                    this._showGridLines = json.showGridLines;\n                }\n\n                this._gridLinesColor = json.gridLinesColor;\n\n                if (json.sort) {\n                    this._sortBy(this._ref(json.sort.ref), json.sort.columns.slice(0));\n                }\n            });\n\n            this._rows._refresh();\n            this._columns._refresh();\n        },\n\n        formula: function(ref) {\n            return this._properties.get(\"formula\", this._grid.cellRefIndex(ref));\n        },\n\n        validation: function(ref) {\n            return this._properties.get(\"validation\", this._grid.cellRefIndex(ref));\n        },\n\n        // NOTE: resetFormulas should be called first.  We don't do it in this\n        // function because it should be done from the Workbook object for all\n        // sheets.\n        resetFormulas: function() {\n            this._forFormulas(function(formula){\n                formula.reset();\n            });\n        },\n\n        resetValidations: function() {\n            this._forValidations(function(validation){\n                validation.reset();\n            });\n        },\n\n        recalc: function(context, callback) {\n            var formulas = this._properties.get(\"formula\").values();\n            var count = formulas.length, pending = 0, i = 0;\n            if (!count && callback) {\n                return callback();\n            }\n            function next() {\n                pending--;\n                if (i == count && !pending) {\n                    callback();\n                }\n            }\n            while (i < count) {\n                pending++;\n                formulas[i++].value.exec(context, callback ? next : null);\n            }\n        },\n\n        revalidate: function(context) {\n            var self = this;\n            this._forValidations(function(validation){\n                var cellRef = new CellRef(validation.row, validation.col);\n                var ref =  new RangeRef(cellRef, cellRef);\n                validation.exec(context, self._get(ref, \"value\"), self._get(ref, \"format\"));\n            });\n        },\n\n        _value: function(row, col, value) {\n            var index = this._grid.index(row, col);\n\n            if (value !== undefined) {\n                this._properties.set(\"value\", index, index, value);\n            } else {\n                return this._properties.get(\"value\", index);\n            }\n        },\n\n        _validation: function(row, col) {\n            var index = this._grid.index(row, col);\n\n            return this._properties.get(\"validation\", index);\n        },\n\n        _compileValidation: function(row, col, validation) {\n            if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                // do not alter an existing object.\n                return validation.clone(this._name(), row, col);\n            }\n\n            if (validation.from != null) {\n                validation.from = (validation.from + \"\").replace(/^=/, \"\");\n            }\n\n            if (validation.to != null) {\n                validation.to = (validation.to + \"\").replace(/^=/, \"\");\n            }\n\n            return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n        },\n\n        _compileFormula: function(row, col, f) {\n            f = f.replace(/^=/, \"\");\n            f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n            return kendo.spreadsheet.calc.compile(f);\n        },\n\n        _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n            var ci, start, end;\n\n            for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                start = this._grid.index(topLeft.row, ci);\n                end = this._grid.index(bottomRight.row, ci);\n                for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                    // Even if it's the same formula in multiple cells, we\n                    // need to have different Formula objects, hence cloning\n                    // it.  Don't worry, clone() is fast.\n                    value = value.clone(this._name(), row, ci);\n                    this._properties.set(property, index, index, value);\n                }\n            }\n            return value;\n        },\n\n        _set: function(ref, name, value) {\n            var topLeft = this._grid.normalize(ref.topLeft);\n            var bottomRight = this._grid.normalize(ref.bottomRight);\n            var ci, start, end;\n\n            if (typeof value == \"number\") {\n                // Apparently, Excel (and LibreOffice and Google\n                // Sheets) will limit precision to 14 digits; type:\n                // -4.2524999999999995 and you get -4.2525.  The\n                // formula engine already does something similar for\n                // intermediate formula results, but we must do it\n                // here as well for original input values.\n                value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n            }\n\n            if (value && name == \"formula\") {\n                if (typeof value == \"string\") {\n                    // get Formula object.  we don't care about handling errors\n                    // here since it won't be called interactively.\n                    value = this._compileFormula(topLeft.row, topLeft.col, value);\n                }\n\n                value = this._copyValuesInRange(topLeft, bottomRight, value, \"formula\");\n\n            } else if (value && name == \"validation\") {\n                value = this._compileValidation(topLeft.row, topLeft.col, value);\n                value = this._copyValuesInRange(topLeft, bottomRight, value, \"validation\");\n\n            } else {\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    this._properties.set(name, start, end, value);\n                    if (name == \"formula\") {\n                        // removing a formula, must clear value.\n                        this._properties.set(\"value\", start, end, null);\n                    }\n                }\n            }\n        },\n\n        _get: function(ref, name) {\n            var topLeft = this._grid.normalize(ref.topLeft);\n\n            var index = this._grid.index(topLeft.row, topLeft.col);\n\n            return this._properties.get(name, index);\n        },\n\n        batch: function(callback, reason) {\n            var suspended = this.suspendChanges();\n\n            this.suspendChanges(true);\n            this._valueChanged = false;\n\n            callback.call(this);\n\n            if (!reason) {\n                reason = { recalc: true };\n            }\n            if (this._valueChanged) {\n                reason.isValue = true;\n            }\n\n            return this.suspendChanges(suspended).triggerChange(reason);\n        },\n\n        _sortBy: function(ref, columns) {\n            var indices = null;\n\n            columns.forEach(function(column) {\n                indices = this._sorter.sortBy(ref, column.index, this._properties.get(\"value\"), column.ascending, indices);\n            }, this);\n\n            this._sort = {\n                ref: ref,\n                columns: columns\n            };\n\n            this._refreshFilter();\n\n            this.forEach(ref, function(row, col, props) {\n                var formula = props.formula;\n                if (formula) {\n                    var diff = row - formula.row;\n                    if (diff !== 0) {\n                        var start = diff > 0 ? formula.row : formula.row + diff;\n                        formula.adjust(this.name(), \"row\", start, diff);\n                    }\n                }\n            }.bind(this));\n\n            this.triggerChange({ recalc: true });\n        },\n\n        _refreshFilter: function() {\n            if (this._filter) {\n                this._filterBy(this._filter.ref, this._filter.columns);\n            }\n        },\n\n        _filterBy: function(ref, columns) {\n            this.batch(function() {\n                for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                    if (this.isFilteredRow(ri)) {\n                        this._filteredRows.value(ri, ri, false);\n                        this._rows.unhide(ri);\n                    }\n                }\n\n                columns.forEach(function(column) {\n                    // do not filter header row\n                    var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n\n                    var cells = [];\n\n                    if (columnRef === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n\n                    this.forEach(columnRef, function(row, col, cell) {\n                        cell.row = row;\n                        cells.push(cell);\n                    });\n\n                    column.filter.prepare(cells);\n\n                    for (var ci = 0; ci < cells.length; ci++) {\n                        var cell = cells[ci];\n                        var value = column.filter.value(cell);\n\n                        if (column.filter.matches(value) === false) {\n                            this._filterRow(cell.row);\n                        }\n                    }\n                }, this);\n\n                this._filter = {\n                    ref: ref,\n                    columns: columns\n                };\n            }, { recalc: true, layout: true, filter: true });\n        },\n\n        filterColumn: function(ref) {\n            var filterRef = this.filter().ref;\n            return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n        },\n\n        filter: function() {\n            return this._filter;\n        },\n\n        clearFilter: function(spec) {\n            this._clearFilter(spec instanceof Array ? spec : [spec]);\n        },\n\n        _clearFilter: function(indices) {\n            if (this._filter) {\n                this.batch(function() {\n                    this._filter.columns = this._filter.columns.filter(function(column) {\n                        return indices.indexOf(column.index) < 0;\n                    });\n\n                    this._refreshFilter();\n                }, { recalc: true, layout: true, filter: true });\n            }\n        },\n\n        getAxisState: function() {\n            return {\n                rows: this._rows.getState(),\n                columns: this._columns.getState()\n            };\n        },\n\n        setAxisState: function(state) {\n            this._rows.setState(state.rows);\n            this._columns.setState(state.columns);\n            this.triggerChange({ layout: true });\n        },\n\n        getState: function() {\n            return {\n                rows: this._rows.getState(),\n                columns: this._columns.getState(),\n                mergedCells: this._mergedCells.map(function(cell) { return cell.clone(); }),\n                properties: this._properties.getState()\n            };\n        },\n\n        setState: function(state) {\n            this._rows.setState(state.rows);\n            this._columns.setState(state.columns);\n            this._mergedCells = state.mergedCells;\n            this._properties.setState(state.properties);\n            this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n        },\n\n        _merge: function(ref) {\n            var mergedCells = this._mergedCells;\n\n            var sheet = this;\n            var mergedRef;\n            this.batch(function() {\n                mergedRef = ref.map(function(ref) {\n                    if (ref instanceof kendo.spreadsheet.CellRef) {\n                        return ref;\n                    }\n\n                    var currentRef = ref.toRangeRef().union(mergedCells, function(ref) {\n                        mergedCells.splice(mergedCells.indexOf(ref), 1);\n                    });\n\n                    var range = new Range(currentRef, sheet);\n                    var formula = range._get(\"formula\");\n                    var value = range.value();\n                    var format = range.format();\n                    var background = range.background();\n\n                    range.value(null);\n                    range.format(null);\n                    range.background(null);\n\n                    var topLeft = new Range(currentRef.collapse(), sheet);\n\n                    if (formula) {\n                        topLeft._set(\"formula\", formula);\n                    } else {\n                        topLeft.value(value);\n                    }\n                    topLeft.format(format);\n                    topLeft.background(background);\n\n                    mergedCells.push(currentRef);\n                    return currentRef;\n                });\n\n                var viewSelection = sheet._viewSelection;\n\n                viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n            }, { activeCell: true, selection: true });\n\n            return mergedRef;\n        },\n\n        _useCultureDecimals: function() {\n            return this._workbook && this._workbook.options.useCultureDecimals;\n        },\n\n        withCultureDecimals: function(f) {\n            var dot = \".\";\n            if (this._useCultureDecimals()) {\n                dot = kendo.culture().numberFormat[\".\"];\n            }\n            return kendo.spreadsheet.calc.withDecimalSeparator(dot, f);\n        },\n\n        drawingBoundingBox: function(drawing) {\n            var left = drawing.offsetX;\n            var top = drawing.offsetY;\n            if (drawing.topLeftCell) {\n                // offsets are relative to cell\n                left += this._columns.sum(0, drawing.topLeftCell.col - 1);\n                top += this._rows.sum(0, drawing.topLeftCell.row - 1);\n            }\n            return new kendo.spreadsheet.Rectangle(left, top, drawing.width, drawing.height);\n        },\n\n        refBoundingBox: function(ref) {\n            return this._grid.rectangle(ref.toRangeRef());\n        },\n\n        addDrawing: function(drw, activate) {\n            if (!(drw instanceof Drawing)) {\n                drw = new Drawing(drw);\n            }\n            this._drawings.push(drw);\n            if (activate) {\n                this._activeDrawing = drw;\n            }\n            this.triggerChange({ layout: true });\n            return drw;\n        },\n\n        removeDrawing: function(drawing) {\n            var pos = this._drawings.indexOf(drawing);\n            if (pos >= 0) {\n                this._drawings.splice(pos, 1);\n                this.triggerChange({ layout: true });\n            }\n        },\n\n        usesImage: function(img) {\n            for (var i = this._drawings.length; --i >= 0;) {\n                if (this._drawings[i].image === img) {\n                    return true;\n                }\n            }\n            return false;\n        },\n\n        isMerged: function(ref) {\n            var merged = this._mergedCells;\n            for (var i = merged.length; --i >= 0;) {\n                if (merged[i].eq(ref)) {\n                    return true;\n                }\n            }\n            return false;\n        }\n    });\n\n    var Drawing = kendo.Class.extend({\n        init: function Drawing(args) {\n            this.reset(args);\n        },\n\n        toJSON: function() {\n            return {\n                topLeftCell: this.topLeftCell.toString(),\n                offsetX: this.offsetX,\n                offsetY: this.offsetY,\n                width: this.width,\n                height: this.height,\n                image: this.image,\n                opacity: this.opacity\n            };\n        },\n\n        clone: function() {\n            return new Drawing(this);\n        },\n\n        reset: function(dr) {\n            var anchor = dr.topLeftCell;\n            if (typeof anchor == \"string\") {\n                anchor = kendo.spreadsheet.calc.parseReference(anchor);\n            }\n            this.topLeftCell = anchor;\n            this.offsetX = dr.offsetX || 0;\n            this.offsetY = dr.offsetY || 0;\n            this.width = dr.width;\n            this.height = dr.height;\n            this.image = dr.image;\n            this.opacity = dr.opacity != null ? dr.opacity : 1;\n        },\n\n        eq: function(dr) {\n            return ((!this.topLeftCell && !dr.topLeftCell)\n                    || (this.topLeftCell && dr.topLeftCell\n                        && this.topLeftCell.eq(dr.topLeftCell)))\n                && this.offsetX === dr.offsetX\n                && this.offsetY === dr.offsetY\n                && this.width === dr.width\n                && this.height === dr.height\n                && this.image === dr.image\n                && this.opacity === dr.opacity;\n        }\n    });\n\n    Drawing.fromJSON = function(args) {\n        return new Drawing(args);\n    };\n\n    kendo.spreadsheet.Sheet = Sheet;\n    kendo.spreadsheet.Drawing = Drawing;\n})(kendo);\n\n(function(kendo) {\n\n        var $ = kendo.jQuery;\n        var outerWidth = kendo._outerWidth;\n        var DOT = \".\";\n        var EMPTYCHAR = \" \";\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: \"k-widget k-header\",\n            sheetsBarSheetsWrapper: \"k-tabstrip k-floatwrap k-tabstrip-bottom\",\n            sheetsBarActive: \"k-spreadsheet-sheets-bar-active\",\n            sheetsBarInactive: \"k-spreadsheet-sheets-bar-inactive\",\n            sheetsBarAdd: \"k-spreadsheet-sheets-bar-add\",\n            sheetsBarRemove: \"k-spreadsheet-sheets-remove\",\n            sheetsBarItems: \"k-spreadsheet-sheets-items\",\n            sheetsBarEditor: \"k-spreadsheet-sheets-editor\",\n            sheetsBarScrollable: \"k-tabstrip-scrollable\",\n            sheetsBarNext: \"k-tabstrip-next\",\n            sheetsBarPrev: \"k-tabstrip-prev\",\n            sheetsBarKItem: \"k-item k-tabstrip-item\",\n            sheetsBarKActive: \"k-active k-state-tab-on-top\",\n            sheetsBarKTextbox: \"k-textbox\",\n            sheetsBarKLink: \"k-link\",\n            sheetsBarKIcon: \"k-icon\",\n            sheetsBarKFontIcon: \"k-icon\",\n            sheetsBarKButton: \"k-button k-icon-button\",\n            sheetsBarKButtonDefaults: \"k-button-md k-rounded-md k-button-solid k-button-solid-base\",\n            sheetsBarKButtonBare: \"k-button-md k-rounded-md k-button-flat k-button-flat-base\",\n            sheetsBarArrowWIcon: \"caret-alt-left\",\n            sheetsBarArrowEIcon: \"caret-alt-right\",\n            sheetsBarKReset: \"k-reset k-tabstrip-items\",\n            sheetsBarXIcon: \"x\",\n            sheetsBarKSprite: \"k-sprite\",\n            sheetsBarPlusIcon: \"plus\",\n            sheetsBarHintWrapper: \"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint\",\n            sheetsBarKResetItems: \"k-reset k-tabstrip-items\"\n        };\n\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                var classNames = SheetsBar.classNames;\n\n                kendo.ui.Widget.call(this, element, options);\n\n                element = this.element;\n\n                element.addClass(classNames.sheetsBarWrapper);\n\n                this._openDialog = options.openDialog;\n\n                this._tree = new kendo.dom.Tree(element[0]);\n\n                this._tree.render([this._addButton(), this._createSheetsWrapper([])]);\n\n                this._toggleScrollEvents(true);\n\n                this._createSortable();\n\n                this._sortable.bind(\"start\", this._onSheetReorderStart.bind(this));\n\n                this._sortable.bind(\"end\", this._onSheetReorderEnd.bind(this));\n\n                element.on(\"click\", DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n\n                element.on(\"click\", \"li\", this._onSheetSelect.bind(this));\n\n                element.on(\"dblclick\", \"li\" + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n\n                element.on(\"click\", DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n\n            options: {\n                name: \"SheetsBar\",\n                scrollable: {\n                    distance: 200\n                }\n            },\n\n            events: [\n                \"select\",\n                \"reorder\",\n                \"rename\"\n            ],\n\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element\n                    .find(kendo.format(\"input{0}{1}\",DOT,SheetsBar.classNames.sheetsBarEditor))\n                    .trigger(\"focus\")\n                    .on(\"keydown\", this._onEditorKeydown.bind(this))\n                    .on(\"blur\", this._onEditorBlur.bind(this));\n            },\n\n            _destroyEditor: function(canceled) {\n                var newSheetName = canceled ? null : this._editor.val();\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n                this._onSheetRename(newSheetName);\n            },\n\n            renderSheets: function(sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n\n            _renderSheets: function(sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n\n                that._renderHtml(isInEditMode, true);\n\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n\n                var sheetsWrapper = that._sheetsWrapper();\n\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n\n                that._toggleScrollButtons();\n            },\n\n            _toggleScrollButtons: function (toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = kendo.scrollLeft(ul);\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n\n                if (toggle === false) {\n                    prev.addClass( 'k-disabled' );\n                    next.addClass( 'k-disabled' );\n                } else {\n                    prev.toggleClass( 'k-disabled', !(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0) );\n                    next.toggleClass( 'k-disabled', !(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1) );\n                }\n\n            },\n\n            _toggleScrollEvents: function(toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.find(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.find(DOT + classNames.sheetsBarNext);\n\n                if (toggle) {\n                    scrollPrevButton.on(\"mousedown\", function (event) {\n                        event.preventDefault();\n                        event.stopPropagation();\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n\n                    scrollNextButton.on(\"mousedown\", function (event) {\n                        event.preventDefault();\n                        event.stopPropagation();\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n\n                    scrollPrevButton.add(scrollNextButton).on(\"mouseup\", function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n\n            _renderHtml: function(isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = (idx === selectedIndex);\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR, role: \"tab\" };\n                    var elementContent = [];\n\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element(\"input\", {\n                            type: \"text\",\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element(\"span\", {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n\n                        if (sheets.length > 1) {\n                            var deleteIcon = element($(kendo.ui.icon(classNames.sheetsBarXIcon))[0]);\n\n                            elementContent.push(element(\"span\", {\n                                className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove,\n                                'data-type': 'remove'\n                            }, [deleteIcon]));\n                        }\n                    }\n\n                    sheetElements.push(element(\"li\", attr, elementContent));\n                }\n\n                this._tree.render([this._addButton(),  this._createSheetsWrapper(sheetElements, renderScrollButtons)]);\n            },\n\n            _createSheetsWrapper: function(sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var itemsWrapper = element('div', { className: 'k-tabstrip-items-wrapper k-hstack' } );\n                var childrenElements = [null, element(\"ul\", {\n                    className: classNames.sheetsBarKReset,\n                    role: \"tablist\"\n                }, sheetElements), null ];\n\n                renderScrollButtons = true;\n\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n\n                    childrenElements[0] = (element(\"span\", { ariaHidden: \"true\", className: baseButtonClass + classNames.sheetsBarPrev }, [\n                        element($(kendo.ui.icon({ icon: classNames.sheetsBarArrowWIcon, iconClass: \"k-button-icon\" }))[0])\n                    ]));\n\n                    childrenElements[2] = (element(\"span\", { ariaHidden: \"true\", className: baseButtonClass + classNames.sheetsBarNext }, [\n                        element($(kendo.ui.icon({ icon: classNames.sheetsBarArrowEIcon, iconClass: \"k-button-icon\" }))[0])\n                    ]));\n                }\n\n                itemsWrapper.children = childrenElements;\n\n                return element(\"div\", { className: classNames.sheetsBarItems }, [ itemsWrapper ]);\n            },\n\n            _createSortable: function() {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format(\"ul li.{0},ul li.{1}\", classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: \"x\",\n                    animation: false,\n                    ignore: \"input\",\n                    end: function () {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap(\"<div class='\" + classNames.sheetsBarHintWrapper + \"'><ul class='\" + classNames.sheetsBarKResetItems + \"'></ul></div>\").closest(\"div\");\n                    }\n                });\n            },\n\n            _onEditorKeydown: function(e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                    }\n\n                    if (e.which === 27) {\n                        this._destroyEditor(true);\n                    }\n                }\n            },\n\n            _onEditorBlur: function() {\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n            },\n\n            _onSheetReorderEnd: function(e) {\n                e.preventDefault();\n                this.trigger(\"reorder\", {oldIndex: e.oldIndex, newIndex: e.newIndex});\n            },\n\n            _onSheetReorderStart: function(e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n\n            _onSheetRemove: function(e) {\n                var removedSheetName = $(e.target).closest(\"li\").text();\n\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n\n                var closeCallback = function(e) {\n                    var dlg = e.sender;\n\n                    if (dlg.isConfirmed()) {\n                        this.trigger(\"remove\", { name: removedSheetName, confirmation: true });\n                    }\n                }.bind(this);\n\n                this._openDialog(\"confirmation\", {\n                    close: closeCallback\n                });\n            },\n\n            _onSheetSelect: function(e) {\n                var selectedSheetText = $(e.target).text();\n\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n\n                this._scrollSheetsToItem($(e.target).closest(\"li\"));\n\n                this.trigger(\"select\", {name: selectedSheetText, isAddButton: false});\n            },\n\n            _onSheetRename: function(newSheetName) {\n                if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                    return;\n                }\n\n                this.trigger(\"rename\", {name: newSheetName, sheetIndex: this._selectedIndex });\n            },\n\n            _onAddSelect: function() {\n                this.trigger(\"select\", {isAddButton: true});\n            },\n\n            _addButton: function() {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element(\"a\", {\n                    role: \"button\",\n                    'aria-label': \"Add new sheet\",\n                    className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonDefaults\n                }, [element($(kendo.ui.icon({ icon: classNames.sheetsBarPlusIcon, iconClass: \"k-button-icon\" }))[0])]);\n            },\n\n            destroy: function() {\n                this._sortable.destroy();\n            },\n\n            _scrollableAllowed: function() {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = kendo.scrollLeft(sheetsGroup);\n                var itemWidth = outerWidth(item);\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var itemPosition;\n\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset);\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset;\n                    }\n                }\n\n                sheetsGroup.finish().animate({ \"scrollLeft\": itemPosition }, \"fast\", \"linear\", function () {\n                    that._toggleScrollButtons();\n                });\n            },\n\n            _sheetsGroup: function() {\n                return this._sheetsWrapper().find(\"ul\");\n            },\n\n            _sheetsWrapper: function() {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = kendo.scrollLeft(sheetsGroup);\n\n                sheetsGroup.finish().animate({ \"scrollLeft\": scrLeft + delta }, \"fast\", \"linear\", function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    })(window.kendo);\n\n// -*- fill-column: 100 -*-\n    \"use strict\";\n\n    // WARNING: removing the following jshint declaration and turning\n    // == into === to make JSHint happy will break functionality.\n\n    var util$2 = kendo.util;\n    var spreadsheet$5 = kendo.spreadsheet;\n    var Ref$2 = spreadsheet$5.Ref;\n    var RangeRef$2 = spreadsheet$5.RangeRef;\n    var CellRef$3 = spreadsheet$5.CellRef;\n    var NameRef$2 = spreadsheet$5.NameRef;\n    var exports = spreadsheet$5.calc;\n    var runtime$4 = exports.runtime;\n\n    // Excel formula parser and compiler to JS.\n    // some code adapted from http://lisperator.net/pltut/\n\n    // these two will hold the same operators, except that when the comma is used as decimal\n    // separator, the union operator must be the semicolon (;) instead of comma.\n    var OPERATORS_STANDARD = Object.create(null);\n    var OPERATORS_COMMA = Object.create(null);\n\n    (function(ops){\n        ops.forEach(function(cls, i){\n            cls.forEach(function(op){\n                OPERATORS_STANDARD[op] = ops.length - i;\n                OPERATORS_COMMA[op == \",\" ? \";\" : op] = ops.length - i;\n            });\n        });\n    })([\n        [ \":\" ],\n        [ \" \" ],\n        [ \",\" ],\n        [ \"%\" ],\n        [ \"^\" ],\n        [ \"*\", \"/\" ],\n        [ \"+\", \"-\" ],\n        [ \"&\" ],\n        [ \"=\", \"<\", \">\", \"<=\", \">=\", \"<>\" ]\n    ]);\n\n    var OPERATORS = OPERATORS_STANDARD;\n\n    var SEPARATORS = {\n        DEC: \".\",\n        ARG: \",\",\n        COL: \",\"\n    };\n\n    function setDecimalSeparator(sep) {\n        SEPARATORS.DEC = sep;\n        SEPARATORS.ARG = sep == \",\" ? \";\" : \",\";\n        SEPARATORS.COL = sep == \",\" ? \"\\\\\" : \",\";\n        OPERATORS = sep == \",\" ? OPERATORS_COMMA : OPERATORS_STANDARD;\n    }\n\n    exports.withDecimalSeparator = function(sep, f) {\n        if (SEPARATORS.DEC == sep) {\n            return f();\n        }\n        var save = SEPARATORS.DEC;\n        setDecimalSeparator(sep);\n        try {\n            return f();\n        } finally {\n            setDecimalSeparator(save);\n        }\n    };\n\n    exports._separators = SEPARATORS;\n\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function() {\n            return this.message;\n        }\n    });\n\n    var TRUE = { type: \"bool\", value: true };\n    var FALSE = { type: \"bool\", value: false };\n\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n\n    function parseReference$1(name, noThrow) {\n        if (name.toLowerCase() == \"#sheet\") {\n            return spreadsheet$5.SHEETREF;\n        }\n        OUT: {\n            // this is redundant, but let's keep it fast for the most\n            // common case  A1.  If this fails, we'll try to employ the\n            // whole tokenizer.\n            var m;\n            if ((m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name))) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row < 0x100000 && col < 0x4000) {\n                    return new CellRef$3(getrow(m[4]), getcol(m[2]));\n                }\n                // no NameRef-s from this function\n                break OUT;\n            }\n            var stream = TokenStream$1(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef$3) {\n                    // this function always makes absolute references\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef$2) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is(\"op\", SEPARATORS.ARG)) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet$5.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error(\"Cannot parse reference: \" + name);\n        }\n    }\n\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream$1(input, { row: row, col: col });\n        var is = input.is;\n\n        return {\n            type: \"exp\",\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n\n        function skip(type, value, allowEOF) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak(\"Expected \" + type + \" \" + value + \" but found \" + tok.type + \" \" + tok.value + \"\");\n                } else if (!allowEOF) {\n                    input.croak(\"Expected \" + type + \" \" + value + \"\");\n                }\n            }\n        }\n\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom()), 0, commas);\n        }\n\n        function parseSymbol(tok) {\n            if (tok.upper == \"TRUE\" || tok.upper == \"FALSE\") {\n                return tok.upper == \"TRUE\" ? TRUE : FALSE;\n            }\n            return addReference(new NameRef$2(tok.value));\n        }\n\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip(\"punc\", \"(\");\n            var args = [];\n            while (1) {\n                if (is(\"punc\", \")\")) {\n                    break;\n                }\n                if (is(\"op\", SEPARATORS.ARG)) {\n                    args.push({ type: \"null\" });\n                    input.next();\n                    continue;\n                }\n                args.push(parseExpression(false));\n                if (input.eof() || is(\"punc\", \")\")) {\n                    break;\n                }\n                skip(\"op\", SEPARATORS.ARG);\n            }\n            skip(\"punc\", \")\", true);\n            return {\n                type: \"func\",\n                func: fname,\n                args: args\n            };\n        }\n\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n\n        function parseAtom() {\n            var exp;\n            if (is(\"ref\")) {\n                exp = fixReference(input.next());\n            }\n            else if (is(\"func\")) {\n                exp = parseFuncall();\n            }\n            else if (is(\"punc\", \"(\")) {\n                input.next();\n                exp = parseExpression(true);\n                skip(\"punc\", \")\", true);\n            }\n            else if (is(\"punc\", \"{\")) {\n                input.next();\n                exp = parseArray();\n                skip(\"punc\", \"}\", true);\n            }\n            else if (is(\"num\") || is(\"str\") || is(\"error\")) {\n                exp = input.next();\n            }\n            else if (is(\"sym\")) {\n                exp = parseSymbol(input.next());\n            }\n            else if (is(\"op\", \"+\") || is(\"op\", \"-\")) {\n                exp = {\n                    type: \"prefix\",\n                    op: input.next().value,\n                    exp: parseAtom()\n                };\n            }\n            else if (!input.peek()) {\n                input.croak(\"Incomplete expression\");\n            }\n            else if (is(\"punc\", \"[\")) {\n                input.croak(\"External reference not supported\");\n            }\n            else {\n                input.croak(\"Parse error\");\n            }\n            return maybePercent(exp);\n        }\n\n        function parseArray() {\n            var row = [], value = [ row ], first = true;\n            while (!input.eof() && !is(\"punc\", \"}\")) {\n                if (first) {\n                    first = false;\n                } else if (is(null, \";\")) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip(null, SEPARATORS.COL);\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: \"matrix\",\n                value: value\n            };\n        }\n\n        function maybeIntersect(exp) {\n            if (is(\"punc\", \"(\") || is(\"ref\") || is(\"num\") || is(\"func\")) {\n                return {\n                    type: \"binary\",\n                    op: \" \",\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n\n        function maybePercent(exp) {\n            if (is(\"op\", \"%\")) {\n                input.next();\n                return maybePercent({\n                    type: \"postfix\",\n                    op: \"%\",\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is(\"op\");\n            if (tok && (commas || tok.value != SEPARATORS.ARG)) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(), his_prec, commas);\n                    return maybeBinary({\n                        type: \"binary\",\n                        op: tok.value == \";\" ? \",\" : tok.value, // translate union back to comma\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n\n    function parseNameDefinition(name, def) {\n        var nameRef = parseFormula(null, 0, 0, name);\n        if (!(nameRef.ast instanceof NameRef$2)) {\n            throw new ParseError(\"Invalid name: \" + name);\n        }\n        nameRef = nameRef.ast;\n\n        if (!(def instanceof Ref$2)) {\n            var defAST = parseFormula(nameRef.sheet, 0, 0, def);\n            if (defAST.ast instanceof Ref$2) {\n                def = defAST.ast;   // single reference\n            } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n                def = defAST.ast.value; // constant\n            } else {\n                def = makeFormula(defAST); // formula\n            }\n        }\n\n        return {\n            name: nameRef,\n            value: def\n        };\n    }\n\n    var makeClosure = (function(cache){\n        return function(code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function(\"'use strict';return(\" + code + \")\")();\n            }\n            return f;\n        };\n    })(Object.create(null));\n\n    function makePrinter(exp) {\n        return makeClosure(\"function(row, col, mod){return(\" + print(exp.ast, exp, 0) + \")}\");\n        function print(node, parent, prec) {\n            switch (node.type) {\n              case \"num\":\n                return \"(kendo.spreadsheet.calc._separators.DEC == '.' ? \"\n                    +  JSON.stringify(JSON.stringify(node.value)) + \" : \"\n                    +  JSON.stringify(JSON.stringify(node.value))\n                    +  \".replace('.' , kendo.spreadsheet.calc._separators.DEC))\";\n              case \"bool\":\n                return JSON.stringify(node.value);\n              case \"error\":\n                return JSON.stringify(\"#\" + node.value);\n              case \"str\":\n                return JSON.stringify(JSON.stringify(node.value));\n              case \"ref\":\n                return \"this.refs[\" + node.index + \"].print(row, col, mod)\";\n              case \"prefix\":\n                return withParens(function(){\n                    return JSON.stringify(node.op) + \" + \" + print(node.exp, node, OPERATORS[node.op]);\n                });\n              case \"postfix\":\n                return withParens(function(){\n                    return print(node.exp, node, OPERATORS[node.op]) + \" + \" + JSON.stringify(node.op);\n                });\n              case \"binary\":\n                return withParens(function(){\n                    var left = parenthesize(\n                        print(node.left, node, OPERATORS[node.op]),\n                        node.left instanceof NameRef$2 && node.op == \":\"\n                    );\n                    var right = parenthesize(\n                        print(node.right, node, OPERATORS[node.op]),\n                        node.right instanceof NameRef$2 && node.op == \":\"\n                    );\n                    if (/^[,;]/.test(node.op)) {\n                        return left + \" + kendo.spreadsheet.calc._separators.ARG + \" + right;\n                    } else {\n                        return left + \" + \" + JSON.stringify(node.op) + \" + \" + right;\n                    }\n                });\n              case \"func\":\n                return JSON.stringify(node.func + \"(\") + \" + \"\n                    + (node.args.length > 0\n                       ? node.args.map(function(arg){\n                           return print(arg, node, 0);\n                       }).join(\" + kendo.spreadsheet.calc._separators.ARG + ' ' + \")\n                       : \"''\")\n                    + \" + ')'\";\n              case \"matrix\":\n                return \"'{ ' + \" + node.value.map(function(el){\n                    return el.map(function(el){\n                        return print(el, node, 0);\n                    }).join(\" + kendo.spreadsheet.calc._separators.COL + ' ' + \");\n                }).join(\" + '; ' + \") + \"+ ' }'\";\n              case \"null\":\n                return \"''\";\n            }\n            throw new Error(\"Cannot make printer for node \" + node.type);\n\n            function withParens(f) {\n                var op = node.op;\n                var needParens = (OPERATORS[op] < prec\n                                  || (!prec && op == \",\")\n                                  || (parent.type == \"prefix\" && prec == OPERATORS[op] && parent.op == \"-\")\n                                  || (parent.type == \"binary\" && prec == OPERATORS[op] && node === parent.right));\n                return parenthesize(f(), needParens);\n            }\n        }\n        function parenthesize(code, cond) {\n            return cond ? \"'(' + \" + code + \" + ')'\" : code;\n        }\n    }\n\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n\n        function cps(node, k){\n            switch (node.type) {\n              case \"ref\"     : return cpsRef(node, k);\n              case \"num\"     :\n              case \"str\"     :\n              case \"null\"    :\n              case \"error\"   :\n              case \"bool\"    : return cpsAtom(node, k);\n              case \"prefix\"  :\n              case \"postfix\" : return cpsUnary(node, k);\n              case \"binary\"  : return cpsBinary(node, k);\n              case \"func\"    : return cpsFunc(node, k);\n              case \"lambda\"  : return cpsLambda(node, k);\n              case \"matrix\"  : return cpsMatrix(node.value, k, true);\n            }\n            throw new Error(\"Cannot CPS \" + node.type);\n        }\n\n        function cpsRef(node, k) {\n            return node.ref == \"name\" ? cpsNameRef(node, k) : cpsAtom(node, k);\n        }\n\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n\n        function cpsNameRef(node, k) {\n            return {\n                type: \"func\",\n                func: \",getname\",\n                args: [ makeContinuation(k), node ]\n            };\n        }\n\n        function cpsUnary(node, k) {\n            return cps({\n                type: \"func\",\n                func: \"unary\" + node.op,\n                args: [ node.exp ]\n            }, k);\n        }\n\n        function cpsBinary(node, k) {\n            return cps({\n                type: \"func\",\n                func: \"binary\" + node.op,\n                args: [ node.left, node.right ]\n            }, k);\n        }\n\n        function cpsIf(co, th, el, k) {\n            return cps(co, function(co){\n                // compile THEN and ELSE into a lambda which takes a callback to invoke with the\n                // result of the branches, and the IF itself will become a call the internal \"if\"\n                // function.\n                var rest = makeContinuation(k);\n                var thenK = gensym(\"T\");\n                var elseK = gensym(\"E\");\n                return {\n                    type: \"func\",\n                    func: \"if\",\n                    args: [\n                        rest,\n                        co, // condition\n                        { // then\n                            type: \"lambda\",\n                            vars: [ thenK ],\n                            body: cps(th || TRUE, function(th){\n                                return {\n                                    type: \"call\",\n                                    func: { type: \"var\", name: thenK },\n                                    args: [ th ]\n                                };\n                            })\n                        },\n                        { // else\n                            type: \"lambda\",\n                            vars: [ elseK ],\n                            body: cps(el || FALSE, function(el){\n                                return {\n                                    type: \"call\",\n                                    func: { type: \"var\", name: elseK },\n                                    args: [ el ]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: \"func\",\n                func: \"IF\",\n                args: [\n                    // first item\n                    args[0],\n                    // if true, apply AND for the rest\n                    {\n                        type: \"func\",\n                        func: \"AND\",\n                        args: args.slice(1)\n                    },\n                    // otherwise return false\n                    FALSE\n                ]\n            }, k);\n        }\n\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: \"func\",\n                func: \"IF\",\n                args: [\n                    // first item\n                    args[0],\n                    // if true, return true\n                    TRUE,\n                    // otherwise apply OR for the rest\n                    {\n                        type: \"func\",\n                        func: \"OR\",\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n              case \"if\":\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n              case \"and\":\n                return cpsAnd(node.args, k);\n              case \"or\":\n                return cpsOr(node.args, k);\n              case \"true\":\n                return k(TRUE);\n              case \"false\":\n                return k(FALSE);\n            }\n            // actual function\n            return (function loop(args, i){\n                if (i == node.args.length) {\n                    return {\n                        type : \"func\",\n                        func : node.func,\n                        args : args\n                    };\n                }\n                else {\n                    return cps(node.args[i], function(value){\n                        return loop(args.concat([ value ]), i + 1);\n                    });\n                }\n            })([ makeContinuation(k) ], 0);\n        }\n\n        function cpsLambda(node, k) {\n            var cont = gensym(\"K\");\n            var body = cps(node.body, function(body){\n                return { type: \"call\",\n                         func: { type: \"var\", value: cont },\n                         args: [ body ] };\n            });\n            return k({ type: \"lambda\",\n                       vars: [ cont ].concat(node.vars),\n                       body: body });\n        }\n\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return (function loop(i){\n                if (i == elements.length) {\n                    return k({\n                        type: \"matrix\",\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function(val){\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            })(0);\n        }\n\n        function makeContinuation(k) {\n            var cont = gensym(\"R\");\n            return {\n                type : \"lambda\",\n                vars : [ cont ],\n                body : k({ type: \"var\", name: cont })\n            };\n        }\n\n        function gensym(name) {\n            if (!name) {\n                name = \"\";\n            }\n            name = \"_\" + name;\n            return name + (++GENSYM);\n        }\n    }\n\n    var FORMULA_CACHE = Object.create(null);\n\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp); // needs .refs\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            // we need to clone because formulas cache the result; even if the formula is the same,\n            // its value will depend on its location, hence we need different objects.  Still, using\n            // this cache is a good idea because we'll reuse the same refs array, handler and\n            // printer instead of allocating new ones (and we skip compiling it).\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function(ret){\n            return {\n                type: \"return\",\n                value: ret\n            };\n        }));\n\n        code = [\n            \"function(){\",\n            \"var context = this, refs = context.formula.absrefs\",\n            code,\n            \"}\"\n        ].join(\";\\n\");\n\n        formula = new runtime$4.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula.clone(exp.sheet, exp.row, exp.col);\n        return formula;\n\n        function js(node){\n            var type = node.type;\n            if (type == \"num\") {\n                return node.value + \"\";\n            }\n            else if (type == \"str\") {\n                return JSON.stringify(node.value);\n            }\n            else if (type == \"error\") {\n                return \"context.error(\" + JSON.stringify(node.value) + \")\";\n            }\n            else if (type == \"return\") {\n                return \"context.resolve(\" + js(node.value) + \")\";\n            }\n            else if (type == \"func\") {\n                return \"context.func(\" + JSON.stringify(node.func) + \", \"\n                    + js(node.args[0]) + \", \" // the callback\n                    + jsArray(node.args.slice(1)) // the arguments\n                    + \")\";\n            }\n            else if (type == \"call\") {\n                return js(node.func) + \"(\" + node.args.map(js).join(\", \") + \")\";\n            }\n            else if (type == \"ref\") {\n                return \"refs[\" + node.index + \"]\";\n            }\n            else if (type == \"bool\") {\n                return \"\" + node.value;\n            }\n            else if (type == \"if\") {\n                return \"(context.bool(\" + js(node.co) + \") ? \" + js(node.th) + \" : \" + js(node.el) + \")\";\n            }\n            else if (type == \"lambda\") {\n                return \"(function(\"\n                    + node.vars.join(\", \")\n                    + \"){ return(\" + js(node.body) + \") })\";\n            }\n            else if (type == \"var\") {\n                return node.name;\n            }\n            else if (type == \"matrix\") {\n                return jsArray(node.value);\n            }\n            else if (type == \"null\") {\n                return \"null\";\n            }\n            else {\n                throw new Error(\"Cannot compile expression \" + type);\n            }\n        }\n\n        function jsArray(a) {\n            return \"[ \" + a.map(js).join(\", \") + \" ]\";\n        }\n    }\n\n    function identity(x) {\n        return x;\n    }\n\n    function TokenStream$1(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null\n            ? function(cell) {\n                if (cell.rel & 1) {\n                    cell.col -= options.col;\n                }\n                if (cell.rel & 2) {\n                    cell.row -= options.row;\n                }\n                return cell;\n            }\n            : identity;\n\n        var addPos = options.forEditor\n            ? function(thing, startToken, endToken) {\n                thing.begin = startToken.begin;\n                thing.end = endToken.end;\n                return thing;\n            }\n            : identity;\n\n        return {\n            peek  : peek,\n            next  : next,\n            croak : input.croak,\n            eof   : input.eof,\n            is    : is\n        };\n\n        function is(type, value) {\n            var tok = peek();\n            return tok != null\n                && (type == null || tok.type === type)\n                && (value == null || tok.value === value)\n                ? tok : null;\n        }\n\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == \"sym\" || t.type == \"rc\" || t.type == \"num\") {\n                    ret =  ahead(8, refRange3D)\n                        || ahead(6, refCell3D)\n                        || ahead(6, refSheetRange)\n                        || ahead(4, refSheetCell)\n                        || ahead(4, refRange)\n                        || ahead(2, refCell)\n                        || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n\n        function toCell(tok, isFirst) {\n            if (tok.type == \"rc\") {\n                // RC notation is read properly without knowing where\n                // we are, so no need to fixCell on this one.\n                // However, if only absolute refs were asked for (from\n                // i.e. parseReference) I feel it's alright to yell\n                // about it here.\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak(\"Cannot read relative cell in RC notation\");\n                }\n                return new CellRef$3(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == \"num\") {\n                if (tok.value <= 1048577) {\n                    // whole row\n                    return fixCell(new CellRef$3(\n                        getrow(tok.value),\n                        isFirst ? -Infinity : +Infinity,\n                        2\n                    ));\n                } else {\n                    return null;\n                }\n            }\n            // otherwise it's \"sym\".  The OOXML spec (SpreadsheetML\n            // 18.2.5) defines the maximum value to be interpreted as\n            // a cell reference to be XFD1048576.\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef$3(\n                        getrow(m[4]),\n                        getcol(m[2]),\n                        (m[1] ? 0 : 1) | (m[3] ? 0 : 2)\n                    ));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == \"$\";\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef$3(\n                        getrow(name),\n                        isFirst ? -Infinity : +Infinity,\n                        (abs ? 0 : 2)\n                    ));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef$3(\n                        isFirst ? -Infinity : +Infinity,\n                        getcol(name),\n                        (abs ? 0 : 1)\n                    ));\n                }\n            }\n        }\n\n        // Sheet1(a) :(b) Sheet2(c) !(d) A1(e) :(f) C3(g) not followed by paren (h)\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == \"sym\" &&\n                b.type == \"op\" && b.value == \":\" &&\n                c.type == \"sym\" &&\n                d.type == \"punc\" && d.value == \"!\" &&\n                (e.type == \"sym\" || e.type == \"rc\" || (e.type == \"num\" && e.value == e.value|0)) &&\n                f.type == \"op\" && f.value == \":\" &&\n                (g.type == \"sym\" || g.type == \"rc\" || (g.type == \"num\" && g.value == g.value|0)) &&\n                g.type == e.type &&\n                !(h.type == \"punc\" && h.value == \"(\" && !g.space))\n            {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    // skip them except the last one, we only wanted to\n                    // ensure it's not paren.\n                    skip(7);\n                    return addPos(new RangeRef$2(\n                        tl.setSheet(a.value, true),\n                        br.setSheet(c.value, true)\n                    ).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n\n        // Sheet1(a) :(b) Sheet2(c) !(d) A1(e) not followed by paren (f)\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == \"sym\" &&\n                b.type == \"op\" && b.value == \":\" &&\n                c.type == \"sym\" &&\n                d.type == \"punc\" && d.value == \"!\" &&\n                (e.type == \"sym\" || e.type == \"rc\" || (e.type == \"num\" && e.value == e.value|0)) &&\n                !(f.type == \"punc\" && f.value == \"(\" && !e.space))\n            {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef$2(\n                        tl.setSheet(a.value, true),\n                        br.setSheet(c.value, true)\n                    ).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n\n        // Sheet1(a) !(b) A1(c) :(d) C3(e) not followed by paren (f)\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == \"sym\" &&\n                b.type == \"punc\" && b.value == \"!\" &&\n                (c.type == \"sym\" || c.type == \"rc\" || (c.type == \"num\" && c.value == c.value|0)) &&\n                d.type == \"op\" && d.value == \":\" &&\n                (e.type == \"sym\" || e.type == \"rc\" || (e.type == \"num\" && e.value == e.value|0)) &&\n                !(f.type == \"punc\" && f.value == \"(\" && !e.space))\n            {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef$2(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n\n        // Sheet1(a) !(b) A1(c) not followed by paren (d)\n        function refSheetCell(a, b, c, d) {\n            if (a.type == \"sym\" &&\n                b.type == \"punc\" && b.value == \"!\" &&\n                (c.type == \"sym\" || c.type == \"rc\" || (c.type == \"num\" && c.value == c.value|0)) &&\n                !(d.type == \"punc\" && d.value == \"(\" && !c.space))\n            {\n                skip(3);\n                var x = toCell(c);\n                if (!x || !isFinite(x.row)) {\n                    x = new NameRef$2(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n\n        // A1(a) :(b) C3(c) not followed by paren (d)\n        function refRange(a, b, c, d) {\n            if ((a.type == \"sym\" || a.type == \"rc\" || (a.type == \"num\" && a.value == a.value|0)) &&\n                (b.type == \"op\" && b.value == \":\") &&\n                (c.type == \"sym\" || c.type == \"rc\" || (c.type == \"num\" && c.value == c.value|0)) &&\n                !(d.type == \"punc\" && d.value == \"(\" && !c.space))\n            {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef$2(tl, br), a, c);\n                }\n            }\n        }\n\n        // A1(a) not followed by paren (b)\n        function refCell(a, b) {\n            if ((a.type == \"sym\" || a.type == \"rc\") && !(b.type == \"punc\" && b.value == \"(\" && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n\n        function funcall(a, b) {\n            if (a.type == \"sym\" && b.type == \"punc\" && b.value == \"(\" && !a.space) {\n                a.type = \"func\";\n                skip(1);\n                return a;       // already has position\n            }\n        }\n    }\n\n    function isWhitespace(ch) {\n        return \" \\t\\r\\n\\xa0\\u200b\".indexOf(ch) >= 0;\n    }\n\n    var EOF = { type: \"eof\" };\n\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n\n        return {\n            next  : next,\n            peek  : peek,\n            eof   : eof,\n            croak : input.croak,\n            ahead : ahead,\n            skip  : skip\n        };\n\n        function isDigit(ch) {\n            return (/[0-9]/i.test(ch));\n        }\n\n        function isIdStart(ch) {\n            return (/[a-z$_]/i.test(ch) || util$2.isUnicodeLetter(ch));\n        }\n\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == \".\";\n        }\n\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n\n        function isPunc(ch) {\n            return \"\\\\!;(){}[]\".indexOf(ch) >= 0;\n        }\n\n        function readNumber() {\n            // XXX: TODO: exponential notation\n            var has_dot = false;\n            var number = readWhile(function(ch){\n                if (ch == SEPARATORS.DEC) {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            if (number == SEPARATORS.DEC) {\n                return { type: \"punc\", value: SEPARATORS.DEC };\n            } else {\n                return { type: \"num\", value: parseFloat(number.replace(SEPARATORS.DEC, \".\")) };\n            }\n        }\n\n        function symbol(id, quote) {\n            return {\n                type  : \"sym\",\n                value : id,\n                upper : id.toUpperCase(),\n                space : isWhitespace(input.peek()),\n                quote : quote\n            };\n        }\n\n        function getRC(a, b, c) {\n            if (!a && !b && !c) {\n                return null;\n            }\n            if ((!a && !c) || (a && c)) {\n                var num = b ? parseInt(b, 10) : 0;\n                return a ? num : num - 1;\n            }\n        }\n\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[)?(-?[0-9]+)?(\\])?C(\\[)?(-?[0-9]+)?(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: \"rc\",\n                        row: row,\n                        col: col,\n                        rel: ((m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) // col\n                              |\n                              (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0) // row\n                             )\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n\n        function readString() {\n            input.next();\n            return { type: \"str\", value: input.readEscaped('\"') };\n        }\n\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped(\"'\"), true);\n        }\n\n        function readOperator() {\n            return {\n                type  : \"op\",\n                value : readWhile(function(ch, op){\n                    return (op + ch) in OPERATORS;\n                })\n            };\n        }\n\n        function readPunc() {\n            return {\n                type  : \"punc\",\n                value : input.next()\n            };\n        }\n\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == \"'\") {\n                return readSheetName();\n            }\n            if (isDigit(ch) || ch == SEPARATORS.DEC) {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if ((m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i))) {\n                input.skip(m);\n                return { type: \"error\", value: m[1] };\n            }\n            if (!options.forEditor) {\n                input.croak(\"Can't handle character with code: \" + ch.charCodeAt(0));\n            }\n            return { type: \"error\", value: input.next() };\n        }\n\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n\n        function skip(n) {\n            index += n;\n        }\n\n        function eof() {\n            return peek() == null;\n        }\n    }\n\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next        : next,\n            peek        : peek,\n            eof         : eof,\n            croak       : croak,\n            readWhile   : readWhile,\n            readEscaped : readEscaped,\n            lookingAt   : lookingAt,\n            skip        : skip,\n            forward     : forward,\n            pos         : location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == \"\\n\") {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === \"\";\n        }\n        function croak(msg) {\n            throw new ParseError(msg + \" (input: \" + input + \")\", pos);\n        }\n        function skip(ch) {\n            if (typeof ch == \"string\") {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak(\"Expected \" + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                // assuming RegExp match data\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = \"\";\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == \"\\\\\") {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = \"\";\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n\n    //// exports\n\n    var FORMAT_PARSERS = [];\n\n    var registerFormatParser = exports.registerFormatParser = function(p) {\n        FORMAT_PARSERS.push(p);\n    };\n\n    exports.parse = function(sheet, row, col, input, format) {\n        if (input instanceof Date) {\n            return { type: \"date\", value: runtime$4.dateToSerial(input) };\n        }\n        if (typeof input == \"number\") {\n            return { type: \"number\", value: input };\n        }\n        if (typeof input == \"boolean\") {\n            return { type: \"boolean\", value: input };\n        }\n        input += \"\";\n        if (/^'/.test(input)) {\n            return {\n                type: \"string\",\n                value: input.substr(1)\n            };\n        }\n        // trivial (integer) percent values; more complex formats are handled below via\n        // registerFormatParser; this case could be dropped completely.\n        if (/^-?[0-9]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: \"percent\",\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: \"string\",\n                    value: \"=\" + input\n                };\n            }\n        }\n        for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n            var result = FORMAT_PARSERS[i](input, format);\n            if (result) {\n                return result;\n            }\n        }\n        if (input.toLowerCase() == \"true\") {\n            return { type: \"boolean\", value: true };\n        }\n        if (input.toLowerCase() == \"false\") {\n            return { type: \"boolean\", value: false };\n        }\n        var date = runtime$4.parseDate(input, format);\n        if (date) {\n            return { type: \"date\", value: runtime$4.dateToSerial(date) };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            format = null;\n            if (num != Math.floor(num)) {\n                format = \"0.\" + String(num).split(\".\")[1].replace(/\\d/g, \"0\");\n            }\n            return {\n                type: \"number\",\n                value: num,\n                format: format\n            };\n        }\n        return {\n            type: \"string\",\n            value: input\n        };\n    };\n\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream$1(input, { forEditor: true, row: row, col: col });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == \"op\" && tok.value == \"=\") {\n            tok.type = \"startexp\";\n        }\n        return tokens;\n\n        function next() {\n            var tok = input.next();\n            if (tok.type == \"sym\") {\n                if (tok.upper == \"TRUE\") {\n                    tok.type = \"bool\";\n                    tok.value = true;\n                } else if (tok.upper == \"FALSE\") {\n                    tok.type = \"bool\";\n                    tok.value = false;\n                }\n            } else if (tok.type == \"ref\") {\n                tok = {\n                    type  : \"ref\",\n                    ref   : (row != null && col != null ? tok.absolute(row, col) : tok),\n                    begin : tok.begin,\n                    end   : tok.end\n                };\n            }\n            return tok;\n        }\n    }\n\n    // The `sqref` attribute in dataValidation (XLSX) will contain a space-separated list of\n    // references.  This helper is called from excel-reader.js to parse them.\n    function parseSqref(input, row, col) {\n        row = row || 0;\n        col = col || 0;\n        input = TokenStream$1(input, { row: row, col: col });\n        var refs = [];\n        while (!input.eof()) {\n            var ref = input.next();\n            if (ref.type != \"ref\") {\n                throw new ParseError(\"Expecting a reference but got: \" + JSON.stringify(ref));\n            }\n            refs.push(ref.absolute(row, col));\n        }\n        return refs;\n    }\n\n    exports.parseNameDefinition = parseNameDefinition;\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference$1;\n    exports.compile = makeFormula;\n    exports.parseSqref = parseSqref;\n\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n\n    /* -----[ a few special formats ]----- */\n\n    // various time formats\n    registerFormatParser(function(input, existingFormat){\n        var m, date = 0, format = \"\";\n        // have date part?\n        if (!existingFormat) {\n            existingFormat = kendo.culture().calendar.patterns.d;\n        }\n        if ((m = /^(\\d+)([-/.])(\\d+)\\2(\\d{2}(?:\\d{2})?)(\\s*)/.exec(input))) {\n            var mo = parseInt(m[1], 10);\n            var sep = m[2];\n            var da = parseInt(m[3], 10);\n            var yr = parseInt(m[4], 10);\n            if (yr < 30) {\n                yr += 2000;\n            } else if (yr < 100) {\n                yr += 1900;\n            }\n            var monthFirst = existingFormat ? existingFormat.indexOf(\"M\") < existingFormat.indexOf(\"d\") : true;\n            if (mo > 12 || !monthFirst) {\n                var tmp = mo;\n                mo = da;\n                da = tmp;\n                monthFirst = false;\n            }\n            if (!runtime$4.validDate(yr, mo, da)) {\n                return null;\n            }\n            date = runtime$4.packDate(yr, mo - 1, da);\n            if (date < 0) { date--; }\n            if (monthFirst) {\n                format = [\"mm\", \"dd\", \"yyyy\"].join(sep);\n            } else {\n                format = [\"dd\", \"mm\", \"yyyy\"].join(sep);\n            }\n            format += m[5];\n            input = input.substr(m[0].length); // skip the date\n        }\n        // hh:mm\n        if ((m = /^(\\d+):(\\d+)$/.exec(input))) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            return {\n                type   : \"date\",\n                format : format + \"hh:mm\",\n                value  : date + runtime$4.packTime(hh, mm, 0, 0)\n            };\n        }\n        // mm:ss.ms\n        if ((m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input))) {\n            var mm = parseInt(m[1], 10);\n            var ss = parseInt(m[2], 10);\n            var ms = parseFloat(m[3]) * 1000;\n            return {\n                type   : \"date\",\n                format : format + \"mm:ss.00\",\n                value  : date + runtime$4.packTime(0, mm, ss, ms)\n            };\n        }\n        // hh:mm:ss\n        if ((m = /^(\\d+):(\\d+):(\\d+)$/.exec(input))) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            return {\n                type   : \"date\",\n                format : format + \"hh:mm:ss\",\n                value  : date + runtime$4.packTime(hh, mm, ss, 0)\n            };\n        }\n        // hh:mm:ss.ms\n        if ((m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input))) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            var ms = parseFloat(m[4]) * 1000;\n            return {\n                type   : \"date\",\n                format : format + \"hh:mm:ss.00\",\n                value  : date + runtime$4.packTime(hh, mm, ss, ms)\n            };\n        }\n    });\n\n    // Support numeric formats with thousands separator and/or currency symbol, like `1,234,567.00`,\n    // `$1234`, `123,456.78 $` etc.  I apologize for this code.\n    registerFormatParser(function(input){\n        var m, n;\n        var culture = kendo.culture();\n        var comma = culture.numberFormat[\",\"];\n        var dot = culture.numberFormat[\".\"];\n        var currency = culture.numberFormat.currency.symbol;\n        var rxnum = getNumberRegexp(comma, dot);\n        var rxcur = new RegExp(\"^\\\\s*\\\\\" + currency + \"\\\\s*\");\n        var sign = 1;\n        var format = \"\";\n        var suffix = \"\";\n        var has_currency = false;\n        var has_percent = false;\n\n        input = InputStream(input.replace(/^\\s+|\\s+$/g, \"\"));\n\n        // has minus before currency?\n        if (input.skip(/^-\\s*/)) {\n            sign = -1;\n        }\n\n        // has currency before number?\n        if ((m = input.skip(rxcur))) {\n            has_currency = true;\n            format += '\"' + m[0] + '\"';\n        }\n\n        // has minus after currency?\n        if (input.skip(/^-\\s*/)) {\n            if (sign < 0) {\n                return null;    // not a number\n            }\n            sign = -1;\n        }\n\n        // read the number itself\n        if (!(n = input.skip(rxnum))) {\n            return null;        // not a number\n        }\n        format += \"0\";\n\n        // has currency after number?\n        if ((m = input.skip(rxcur))) {\n            if (has_currency) {\n                return null;    // either before or after, not both.\n            }\n            has_currency = true;\n            suffix = '\"' + m[0] + '\"';\n        }\n\n        // has percent after number?\n        if (!has_currency && (m = input.skip(/^\\s*%\\s*/))) {\n            has_percent = true;\n            suffix = m[0];      // no quotes this time, % is special in format\n        }\n\n        if (!input.eof()) {\n            return null;        // should anything else follow, not a number\n        }\n\n        if (n[2] || has_currency) {\n            format = format.replace(\"0\", \"#\");\n            format += \",0\";\n        }\n        if (n[3]) {\n            format += \".\" + repeat(\"0\", n[3].length - 1);\n        }\n        var value = n[0]\n            .replace(new RegExp(\"\\\\\" + comma, \"g\"), \"\")\n            .replace(new RegExp(\"\\\\\" + dot, \"g\"), \".\");\n\n        value = parseFloat(value);\n        if (has_percent) {\n            value /= 100;\n        }\n\n        format += suffix;\n        if (has_currency) {\n            format += ';-' + format;\n        }\n\n        return {\n            type: \"number\",\n            currency: has_currency,\n            format: format,\n            value: sign * value\n        };\n    });\n\n    registerFormatParser(function(input){\n        var m;\n        if ((m = /^([0-9]*)\\.([0-9]+)(\\s*%)$/.exec(input))) {\n            return {\n                type: \"number\",\n                value: parseFloat(input) / 100,\n                format: \"0.\" + repeat(\"0\", m[2].length) + m[3]\n            };\n        }\n    });\n\n    var NUMBER_FORMAT_RX = {};\n    function getNumberRegexp(comma, dot) {\n        var id = comma + dot;\n        var rx = NUMBER_FORMAT_RX[id];\n        if (!rx) {\n            rx = \"^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)\";\n            rx = rx.replace(/DOT/g, \"\\\\\" + dot).replace(/COM/g, \"\\\\\" + comma);\n            rx = new RegExp(rx);\n            NUMBER_FORMAT_RX[id] = rx;\n        }\n        return rx;\n    }\n\n    function repeat(str, len) {\n        var out = \"\";\n        while (len-- > 0) {\n            out += str;\n        }\n        return out;\n    }\n\n\"use strict\";\n\n    /* global JSZip */\n\n    // WARNING: removing the following jshint declaration and turning\n    // == into === to make JSHint happy will break functionality.\n\n\n\n    var $$1 = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n\n    var MAP_EXCEL_OPERATOR = {\n        // includes only what differs; key is Excel's operator, value\n        // is our operator.\n        greaterThanOrEqual : \"greaterThanOrEqualTo\",\n        lessThanOrEqual    : \"lessThanOrEqualTo\"\n    };\n\n    var ERROR_LOG = null;\n\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = async function(e) {\n            JSZip.loadAsync(e.target.result)\n                .then(async zip => await readWorkbook(zip, workbook, deferred));\n        };\n        reader.readAsArrayBuffer(file);\n    }\n\n    var SEL_CELL = [\"sheetData\", \"row\", \"c\"];\n    var SEL_COL = [\"cols\", \"col\"];\n    var SEL_DEFINED_NAME = [\"definedNames\", \"definedName\"];\n    var SEL_FORMULA = [\"sheetData\", \"row\", \"c\", \"f\"];\n    var SEL_MERGE = [\"mergeCells\", \"mergeCell\"];\n    var SEL_PANE = [\"sheetViews\", \"sheetView\", \"pane\"];\n    var SEL_ROW = [\"sheetData\", \"row\"];\n    var SEL_SELECTION = [\"sheetViews\", \"sheetView\", \"selection\"];\n    var SEL_SHEET = [\"sheets\", \"sheet\"];\n    var SEL_STRING = [\"sheetData\", \"row\", \"c\", \"is\"];\n    var SEL_TEXT = [\"t\"];\n    var SEL_SHARED_STRING = [\"si\"];\n    var SEL_VALUE = [\"sheetData\", \"row\", \"c\", \"v\"];\n    var SEL_VIEW = [\"bookViews\", \"workbookView\"];\n    var SEL_SHEET_VIEW = [\"sheetViews\", \"sheetView\"];\n    var SEL_HYPERLINK = [\"hyperlinks\", \"hyperlink\"];\n    var SEL_PROTECTION = [\"sheetProtection\"];\n\n    /* A validation section looks like this:\n     *\n     * <dataValidations count=\"1\">\n     *   <dataValidation type=\"list\" allowBlank=\"1\" showInputMessage=\"1\" showErrorMessage=\"1\" sqref=\"B2\">\n     *     <formula1>$E$2:$E$5</formula1>\n     *   </dataValidation>\n     * </dataValidations>\n     */\n    var SEL_VALIDATION = [\"dataValidations\", \"dataValidation\"];\n    var SEL_VALIDATION_FORMULA1 = [\"dataValidations\", \"dataValidation\", \"formula1\"];\n    var SEL_VALIDATION_FORMULA2 = [\"dataValidations\", \"dataValidation\", \"formula2\"];\n\n    /* However, when a validation formula in one sheet references\n     * cells from another sheet, Excel produces this version instead:\n     *\n     * <extLst>\n     *   <ext xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" uri=\"{CCE6A557-97BC-4b89-ADB6-D9C93CAAB3DF}\">\n     *     <x14:dataValidations xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\" count=\"1\">\n     *       <x14:dataValidation type=\"list\" allowBlank=\"1\" showInputMessage=\"1\" showErrorMessage=\"1\">\n     *         <x14:formula1>\n     *           <xm:f>Sheet2!$B$3:$B$6</xm:f>\n     *         </x14:formula1>\n     *         <xm:sqref>B1</xm:sqref>\n     *       </x14:dataValidation>\n     *     </x14:dataValidations>\n     *   </ext>\n     * </extLst>\n     *\n     * I call it the \"insane version\", because that's what it is.\n     * Barring the case that the engineers who produced this horror\n     * were on LSD, the only plausible reason for it is that Microsoft\n     * does not want third party software to be compatible with Excel\n     * (sentiment I've had over and over while working on the\n     * Spreadsheet widget).\n     */\n    // XXX: technically, the aliases `x14` and `xm` below could be\n    // different, but Excel seems to be hard-coded on these; our\n    // parser does not support proper namespaces for now anyway, so\n    // hard-coded they are.\n    var SEL_VALIDATION_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\"];\n    var SEL_VALIDATION_SQREF_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"xm:sqref\"];\n    var SEL_VALIDATION_FORMULA1_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"x14:formula1\", \"xm:f\"];\n    var SEL_VALIDATION_FORMULA2_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"x14:formula2\", \"xm:f\"];\n\n    // comment selectors (in files like comments1.xml)\n    var SEL_COMMENT = [\"commentList\", \"comment\"];\n    var SEL_AUTHOR = [\"authors\", \"author\"];\n    var SEL_COMMENT_TEXT = [\"t\"];\n\n    function xl(file) {\n        if (!/^\\//.test(file)) {\n            if (!/^xl\\//.test(file)) {\n                file = \"xl/\" + file;\n            }\n        } else {\n            file = file.substr(1);\n        }\n        return file;\n    }\n\n    async function readWorkbook(zip, workbook, progress) {\n        ERROR_LOG = workbook.excelImportErrors = [];\n\n        var strings = await readStrings(zip);\n        var relationships = await readRelationships(zip, \"_rels/workbook.xml\");\n        var theme = await readTheme(zip, relationships.byType.theme[0]);\n        var styles = await readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n\n        await parse$1(zip, \"xl/workbook.xml\", {\n            enter: function(tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs[\"r:id\"];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(relationships.bytes[file]);\n\n                    workbook.options.columnWidth = dim.columnWidth || workbook.options.columnWidth;\n                    workbook.options.rowHeight = dim.rowHeight || workbook.options.rowHeight;\n\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function(text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs[\"function\"]) || bool(attrs.vbProcedure))) {\n                    var localSheetId = attrs.localSheetId;\n                    var sheet = null;\n                    if (localSheetId != null) {\n                        sheet = items[localSheetId].options.name;\n                    }\n                    var name = attrs.name;\n                    if (name != \"_xlnm._FilterDatabase\") {\n                        if (sheet) {\n                            name = \"'\" + sheet.replace(/\\'/g, \"\\\\'\") + \"'!\" + name;\n                        }\n                        withErrorLog(sheet, null, function(){\n                            workbook.defineName(name, text, bool(attrs.hidden));\n                        }, \"reading user-defined name: \" + name);\n                    }\n                }\n            }\n        });\n\n        var loading = new $$1.Deferred();\n        loading.progress(function(args) {\n            if (progress) {\n                progress.notify(args);\n            }\n        })\n        .then(function() {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n\n            workbook.activeSheet(sheets[activeSheet]);\n\n            if (progress) {\n                progress.resolve();\n            }\n        });\n\n        loadSheets(items, workbook, loading);\n    }\n\n    function loadSheets(items, workbook, progress) {\n        var ready = (new $$1.Deferred()).resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function(entry, i) {\n                ready = ready.then(function() {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n\n                    var promise = queueSheet(sheet, entry);\n                    var args = {\n                        sheet: sheet,\n                        progress: i / (items.length - 1)\n                    };\n\n                    promise.then(function() {\n                        progress.notify(args);\n                    });\n\n                    return promise;\n                });\n            })(items[i], i);\n        }\n\n        ready.then(function() {\n            progress.resolve();\n        });\n    }\n\n    function queueSheet(sheet, ctx) {\n        var deferred = new $$1.Deferred();\n\n        setTimeout(async function() {\n            await readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n\n        return deferred;\n    }\n\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i]\n                .suspendChanges(false)\n                .triggerChange({ recalc: true });\n        }\n    }\n\n    function sheetDimensions(bytes) {\n        var ref, dim = {\n            rows: 0,\n            cols: 0\n        };\n\n        parseXML(bytes, {\n            enter: function(tag, attrs) {\n                if (tag == \"dimension\") {\n                    ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === \"sheetFormatPr\") {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW) && attrs.r) {\n                    dim.rows = Math.max(dim.rows, +attrs.r);\n                } else if (this.is(SEL_CELL) && attrs.r) {\n                    ref = parseReference(attrs.r);\n                    dim.rows = Math.max(dim.rows, ref.row + 1);\n                    dim.cols = Math.max(dim.cols, ref.col + 1);\n                }\n            }\n        });\n\n        return dim;\n    }\n\n    function toColWidth(size) {\n        // No font to compute agains, hence the magic number\n        var maximumDigitWidth = 7;\n\n        // The formula below is taken from the OOXML spec\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return fraction * maximumDigitWidth;\n    }\n\n    function toRowHeight(pts) {\n        return pts * (4 / 3);\n    }\n\n    async function readSheet(zip, file, sheet, strings, styles) {\n        var sharedFormulas = {};\n        var ref, type, value, formula, formulaRange, isArrayFormula;\n        var nCols = sheet._columns._count;\n        var prevCellRef = null;\n        var relsFile = file.replace(/worksheets\\//, \"worksheets/_rels/\");\n        var relationships = await readRelationships(zip, relsFile);\n        var formula1, formula2;\n\n        var filterRef;\n        var filterColumn;\n        var customFilterLogic;\n        var customFilterCriteria;\n        var valueFilterBlanks;\n        var valueFilterValues;\n        var filters = [];\n        var deferredStyles = [];\n\n        ERROR_LOG = sheet._workbook.excelImportErrors;\n\n        file = xl(file);\n\n        await parse$1(zip, file, {\n            enter: function(tag, attrs, closed) {\n                var tmp;\n                if (this.is(SEL_FORMULA)) {\n                    if (closed) {\n                        if (attrs.t == \"shared\" && attrs.si != null) {\n                            formula = sheet.range(sharedFormulas[attrs.si])._get(\"formula\");\n                        }\n                    }\n                }\n                else if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    ref = attrs.r;\n                    formulaRange = null;\n\n                    if (ref == null) {\n                        // apparently some tools omit the `r` for\n                        // consecutive cells in a row, so we'll figure\n                        // it out from the previous cell's reference.\n                        // XXX: this could be slightly optimized by\n                        // keeping it parsed instead of stringifying\n                        // it to parse it again later.\n                        ref = parseReference(prevCellRef);\n                        ref.col++;\n                        ref = ref.toString();\n                    }\n                    prevCellRef = ref;\n\n                    // XXX: can't find no type actually, so everything is\n                    // interpreted as string.  Additionally, cells having\n                    // a formula will contain both <f> and <v> nodes,\n                    // which makes the value take precedence because it's\n                    // the second node; hence, the hack is to keep note of\n                    // them in the `text` handler, and apply the\n                    // appropriate one in the `leave` handler below.\n                    type = attrs.t;\n\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        deferredStyles.push({ ref: ref,  sty: +styleIndex });\n                    }\n                }\n                else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                }\n                else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    var width;\n                    if (attrs.width) {\n                        width = toColWidth(parseFloat(attrs.width));\n                        if (width !== 0) {\n                            sheet._columns.values.value(start, stop, width);\n                        }\n                    }\n                    if (attrs.hidden === \"1\" || width === 0) {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                    if (attrs.style != null) {\n                        // apply style on a whole range of columns\n                        deferredStyles.unshift({\n                            ref: new kendo.spreadsheet.RangeRef(\n                                new kendo.spreadsheet.CellRef(-Infinity, start),\n                                new kendo.spreadsheet.CellRef(+Infinity, stop)\n                            ),\n                            sty: +attrs.style\n                        });\n                    }\n                }\n                else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    var height;\n                    if (attrs.ht) {\n                        height = toRowHeight(parseFloat(attrs.ht));\n                        if (height !== 0) {\n                            sheet._rows.values.value(row, row, height);\n                        }\n                    }\n                    if (attrs.hidden === \"1\" || height === 0) {\n                        sheet.hideRow(row);\n                    }\n                }\n                else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                }\n                else if (this.is(SEL_PANE)) {\n                    if (attrs.state && attrs.state.indexOf(\"frozen\") > -1) {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                }\n                else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.showGridLines(bool(attrs.showGridLines, true));\n                }\n                else if (this.is(SEL_HYPERLINK)) {\n                    var relId = attrs[\"r:id\"];\n                    var target = relationships.byId[relId];\n                    if (target) {\n                        sheet.range(attrs.ref).link(target);\n                    }\n                }\n                else if (this.is(SEL_PROTECTION)) {\n                    if (attrs.sheet) {\n                        sheet.range(kendo.spreadsheet.SHEETREF).enable(false);\n                    }\n                }\n                else if (this.is([\"autoFilter\"])) {\n                    filterRef = attrs.ref;\n                    if (closed) {\n                        addAutoFilter();\n                    }\n                }\n                else if (filterRef) {\n                    if (this.is([\"filterColumn\"])) {\n                        filterColumn = parseInt(attrs.colId, 10);\n                    }\n                    else if (this.is([\"customFilters\"])) {\n                        customFilterLogic = bool(attrs.and) ? \"and\" : \"or\";\n                        customFilterCriteria = [];\n                    }\n                    else if (this.is([\"customFilter\"])) {\n                        tmp = getCustomFilter(attrs.operator, attrs.val);\n                        if (tmp) {\n                            customFilterCriteria.push({\n                                operator: tmp.operator,\n                                value: tmp.value\n                            });\n                        }\n                    }\n                    else if (this.is([\"dynamicFilter\"])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.DynamicFilter({\n                                type: dynamicFilterType(attrs.type)\n                            })\n                        });\n                    }\n                    else if (this.is([\"top10\"])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.TopFilter({\n                                value: getFilterVal(attrs.val),\n                                type: (function(percent, top){\n                                    return percent && top ? \"topPercent\"\n                                        :  top ? \"topNumber\"\n                                        :  percent ? \"bottomPercent\"\n                                        :  \"bottomNumber\";\n                                })(bool(attrs.percent), bool(attrs.top))\n                            })\n                        });\n                    }\n                    else if (this.is([\"filters\"])) {\n                        valueFilterBlanks = bool(attrs.blank);\n                        valueFilterValues = [];\n                    }\n                    else if (this.is([\"filter\"])) {\n                        valueFilterValues.push(getFilterVal(attrs.val));\n                    }\n                }\n            },\n            leave: function(tag, attrs) {\n                if (this.is(SEL_FORMULA)) {\n                    if (!formula && attrs.t == \"shared\" && attrs.si != null) {\n                        formula = sheet.range(sharedFormulas[attrs.si])._get(\"formula\");\n                    }\n                }\n                else if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        var failed = withErrorLog(sheet, formulaRange || ref, function(){\n                            sheet.range(formulaRange || ref).formula(formula, isArrayFormula);\n                        }, \"parsing formula\");\n                        if (failed) {\n                            sheet.range(formulaRange || ref).value(formula)\n                                .background(\"#ffaaaa\");\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n\n                        if (!range._get(\"formula\")) {\n                            // Check for \"shared\" formulas before applying a value.\n                            if (!type || type == \"n\") {\n                                value = parseFloat(value);\n                            } else if (type == \"s\") {\n                                value = strings[integer(value)];\n                            } else if (type == \"b\") {\n                                value = value === \"1\";\n                            } else if (type == \"d\") {\n                                value = kendo.parseDate(value);\n                            }\n\n                            if (value != null) {\n                                range.value(value);\n                            }\n                        }\n                    }\n                } else if (this.is(SEL_VALIDATION) ||\n                           this.is(SEL_VALIDATION_INSANE)) {\n                    (function(){\n                        var refs = kendo.spreadsheet.calc.parseSqref(attrs.sqref);\n                        var type = attrs.type.toLowerCase();\n                        var operator = attrs.operator;\n                        if (/^(?:whole|decimal)$/.test(type)) {\n                            // we only support \"number\"\n                            type = \"number\";\n                        } else if (type == \"list\") {\n                            // there'll be no operator from Excel for lists\n                            operator = \"list\";\n                        }\n                        if (!operator && /^(?:number|date)$/.test(type)) {\n                            // Excel skips setting the operator for\n                            // \"between\", because why not.\n                            operator = \"between\";\n                        }\n                        refs.forEach(function(ref){\n                            withErrorLog(sheet, ref, function(){\n                                sheet.range(ref).validation({\n                                    type             : bool(attrs.showErrorMessage, true) ? \"reject\" : \"warning\",\n                                    from             : formula1,\n                                    to               : formula2,\n                                    dataType         : type,\n                                    comparerType     : MAP_EXCEL_OPERATOR[operator] || operator,\n                                    allowNulls       : bool(attrs.allowBlank),\n                                    showButton       : bool(attrs.showDropDown) || type == \"date\" || type == \"list\",\n                                    messageTemplate  : attrs.error,\n                                    titleTemplate    : attrs.errorTitle\n                                });\n                            }, \"parsing validation\");\n                        });\n                    })();\n                } else if (tag == \"cols\") {\n                    sheet._columns._refresh();\n                } else if (tag == \"sheetData\") {\n                    sheet._rows._refresh();\n                } else if (tag == \"autoFilter\") {\n                    addAutoFilter();\n                } else if (filterRef) {\n                    if (tag == \"customFilters\") {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.CustomFilter({\n                                logic: customFilterLogic,\n                                criteria: customFilterCriteria\n                            })\n                        });\n                    } else if (tag == \"filters\") {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.ValueFilter({\n                                values: valueFilterValues,\n                                blanks: valueFilterBlanks\n                            })\n                        });\n                    }\n                }\n            },\n            text: function(text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if ((attrs = this.is(SEL_FORMULA))) {\n                    formula = text;\n                    isArrayFormula = attrs.t == \"array\";\n                    if (isArrayFormula) {\n                        formulaRange = attrs.ref;\n                    } else if (attrs.t == \"shared\") {\n                        sharedFormulas[attrs.si] = ref;\n                    }\n                } else if (this.is(SEL_VALIDATION_FORMULA1) ||\n                           this.is(SEL_VALIDATION_FORMULA1_INSANE)) {\n                    formula1 = text;\n                } else if (this.is(SEL_VALIDATION_FORMULA2) ||\n                           this.is(SEL_VALIDATION_FORMULA2_INSANE)) {\n                    formula2 = text;\n                } else if (this.is(SEL_VALIDATION_SQREF_INSANE)) {\n                    // put it in <dataValidation>'s attributes where it should be\n                    this.stack[this.stack.length - 2].sqref = text;\n                }\n            }\n        });\n\n        deferredStyles.forEach(({ ref, sty }) => applyStyle(sheet, ref, styles, sty));\n\n        if (relationships.byType.comments) {\n            var commentFile = relative_file(file, relationships.byType.comments[0]);\n            await readComments(zip, commentFile, sheet);\n        }\n\n        if (relationships.byType.drawing) {\n            var drawingFile = relative_file(file, relationships.byType.drawing[0]);\n            await readDrawings(zip, drawingFile, sheet);\n        }\n\n        function addAutoFilter() {\n            sheet.range(filterRef).filter(filters);\n            filterRef = null;\n        }\n    }\n\n    function getContentType(filename) {\n        var m = /\\.([^.]+)$/.exec(filename);\n        if (m && m[1]) {\n            return {\n                jpg  : \"image/jpeg\",\n                jpeg : \"image/jpeg\",\n                png  : \"image/png\",\n                gif  : \"image/gif\",\n                wmf  : \"image/wmf\"\n            }[m[1].toLowerCase()];\n        }\n    }\n\n    function getFileName(filename) {\n        var m = /[^/]+$/.exec(filename);\n        return m && m[0];\n    }\n\n    async function readDrawings(zip, file, sheet) {\n        var sel_two_cell_anchor = [ \"xdr:twoCellAnchor\" ];\n        var sel_ext = [ \"xdr:ext\" ];\n        var sel_one_cell_anchor = [ \"xdr:oneCellAnchor\" ];\n        var sel_from = [ \"xdr:from\" ];\n        var sel_to = [ \"xdr:to\" ];\n        var sel_row = [ \"xdr:row\" ];\n        var sel_col = [ \"xdr:col\" ];\n        var sel_row_offset = [ \"xdr:rowOff\" ];\n        var sel_col_offset = [ \"xdr:colOff\" ];\n        var sel_blip = [ \"xdr:blipFill\", \"a:blip\" ];\n\n        var relsFile = file.replace(/drawings\\//, \"drawings/_rels/\");\n        var relationships = await readRelationships(zip, relsFile);\n\n        if (relationships.byType.image) {\n            let relkeys = Object.keys(relationships.byId);\n            for (let i = 0; i < relkeys.length; ++i) {\n                let id = relkeys[i];\n                let img = relative_file(file, relationships.byId[id]);\n                let type = getContentType(img);\n                if (type) {\n                    var data = await zip.file(img).async(\"arraybuffer\");\n                    var name = getFileName(img);\n                    var blob = name && !(kendo.support.browser.msie || kendo.support.browser.edge)\n                        ? new window.File([ data ], name, { type: type })\n                        : new window.Blob([ data ], { type: type });\n                    relationships.byId[id] = sheet._workbook.addImage(blob);\n                }\n            }\n        }\n\n        var cdr, ref, width, height;\n        await parse$1(zip, file, {\n            enter: function(tag, attrs) {\n                if (this.is(sel_two_cell_anchor) || this.is(sel_one_cell_anchor)) {\n                    cdr = {};\n                }\n                else if (this.is(sel_from) || this.is(sel_to)) {\n                    ref = {};\n                }\n                else if (this.is(sel_blip)) {\n                    var id = attrs[\"r:embed\"];\n                    cdr.image = relationships.byId[id];\n                }\n                else if (this.is(sel_ext)) {\n                    width = excelToPixels(parseFloat(attrs.cx));\n                    height = excelToPixels(parseFloat(attrs.cy));\n                }\n            },\n            leave: function() {\n                if (this.is(sel_from)) {\n                    cdr.topLeftCell = new kendo.spreadsheet.CellRef(ref.row, ref.col);\n                    cdr.offsetX = excelToPixels(ref.colOffset);\n                    cdr.offsetY = excelToPixels(ref.rowOffset);\n                }\n                else if (this.is(sel_to)) {\n                    cdr.brCell = new kendo.spreadsheet.CellRef(ref.row, ref.col);\n                    cdr.brX = excelToPixels(ref.colOffset);\n                    cdr.brY = excelToPixels(ref.rowOffset);\n                }\n                // Add drawing only when it is image\n                else if (this.is(sel_two_cell_anchor) && cdr.image) {\n                    var left = sheet._columns.sum(0, cdr.topLeftCell.col - 1) + cdr.offsetX;\n                    var top = sheet._rows.sum(0, cdr.topLeftCell.row - 1) + cdr.offsetY;\n                    var right = sheet._columns.sum(0, cdr.brCell.col - 1) + cdr.brX;\n                    var bottom = sheet._rows.sum(0, cdr.brCell.row - 1) + cdr.brY;\n\n                    sheet.addDrawing({\n                        topLeftCell : cdr.topLeftCell,\n                        offsetX     : cdr.offsetX,\n                        offsetY     : cdr.offsetY,\n                        width       : width != null ? width : right - left,\n                        height      : height != null ? height : bottom - top,\n                        image       : cdr.image,\n                        opacity     : 1\n                    });\n                }\n                // Add drawing only when it is image\n                else if (this.is(sel_one_cell_anchor) && cdr.image) {\n                    sheet.addDrawing({\n                        topLeftCell : cdr.topLeftCell,\n                        offsetX     : cdr.offsetX,\n                        offsetY     : cdr.offsetY,\n                        width       : width,\n                        height      : height,\n                        image       : cdr.image,\n                        opacity     : 1\n                    });\n                }\n            },\n            text: function(text) {\n                if (this.is(sel_row)) {\n                    ref.row = parseFloat(text);\n                }\n                else if (this.is(sel_col)) {\n                    ref.col = parseFloat(text);\n                }\n                else if (this.is(sel_row_offset)) {\n                    ref.rowOffset = parseFloat(text);\n                }\n                else if (this.is(sel_col_offset)) {\n                    ref.colOffset = parseFloat(text);\n                }\n            }\n        });\n    }\n\n    async function readComments(zip, file, sheet) {\n        var authors = [];\n        var author;\n        var comment;\n        await parse$1(zip, file, {\n            enter: function(tag, attrs) {\n                if (this.is(SEL_COMMENT)) {\n                    comment = {\n                        author: authors[attrs.authorId],\n                        ref: attrs.ref,\n                        text: \"\"\n                    };\n                } else if (this.is(SEL_AUTHOR)) {\n                    author = \"\";\n                }\n            },\n            leave: function() {\n                if (this.is(SEL_COMMENT)) {\n                    sheet.range(comment.ref).comment(comment.text);\n                } else if (this.is(SEL_AUTHOR)) {\n                    authors.push(author);\n                }\n            },\n            text: function(text) {\n                if (this.is(SEL_COMMENT_TEXT)) {\n                    comment.text += text;\n                } else if (this.is(SEL_AUTHOR)) {\n                    author += text;\n                }\n            }\n        });\n    }\n\n    function getCustomFilter(op, value) {\n        var ourOp = {\n            equal               : \"eq\",\n            notEqual            : \"ne\",\n            greaterThan         : \"gt\",\n            greaterThanOrEqual  : \"gte\",\n            lessThan            : \"lt\",\n            lessThanOrEqual     : \"lte\"\n        }[op];\n\n        value = getFilterVal(value);\n\n        if (ourOp && typeof value == \"number\") {\n            return { operator: ourOp, value: value };\n        }\n\n        if ((op == \"notEqual\" || !op) && typeof value == \"string\") {\n            // Excel text operators support * and ? wildcards.  Since\n            // our startswith/endswith/contains filters do not, we\n            // can't really use them here, so we'll apply the more\n            // generic \"matches\" and \"doesnotmatch\" filters.\n            return {\n                operator: op ? \"doesnotmatch\" : \"matches\",\n                value: value\n            };\n        }\n    }\n\n    function dynamicFilterType(type) {\n        return {\n            Q1  : \"quarter1\",\n            Q2  : \"quarter2\",\n            Q3  : \"quarter3\",\n            Q4  : \"quarter4\",\n            M1  : \"january\",\n            M2  : \"february\",\n            M3  : \"march\",\n            M4  : \"april\",\n            M5  : \"may\",\n            M6  : \"june\",\n            M7  : \"july\",\n            M8  : \"august\",\n            M9  : \"september\",\n            M10 : \"october\",\n            M11 : \"november\",\n            M12 : \"december\"\n        }[type.toUpperCase()] || type;\n    }\n\n    function getFilterVal(val) {\n        var tmp = parseFloat(val);\n        if (!isNaN(tmp) && tmp == val) {\n            return tmp;\n        }\n        return val;\n    }\n\n    function withErrorLog(sheet, ref, func, context) {\n        try {\n            func();\n            return false;\n        } catch(ex) {\n            var err = { context: context, error: String(ex) };\n            if (sheet && sheet.name) {\n                err.sheet = sheet.name();\n            } else if (sheet) {\n                err.sheet = sheet;\n            }\n            if (ref) {\n                err.location = String(ref);\n            }\n            ERROR_LOG.push(err);\n            return true;\n        }\n    }\n\n    var BORDER_WIDTHS = {\n        \"none\"            : 0,\n        \"thin\"            : 1,\n        \"medium\"          : 2,\n        \"dashed\"          : 1,\n        \"dotted\"          : 1,\n        \"thick\"           : 3,\n        \"double\"          : 3,\n        \"hair\"            : 1,\n        \"mediumDashed\"    : 2,\n        \"dashDot\"         : 1,\n        \"mediumDashDot\"   : 2,\n        \"dashDotDot\"      : 1,\n        \"mediumDashDotDot\": 2,\n        \"slantDashDot\"    : 1\n    };\n\n    var DEFAULT_FORMATS = {\n        0  : \"General\",\n        1  : \"0\",\n        2  : \"0.00\",\n        3  : \"#,##0\",\n        4  : \"#,##0.00\",\n        9  : \"0%\",\n        10 : \"0.00%\",\n        11 : \"0.00E+00\",\n        12 : \"# ?/?\",\n        13 : \"# ??/??\",\n        14 : \"mm-dd-yy\",\n        15 : \"d-mmm-yy\",\n        16 : \"d-mmm\",\n        17 : \"mmm-yy\",\n        18 : \"h:mm AM/PM\",\n        19 : \"h:mm:ss AM/PM\",\n        20 : \"h:mm\",\n        21 : \"h:mm:ss\",\n        22 : \"m/d/yy h:mm\",\n        37 : \"#,##0 ;(#,##0)\",\n        38 : \"#,##0 ;[Red](#,##0)\",\n        39 : \"#,##0.00;(#,##0.00)\",\n        40 : \"#,##0.00;[Red](#,##0.00)\",\n        45 : \"mm:ss\",\n        46 : \"[h]:mm:ss\",\n        47 : \"mmss.0\",\n        48 : \"##0.0E+0\",\n        49 : \"@\"\n    };\n\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet(\"applyBorder\", \"borderId\")) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet(\"applyFont\", \"fontId\")) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet(\"applyAlignment\", \"textAlign\")) {\n            range.textAlign(value);\n        }\n        if (shouldSet(\"applyAlignment\", \"verticalAlign\")) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet(\"applyAlignment\", \"indent\")) {\n            range.indent(value);\n        }\n        if (shouldSet(\"applyAlignment\", \"wrapText\")) {\n            // don't use range.wrap to avoid recomputing row height\n            range._property(\"wrap\", value);\n        }\n        if (shouldSet(\"applyFill\", \"fillId\")) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet(\"applyNumberFormat\", \"numFmtId\")) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        if (shouldSet(\"applyProtection\", \"protection\")) {\n            range.enable(!xf.protection.locked);\n        }\n\n        function setFormat(f) {\n            var format = typeof f == \"string\" ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                // XXX: drop locale info.\n                // http://stackoverflow.com/questions/894805/excel-number-format-what-is-409\n                // not supported by the formatting library.\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, \"\");\n                range.format(format);\n            }\n        }\n\n        function setFill(f) {\n            if (f.type == \"solid\") {\n                range.background(f.color);\n            }\n        }\n\n        function setFont(f) {\n            range.fontFamily(f.name);\n            //range.fontSize(f.size); //XXX: will recalc row height.\n            // converting from points to pixels\n            if (f.size) {\n                range._property(\"fontSize\", f.size * 4 / 3);\n            }\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n            if (f.underline) {\n                range.underline(true);\n            }\n            if (f.color) {\n                range.color(f.color);\n            }\n        }\n\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n\n                var width = BORDER_WIDTHS[border.style];\n                if (!width) {\n                    return;\n                }\n\n                var color = border.color;\n                if (color == null) {\n                    color = \"#000\";\n                }\n\n                var value = { size: width, color: color };\n                if (side == \"diagonal\") {\n                    value.type = border.up << 1 | border.down;\n                }\n\n                range._property(prop, value);\n            }\n\n            set(\"left\", \"borderLeft\");\n            set(\"top\", \"borderTop\");\n            set(\"right\", \"borderRight\");\n            set(\"bottom\", \"borderBottom\");\n            set(\"diagonal\", \"dBorders\");\n        }\n\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n\n    function parse$1(zip, file, callbacks) {\n        return new Promise(resolve => {\n            let obj = zip.file(file);\n            if (obj) {\n                obj.async(\"uint8array\").then(bytes => {\n                    parseXML(bytes, callbacks);\n                    resolve();\n                });\n            } else {\n                resolve();\n            }\n        });\n    }\n\n    async function readStrings(zip) {\n        var strings = [];\n        var current = null;\n        await parse$1(zip, \"xl/sharedStrings.xml\", {\n            leave: function() {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                    current = null;\n                }\n            },\n            text: function(text) {\n                if (this.is(SEL_TEXT)) {\n                    if (current == null) {\n                        current = \"\";\n                    }\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n\n    async function readRelationships(zip, file) {\n        var map = { byId: {}, byType: { theme: [] }, bytes: {} };\n        await parse$1(zip, xl(file) + \".rels\", {\n            enter: function(tag, attrs) {\n                if (tag == \"Relationship\") {\n                    map.byId[attrs.Id] = attrs.Target;\n\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        let names = [];\n        let promises = [];\n        Object.keys(map.byId).forEach(id => {\n            let filename = map.byId[id];\n            let obj = zip.file(xl(filename));\n            if (obj) {\n                names.push(filename);\n                promises.push(obj.async(\"uint8array\"));\n            }\n        });\n        let data = await Promise.all(promises);\n        names.forEach((name, i) => map.bytes[name] = data[i]);\n        return map;\n    }\n\n    var SEL_BORDER = [\"borders\", \"border\"];\n    var SEL_FILL = [\"fills\", \"fill\"];\n    var SEL_FONT = [\"fonts\", \"font\"];\n    var SEL_INLINE_STYLE = [\"cellXfs\", \"xf\"];\n    var SEL_NAMED_STYLE = [\"cellStyleXfs\", \"xf\"];\n    var SEL_NUM_FMT = [\"numFmts\", \"numFmt\"];\n\n    var INDEXED_COLORS = [\n        toCSSColor(\"FF000000\"), toCSSColor(\"FFFFFFFF\"), toCSSColor(\"FFFF0000\"),\n        toCSSColor(\"FF00FF00\"), toCSSColor(\"FF0000FF\"), toCSSColor(\"FFFFFF00\"),\n        toCSSColor(\"FFFF00FF\"), toCSSColor(\"FF00FFFF\"), toCSSColor(\"FF000000\"),\n        toCSSColor(\"FFFFFFFF\"), toCSSColor(\"FFFF0000\"), toCSSColor(\"FF00FF00\"),\n        toCSSColor(\"FF0000FF\"), toCSSColor(\"FFFFFF00\"), toCSSColor(\"FFFF00FF\"),\n        toCSSColor(\"FF00FFFF\"), toCSSColor(\"FF800000\"), toCSSColor(\"FF008000\"),\n        toCSSColor(\"FF000080\"), toCSSColor(\"FF808000\"), toCSSColor(\"FF800080\"),\n        toCSSColor(\"FF008080\"), toCSSColor(\"FFC0C0C0\"), toCSSColor(\"FF808080\"),\n        toCSSColor(\"FF9999FF\"), toCSSColor(\"FF993366\"), toCSSColor(\"FFFFFFCC\"),\n        toCSSColor(\"FFCCFFFF\"), toCSSColor(\"FF660066\"), toCSSColor(\"FFFF8080\"),\n        toCSSColor(\"FF0066CC\"), toCSSColor(\"FFCCCCFF\"), toCSSColor(\"FF000080\"),\n        toCSSColor(\"FFFF00FF\"), toCSSColor(\"FFFFFF00\"), toCSSColor(\"FF00FFFF\"),\n        toCSSColor(\"FF800080\"), toCSSColor(\"FF800000\"), toCSSColor(\"FF008080\"),\n        toCSSColor(\"FF0000FF\"), toCSSColor(\"FF00CCFF\"), toCSSColor(\"FFCCFFFF\"),\n        toCSSColor(\"FFCCFFCC\"), toCSSColor(\"FFFFFF99\"), toCSSColor(\"FF99CCFF\"),\n        toCSSColor(\"FFFF99CC\"), toCSSColor(\"FFCC99FF\"), toCSSColor(\"FFFFCC99\"),\n        toCSSColor(\"FF3366FF\"), toCSSColor(\"FF33CCCC\"), toCSSColor(\"FF99CC00\"),\n        toCSSColor(\"FFFFCC00\"), toCSSColor(\"FFFF9900\"), toCSSColor(\"FFFF6600\"),\n        toCSSColor(\"FF666699\"), toCSSColor(\"FF969696\"), toCSSColor(\"FF003366\"),\n        toCSSColor(\"FF339966\"), toCSSColor(\"FF003300\"), toCSSColor(\"FF333300\"),\n        toCSSColor(\"FF993300\"), toCSSColor(\"FF993366\"), toCSSColor(\"FF333399\"),\n        toCSSColor(\"FF333333\"),\n        toCSSColor(\"FF000000\"), // System Foreground\n        toCSSColor(\"FFFFFFFF\")  // System Background\n    ];\n\n    async function readStyles(zip, theme) {\n        var styles = {\n            fonts        : [],\n            numFmts      : {},\n            fills        : [],\n            borders      : [],\n            namedStyles  : [],\n            inlineStyles : []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        await parse$1(zip, \"xl/styles.xml\", {\n            enter: function(tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                }\n                else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                    if (closed) {\n                        // apparently, there's XLSX in the wild with\n                        // <font/>, because why not (also, <border/>).\n                        // if we don't null the variable, we always\n                        // enter below and effectively ignore the rest\n                        // of the file.\n                        font = null;\n                    }\n                } else if (font) {\n                    if (tag == \"sz\") {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == \"name\") {\n                        font.name = attrs.val;\n                    } else if (tag == \"b\") {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == \"i\") {\n                        font.italic = bool(attrs.val, true);\n                    } else if (tag == \"u\") {\n                        font.underline = (attrs.val == null || attrs.val == \"single\");\n                    } else if (tag == \"color\") {\n                        font.color = getColor(attrs, null);\n                    }\n                }\n                else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                    if (closed) {\n                        fill = null;\n                    }\n                } else if (fill) {\n                    if (tag == \"patternFill\") {\n                        fill.type = attrs.patternType;\n                    } else if (tag == \"fgColor\" && fill.type === \"solid\") {\n                        fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                    } else if (tag == \"bgColor\" && fill.type !== \"solid\") {\n                        fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                    }\n                }\n                else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {\n                        diagonalUp   : +bool(attrs.diagonalUp, 0),\n                        diagonalDown : +bool(attrs.diagonalDown, 0)\n                    });\n                    if (closed) {\n                        border = null;\n                    }\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom|diagonal)$/.test(tag)) {\n                        border[tag] = { style: attrs.style || \"none\" };\n                        if (tag == \"diagonal\") {\n                            border.diagonal.up = border.diagonalUp;\n                            border.diagonal.down = border.diagonalDown;\n                        }\n                    }\n                    if (tag == \"color\") {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs, INDEXED_COLORS[0]);\n                    }\n                }\n                else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == \"alignment\") {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                        if (attrs.indent != null) {\n                            xf.indent = integer(attrs.indent);\n                        }\n                    } else if (tag == \"protection\") {\n                        xf.protection = {\n                            locked: bool(attrs.locked)\n                        };\n                    }\n                }\n            },\n            leave: function(tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == \"xf\") {\n                    xf = null;\n                }\n            }\n        });\n\n        function getXf(attrs) {\n            var xf = {\n                borderId          : integer(attrs.borderId),\n                fillId            : integer(attrs.fillId),\n                fontId            : integer(attrs.fontId),\n                numFmtId          : integer(attrs.numFmtId),\n                pivotButton       : bool(attrs.pivotButton),\n                quotePrefix       : bool(attrs.quotePrefix),\n                xfId              : integer(attrs.xfId)\n            };\n            addBool(\"applyAlignment\");\n            addBool(\"applyBorder\");\n            addBool(\"applyFill\");\n            addBool(\"applyFont\");\n            addBool(\"applyNumberFormat\");\n            if (addBool(\"applyProtection\")) {\n                xf.protection = { locked: true };\n            }\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    return xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n\n        function getColor(attrs, defaultThemeColor) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                if (!themeColor) {\n                    // returning black by default for font color causes\n                    // https://github.com/telerik/kendo-ui-core/issues/5826\n                    // in default cell style, color is undefined\n                    return defaultThemeColor;\n                }\n\n                var color = kendo.parseColor(themeColor);\n\n                if (attrs.tint) {\n                    color = color.toHSL();\n\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n\n                return color.toCssRgba();\n            }\n        }\n\n        return styles;\n    }\n\n    var SEL_SCHEME_RGBCLR = [\"a:clrScheme\", \"*\", \"a:srgbClr\"];\n    var SEL_SCHEME_SYSCLR = [\"a:clrScheme\", \"*\", \"a:sysClr\"];\n    async function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = {\n            colorScheme: scheme\n        };\n\n        var file = xl(rel);\n        if (zip.file(file)) {\n            await parse$1(zip, file, {\n                enter: function(tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(\n                            attrs.val == \"window\" ? \"FFFFFFFF\" : \"FF000000\"\n                        ));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor(\"FF\" + attrs.val));\n                    }\n                }\n            });\n\n            if (scheme.length > 3) {\n                // lt1 <-> dk1\n                swap(scheme, 0, 1);\n                // lt2 <-> dk2\n                swap(scheme, 2, 3);\n            }\n        }\n\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n\n        return theme;\n    }\n\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == \"true\" || val === true || val == 1;\n    }\n\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return \"rgba(\" +\n            parseInt(m[2], 16) + \", \" +\n            parseInt(m[3], 16) + \", \" +\n            parseInt(m[4], 16) + \", \" +\n            parseInt(m[1], 16) / 255 + \")\";\n    }\n\n    function relative_file(base, name) {\n        base = base.split(/\\/+/);\n        name = name.split(/\\/+/);\n        base.pop();\n        while (name.length) {\n            var part = name.shift();\n            if (part === \"\") {\n                base = [];      // absolute\n            } else if (part === \".\") {\n                continue;\n            } else if (part === \"..\") {\n                base.pop();\n            } else {\n                base.push(part);\n            }\n        }\n        return base.join(\"/\");\n    }\n\n    function excelToPixels(val) {\n        return val / 9525;\n    }\n\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n\n(function(kendo) {\n\n\n\n\n    var $ = kendo.jQuery;\n    var Formula = kendo.spreadsheet.calc.runtime.Formula;\n    var Ref = kendo.spreadsheet.Ref;\n    var CalcError = kendo.spreadsheet.CalcError;\n\n    kendo.spreadsheet.messages.workbook = {\n        defaultSheetName: \"Sheet\"\n    };\n\n    function loadBinary(url, callback) {\n        var xhr = new XMLHttpRequest();\n        xhr.onload = function() {\n            callback(xhr.response, xhr.getResponseHeader(\"Content-Type\"));\n        };\n        xhr.onerror = function() {\n            callback(null);\n        };\n        xhr.open(\"GET\", url);\n        xhr.responseType = \"arraybuffer\";\n        xhr.send();\n    }\n\n    var Workbook = kendo.Observable.extend({\n        options: {},\n\n        init: function(options, view) {\n            kendo.Observable.fn.init.call(this);\n\n            this.options = options;\n\n            this._view = view;\n            this._sheets = [];\n            this._images = {};\n            this._imgID = 0;\n\n            this._sheetsSearchCache = {};\n\n            this._sheet = this.insertSheet({\n                rows: this.options.rows,\n                columns: this.options.columns,\n                rowHeight: this.options.rowHeight,\n                columnWidth: this.options.columnWidth,\n                headerHeight: this.options.headerHeight,\n                headerWidth: this.options.headerWidth,\n                dataSource: this.options.dataSource\n            });\n\n            this.undoRedoStack = new kendo.util.UndoRedoStack();\n            this.undoRedoStack.bind([\"undo\", \"redo\"], this._onUndoRedo.bind(this));\n\n            this._context = new kendo.spreadsheet.FormulaContext(this);\n            this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n            this._names = Object.create(null);\n\n            this.fromJSON(this.options);\n        },\n\n        clipboard: function() {\n            if(!this._clipboard) {\n                 this._clipboard = new kendo.spreadsheet.Clipboard(this);\n            }\n            return this._clipboard;\n        },\n\n        destroy: function() {\n            this.unbind();\n\n            if (this._clipboard) {\n                this._clipboard.destroy();\n            }\n        },\n\n        events: [\n            \"cut\",\n            \"copy\",\n            \"paste\",\n            \"changing\",\n            \"change\",\n            \"excelImport\",\n            \"excelExport\",\n            \"insertSheet\",\n            \"removeSheet\",\n            \"selectSheet\",\n            \"renameSheet\",\n            \"insertRow\",\n            \"insertColumn\",\n            \"deleteRow\",\n            \"deleteColumn\",\n            \"hideRow\",\n            \"hideColumn\",\n            \"unhideRow\",\n            \"unhideColumn\",\n            \"select\",\n            \"changeFormat\",\n            \"dataBinding\",\n            \"dataBound\",\n            \"progress\"\n        ],\n\n        _sheetChanging: function(e) {\n            if (this.trigger(\"changing\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _sheetChange: function(e) {\n            this.trigger(\"change\", e);\n        },\n\n        _sheetInsertRow: function(e) {\n            if (this.trigger(\"insertRow\", {\n                sheet: e.sender,\n                index: e.index\n            })) {\n                e.preventDefault();\n            }\n        },\n\n        _sheetInsertColumn: function(e) {\n            if (this.trigger(\"insertColumn\", {\n                sheet: e.sender,\n                index: e.index\n            })) {\n                e.preventDefault();\n            }\n        },\n\n        _sheetDeleteRow: function(e) {\n            if (this.trigger(\"deleteRow\", {\n                sheet: e.sender,\n                index: e.index\n            })) {\n                e.preventDefault();\n            }\n        },\n\n        _sheetDeleteColumn: function(e) {\n            if (this.trigger(\"deleteColumn\", {\n                sheet: e.sender,\n                index: e.index\n            })) {\n                e.preventDefault();\n            }\n        },\n\n        _sheetHideRow: function(e) {\n            if (this.trigger(\"hideRow\", {\n                sheet: e.sender,\n                index: e.index\n            })) {\n                e.preventDefault();\n            }\n        },\n\n        _sheetHideColumn: function(e) {\n            if (this.trigger(\"hideColumn\", {\n                sheet: e.sender,\n                index: e.index\n            })) {\n                e.preventDefault();\n            }\n        },\n\n        _sheetUnhideRow: function(e) {\n            if (this.trigger(\"unhideRow\", {\n                sheet: e.sender,\n                index: e.index\n            })) {\n                e.preventDefault();\n            }\n        },\n\n        _sheetUnhideColumn: function(e) {\n            if (this.trigger(\"unhideColumn\", {\n                sheet: e.sender,\n                index: e.index\n            })) {\n                e.preventDefault();\n            }\n        },\n\n        _sheetSelect: function(e) {\n            this.trigger(\"select\", e);\n        },\n\n        _sheetDataBinding: function(e) {\n            if (this.trigger(\"dataBinding\", {\n                sheet: e.sender\n            })) {\n                e.preventDefault();\n            }\n        },\n\n        _sheetDataBound: function(e) {\n            this.trigger(\"dataBound\", {\n                sheet: e.sender\n            });\n        },\n\n        _sheetProgress: function(e) {\n            var that = this;\n\n            setTimeout(function() {\n                that.trigger(\"progress\", {\n                    toggle: e.toggle\n                });\n            });\n        },\n\n        _sheetCommandRequest: function(e) {\n            this.trigger(\"commandRequest\", e);\n        },\n\n        _inputForRef: function(ref) {\n            var self = this;\n            return self._sheet.withCultureDecimals(function(){\n                return new kendo.spreadsheet.Range(ref, self._sheet).input();\n            });\n        },\n\n        _onUndoRedo: function(e) {\n            e.command.range().select();\n        },\n\n        execute: function(options) {\n            var commandOptions = $.extend({ workbook: this }, options.options);\n            var command = new kendo.spreadsheet[options.command](commandOptions);\n            var sheet = this.activeSheet();\n\n            if (commandOptions.origin) {\n                command.origin(commandOptions.origin);\n            }\n\n            if (commandOptions.operatingRange) {\n                command.range(commandOptions.operatingRange);\n            } else {\n                command.range(sheet.selection());\n            }\n\n            if (commandOptions.editRange) {\n                command._editRange = commandOptions.editRange;\n            }\n\n            var result = command.exec();\n\n            if (!result || result.reason !== \"error\") {\n                if (!command.cannotUndo) {\n                    this.undoRedoStack.push(command);\n                }\n            }\n\n            // when the undo/redo stack is truncated (by e.g. adding a\n            // non-redo command after undoing) it's possible to\n            // discard images from the dropped commands.\n            this.cleanupImages();\n\n            return result;\n        },\n\n        resetFormulas: function() {\n            this._sheets.forEach(function(sheet){\n                sheet.resetFormulas();\n            });\n        },\n\n        resetValidations: function() {\n            this._sheets.forEach(function(sheet){\n                sheet.resetValidations();\n            });\n        },\n\n        refresh: function(reason) {\n            if (reason.recalc) {\n                this.resetFormulas();\n                this.resetValidations();\n                this._sheet.recalc(this._context);\n                this._sheet.revalidate(this._validationContext);\n            }\n        },\n\n        activeSheet: function(sheet) {\n            if (sheet === undefined) {\n                return this._sheet;\n            }\n\n            if (!this.sheetByName(sheet.name())) {\n                return;\n            }\n\n            this._sheet = sheet;\n\n            //TODO: better way to get all reasons?\n            sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n        },\n\n        moveSheetToIndex: function(sheet, toIndex) {\n            var fromIndex = this.sheetIndex(sheet);\n            var sheets = this._sheets;\n\n            if (fromIndex === -1) {\n                return;\n            }\n\n            this._sheetsSearchCache = {};\n\n            sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n\n            this.trigger(\"change\", { sheetSelection: true });\n        },\n\n        insertSheet: function(options) {\n            options = options || {};\n            var that = this;\n            var insertIndex = typeof options.index === \"number\" ? options.index : that._sheets.length;\n            var sheetName;\n            var sheets = that._sheets;\n\n            var getUniqueSheetName = function(sheetNameSuffix) {\n                sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n\n                var name = kendo.spreadsheet.messages.workbook.defaultSheetName + sheetNameSuffix;\n\n                if (!that.sheetByName(name)) {\n                    return name;\n                }\n\n                return getUniqueSheetName(sheetNameSuffix + 1);\n            };\n\n            if (options.name && that.sheetByName(options.name)) {\n                return;\n            }\n\n            this._sheetsSearchCache = {};\n\n            sheetName = options.name || getUniqueSheetName();\n\n            var sheet = new kendo.spreadsheet.Sheet(\n                options.rows || this.options.rows,\n                options.columns || this.options.columns,\n                options.rowHeight || this.options.rowHeight,\n                options.columnWidth || this.options.columnWidth,\n                options.headerHeight || this.options.headerHeight,\n                options.headerWidth || this.options.headerWidth,\n                options.defaultCellStyle || this.options.defaultCellStyle\n            );\n\n            sheet._workbook = this;\n\n            sheet._name(sheetName);\n\n            this._bindSheetEvents(sheet);\n\n            sheets.splice(insertIndex, 0, sheet);\n\n            if (options.data) {\n                sheet.fromJSON(options.data);\n            }\n\n            if (options.dataSource) {\n                sheet.setDataSource(options.dataSource);\n            }\n\n            this.trigger(\"change\", { sheetSelection: true });\n\n            return sheet;\n        },\n\n        _bindSheetEvents: function(sheet) {\n            sheet.bind(\"changing\", this._sheetChanging.bind(this));\n            sheet.bind(\"change\", this._sheetChange.bind(this));\n            sheet.bind(\"insertRow\", this._sheetInsertRow.bind(this));\n            sheet.bind(\"insertColumn\", this._sheetInsertColumn.bind(this));\n            sheet.bind(\"deleteRow\", this._sheetDeleteRow.bind(this));\n            sheet.bind(\"deleteColumn\", this._sheetDeleteColumn.bind(this));\n            sheet.bind(\"hideRow\", this._sheetHideRow.bind(this));\n            sheet.bind(\"hideColumn\", this._sheetHideColumn.bind(this));\n            sheet.bind(\"unhideRow\", this._sheetUnhideRow.bind(this));\n            sheet.bind(\"unhideColumn\", this._sheetUnhideColumn.bind(this));\n            sheet.bind(\"select\", this._sheetSelect.bind(this));\n            sheet.bind(\"commandRequest\", this._sheetCommandRequest.bind(this));\n            sheet.bind(\"dataBinding\", this._sheetDataBinding.bind(this));\n            sheet.bind(\"dataBound\", this._sheetDataBound.bind(this));\n            sheet.bind(\"progress\", this._sheetProgress.bind(this));\n        },\n\n        sheets: function() {\n            return this._sheets.slice();\n        },\n\n        sheetByName: function (sheetName) {\n            return this._sheets[this.sheetIndex(sheetName)];\n        },\n\n        sheetByIndex: function(index) {\n            return this._sheets[index];\n        },\n\n        sheetIndex: function(sheet) {\n            var sheets = this._sheets;\n            var sheetName = (typeof sheet == \"string\" ? sheet : sheet.name()).toLowerCase();\n            var idx = this._sheetsSearchCache[sheetName];\n\n            if (idx >= 0) {\n                return idx;\n            }\n\n            for(idx = 0; idx < sheets.length; idx++) {\n                var name = sheets[idx].name().toLowerCase();\n                this._sheetsSearchCache[name] = idx;\n\n                if (name === sheetName) {\n                    return idx;\n                }\n            }\n\n            return -1;\n        },\n\n        renameSheet: function(sheet, newSheetName) {\n            var oldSheetName = sheet.name().toLowerCase();\n\n            if (!newSheetName ||\n                oldSheetName === newSheetName.toLowerCase() ||\n                this.sheetByName(newSheetName)) {\n                return;\n            }\n\n            sheet = this.sheetByName(oldSheetName);\n\n            if (!sheet) {\n                return;\n            }\n\n            this._sheetsSearchCache = {};\n\n            if (this.trigger(\"renameSheet\", {\n                sheet: sheet,\n                newSheetName: newSheetName\n            })) {\n                return;\n            }\n\n            // update references\n            this._sheets.forEach(function(sheet){\n                sheet._forFormulas(function(formula){\n                    formula.renameSheet(oldSheetName, newSheetName);\n                });\n            });\n\n            this.forEachName(function(def, name){\n                // 1. redefine sheet-local names\n                if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                    this.undefineName(name);\n                    def.name = def.nameref.print();\n                    this.nameDefinition(def.name, def);\n                }\n                // 2. if the value is reference or formula, update it\n                if (def.value instanceof Ref || def.value instanceof Formula) {\n                    def.value.renameSheet(oldSheetName, newSheetName);\n                }\n            }.bind(this));\n\n            sheet._name(newSheetName);\n\n            this.trigger(\"change\", { sheetSelection: true });\n\n            return sheet;\n        },\n\n        removeSheet: function(sheet) {\n            var that = this;\n            var sheets = that._sheets;\n            var name = sheet.name();\n            var index = that.sheetIndex(sheet);\n\n            if (sheets.length === 1) {\n                return;\n            }\n\n            if (this.trigger(\"removeSheet\", { sheet: sheet })) {\n                return;\n            }\n\n            this._sheetsSearchCache = {};\n\n            if (index > -1) {\n                sheet.unbind();\n\n                sheets.splice(index, 1);\n\n                if (that.activeSheet().name() === name) {\n                    var newSheet = sheets[index === sheets.length ? index-1 : index];\n                    that.activeSheet(newSheet);\n                } else {\n                    this.trigger(\"change\", { recalc: true,  sheetSelection: true });\n                }\n            }\n        },\n\n        _clearSheets: function() {\n            for (var i = 0; i < this._sheets.length; i++) {\n                this._sheets[i]._activeDrawing = [];\n                this._sheets[i]._drawings = [];\n                this._sheets[i].unbind();\n            }\n            this._sheets = [];\n            this._sheetsSearchCache = {};\n            this._names = {};\n            this._images = {};\n            this._imgID = 0;\n        },\n\n        // _loadImages: function() {\n        //     var self = this;\n        //     var ids = Object.keys(self._images);\n        //     var count = ids.length;\n        //     if (count) {\n        //         ids.forEach(function(id){\n        //             var img = self._images[id];\n        //             if (!img.blob) {\n        //                 loadBinary(img.url, function(data, type) {\n        //                     // XXX: can we do something better in case of error?\n        //                     if (data != null) {\n        //                         img.blob = new Blob([ data ], { type: type });\n        //                         delete img.url;\n        //                     }\n        //                     next();\n        //                 });\n        //             }\n        //         });\n        //     } else {\n        //         next();\n        //     }\n        //     function next() {\n        //         if (--count <= 0) {\n        //             self.activeSheet().triggerChange({ layout: true });\n        //         }\n        //     }\n        // },\n\n        fromJSON: function(json) {\n            if (json.sheets) {\n                this._clearSheets();\n\n                if (json.images) {\n                    this._imgID = 0;\n                    this._images = {};\n                    Object.keys(json.images).forEach(function(id){\n                        if (!isNaN(id)) {\n                            var num = parseFloat(id);\n                            if (isFinite(num)) {\n                                this._imgID = Math.max(this._imgID, num);\n                            }\n                        }\n                        this._images[id] = { url: json.images[id] };\n                    }, this);\n                    // this._loadImages();\n                }\n\n                for (var idx = 0; idx < json.sheets.length; idx++) {\n                    var data = json.sheets[idx];\n                    var args = sheetParamsFromJSON(data, this.options);\n                    var sheet = this.insertSheet({\n                        rows         : args.rowCount,\n                        columns      : args.columnCount,\n                        rowHeight    : args.rowHeight,\n                        columnWidth  : args.columnWidth,\n                        headerHeight : args.headerHeight,\n                        headerWidth  : args.headerWidth,\n                        data         : data\n                    });\n\n                    if (data.dataSource) {\n                        sheet.setDataSource(data.dataSource);\n                    }\n                }\n            }\n\n            if (json.activeSheet) {\n                this.activeSheet(this.sheetByName(json.activeSheet));\n            } else {\n                this.activeSheet(this._sheets[0]);\n            }\n\n            if (json.names) {\n                json.names.forEach(function(def){\n                    this.defineName(def.name, def.value, def.hidden);\n                }, this);\n            }\n        },\n\n        toJSON: function() {\n            this.resetFormulas();\n            this.resetValidations();\n            var names = Object.keys(this._names).map(function(name){\n                var def = this._names[name];\n                var val = def.value;\n                if (val instanceof Ref || val instanceof Formula) {\n                    val = val.print(0, 0, true);\n                } else if (val instanceof CalcError) {\n                    val = val + \"\";\n                } else {\n                    val = JSON.stringify(val);\n                }\n                return {\n                    value     : val,\n                    hidden    : def.hidden,\n                    name      : def.name,\n\n                    // these two are not really useful in\n                    // deserialization, but are handy in OOXML export.\n                    sheet     : def.nameref.sheet,\n                    localName : def.nameref.name\n                };\n            }, this);\n            return {\n                activeSheet: this.activeSheet().name(),\n                sheets: this._sheets.map(function(sheet) {\n                    sheet.recalc(this._context);\n                    sheet.revalidate(this._validationContext);\n                    return sheet.toJSON();\n                }, this),\n                names: names,\n                columnWidth: this.options.columnWidth,\n                rowHeight: this.options.rowHeight\n            };\n        },\n\n        saveJSON: function() {\n            var self = this;\n            var deferred = new $.Deferred();\n            var data = self.toJSON();\n            var ids = Object.keys(self._images).filter(function(id){\n                return self.usesImage(id) === 1;\n            });\n            var count = ids.length;\n            data.images = {};\n            if (count) {\n                ids.forEach(function(id){\n                    var img = self._images[id];\n                    if (img.blob) {\n                        var reader = new FileReader();\n                        reader.onload = function() {\n                            data.images[id] = reader.result;\n                            next();\n                        };\n                        reader.readAsDataURL(img.blob);\n                    } else {\n                        data.images[id] = img.url;\n                        next();\n                    }\n                });\n            } else {\n                next();\n            }\n            return deferred.promise();\n\n            function next() {\n                if (--count <= 0) {\n                    deferred.resolve(data);\n                }\n            }\n        },\n\n        fromFile: function(file) {\n            var deferred = new $.Deferred();\n            var promise = deferred.promise();\n            var args = { file: file, promise: promise };\n\n            if (file && !this.trigger(\"excelImport\", args)) {\n                this._clearSheets();\n                kendo.spreadsheet.readExcel(file, this, deferred);\n            } else {\n                deferred.reject();\n            }\n\n            return promise;\n        },\n\n        saveAsExcel: function(options) {\n            var self = this;\n            options = $.extend({}, self.options.excel, options);\n            var data = self.toJSON();\n\n            if (self.trigger(\"excelExport\", { workbook: data })) {\n                return;\n            }\n\n            var ids = Object.keys(self._images).filter(function(id){\n                return self.usesImage(id) === 1;\n            });\n            var count = ids.length;\n            var images = count ? {} : null;\n            if (count) {\n                ids.forEach(function(id){\n                    var img = self._images[id];\n                    if (img.blob) {\n                        var reader = new FileReader();\n                        reader.onload = function() {\n                            images[id] = {\n                                type: img.blob.type,\n                                name: img.blob.name,\n                                data: reader.result\n                            };\n                            next();\n                        };\n                        reader.readAsArrayBuffer(img.blob);\n                    } else {\n                        loadBinary(img.url, function(data, type){\n                            images[id] = { type: type, data: data };\n                            next();\n                        });\n                    }\n                });\n            } else {\n                next();\n            }\n\n            function next() {\n                if (--count <= 0) {\n                    data.images = images;\n                    var workbook = new kendo.ooxml.Workbook(data);\n                    var saveOptions = {\n                        fileName: data.fileName || options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy\n                    };\n\n                    if (options.forceProxy) {\n                        kendo.saveAs($.extend(saveOptions, {\n                            dataURI: workbook.toBlob()\n                        }));\n                    } else {\n                        workbook.toDataURLAsync().then(function(data) {\n                            kendo.saveAs($.extend(saveOptions, {\n                                dataURI: data\n                            }));\n                        });\n                    }\n                }\n            }\n        },\n\n        draw: function(options, callback) {\n            if (typeof options == \"function\" && !callback) {\n                callback = options;\n                options = {};\n            }\n            var parts = [], sheets = this._sheets;\n            (function loop(i){\n                if (i < sheets.length) {\n                    sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function(group){\n                        parts.push(group);\n                        loop(i + 1);\n                    });\n                } else {\n                    var group = parts[0];\n                    for (i = 1; i < parts.length; ++i) {\n                        group.children = group.children.concat(parts[i].children);\n                    }\n                    callback(group);\n                }\n            })(0);\n        },\n\n        nameForRef: function(ref, sheet) {\n            if (sheet === undefined) {\n                sheet = ref.sheet;\n            }\n            sheet = sheet.toLowerCase();\n            var str = ref + \"\";\n            for (var name in this._names) {\n                var def = this._names[name];\n                var val = def.value;\n                if (val instanceof Ref) {\n                    if (!val.sheet || (val.sheet && sheet == val.sheet.toLowerCase())) {\n                        if (val + \"\" == str) {\n                            return def;\n                        }\n                    }\n                }\n            }\n            return { name: str };\n        },\n\n        defineName: function(name, value, hidden) {\n            var x = kendo.spreadsheet.calc.parseNameDefinition(name, value);\n            name = x.name.print();\n            this._names[name.toLowerCase()] = {\n                value   : x.value,\n                hidden  : hidden,\n                name    : name,\n                nameref : x.name\n            };\n        },\n\n        undefineName: function(name) {\n            delete this._names[name.toLowerCase()];\n        },\n\n        nameValue: function(name) {\n            name = name.toLowerCase();\n            if (name in this._names) {\n                return this._names[name].value;\n            }\n            return null;\n        },\n\n        nameDefinition: function(name, def) {\n            name = name.toLowerCase();\n            if (arguments.length > 1) {\n                if (def === undefined) {\n                    delete this._names[name];\n                } else {\n                    this._names[name] = def;\n                }\n            }\n            return this._names[name];\n        },\n\n        forEachName: function(func) {\n            Object.keys(this._names).forEach(function(name){\n                func(this._names[name], name);\n            }, this);\n        },\n\n        adjustNames: function(affectedSheet, forRow, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            Object.keys(this._names).forEach(function(name){\n                var def = this._names[name];\n                var x = def.value;\n                if (x instanceof Ref &&\n                    x.sheet.toLowerCase() == affectedSheet) {\n                    def.value = x.adjust(null, null, null, null, forRow, start, delta);\n                }\n                else if (x instanceof Formula) {\n                    x.adjust(affectedSheet, forRow ? \"row\" : \"col\", start, delta);\n                }\n            }, this);\n        },\n\n        addImage: function(image) {\n            var id = String(++this._imgID);\n            if (typeof image == \"string\") {\n                this._images[id] = { url: image };\n            } else {\n                this._images[id] = { blob: image };\n            }\n            return id;\n        },\n\n        imageUrl: function(id) {\n            var img = this._images[id];\n            var url = img.url;\n            if (!url) {\n                url = img.url = window.URL.createObjectURL(img.blob);\n            }\n            return url;\n        },\n\n        cleanupImages: function() {\n            Object.keys(this._images).forEach(function(id){\n                if (!this.usesImage(id)) {\n                    var url = this._images[id].url;\n                    if (url) {\n                        window.URL.revokeObjectURL(url);\n                    }\n                    delete this._images[id];\n                }\n            }, this);\n        },\n\n        usesImage: function(img) {\n            var i;\n            var sheets = this._sheets;\n            for (i = sheets.length; --i >= 0;) {\n                if (sheets[i].usesImage(img)) {\n                    return 1;\n                }\n            }\n            var stack = this.undoRedoStack.stack;\n            for (i = stack.length; --i >= 0;) {\n                if (stack[i].usesImage(img)) {\n                    return 2; // signal that it's only in the undo stack\n                }\n            }\n            return false;\n        }\n\n    });\n\n    function sheetParamsFromJSON(data, options) {\n        function or(a, b, c) {\n            return a !== undefined ? a : b !== undefined ? b : c;\n        }\n\n        var rowCount     = or(data.rowCount, options.rows, 200),\n            columnCount  = or(data.columnCount, options.columns, 50),\n            rowHeight    = or(data.rowHeight, options.rowHeight, 20),\n            columnWidth  = or(data.columnWidth, options.columnWidth, 64),\n            headerHeight = or(data.headerHeight, options.headerHeight, 20),\n            headerWidth  = or(data.headerWidth, options.headerWidth, 32);\n\n        if (data.rows !== undefined) {\n            for (var i = 0; i < data.rows.length; ++i) {\n                var row = data.rows[i];\n                var ri = or(row.index, i);\n                if (ri >= rowCount) { rowCount = ri + 1; }\n                if (row.cells) {\n                    for (var j = 0; j < row.cells.length; ++j) {\n                        var cell = row.cells[j];\n                        var ci = or(cell.index, j);\n                        if (ci >= columnCount) { columnCount = ci + 1; }\n                    }\n                }\n            }\n        }\n\n        return {\n            rowCount     : rowCount,\n            columnCount  : columnCount,\n            rowHeight    : rowHeight,\n            columnWidth  : columnWidth,\n            headerHeight : headerHeight,\n            headerWidth  : headerWidth\n        };\n    }\n\n    kendo.spreadsheet.Workbook = Workbook;\n    if (kendo.PDFMixin) {\n        kendo.PDFMixin.extend(Workbook.prototype);\n\n        Workbook.prototype.saveAsPDF = function(options) {\n            var progress = new $.Deferred();\n            var promise = progress.promise();\n            var args = { promise: promise };\n            if (this.trigger(\"pdfExport\", args)) {\n                return;\n            }\n\n            this._drawPDF(options, progress)\n            .then(function(root) {\n                return options.forceProxy\n                    ? kendo.pdf.exportPDF(root) // produce data URI for proxy\n                    : kendo.pdf.exportPDFToBlob(root);\n            })\n            .done(function(dataURI) {\n                kendo.saveAs({\n                    dataURI: dataURI,\n                    fileName: options.fileName,\n                    proxyURL: options.proxyURL,\n                    forceProxy: options.forceProxy,\n                    proxyTarget: options.proxyTarget\n                });\n\n                progress.resolve();\n            })\n            .fail(function(err) {\n                progress.reject(err);\n            });\n\n            return promise;\n        };\n\n        Workbook.prototype._drawPDF = function(options) {\n            var result = new $.Deferred();\n            var callback = function(group) {\n                result.resolve(group);\n            };\n            switch(options.area) {\n            case \"workbook\":\n                options.workbook.draw(options, callback);\n                break;\n            case \"sheet\":\n                options.workbook.activeSheet().draw(options, callback);\n                break;\n            case \"selection\":\n                options.workbook.activeSheet().selection().draw(options, callback);\n                break;\n            }\n\n            return result.promise();\n        };\n    }\n})(kendo);\n\nvar spreadsheet$4 = kendo.spreadsheet;\n    var CellRef$2 = spreadsheet$4.CellRef;\n    var RangeRef$1 = spreadsheet$4.RangeRef;\n    var UnionRef$1 = spreadsheet$4.UnionRef;\n    var NameRef$1 = spreadsheet$4.NameRef;\n    var Ref$1 = spreadsheet$4.Ref;\n\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n\n        getRefCells: function(ref, hiddenInfo, fsheet, frow, fcol, wantNulls) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef$2) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{\n                        value: new kendo.spreadsheet.calc.runtime.CalcError(\"REF\")\n                    }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n\n                if (wantNulls || formula != null || value != null) {\n                    return [{\n                        formula: formula,\n                        value: value,\n                        row: ref.row,\n                        col: ref.col,\n                        sheet: ref.sheet,\n                        hidden: hiddenInfo ? (sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0) : false\n                    }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef$1) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    // \"3D\" reference.\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{\n                        value: new kendo.spreadsheet.calc.runtime.CalcError(\"REF\")\n                    }];\n                }\n\n                // XXX: This is nicer, but significantly slower.\n                // Should investigate why, or add some options to make\n                // it faster (i.e. probably because it adds all cell\n                // properties, while we only need value and formula).\n                //\n                //     var add = function(row, col, data){\n                //         data.row = row;\n                //         data.col = col;\n                //         data.sheet = sheet.name();\n                //         states.push(data);\n                //     };\n                //     while (i <= n) {\n                //         sheet = this.workbook.sheetByIndex(i++);\n                //         sheet.forEach(ref, add);\n                //     }\n                //\n                // For now keep doing it \"manually\".\n\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n\n                    var values = sheet._properties.iterator(\"value\", startCellIndex, endCellIndex);\n\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get(\"formula\", index);\n                            value = values.at(index);\n                            if (wantNulls || formula != null || value != null) {\n                                states.push({\n                                    formula : formula,\n                                    value   : value,\n                                    row     : row,\n                                    col     : col,\n                                    sheet   : sheet.name(),\n                                    hidden  : hiddenInfo ? (sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0) : false\n                                });\n                            }\n                        }\n                    }\n                }\n\n                return states;\n            }\n            if (ref instanceof UnionRef$1) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef$1) {\n                var val = this.nameValue(ref, fsheet, frow, fcol);\n                // XXX: revise this\n                if (val instanceof Ref$1) {\n                    return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n                }\n                return [{\n                    value: val == null ? new kendo.spreadsheet.calc.runtime.CalcError(\"NAME\") : val\n                }];\n            }\n            return [];\n        },\n\n        isMerged: function(ref) {\n            var sheet = this.workbook.sheetByName(ref.sheet);\n            return sheet.isMerged(ref);\n        },\n\n        nameValue: function(ref, fsheet, frow, fcol) {\n            var val;\n            if (ref.hasSheet()) {\n                // qualified name\n                val = this.workbook.nameValue(this._displayString(ref.print()));\n            } else {\n                // try local name\n                ref = ref.clone().setSheet(fsheet, true);\n                val = this.workbook.nameValue(this._displayString(ref.print()));\n                if (val == null) {\n                    // try global name\n                    val = this.workbook.nameValue(this._displayString(ref.name));\n                }\n                if (val == null) {\n                    // try without _displayString\n                    val = this.workbook.nameValue(ref.print()) || this.workbook.nameValue(ref.name);\n                }\n            }\n            if (val instanceof Ref$1) {\n                val = val.absolute(frow, fcol);\n            }\n            return val;\n        },\n\n        getData: function(ref, fsheet, frow, fcol, wantNulls) {\n            var single = ref instanceof CellRef$2;\n            if (ref instanceof NameRef$1) {\n                single = this.workbook.nameValue(ref.name) instanceof CellRef$2;\n            }\n            var data = this.getRefCells(ref, false, fsheet, frow, fcol, wantNulls).map(function(cell){\n                var val = cell.value;\n                if (val instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                    val = val.value;\n                }\n                return val;\n            });\n            return single ? data[0] : data;\n        },\n\n        onFormula: function(f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({ row: row, col: col });\n            if (currentFormula !== f) {\n                // could have been deleted or modified in the mean time,\n                // if the formula was asynchronous.  ignore this result.\n                return false;\n            }\n\n            var arrayRange = f.arrayFormulaRange;\n            if (arrayRange) {\n                // `value` will always be a Matrix in this case;\n                // enforced in runtime.js (Context::_resolve).  We\n                // must fill only cells in arrayRange.\n                var tlRow, tlCol;\n                var width = value.width;\n                var height = value.height;\n                sheet.forEach(arrayRange, function(row, col){\n                    if (tlRow === undefined) {\n                        tlRow = row;\n                        tlCol = col;\n                    }\n                    var vrow = row - tlRow;\n                    var vcol = col - tlCol;\n                    var val;\n                    if (vrow < height && vcol < width) {\n                        val = value.get(vrow, vcol);\n                    } else {\n                        val = new kendo.spreadsheet.calc.runtime.CalcError(\"N/A\");\n                    }\n                    sheet._value(row, col, val);\n                });\n            }\n            else {\n                // formulas may return references.  if a range or union,\n                // we'll just save the first cell.\n                if (value instanceof Ref$1) {\n                    value = this.getData(value, f.sheet, row, col);\n                    if (Array.isArray(value)) {\n                        value = value[0];\n                    }\n                    if (value === undefined) {\n                        value = null; // clear contents\n                    }\n                }\n\n                // when not saved as an array formula, a formula\n                // returning a Matrix will just save the first value.\n                if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                    value = value.get(0, 0);\n                }\n\n                sheet._value(row, col, value);\n            }\n\n            clearTimeout(sheet._formulaContextRefresh);\n            sheet._formulaContextRefresh = setTimeout(function(){\n                sheet.batch(function(){}, { layout: true });\n            }, 50);\n\n            return true;\n        },\n        _displayString: function(val) {\n            if (/^[a-z_][a-z0-9_]*$/i.test(val)) {\n                return val;\n            }\n            return \"'\" + val.replace(/\\x27/g, \"\\\\'\") + \"'\";\n        }\n    });\n\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function() {\n            return true;\n        }\n    });\n\n    spreadsheet$4.FormulaContext = FormulaContext;\n    spreadsheet$4.ValidationFormulaContext = ValidationFormulaContext;\n\n(function(kendo) {\n    'use strict';\n\n    var $ = kendo.jQuery;\n    var alphaNumRegExp = /:alphanum$/;\n\n    var ACTIONS = {\n        \"up\": \"up\",\n        \"down\": \"down\",\n        \"left\": \"left\",\n        \"right\": \"right\",\n        \"home\": \"first-col\",\n        \"end\": \"last-col\",\n        \"ctrl+left\": \"word-left\",\n        \"ctrl+right\": \"word-right\",\n        \"ctrl+up\": \"word-up\",\n        \"ctrl+down\": \"word-down\",\n        \"ctrl+home\": \"first\",\n        \"ctrl+end\": \"last\",\n        \"pageup\": \"prev-page\",\n        \"pagedown\": \"next-page\"\n    };\n\n    var ENTRY_ACTIONS = {\n        \"tab\": \"next\",\n        \"shift+tab\": \"previous\",\n        \"enter\": \"lower\",\n        \"shift+enter\": \"upper\",\n        \"delete\": \"clearContents\",\n        \"backspace\": \"clearContents\",\n        \"shift+:alphanum\": \"edit\",\n        \"alt+:alphanum\": \"edit\",\n        \":alphanum\": \"edit\",\n        \"ctrl+:alphanum\": \"ctrl\",\n        \"alt+ctrl+:alphanum\": \"edit\",\n        \":edit\": \"edit\"\n    };\n\n    var CONTAINER_EVENTS = {\n        \"wheel\": \"onWheel\",\n        \"*+mousedown\": \"onMouseDown\",\n        \"contextmenu\": \"onContextMenu\",\n        \"*+mousedrag\": \"onMouseDrag\",\n        \"*+mouseup\": \"onMouseUp\",\n        \"*+dblclick\": \"onDblClick\",\n        \"mousemove\": \"onMouseMove\"\n    };\n\n    var CLIPBOARD_EVENTS = {\n        \"pageup\": \"onPageUp\",\n        \"pagedown\": \"onPageDown\",\n        \"mouseup\": \"onMouseUp\",\n        \"*+cut\": \"onCut\",\n        \"*+paste\": \"onPaste\",\n        \"*+copy\": \"onCopy\"\n    };\n\n    var EDITOR_EVENTS = {\n        \"esc\": \"onEditorEsc\",\n        \"enter\": \"onEditorBlur\",\n        \"alt+enter\": \"insertNewline\",\n        \"shift+enter\": \"onEditorBlur\",\n        \"tab\": \"onEditorBlur\",\n        \"shift+tab\": \"onEditorBlur\",\n        \"shift+ctrl+enter\": \"onEditorArrayFormula\"\n    };\n\n    var FORMULABAR_EVENTS = $.extend({ focus: \"onEditorBarFocus\" }, EDITOR_EVENTS);\n    var FORMULAINPUT_EVENTS = $.extend({ focus: \"onEditorCellFocus\" }, EDITOR_EVENTS);\n\n    var SELECTION_MODES = {\n       cell: \"range\",\n       rowheader: \"row\",\n       columnheader: \"column\",\n       topcorner: \"sheet\",\n       autofill: \"autofill\"\n    };\n\n    function toActionSelector(selectors) {\n        return selectors.map(function(action) {\n            return '[data-action=\"' + action + '\"]';\n        }).join(\",\");\n    }\n\n    var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([ 'cut', 'copy', 'paste', 'insert-left', 'insert-right', 'insert-above', 'insert-below' ]);\n    var UNHIDE_ACTION_SELECTORS = toActionSelector([ 'unhide-row', 'unhide-column' ]);\n\n    var ACTION_KEYS = [];\n    var SHIFT_ACTION_KEYS = [];\n    var ENTRY_ACTION_KEYS = [];\n\n    for (var key in ACTIONS) {\n        ACTION_KEYS.push(key);\n        SHIFT_ACTION_KEYS.push(\"shift+\" + key);\n    }\n\n    for (key in ENTRY_ACTIONS) {\n        ENTRY_ACTION_KEYS.push(key);\n    }\n\n    CLIPBOARD_EVENTS[ACTION_KEYS] = \"onAction\";\n    CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = \"onShiftAction\";\n    CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = \"onEntryAction\";\n\n    FORMULAINPUT_EVENTS[ACTION_KEYS] = \"onEditorAction\";\n    FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = \"onEditorShiftAction\";\n\n    var Controller = kendo.Class.extend({\n        init: function(view, workbook) {\n            this.view = view;\n            this.workbook(workbook);\n            this.container = $(view.container);\n            this.clipboardElement = $(view.clipboard);\n            this.cellContextMenu = view.cellContextMenu;\n            this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n            this.colHeaderContextMenu = view.colHeaderContextMenu;\n            this.drawingContextMenu = view.drawingContextMenu;\n            this.scroller = view.scroller;\n            this.tabstrip = view.tabstrip;\n            this.sheetsbar = view.sheetsbar;\n\n            view.nameEditor.bind(\"enter\", this.onNameEditorEnter.bind(this));\n            view.nameEditor.bind(\"cancel\", this.onNameEditorCancel.bind(this));\n            view.nameEditor.bind(\"select\", this.onNameEditorSelect.bind(this));\n            view.nameEditor.bind(\"delete\", this.onNameEditorDelete.bind(this));\n\n            this.editor = view.editor;\n            this.editor.bind(\"change\", this.onEditorChange.bind(this));\n            this.editor.bind(\"activate\", this.onEditorActivate.bind(this));\n            this.editor.bind(\"deactivate\", this.onEditorDeactivate.bind(this));\n            this.editor.bind(\"update\", this.onEditorUpdate.bind(this));\n\n            $(view.scroller).on(\"scroll\", this.onScroll.bind(this));\n            this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n            $(view.scroller).on(\"mousedown\", this.onMouseDown.bind(this));\n\n            this._enableEditorEvents();\n\n            if (this.sheetsbar) {\n                this.sheetsbar.bind(\"select\", this.onSheetBarSelect.bind(this));\n                this.sheetsbar.bind(\"reorder\", this.onSheetBarReorder.bind(this));\n                this.sheetsbar.bind(\"rename\", this.onSheetBarRename.bind(this));\n                this.sheetsbar.bind(\"remove\", this.onSheetBarRemove.bind(this));\n            }\n\n            this.cellContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n            this.rowHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n            this.colHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n            this.drawingContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n\n            // this is necessary for Windows to catch prevent context menu correctly\n            this.cellContextMenu.element\n                .add(this.rowHeaderContextMenu.element)\n                .add(this.colHeaderContextMenu.element)\n                .add(this.drawingContextMenu.element)\n                .on(\"contextmenu\", false);\n\n            if (this.tabstrip) {\n                this.tabstrip.bind(\"action\", this.onCommandRequest.bind(this));\n                this.tabstrip.bind(\"dialog\", this.onDialogRequest.bind(this));\n            }\n        },\n\n        _enableEditorEvents: function (enable) {\n            if (enable === undefined || enable) {\n                this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n            } else {\n                this.keyListener.destroy();\n                this.barKeyListener.destroy();\n                this.inputKeyListener.destroy();\n            }\n        },\n\n        _execute: function(options) {\n            var result = this._workbook.execute(options);\n\n            if (options.command === \"EditCommand\" && !result) {\n                this._workbook.trigger(\"change\", { editorClose: true });\n            }\n\n            if (result) {\n                this._preventNavigation = true;\n                if (result.reason === \"error\") {\n                    this.editor.deactivate(true); // make sure we don't call any change hooks\n                    this.view.showError(result, function(){\n                        // we only get here in case of a validation error when the user decided to retry.\n                        this.activateEditor(false);\n                        // reset to last input from user\n                        this.editor.value(this._lastEditorValue);\n                        // however, set _value manually such that it'll detect change properly.  ugly :-\\\n                        this.editor._value = this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());\n                        // seems like a nice UX to have the whole input selected\n                        this.editor.select();\n                    }.bind(this));\n                } else {\n                    this.view.openDialog(result.reason);\n                }\n            }\n\n            return result;\n        },\n\n        _activeTooltip: function() {\n            return this._workbook.activeSheet().activeCell().simplify().toString();\n        },\n\n        onContextMenuSelect: function(e) {\n            var action = $(e.item).data(\"action\");\n            var command;\n            switch(action) {\n              case \"cut\":\n                command = { command: \"ToolbarCutCommand\", options: { workbook: this._workbook } };\n                break;\n              case \"copy\":\n                command = { command: \"ToolbarCopyCommand\", options: { workbook: this._workbook } };\n                break;\n              case \"paste\":\n                command = { command: \"ToolbarPasteCommand\", options: { workbook: this._workbook } };\n                break;\n              case \"delete-drawing\":\n                command = { command: \"DeleteDrawingCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n                break;\n              case \"bring-to-front\":\n                command = { command: \"BringToFrontCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n                break;\n              case \"send-to-back\":\n                command = { command: \"SendToBackCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n                break;\n              case \"unmerge\":\n                command = { command: \"MergeCellCommand\", options: { value: \"unmerge\" } };\n                break;\n              case \"merge\":\n                this.view.openDialog(\"merge\");\n                break;\n              case \"hide-row\":\n                command = { command: \"HideLineCommand\", options: { axis: \"row\" } };\n                break;\n              case \"hide-column\":\n                command = { command: \"HideLineCommand\", options: { axis: \"column\" } };\n                break;\n              case \"unhide-row\":\n                command = { command: \"UnHideLineCommand\", options: { axis: \"row\" } };\n                break;\n              case \"unhide-column\":\n                command = { command: \"UnHideLineCommand\", options: { axis: \"column\" } };\n                break;\n              case \"delete-row\":\n                command = { command: \"DeleteRowCommand\" };\n                break;\n              case \"delete-column\":\n                command = { command: \"DeleteColumnCommand\" };\n                break;\n            }\n\n            if (command) {\n                this._execute(command);\n            }\n        },\n\n        onSheetBarRemove: function(e) {\n            var sheet = this._workbook.sheetByName(e.name);\n\n            //TODO: move to model!\n            if (!sheet) {\n                return;\n            }\n\n            this._workbook.removeSheet(sheet);\n        },\n\n        destroy: function() {\n            this.listener.destroy();\n            this._enableEditorEvents(false);\n            this.keyListener.destroy();\n            this.inputKeyListener.destroy();\n        },\n\n        onSheetBarSelect: function(e) {\n            var sheet;\n            var workbook = this._workbook;\n\n            if (e.isAddButton) {\n                if (this._workbook.trigger(\"insertSheet\")) {\n                    return;\n                }\n\n                sheet = workbook.insertSheet();\n            } else {\n                sheet = workbook.sheetByName(e.name);\n            }\n\n            //TODO: move to model\n            if (workbook.activeSheet().name() !== sheet.name()) {\n                if (this._workbook.trigger(\"selectSheet\", { sheet: sheet })) {\n                    return;\n                }\n\n                if (!this.editor.canInsertRef(false)) {\n                    this.editor.deactivate();\n                }\n\n                workbook.activeSheet(sheet);\n            }\n        },\n\n        onSheetBarReorder: function(e) {\n            var workbook = this._workbook;\n            var sheet = workbook.sheetByIndex(e.oldIndex);\n            var activeSheet = workbook.activeSheet();\n            var activeSheetName = activeSheet.name();\n\n            workbook.moveSheetToIndex(sheet, e.newIndex);\n\n            if (activeSheetName !== sheet.name()) {\n                if (workbook.trigger(\"selectSheet\", { sheet: sheet })) {\n                    workbook.activeSheet(activeSheet);\n                    return;\n                }\n\n                if (!this.editor.canInsertRef(false)) {\n                    this.editor.deactivate();\n                }\n\n                workbook.activeSheet(sheet);\n            }\n        },\n\n        onSheetBarRename: function(e) {\n            var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n\n            if (this._workbook.sheetByName(e.name)) {\n                this.view.showError({ reason: \"error\", type: \"duplicateSheetName\" });\n                return;\n            }\n\n            this._workbook.renameSheet(sheet, e.name);\n\n            this.clipboardElement.focus();\n        },\n\n        sheet: function(sheet) {\n            this.navigator = sheet.navigator();\n            this.axisManager = sheet.axisManager();\n        },\n\n        workbook: function(workbook) {\n            this._workbook = workbook;\n            this.clipboard = workbook.clipboard();\n            workbook.bind(\"commandRequest\", this.onCommandRequest.bind(this));\n        },\n\n        refresh: function() {\n            var editor = this.editor;\n            var workbook = this._workbook;\n            var sheet = workbook.activeSheet();\n\n            this._viewPortHeight = this.view.scroller.clientHeight;\n            this.navigator.height(this._viewPortHeight);\n\n            if (!editor.isActive() && !this.isEditorDisabled) {\n                editor.enable(sheet.selection().enable() !== false);\n                this.resetEditorValue();\n            }\n\n            var ref = sheet.selection()._ref.simplify();\n            var def = this._workbook.nameForRef(ref, sheet.name());\n            this.view.nameEditor.value(def.name);\n        },\n\n        onScroll: function() {\n            this.view.render({ scroll: true });\n        },\n\n        onWheel: function(event) {\n            var deltaX = event.originalEvent.deltaX;\n            var deltaY = event.originalEvent.deltaY;\n\n            if (event.originalEvent.deltaMode === 1) {\n                deltaX *= 10;\n                deltaY *= 10;\n            }\n\n            this.scrollWith(deltaX, deltaY);\n\n            event.preventDefault();\n        },\n\n        onAction: function(event, action) {\n            var sheet = this._workbook.activeSheet();\n            sheet._activeDrawing = null;\n            this.navigator.moveActiveCell(ACTIONS[action]);\n            event.preventDefault();\n        },\n\n        onPageUp: function() {\n            this.scrollDown(-this._viewPortHeight);\n        },\n\n        onPageDown: function() {\n            this.scrollDown(this._viewPortHeight);\n        },\n\n        onEntryAction: function(event, action) {\n            var sheet = this._workbook.activeSheet();\n\n            if (event.mod) {\n                var key = String.fromCharCode(event.keyCode);\n                var shouldPrevent = true;\n\n                switch(key) {\n                  case \"A\":\n                    sheet._activeDrawing = null;\n                    this.navigator.selectAll();\n                    break;\n                  case \"Y\":\n                    this._workbook.undoRedoStack.redo();\n                    break;\n                  case \"Z\":\n                    this._workbook.undoRedoStack.undo();\n                    break;\n                  default:\n                    shouldPrevent = false;\n                    break;\n                }\n                if (shouldPrevent) {\n                    event.preventDefault();\n                }\n            } else {\n                var disabled = sheet.selection().enable() === false;\n                var casual = action !== \":edit\";\n\n                if (action == \"delete\" || action == \"backspace\") {\n                    if (sheet._activeDrawing) {\n                        this._execute({\n                            command: \"DeleteDrawingCommand\",\n                            options: { drawing: sheet._activeDrawing }\n                        });\n                    } else if (!disabled) {\n                        this._execute({ command: \"ClearContentCommand\" });\n                    }\n                    event.preventDefault();\n                } else if (alphaNumRegExp.test(action) || !casual) {\n                    sheet._activeDrawing = null;\n                    if (disabled) {\n                        event.preventDefault();\n                        return;\n                    }\n                    if (casual) {\n                        this.editor.value(\"\");\n                    }\n                    this.activateEditor(casual);\n                } else {\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                    event.preventDefault();\n                }\n            }\n        },\n\n        onShiftAction: function(event, action) {\n            this.navigator.modifySelection(ACTIONS[action.replace(\"shift+\", \"\")], this.appendSelection);\n            event.preventDefault();\n        },\n\n        onMouseMove: function(event) {\n            var sheet = this._workbook.activeSheet();\n\n            if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                return;\n            }\n\n            var object = this.objectAt(event);\n            if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n                sheet.positionResizeHandle(object.ref);\n            } else {\n                sheet.removeResizeHandle();\n            }\n\n            sheet._renderComment(object.type == \"cell\" ? object.ref : null);\n        },\n\n        onMouseDown: function(event) {\n            var object = this.objectAt(event);\n            if (object.pane) {\n                this.originFrame = object.pane;\n            }\n\n            if (this._startResizingDrawing(event, object)) {\n                event.stopPropagation();\n                return;\n            }\n\n            var sheet = this._workbook.activeSheet();\n            var win = this.container.closest('[' + kendo.attr(\"role\") + '=\"window\"]');\n            if (win.length) {\n                win = kendo.widgetInstance(win);\n                if (win && win.options.modal) {\n                    event.stopPropagation();\n                }\n            }\n\n            sheet._activeDrawing = null;\n            if (object.type === \"drawing\") {\n                sheet._activeDrawing = object.drawing;\n                object.copy = object.drawing.clone();\n                object.startBox = sheet.drawingBoundingBox(object.copy);\n                sheet.startDragging(object);\n                sheet.triggerChange({ dragging: true });\n                event.preventDefault();\n                return;\n            }\n\n            if (object.type === \"outside\") {\n                event.preventDefault();\n                event.stopPropagation();\n                return;\n            }\n\n            if (object.type === \"editor\") {\n                // XXX: canceling the edits, because they might not\n                // validate.  Not sure it's the Right Thing.\n                this.onEditorEsc();\n                this.openCustomEditor();\n                event.preventDefault();\n                return;\n            }\n\n            if (this.editor.canInsertRef(false) && object.ref) {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n                event.preventDefault();\n                return;\n            } else {\n                this._preventNavigation = false;\n                this.editor.deactivate();\n                if (this._preventNavigation) {\n                    return;     // validation error\n                }\n            }\n\n            if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n                sheet.startResizing({ x: object.x, y: object.y });\n                event.preventDefault();\n                return;\n            }\n\n            if (object.type === \"filtericon\") {\n                this.openFilterMenu(event);\n                event.preventDefault();\n                return;\n            }\n\n            this._selectionMode = SELECTION_MODES[object.type];\n            this.appendSelection = event.mod;\n            this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n        },\n\n        _startResizingDrawing: function(event) {\n            var handle = $(event.target).closest(\".k-spreadsheet-drawing-handle\");\n            if (handle.length) {\n                var location = this.translateCoords(event);\n                var direction = handle.data(\"direction\");\n                var sheet = this._workbook.activeSheet();\n                var drawing = sheet._activeDrawing;\n                sheet.startDragging({\n                    pane     : this.originFrame,\n                    drawing  : drawing,\n                    copy     : drawing.clone(),\n                    startBox : sheet.drawingBoundingBox(drawing),\n                    resize   : direction,\n                    //aspect   : drawing.width / drawing.height,\n                    startX   : location.x,\n                    startY   : location.y\n                });\n                return true;\n            }\n        },\n\n        onContextMenu: function(event) {\n            var sheet = this._workbook.activeSheet();\n\n            event.preventDefault();\n\n            if (sheet.resizingInProgress() || sheet.draggingInProgress()) {\n                return;\n            }\n\n            this.cellContextMenu.close();\n            this.colHeaderContextMenu.close();\n            this.rowHeaderContextMenu.close();\n            this.drawingContextMenu.close();\n\n            var menu;\n\n            var object = this.objectAt(event);\n\n            if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n                return;\n            }\n\n            if (object.ref) {\n                this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n            } else if (object.type == \"drawing\") {\n                this.navigator.selectDrawingForContextMenu(object.drawing);\n            }\n\n            var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n            var showUnhide = false;\n            var showUnmerge = false;\n\n            if (object.type == \"columnheader\") {\n                menu = this.colHeaderContextMenu;\n                showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n            } else if (object.type == \"rowheader\") {\n                menu = this.rowHeaderContextMenu;\n                showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n            } else if (object.type == \"drawing\") {\n                menu = this.drawingContextMenu;\n            } else {\n                menu = this.cellContextMenu;\n                showUnmerge = this.navigator.selectionIncludesMergedCells();\n            }\n\n            menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n            menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n            menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n\n            // avoid the immediate close\n            setTimeout(function() {\n                menu.open(event.pageX, event.pageY);\n            });\n        },\n\n        prevent: function(event) {\n            event.preventDefault();\n        },\n\n        constrainResize: function(type, ref) {\n            var sheet = this._workbook.activeSheet();\n            var resizeHandle = sheet.resizeHandlePosition();\n\n            return !resizeHandle || type === \"outside\" || type === \"topcorner\" || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n        },\n\n        _dragDrawing: function(event) {\n            var sheet = this._workbook.activeSheet();\n            var drag = sheet.draggingInProgress();\n            if (!drag) {\n                return false;\n            }\n\n            var location = this.translateCoords(event);\n            var drawing = drag.drawing;\n            var deltaX = location.x - drag.startX;\n            var deltaY = location.y - drag.startY;\n\n            if (drag.resize == \"SE\") {\n                if (drag.aspect) {\n                    if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                        drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                        drawing.height = drawing.width / drag.aspect;\n                    } else {\n                        drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                        drawing.width = drawing.height * drag.aspect;\n                    }\n                } else {\n                    drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                    drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                }\n            }\n            else if (drag.resize == \"E\") {\n                drawing.width = Math.max(drag.copy.width + deltaX, 20);\n            }\n            else if (drag.resize == \"S\") {\n                drawing.height = Math.max(drag.copy.height + deltaY, 20);\n            }\n            else if (drag.resize == \"N\") {\n                if (drag.copy.height - deltaY > 20) {\n                    drawing.height = drag.copy.height - deltaY;\n                    drawing.offsetY = drag.copy.offsetY + deltaY;\n                }\n            }\n            else if (drag.resize == \"W\") {\n                if (drag.copy.width - deltaX > 20) {\n                    drawing.width = drag.copy.width - deltaX;\n                    drawing.offsetX = drag.copy.offsetX + deltaX;\n                }\n            }\n            else if (drag.resize == \"NE\") {\n                drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                if (drag.copy.height - deltaY > 20) {\n                    drawing.height = drag.copy.height - deltaY;\n                    drawing.offsetY = drag.copy.offsetY + deltaY;\n                }\n            }\n            else if (drag.resize == \"SW\") {\n                drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                if (drag.copy.width - deltaX > 20) {\n                    drawing.width = drag.copy.width - deltaX;\n                    drawing.offsetX = drag.copy.offsetX + deltaX;\n                }\n            }\n            else if (drag.resize == \"NW\") {\n                if (drag.copy.height - deltaY > 20) {\n                    drawing.height = drag.copy.height - deltaY;\n                    drawing.offsetY = drag.copy.offsetY + deltaY;\n                }\n                if (drag.copy.width - deltaX > 20) {\n                    drawing.width = drag.copy.width - deltaX;\n                    drawing.offsetX = drag.copy.offsetX + deltaX;\n                }\n            }\n            // just moving (no resize)\n            else {\n                drawing.offsetX = drag.copy.offsetX + deltaX;\n                drawing.offsetY = drag.copy.offsetY + deltaY;\n            }\n\n            sheet.triggerChange({ dragging: true });\n\n            return true;\n        },\n\n        onMouseDrag: function(event) {\n            if (this._selectionMode === \"sheet\") {\n                return;\n            }\n\n            var location = { clientX: event.clientX, clientY: event.clientY };\n            var sheet = this._workbook.activeSheet();\n\n            if (this._dragDrawing(event)) {\n                return;\n            }\n\n            var object = this.objectAt(location);\n\n            if (sheet.resizingInProgress()) {\n\n                if (!this.constrainResize(object.type, object.ref)) {\n                    sheet.resizeHintPosition({ x: object.x, y: object.y });\n                }\n\n                return;\n            }\n\n            if (object.type === \"outside\") {\n                this.startAutoScroll(object);\n                return;\n            }\n\n            if (this.originFrame === object.pane) {\n                this.selectToLocation(location);\n            } else { // cross frame selection\n                var frame = this.originFrame._grid;\n\n                if (object.x > frame.right) {\n                    kendo.scrollLeft(this);\n                }\n\n                if (object.y > frame.bottom) {\n                    this.scrollTop();\n                }\n\n                if (object.y < frame.top || object.x < frame.left) {\n                    this.startAutoScroll(object, location);\n                } else {\n                    this.selectToLocation(location);\n                }\n            }\n\n            event.preventDefault();\n        },\n\n        onMouseUp: function(event) {\n            var sheet = this._workbook.activeSheet();\n            sheet.completeResizing();\n            sheet.completeDragging();\n\n            this.navigator.completeSelection();\n            this.stopAutoScroll();\n\n            var editor = this.editor.activeEditor();\n            if (!editor) {\n                return;\n            }\n            var el = event.target;\n            while (el) {\n                if (el === editor.element[0]) {\n                    return;\n                }\n                el = el.parentNode;\n            }\n\n            var object = this.objectAt(event);\n            if (object && object.ref && editor.canInsertRef(false)) {\n                editor.refAtPoint(sheet);\n                sheet._setFormulaSelections(editor.highlightedRefs());\n            }\n        },\n\n        onDblClick: function(event) {\n            var object = this.objectAt(event);\n            var disabled = this._workbook.activeSheet().selection().enable() === false;\n\n            if (object.type !== \"cell\" || disabled) {\n                return;\n            }\n\n            var sel = this._workbook.activeSheet().selection();\n            this.activateEditor(!sel.value() && !sel.formula());\n            this.onEditorUpdate();\n        },\n\n        onCut: function(e) {\n            var self = this;\n            setTimeout(function(){\n                self.clipboard.menuInvoked = (e === undefined);\n                self._execute({\n                    command: \"CutCommand\",\n                    options: { workbook: self.view._workbook, event: e.originalEvent || e }\n                });\n            });\n        },\n\n        clipBoardValue: function() {\n            return this.clipboardElement.html();\n        },\n\n        _pasteImage: function(blob) {\n            var self = this;\n            var img = new window.Image();\n            img.src = window.URL.createObjectURL(blob);\n            img.onload = function() {\n                self._execute({\n                    command: \"InsertImageCommand\",\n                    options: {\n                        blob: blob,\n                        width: img.width,\n                        height: img.height\n                    }\n                });\n            };\n            setTimeout(function(){\n                window.URL.revokeObjectURL(img.src);\n            }, 10);\n        },\n\n        onPaste: function(e) {\n            var self = this;\n            var html = \"\";\n            var plain = \"\";\n            self.clipboard.menuInvoked = (e === undefined);\n            if (e) {\n                var clipboardData = e.originalEvent.clipboardData;\n                if (clipboardData && clipboardData.getData) {\n                    e.preventDefault();\n                    var hasHTML = false;\n                    var hasPlainText = false;\n                    // Firefox uses DOMStringList, needs special handling\n                    if (window.DOMStringList && clipboardData.types instanceof window.DOMStringList) {\n                        hasHTML = clipboardData.types.contains(\"text/html\");\n                        hasPlainText = clipboardData.types.contains(\"text/plain\");\n                    } else if (Array.isArray(clipboardData.types)) {\n                        hasHTML = clipboardData.types.indexOf(\"text/html\") >= 0;\n                        hasPlainText = clipboardData.types.indexOf(\"text/plain\") >= 0;\n                    } else {\n                        hasHTML = /text\\/html/.test(clipboardData.types);\n                        hasPlainText = /text\\/plain/.test(clipboardData.types);\n                    }\n                    if (hasHTML) {\n                        html = clipboardData.getData('text/html').trim();\n                    }\n                    if (hasPlainText) {\n                        plain = clipboardData.getData('text/plain').trim();\n                    }\n                    if (!html && !plain && clipboardData.items && clipboardData.items.length) {\n                        for (var i = 0; i < clipboardData.items.length; ++i) {\n                            var item = clipboardData.items[i];\n                            if (item.kind == \"file\" && /^image\\/(?:png|jpe?g|gif)$/i.test(item.type)) {\n                                return self._pasteImage(item.getAsFile());\n                            }\n                        }\n                    }\n                } else {\n                    if (window.clipboardData.files && window.clipboardData.files.length) {\n                        var file = window.clipboardData.files[0];\n                        if (/^image\\/(?:png|jpe?g|gif)$/i.test(file.type)) {\n                            return self._pasteImage(file);\n                        }\n                    }\n\n                    plain = window.clipboardData.getData(\"Text\");\n                    if (plain) {\n                        plain = plain.trim();\n                    }\n\n                    // There's no way to get the HTML clipboard contents in IE other than letting\n                    // the browser handle the event (it pastes into our clipboardElement), and then\n                    // we can read the HTML from there.  Need to allow a small timeout for this.\n                    self.clipboardElement.empty();\n                    setTimeout(function(){\n                        html = self.clipboardElement.html();\n                        if (html || plain) {\n                            self.clipboard.external({ html: html, plain: plain });\n                            self._execute({\n                                command: \"PasteCommand\",\n                                options: { workbook: self.view._workbook, event: e.originalEvent || e }\n                            });\n                        }\n                    });\n\n                    return;\n                }\n            } else {\n                if (kendo.support.browser.msie) {\n                    self.clipboardElement.trigger(\"focus\").select();\n                    document.execCommand('paste');\n                    return;\n                } else {\n                    self.clipboard.menuInvoked = true;\n                }\n            }\n\n            if (!html && !plain) {\n                return;\n            }\n            self.clipboard.external({ html: html, plain:plain });\n            self._execute({\n                command: \"PasteCommand\",\n                options: { workbook: self.view._workbook, event: e.originalEvent || e }\n            });\n        },\n\n        onCopy: function(e) {\n            this.clipboard.menuInvoked = (e === undefined);\n            this._execute({\n                command: \"CopyCommand\",\n                options: { workbook: this.view._workbook, event: e.originalEvent || e }\n            });\n        },\n\n////////////////////////////////////////////////////////////////////\n\n        scrollTop: function() {\n            this.scroller.scrollTop = 0;\n        },\n\n        scrollLeft: function() {\n            this.scroller.scrollLeft = 0;\n        },\n\n        scrollDown: function(value) {\n            this.scroller.scrollTop += value;\n        },\n\n        scrollRight: function(value) {\n            this.scroller.scrollLeft += value;\n        },\n\n        scrollWith: function(right, down) {\n            this.scroller.scrollTop += down;\n            this.scroller.scrollLeft += right;\n        },\n\n        translateCoords: function(location) {\n            var box = this.container[0].getBoundingClientRect();\n            return {\n                x: location.clientX - box.left,\n                y: location.clientY - box.top\n            };\n        },\n\n        objectAt: function(location, noDrawing) {\n            if (!location) {\n                return;\n            }\n            location = this.translateCoords(location);\n            return this.view.objectAt(location.x, location.y, noDrawing);\n        },\n\n        selectToLocation: function(cellLocation) {\n            var object = this.objectAt(cellLocation, true);\n\n            if (object.pane && object.ref) { // cell, rowheader or columnheader\n                this.extendSelection(object);\n                this.lastKnownCellLocation = cellLocation;\n                this.originFrame = object.pane;\n            }\n\n            this.stopAutoScroll();\n        },\n\n        extendSelection: function(object) {\n            this.navigator.extendSelection(object.ref, this._selectionMode);\n        },\n\n        autoScroll: function() {\n            var x = this._autoScrollTarget.x;\n            var y = this._autoScrollTarget.y;\n            var boundaries = this.originFrame._grid;\n            var scroller = this.view.scroller;\n            var scrollStep = 8;\n\n            var scrollLeft = scroller.scrollLeft;\n            var scrollTop = scroller.scrollTop;\n\n            if (x < boundaries.left) {\n                this.scrollRight(-scrollStep);\n            }\n            if (x > boundaries.right) {\n                this.scrollRight(scrollStep);\n            }\n            if (y < boundaries.top) {\n                this.scrollDown(-scrollStep);\n            }\n            if (y > boundaries.bottom) {\n                this.scrollDown(scrollStep);\n            }\n\n            if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                this.selectToLocation(this.finalLocation);\n            } else {\n                this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n            }\n        },\n\n        startAutoScroll: function(viewObject, location) {\n            if (!this._scrollInterval) {\n                this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n            }\n\n            this.finalLocation = location || this.lastKnownCellLocation;\n\n            this._autoScrollTarget = viewObject;\n        },\n\n        stopAutoScroll: function() {\n            clearInterval(this._scrollInterval);\n            this._scrollInterval = null;\n        },\n\n        openCustomEditor: function() {\n            this.view.openCustomEditor();\n        },\n\n        openFilterMenu: function(event) {\n            var object = this.objectAt(event);\n            var sheet = this._workbook.activeSheet();\n            var column = sheet.filterColumn(object.ref);\n            var filterMenu = this.view.createFilterMenu(column);\n\n            filterMenu.bind(\"action\", this.onCommandRequest.bind(this));\n            filterMenu.bind(\"action\", filterMenu.close.bind(filterMenu));\n\n            filterMenu.openFor(event.target, event);\n        },\n\n////////////////////////////////////////////////////////////////////\n\n        _saveEditorValue: function(arrayFormula) {\n            var sheet = this.editor._range.sheet();\n            var value = this.editor.value();\n            if (this._workbook.activeSheet() !== sheet) {\n                // remove highlighted refs (XXX: which are mostly wrong, BTW)\n                this._workbook.activeSheet()._setFormulaSelections();\n                // go back to the original sheet\n                this._workbook.activeSheet(sheet);\n            }\n            sheet.isInEditMode(false);\n            this._lastEditorValue = value;\n            this._execute({\n                command: \"EditCommand\",\n                options: {\n                    value: value,\n                    arrayFormula: arrayFormula\n                }\n            });\n        },\n\n        onEditorChange: function() {\n            this._saveEditorValue(false);\n        },\n\n        onEditorArrayFormula: function() {\n            this._saveEditorValue(true);\n            this.editor.deactivate(true);\n        },\n\n        onEditorActivate: function() {\n            var workbook = this._workbook;\n            var sheet = workbook.activeSheet();\n\n            sheet._setFormulaSelections(this.editor.highlightedRefs());\n            sheet.isInEditMode(true);\n        },\n\n        onEditorDeactivate: function() {\n            var sheet = this._workbook.activeSheet();\n\n            sheet.isInEditMode(false);\n            sheet._setFormulaSelections([]);\n        },\n\n        onEditorUpdate: function() {\n            this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n        },\n\n        onEditorBarFocus: function() {\n            var disabled = this._workbook.activeSheet().selection().enable() === false;\n            if (disabled) {\n                return;\n            }\n            this.editor\n                .activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n        },\n\n        onEditorCellFocus: function() {\n            this.editor.scale();\n        },\n\n        onEditorEsc: function() {\n            this.resetEditorValue();\n            this.editor.deactivate();\n\n            this.clipboardElement.trigger(\"focus\");\n        },\n\n        insertNewline: function(e) {\n            e.preventDefault();\n            this.editor.insertNewline();\n        },\n\n        onEditorBlur: function(_, action) {\n            if (this.editor.isFiltered()) {\n                return;\n            }\n\n            this._preventNavigation = false;\n            this.editor.deactivate();\n\n            if (!this._preventNavigation) {\n                this.clipboardElement.trigger(\"focus\");\n                this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n            }\n        },\n\n        onEditorAction: function(event, action) {\n            var editor = this.editor;\n            var sheet = this._workbook.activeSheet();\n\n            if (this._casualEditing && /^(?:up|right|down|left)$/.test(action)) {\n                this.deactivateEditor();\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            }\n            else if (editor.canInsertRef(true)) {\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                editor.activeEditor().refAtPoint(sheet);\n                sheet._setFormulaSelections(editor.highlightedRefs());\n                event.preventDefault();\n            }\n        },\n\n        onEditorShiftAction: function(event, action) {\n            var editor = this.editor;\n            var sheet = this._workbook.activeSheet();\n\n            if (editor.canInsertRef(true)) {\n                this.navigator.modifySelection(ACTIONS[action.replace(\"shift+\", \"\")], this.appendSelection);\n\n                editor.activeEditor().refAtPoint(sheet);\n                sheet._setFormulaSelections(editor.highlightedRefs());\n\n                event.preventDefault();\n            }\n        },\n\n////////////////////////////////////////////////////////////////////\n        resetEditorValue: function() {\n            var sheet = this._workbook.activeSheet();\n            var ref = sheet.activeCell();\n            var input = this._workbook._inputForRef(ref);\n            var x = sheet.range(ref).intersectingArrayFormula();\n            if (x) {\n                input = \"=\" + x.formula;\n            }\n            this.editor.value(input, !!x);\n        },\n\n        activateEditor: function(casual) {\n            // This flag will be false when F2 has been pressed, and\n            // true when editing is \"casual\", i.e., user just started\n            // typing.  In this case we want arrow keys to do cell\n            // navigation rather than move the cursor.\n            // https://github.com/telerik/kendo-ui-core/issues/3644\n            this._casualEditing = casual;\n\n            this.editor.activate({\n                range: this._workbook.activeSheet().selection(),\n                rect: this.view.activeCellRectangle(),\n                tooltip: this._activeTooltip()\n            }).focus();\n        },\n\n        deactivateEditor: function() {\n            this.view.editor.deactivate();\n        },\n\n        onCommandRequest: function(e) {\n            if (e.command) {\n                this._execute(e);\n            } else {\n                this._workbook.undoRedoStack[e.action]();\n            }\n        },\n\n        onDialogRequest: function(e) {\n            var additionalOptions = {\n                pdfExport: this._workbook.options.pdf,\n                excelExport: this._workbook.options.excel\n            };\n\n            if (e.options) {\n                $.extend(true, e.options, additionalOptions);\n            } else {\n                e.options = additionalOptions;\n            }\n\n            this.view.openDialog(e.name, e.options);\n        },\n\n        onNameEditorEnter: function() {\n            var ref;\n            var workbook = this._workbook;\n            var sheet = workbook.activeSheet();\n            var name = this.view.nameEditor.value();\n\n            // 1. does it look like a reference, or already defined\n            // name?  If so, just select it (don't define/modify any\n            // names)\n            ref = kendo.spreadsheet.calc.parseReference(name, true) || workbook.nameValue(name);\n            if (ref instanceof kendo.spreadsheet.Ref) {\n                if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                    // reference points to another sheet, select it if found\n                    var tmp = workbook.sheetByName(ref.sheet);\n                    if (tmp) {\n                        workbook.activeSheet(tmp);\n                        sheet = tmp;\n                    }\n                }\n                sheet.range(ref).select();\n                return;\n            }\n\n            ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n\n            // XXX: should we check if a name is already defined for this range, and update it instead?\n            // Excel just adds a new one, and provides a more complete Name Manager dialog.\n            //var def = workbook.nameForRef(ref, sheet.name());\n\n            // just define new name\n            this._execute({\n                command: \"DefineNameCommand\",\n                options: { name: name, value: ref }\n            });\n\n            this.clipboardElement.trigger(\"focus\");\n        },\n        onNameEditorCancel: function() {\n            this.clipboardElement.trigger(\"focus\");\n        },\n        onNameEditorSelect: function(ev) {\n            var name = ev.name;\n            var workbook = this._workbook;\n            var sheet = workbook.activeSheet();\n            var ref = workbook.nameValue(name);\n            if (ref instanceof kendo.spreadsheet.Ref) {\n                if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                    // reference points to another sheet, select it if found\n                    var tmp = workbook.sheetByName(ref.sheet);\n                    if (tmp) {\n                        workbook.activeSheet(tmp);\n                        sheet = tmp;\n                    }\n                }\n                sheet.range(ref).select();\n                return;\n            }\n            this.clipboardElement.trigger(\"focus\");\n        },\n        onNameEditorDelete: function(ev) {\n            this._execute({\n                command: \"DeleteNameCommand\",\n                options: { name: ev.name }\n            });\n            this.clipboardElement.trigger(\"focus\");\n        }\n    });\n\n    kendo.spreadsheet.Controller = Controller;\n})(window.kendo);\n\n(function(kendo) {\n\n    var $ = kendo.jQuery;\n    var CellRef = kendo.spreadsheet.CellRef;\n    var DOT = \".\";\n    var RESIZE_HANDLE_WIDTH = 7;\n    var EDIT_BUTTON_WIDTH = 20;\n    var ERROR = \"Error\";\n    var viewClassNames = {\n        view: \"k-spreadsheet-view\",\n        fixedContainer: \"k-spreadsheet-fixed-container\",\n        editContainer: \"k-spreadsheet-edit-container\",\n        scroller: \"k-spreadsheet-scroller\",\n        viewSize: \"k-spreadsheet-view-size\",\n        clipboard: \"k-spreadsheet-clipboard\",\n        cellEditor: \"k-spreadsheet-cell-editor\",\n        barEditor: \"k-spreadsheet-editor\",\n        topCorner: \"k-spreadsheet-top-corner\",\n        filterHeadersWrapper: \"k-filter-wrapper\",\n        filterRange: \"k-filter-range\",\n        filterButton: \"k-spreadsheet-filter\",\n        filterButtonSelected: \"k-selected\",\n        horizontalResize: \"k-horizontal-resize\",\n        verticalResize: \"k-vertical-resize\",\n        icon: \"k-icon\",\n        iconFilterDefault: \"caret-alt-down\",\n        sheetsBar: \"k-spreadsheet-sheets-bar\",\n        sheetsBarActive: \"k-spreadsheet-sheets-bar-active\",\n        sheetsBarInactive: \"k-spreadsheet-sheets-bar-inactive\",\n        cellContextMenu: \"k-spreadsheet-cell-context-menu\",\n        rowHeaderContextMenu: \"k-spreadsheet-row-header-context-menu\",\n        colHeaderContextMenu: \"k-spreadsheet-col-header-context-menu\",\n        drawingContextMenu: \"k-spreadsheet-drawing-context-menu\"\n    };\n\n    kendo.spreadsheet.messages.view = {\n        nameBox: \"Name Box\",\n        formulaInput: \"Formula Input\",\n        errors: {\n            openUnsupported: \"Unsupported format. Please select an .xlsx file.\",\n            shiftingNonblankCells: \"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.\",\n            insertColumnWhenRowIsSelected: \"Cannot insert column when all columns are selected.\",\n            insertRowWhenColumnIsSelected: \"Cannot insert row when all rows are selected.\",\n            filterRangeContainingMerges: \"Cannot create a filter within a range containing merges\",\n            sortRangeContainingMerges: \"Cannot sort a range containing merges\",\n            cantSortMultipleSelection: \"Cannot sort multiple selection\",\n            cantSortNullRef: \"Cannot sort empty selection\",\n            cantSortMixedCells: \"Cannot sort range containing cells of mixed shapes\",\n            validationError: \"The value that you entered violates the validation rules set on the cell.\",\n            cannotModifyDisabled: \"Cannot modify disabled cells.\",\n            insertRowBelowLastRow: \"Cannot insert row below the last row.\",\n            insertColAfterLastCol: \"Cannot insert column to the right of the last column.\"\n        },\n        tabs: {\n            home: \"Home\",\n            insert: \"Insert\",\n            data: \"Data\"\n        }\n    };\n\n    kendo.spreadsheet.messages.menus = {\n        \"cut\"          : \"Cut\",\n        \"copy\"         : \"Copy\",\n        \"paste\"        : \"Paste\",\n        \"merge\"        : \"Merge\",\n        \"unmerge\"      : \"Unmerge\",\n        \"delete\"       : \"Delete\",\n        \"hide\"         : \"Hide\",\n        \"unhide\"       : \"Unhide\",\n        \"bringToFront\" : \"Bring to front\",\n        \"sendToBack\"   : \"Send to back\"\n    };\n\n    function selectElementContents(el) {\n        var sel = window.getSelection();\n        sel.removeAllRanges();\n\n        var range = document.createRange();\n        range.selectNodeContents(el);\n\n        sel.addRange(range);\n    }\n\n    function cellBefore(table, row) {\n        var cells = table.trs[row].children;\n        return cells[cells.length - 2];\n    }\n\n    function cellAbove(table, row) {\n        var prevRow = table.trs[row-1];\n        var index = table.trs[row].children.length-1;\n\n        if (prevRow && index >= 0) {\n            return prevRow.children[index];\n        }\n    }\n\n    function cellBorder(value) {\n        return (value.size || 1) + \"px solid \" + (value.color || \"#000\");\n    }\n\n    function asURL(link) {\n        if (!/:\\/\\//.test(link)) {\n            link = \"http://\" + link;\n        }\n        return link;\n    }\n\n    function drawCell(collection, cell, cls, showGrid) {\n        function maybeLink(el) {\n            var link = cell.link;\n            if (!link) {\n                if (typeof cell.value == \"object\") {\n                    link = cell.value.link;\n                }\n            }\n            if (link) {\n                var style = {\n                    textDecoration: \"none\"\n                };\n                if (cell.color) {\n                    style.color = cell.color;\n                }\n                if (cell.underline) {\n                    style.textDecoration = \"underline\";\n                }\n                return kendo.dom.element(\"a\", {\n                    href   : asURL(link),\n                    style  : style,\n                    target : \"_blank\" // XXX: customizable?\n                }, el ? [ el ] : []);\n            }\n            return el;\n        }\n\n        var shouldDraw = (cell.value != null || (cell.validation != null && !cell.validation.value) || // jshint ignore:line\n                          cell.background || cell.merged || cell.comment || cell.dBorders);\n        if (!cls && !shouldDraw) {\n            return;\n        }\n\n        var style = { background: [] };\n        var background = cell.background;\n        if (background) {\n            var defaultBorder = background;\n            if (showGrid) {\n                // darken\n                defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                defaultBorder.v *= 0.9;\n                defaultBorder = defaultBorder.toCssRgba();\n            }\n            defaultBorder = cellBorder({ color: defaultBorder });\n            style.outline = defaultBorder;\n        }\n\n        if (cell.dBorders) {\n            if (cell.dBorders.type & 2) {\n                style.background.push(\"linear-gradient(to top left, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) calc(50% - \" +\n                                      cell.dBorders.size + \"px), \" + cell.dBorders.color + \" 50%, rgba(0, 0, 0, 0) calc(50% + \" +\n                                      cell.dBorders.size + \"px), rgba(0, 0, 0, 0) 100%)\");\n            }\n            if (cell.dBorders.type & 1) {\n                style.background.push(\"linear-gradient(to top right, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) calc(50% - \" +\n                                      cell.dBorders.size + \"px), \" + cell.dBorders.color + \" 50%, rgba(0, 0, 0, 0) calc(50% + \" +\n                                      cell.dBorders.size + \"px), rgba(0, 0, 0, 0) 100%)\");\n            }\n        }\n\n        if (background) {\n            style.background.push(background);\n        }\n\n        if (cell.color) {\n            style.color = cell.color;\n        }\n\n        if (cell.fontFamily) {\n            style.fontFamily = cell.fontFamily;\n        }\n\n        if (cell.underline) {\n            style.textDecoration = \"underline\";\n        }\n\n        if (cell.italic) {\n            style.fontStyle = \"italic\";\n        }\n\n        if (cell.textAlign) {\n            style.textAlign = cell.textAlign;\n        }\n\n        if (cell.bold) {\n            style.fontWeight = \"bold\";\n        }\n\n        if (cell.fontSize) {\n            style.fontSize = cell.fontSize + \"px\";\n        }\n\n        if (cell.wrap === true) {\n            style.whiteSpace = \"pre-wrap\";\n            style.overflowWrap = \"break-word\";\n            style.wordWrap = \"break-word\";\n        } else {\n            style.whiteSpace = \"pre\";\n            style.overflowWrap = \"normal\";\n            style.wordWrap = \"normal\";\n        }\n\n        style.left = (cell.left + 1) + \"px\";\n        style.top = (cell.top + 1) + \"px\";\n        style.width = (cell.width - 1) + \"px\";\n        style.height = (cell.height - 1) + \"px\";\n\n        var data = cell.value, type = typeof data, format = cell.format;\n        if (!format && type == \"number\" && data != Math.floor(data)) {\n            format = \"0.##############\";\n        }\n        if (format && data != null) {\n            data = kendo.spreadsheet.formatting.format(data, format);\n            if (data.__dataType) {\n                type = data.__dataType;\n            }\n        } else if (data != null) {\n            if (cell.html) {\n                data = kendo.dom.html(data);\n            } else {\n                data = kendo.dom.text(data);\n            }\n        }\n\n        if (!style.textAlign) {\n            switch (type) {\n              case \"number\":\n              case \"date\":\n              case \"percent\":\n              case \"currency\":\n                style.textAlign = \"right\";\n                break;\n              case \"boolean\":\n                style.textAlign = \"center\";\n                break;\n            }\n        }\n\n        // defined in print.js\n        kendo.spreadsheet.draw.applyIndent(cell, style);\n\n        var classNames = [ paneClassNames.cell ];\n\n        if (cls) {\n            classNames.push(cls);\n        }\n        if (cell.enable === false) {\n            classNames.push(\"k-disabled\");\n        }\n        if (cell.merged) {\n            classNames.push(\"k-spreadsheet-merged-cell\");\n            if (!cell.enable) {\n                collection.push(kendo.dom.element(\"div\", {\n                    className: \"k-spreadsheet-disabled-mask\",\n                    style: {\n                        left: (cell.left + 1) + \"px\",\n                        top: (cell.top + 1) + \"px\",\n                        width: (cell.width - 1) + \"px\",\n                        height: (cell.height - 1) + \"px\"\n                    }\n                }));\n            }\n        }\n        if (cell.comment) {\n            classNames.push(\"k-spreadsheet-has-comment\");\n        }\n\n        var verticalAlign = cell.verticalAlign || \"bottom\";\n\n        if (verticalAlign && data) {\n            data = kendo.dom.element(\"div\", { className: \"k-vertical-align-\" + verticalAlign }, [ maybeLink(data) ]);\n        } else {\n            data = maybeLink(data);\n        }\n\n        if (style.background.length) {\n            style.background = style.background.join(\",\");\n        } else {\n            delete style.background;\n        }\n\n        var children = data ? [ data ] : [];\n        var properties = {\n            style: style\n        };\n        var validation = cell.validation;\n        if (validation && !validation.value) {\n            children.push(kendo.dom.element(\"span\", { className: \"k-dirty\" }));\n            classNames.push(\"k-dirty-cell\");\n\n            properties.title = validation.message;\n        }\n        properties.className = classNames.join(\" \");\n\n        var div = kendo.dom.element(\"div\", properties, children);\n        collection.push(div);\n        return div;\n    }\n\n    function addCell(table, row, cell) {\n        var style = {};\n\n        if (cell.background) {\n            style.backgroundColor = cell.background;\n        }\n\n        if (cell.color) {\n            style.color = cell.color;\n        }\n\n        if (cell.fontFamily) {\n            style.fontFamily = cell.fontFamily;\n        }\n\n        if (cell.underline) {\n            style.textDecoration = \"underline\";\n        }\n\n        if (cell.italic) {\n            style.fontStyle = \"italic\";\n        }\n\n        if (cell.textAlign) {\n            style.textAlign = cell.textAlign;\n        }\n\n        if (cell.verticalAlign) {\n            style.verticalAlign = (cell.verticalAlign === \"center\") ? \"middle\" : cell.verticalAlign;\n        }\n\n        if (cell.bold) {\n            style.fontWeight = \"bold\";\n        }\n\n        if (cell.fontSize) {\n            style.fontSize = cell.fontSize + \"px\";\n        }\n\n        if (cell.wrap === true) {\n            style.whiteSpace = \"pre-wrap\";\n        }\n\n        if (cell.borderRight) {\n            style.borderRight = cellBorder(cell.borderRight);\n        } else if (cell.background) {\n            style.borderRightColor = cell.background;\n        }\n\n        if (cell.borderBottom) {\n            style.borderBottom = cellBorder(cell.borderBottom);\n        } else if (cell.background) {\n            style.borderBottomColor = cell.background;\n        }\n\n        var data = cell.value, type = typeof data, format = cell.format;\n        if (!format && type == \"number\" && data != Math.floor(data)) {\n            format = \"0.##############\";\n        }\n        if (format && data != null) {\n            data = kendo.spreadsheet.formatting.format(data, format);\n            if (data.__dataType) {\n                type = data.__dataType;\n            }\n        }\n\n        var attrs = { style: style };\n\n        if (!style.textAlign) {\n            switch (type) {\n              case \"number\":\n              case \"date\":\n              case \"percent\":\n              case \"currency\":\n                style.textAlign = \"right\";\n                break;\n              case \"boolean\":\n                style.textAlign = \"center\";\n                break;\n            }\n        }\n\n        if (!/^(?:string|undefined)$/.test(type)) {\n            // provide original value and number format for better\n            // interoperability with google sheets and libre office.\n            attrs.sdval = cell.value;\n            attrs[\"data-sheets-value\"] = JSON.stringify({ 1: 3, 3: cell.value });\n            if (format) {\n                attrs.sdnum = format;\n                attrs[\"data-sheets-numberformat\"] = JSON.stringify({ 1: 2, 2: format, 3: 1 });\n            }\n        }\n        if (cell.formula) {\n            attrs[\"data-sheets-formula\"] = \"=\" + cell.formula.print();\n        }\n\n        var className = null;\n\n        if (cell.enable === false) {\n            className = \"k-disabled\";\n        }\n\n        var td = table.addCell(row, data, attrs, className, cell.validation);\n\n        var border, sibling;\n\n        if (cell.borderLeft) {\n            sibling = cellBefore(table, row);\n            border = cellBorder(cell.borderLeft);\n            if (sibling && border) {\n                sibling.attr.style.borderRight = border;\n            }\n        } else if (cell.background) {\n            style.borderLeftColor = cell.background;\n        }\n\n        if (cell.borderTop) {\n            sibling = cellAbove(table, row);\n            border = cellBorder(cell.borderTop);\n            if (sibling && border) {\n                sibling.attr.style.borderBottom = border;\n            }\n        } else if (cell.background) {\n            style.borderTopColor = cell.background;\n        }\n\n        return td;\n    }\n\n    var HtmlTable = kendo.Class.extend({\n        init: function() {\n            this.cols = [];\n            this.trs = [];\n            this._height = 0;\n            this._width = 0;\n        },\n\n        addColumn: function(width) {\n            this._width += width;\n\n            var col = kendo.dom.element(\"col\", { style: { width: width + \"px\" } });\n\n            col.visible = width > 0;\n\n            this.cols.push(col);\n        },\n\n        addRow: function(height) {\n            var attr = null;\n\n            attr = { style: { height: height + \"px\" } };\n\n            this._height += height;\n\n            var tr = kendo.dom.element(\"tr\", attr);\n\n            tr.visible = height > 0;\n\n            this.trs.push(tr);\n        },\n\n        addCell: function(rowIndex, text, attrs, className, validation) {\n            if (text === null || text === undefined) {\n                text = \"\";\n            }\n            if (!(text instanceof kendo.dom.Node)) {\n                text = kendo.dom.text(text);\n            }\n\n            var children = [ text ];\n\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element(\"span\", { className: \"k-dirty\" }));\n\n                className = (className || \"\") + (className ? \" \" : \"\") + \"k-dirty-cell\";\n                attrs.title = validation.message;\n            }\n\n            if (className) {\n                attrs.className = className;\n            }\n            var td = kendo.dom.element(\"td\", attrs, children);\n\n            this.trs[rowIndex].children.push(td);\n            return td;\n        },\n\n        toDomTree: function(x, y, className) {\n            this.trs = this.trs.filter(function(tr) {\n                return tr.visible;\n            });\n\n            var offset = 0;\n            this.cols = this.cols.filter(function(col, ci) {\n                if (!col.visible) {\n                    this.trs.forEach(function(tr) {\n                        tr.children.splice(ci - offset, 1);\n                    });\n                    offset++;\n                }\n\n                return col.visible;\n            }, this);\n\n            return kendo.dom.element(\"table\", {\n                style: { left: x + \"px\", top: y + \"px\", height: this._height + \"px\", width: this._width + \"px\" },\n                className: className,\n                role: \"presentation\"\n            },[\n                kendo.dom.element(\"colgroup\", null, this.cols),\n                kendo.dom.element(\"tbody\", null, this.trs)\n            ]);\n        }\n    });\n\n    var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' +\n        '<li data-action=cut>#: messages.cut #</li>' +\n        '<li data-action=copy>#: messages.copy #</li>' +\n        '<li data-action=paste>#: messages.paste #</li>' +\n        '<li class=\"k-separator\"></li>' +\n        '<li data-action=merge>#: messages.merge #</li>' +\n        '<li data-action=unmerge>#: messages.unmerge #</li>' +\n    '</ul>';\n\n    var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' +\n        '<li data-action=cut>#: messages.cut #</li>' +\n        '<li data-action=copy>#: messages.copy #</li>' +\n        '<li data-action=paste>#: messages.paste #</li>' +\n        '<li class=\"k-separator\"></li>' +\n        '<li data-action=\"delete-row\">#: messages.delete #</li>'+\n        '<li data-action=\"hide-row\">#: messages.hide #</li>'+\n        '<li data-action=\"unhide-row\">#: messages.unhide #</li>'+\n    '</ul>';\n\n    var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' +\n        '<li data-action=cut>#: messages.cut #</li>' +\n        '<li data-action=copy>#: messages.copy #</li>' +\n        '<li data-action=paste>#: messages.paste #</li>' +\n        '<li class=\"k-separator\"></li>' +\n        '<li data-action=\"delete-column\">#: messages.delete #</li>'+\n        '<li data-action=\"hide-column\">#: messages.hide #</li>'+\n        '<li data-action=\"unhide-column\">#: messages.unhide #</li>'+\n    '</ul>';\n\n    var DRAWING_CONTEXT_MENU = '<ul class=\"#=classNames.drawingContextMenu#\">' +\n        // '<li data-action=cut>#: messages.cut #</li>' +\n        // '<li data-action=copy>#: messages.copy #</li>' +\n        // '<li data-action=paste>#: messages.paste #</li>' +\n        // '<li class=\"k-separator\"></li>' +\n        '<li data-action=\"bring-to-front\">#: messages.bringToFront #</li>' +\n        '<li data-action=\"send-to-back\">#: messages.sendToBack #</li>' +\n        '<li class=\"k-separator\"></li>' +\n        '<li data-action=\"delete-drawing\">#: messages.delete #</li>' +\n    '</ul>';\n\n    kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n\n    var VIEW_CONTENTS = '<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' +\n        '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' +\n        CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU + DRAWING_CONTEXT_MENU;\n\n    function within(value, min, max) {\n        return value >= min && value <= max;\n    }\n\n    var View = kendo.Class.extend({\n        init: function(element, options) {\n            var classNames = View.classNames;\n\n            this.element = element;\n\n            this.options = $.extend(true, {\n                messages: kendo.spreadsheet.messages.view\n            }, this.options, options);\n\n            this._chrome();\n\n            this._dialogs = [];\n\n            element.append(kendo.template(VIEW_CONTENTS)({\n                classNames: classNames,\n                messages: kendo.spreadsheet.messages.menus\n            }));\n\n            this._formulaInput();\n\n            this.wrapper =      element.find(DOT + classNames.view);\n            this.container =    element.find(DOT + classNames.fixedContainer)[0];\n            this.scroller =     element.find(DOT + classNames.scroller)[0];\n            this.clipboard =    element.find(DOT + classNames.clipboard);\n\n            this.viewSize = $(this.scroller.firstChild);\n\n            this.tree = new kendo.dom.Tree(this.container);\n            this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n\n            this.editor = new kendo.spreadsheet.SheetEditor(this);\n\n            this._sheetsbar();\n\n            var contextMenuConfig = {\n                target: element,\n                animation: false,\n                showOn: \"never\" // this is just an invalid event name to prevent the show\n            };\n\n            this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n\n            this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n\n            this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n\n            this.drawingContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.drawingContextMenu), contextMenuConfig);\n        },\n\n        enableClipboard: function(enable) {\n            this.isClipboardDeactivated = !enable;\n\n            if (enable) {\n                this.clipboard.attr(\"contenteditable\", enable);\n            } else {\n                this.clipboard.removeAttr(\"contenteditable\");\n            }\n        },\n\n        _resize: function() {\n            var actionBar = $(this.formulaBar.element).parents(\".k-spreadsheet-action-bar\");\n            var outerHeight = kendo._outerHeight;\n            var tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n            var formulaBarHeight = actionBar ? outerHeight(actionBar) : 0;\n            var sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n\n            this.wrapper.height(\n                this.element.height() -\n                    (tabstripHeight + formulaBarHeight + sheetsBarHeight)\n            );\n\n            if (this.tabstrip) {\n                this.tabstrip.quickAccessAdjust();\n            }\n        },\n\n        _chrome: function() {\n            var wrapper = $(\"<div class='k-spreadsheet-action-bar' />\").prependTo(this.element);\n\n            var nameEditor = $(\"<div class='k-spreadsheet-name-editor' />\").appendTo(wrapper);\n            this.nameEditor = new kendo.spreadsheet.NameEditor(nameEditor, this.options);\n\n            var formulaBar = $(\"<div />\").appendTo(wrapper);\n            this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar, this.options);\n\n            if (this.options.toolbar) {\n                this._tabstrip();\n            }\n        },\n\n        _formulaInput: function() {\n            var editor = this.element.find(DOT + View.classNames.cellEditor);\n\n            this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, {\n                autoScale: true\n            });\n        },\n\n        _sheetsbar: function() {\n            if (this.options.sheetsbar) {\n                var options = $.extend(true, {\n                    openDialog: this.openDialog.bind(this)\n                }, this.options.sheetsbar);\n\n                this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), options);\n            }\n        },\n\n        _tabstrip: function() {\n            var messages = this.options.messages.tabs;\n            var options = $.extend(true, { home: true, insert: true, data: true }, this.options.toolbar);\n            var tabs = [];\n\n            if (this.tabstrip) {\n                this.tabstrip.destroy();\n                this.element.children(\".k-tabstrip\").remove();\n            }\n\n            for (var name in options) {\n                if (options[name] === true || options[name] instanceof Array) {\n                    tabs.push({ id: name, text: messages[name], content: \"\" });\n                }\n            }\n\n            this.tabstrip = new kendo.spreadsheet.TabStrip($(\"<div />\").prependTo(this.element), {\n                animation: false,\n                dataTextField: \"text\",\n                dataContentField: \"content\",\n                dataSource: tabs,\n                toolbarOptions: options,\n                view: this\n            });\n\n            this.tabstrip.select(0);\n        },\n\n        _executeCommand: function(e) {\n            this._sheet.trigger(\"commandRequest\", e);\n        },\n\n        workbook: function(workbook) {\n            this._workbook = workbook;\n            workbook._view = this;\n            this.nameEditor._workbook = workbook;\n        },\n\n        sheet: function(sheet) {\n            this._sheet = sheet;\n        },\n\n        activeCellRectangle: function() {\n            return this.cellRectangle(this._sheet._viewActiveCell());\n        },\n\n        _rectangle: function(pane, ref) {\n            return pane._grid.boundingRectangle(ref.toRangeRef());\n        },\n\n        isColumnResizer: function(x, pane, col) {\n            // relative to content\n            x -= this._sheet._grid._headerWidth;\n\n            // add scroll if pane is not frozen\n            if (!pane._grid.columns.frozen) {\n                x += this.scroller.scrollLeft;\n            }\n\n            col = this._sheet._grid._columns.locate(0, col, function(w){\n                return Math.abs(x - w) <= RESIZE_HANDLE_WIDTH/2;\n            });\n\n            return col !== null && !this._sheet.isHiddenColumn(col) ? col : null;\n        },\n\n        isRowResizer: function(y, pane, row) {\n            // relative to content\n            y -= this._sheet._grid._headerHeight;\n\n            // add scroll if pane is not frozen\n            if (!pane._grid.rows.frozen) {\n                y += this.scroller.scrollTop;\n            }\n\n            row = this._sheet._grid._rows.locate(0, row, function(h){\n                return Math.abs(y - h) <= RESIZE_HANDLE_WIDTH/2;\n            });\n\n            return row !== null && !this._sheet.isHiddenRow(row) ? row : null;\n        },\n\n        isFilterIcon: function(x, y, pane, ref) {\n            var self = this;\n            var theGrid = pane._grid;\n            var scrollTop = theGrid.rows.frozen ? 0 : self.scroller.scrollTop;\n            var scrollLeft = theGrid.columns.frozen ? 0 : self.scroller.scrollLeft;\n\n            x -= self._sheet._grid._headerWidth - scrollLeft;\n            y -= self._sheet._grid._headerHeight - scrollTop;\n\n            return kendo.util.withExit(function(exit){\n                self._sheet.forEachFilterHeader(ref, function(ref) {\n                    var rect = self._rectangle(pane, ref);\n                    if (pane.filterIconRect(rect).intersects(x, y)) {\n                        exit(true);\n                    }\n                });\n            });\n        },\n\n        isAutoFill: function(x, y, pane) {\n            var selection = this._sheet.select();\n\n            if (selection.size > 1) {\n                return false;\n            }\n\n            x -= this._sheet._grid._headerWidth;\n            y -= this._sheet._grid._headerHeight;\n\n            if (!pane._grid.columns.frozen) {\n                x += this.scroller.scrollLeft;\n            }\n\n            if (!pane._grid.rows.frozen) {\n                y += this.scroller.scrollTop;\n            }\n\n            var rectangle = this._rectangle(pane, selection);\n\n            return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n        },\n\n        isEditButton: function(x, y, pane) {\n            var ed = this._sheet.activeCellCustomEditor();\n            if (ed) {\n                var r = this.activeCellRectangle();\n                // XXX: hard-coded button width (20)\n\n                if (y >= r.top && y <= r.bottom) {\n                    this._editorInLastColumn = pane._editorInLastColumn;\n                    return pane._editorInLastColumn ? x < r.left && x >= r.left - EDIT_BUTTON_WIDTH\n                        : x > r.right && x <= r.right + EDIT_BUTTON_WIDTH;\n                }\n            }\n        },\n\n        drawingAt: function(x, y, pane) {\n            x -= this._sheet._grid._headerWidth;\n            y -= this._sheet._grid._headerHeight;\n\n            if (!pane._grid.columns.frozen) {\n                x += this.scroller.scrollLeft;\n            }\n\n            if (!pane._grid.rows.frozen) {\n                y += this.scroller.scrollTop;\n            }\n\n            var sheet = this._sheet;\n            var drawings = this._sheet._drawings;\n            for (var i = drawings.length; --i >= 0;) {\n                var d = drawings[i];\n                var box = sheet.drawingBoundingBox(d);\n                if (box.intersects(x, y)) {\n                    return {\n                        drawing: d,\n\n                        // also include how far is the drawing's\n                        // top-left from the mouse position, as it's\n                        // not easy to compute some place else.\n                        drx: box.left - x,\n                        dry: box.top - y\n                    };\n                }\n            }\n        },\n\n        objectAt: function(x, y, noDrawing) {\n            var grid = this._sheet._grid;\n            var object, pane;\n\n            if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                object = { type: \"outside\" };\n            } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                object = { type: \"topcorner\" };\n            } else {\n                pane = this.paneAt(x, y);\n\n                if (!pane) {\n                    object = { type: \"outside\" };\n                } else {\n                    if (!noDrawing) {\n                        var drawing = this.drawingAt(x, y, pane);\n                        if (drawing) {\n                            return {\n                                type: \"drawing\",\n                                drawing: drawing.drawing,\n                                drx: drawing.drx,\n                                dry: drawing.dry,\n                                pane: pane,\n                                startX: x,\n                                startY: y\n                            };\n                        }\n                    }\n\n                    var row = pane._grid.rows.indexVisible(y, this.scroller.scrollTop);\n                    var column = pane._grid.columns.indexVisible(x, this.scroller.scrollLeft);\n\n                    var type = \"cell\";\n                    var ref = new CellRef(row, column);\n                    var selecting = this._sheet.selectionInProgress();\n\n                    if (this.isAutoFill(x, y, pane)) {\n                        type = \"autofill\";\n                    } else if (this.isFilterIcon(x, y, pane, ref)) {\n                        type = \"filtericon\";\n                    } else if (!selecting && x < grid._headerWidth) {\n                        type = \"rowheader\";\n                        if ((row = this.isRowResizer(y, pane, row)) !== null) {\n                            ref = new CellRef(row, -Infinity);\n                            type = \"rowresizehandle\";\n                        }\n                    } else if (!selecting && y < grid._headerHeight) {\n                        type = \"columnheader\";\n                        if ((column = this.isColumnResizer(x, pane, column)) !== null) {\n                            ref = new CellRef(-Infinity, column);\n                            type = \"columnresizehandle\";\n                        }\n                    } else if (this.isEditButton(x, y, pane)) {\n                        type = \"editor\";\n                    }\n\n                    object = { type: type, ref: ref };\n                }\n            }\n\n            object.pane = pane;\n            object.x = x;\n            object.y = y;\n            return object;\n        },\n\n        paneAt: function(x, y) {\n            return this.panes.filter(function paneLocationWithin(pane) {\n                var grid = pane._grid;\n                return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n            })[0];\n        },\n\n        containingPane: function(cell) {\n            return this.panes.filter(function(pane) {\n                if (pane._grid.contains(cell)) {\n                    return true;\n                }\n                return false;\n            })[0];\n        },\n\n        cellRectangle: function(cell) {\n            var theGrid = this.containingPane(cell)._grid;\n            var rectangle = this._sheet._grid.rectangle(cell);\n\n            return rectangle.offset(\n                theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft),\n                theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop)\n            );\n        },\n\n        refresh: function(reason) {\n            var sheet = this._sheet;\n\n            if (this.tabstrip) {\n                this.tabstrip.refreshTools(sheet.range(sheet.activeCell()), reason);\n            }\n\n            if (reason.sheetSelection && this.sheetsbar) {\n                this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n            }\n\n            this._resize();\n\n            //TODO: refresh sheets list on sheetSelection\n            this.viewSize[0].style.height = sheet._grid.totalHeight() + \"px\";\n            this.viewSize[0].style.width = sheet._grid.totalWidth() + \"px\";\n\n            if (reason.layout) {\n                var frozenColumns = sheet.frozenColumns();\n                var frozenRows = sheet.frozenRows();\n\n                // main or bottom or right pane\n                this.panes = [ this._pane(frozenRows, frozenColumns) ];\n\n                // left pane\n                if (frozenColumns > 0) {\n                    this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                }\n\n                // top pane\n                if (frozenRows > 0) {\n                    this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                }\n\n                // left-top \"fixed\" pane\n                if (frozenRows > 0 && frozenColumns > 0) {\n                    this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                }\n            }\n\n            if (reason.filter) {\n                this._destroyFilterMenu();\n            }\n\n            if (reason.activeCell) {\n                this._focus = sheet.activeCell().toRangeRef();\n            }\n        },\n\n        createFilterMenu: function(column) {\n            this._destroyFilterMenu();\n\n            var sheet = this._sheet;\n            var ref = sheet.filter().ref;\n            var range = new kendo.spreadsheet.Range(ref, sheet);\n            var element = $(\"<div />\").appendTo(this.element);\n            var options = { column: column, range: range };\n            var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n\n            this._filterMenu = filterMenu;\n\n            return filterMenu;\n        },\n\n        selectClipboardContents: function() {\n            if (!this.isClipboardDeactivated) {\n                this.clipboard.focus();\n                selectElementContents(this.clipboard[0]);\n            }\n        },\n\n        scrollIntoView: function(cell) {\n            var willScroll = false;\n            var theGrid = this.containingPane(cell)._grid;\n\n            var boundaries = theGrid.scrollBoundaries(cell);\n\n            var scroller = this.scroller;\n            var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n            var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n\n            if (boundaries.top < scrollTop) {\n                willScroll = true;\n                scroller.scrollTop = boundaries.scrollTop;\n            }\n\n            if (boundaries.bottom > scrollTop) {\n                willScroll = true;\n                scroller.scrollTop = boundaries.scrollBottom;\n            }\n\n            if (boundaries.left < scrollLeft) {\n                willScroll = true;\n                scroller.scrollLeft = boundaries.scrollLeft;\n            }\n\n            if (boundaries.right > scrollLeft) {\n                willScroll = true;\n                scroller.scrollLeft = boundaries.scrollRight;\n            }\n\n            return willScroll;\n        },\n\n        _destroyDialog: function() {\n            this._dialogs.pop();\n        },\n\n        openCustomEditor: function() {\n            var self = this;\n            var cell = self._sheet.activeCell().first();\n            var editor = self._sheet.activeCellCustomEditor();\n            var range = self._sheet.range(cell);\n            editor.edit({\n                range      : range,\n                rect       : self.activeCellRectangle(),\n                view       : this,\n                validation : this._sheet.validation(cell),\n                alignLeft  : this._editorInLastColumn,\n                callback   : function(value, parse){\n                    self._executeCommand({\n                        command: \"EditCommand\",\n                        options: {\n                            operatingRange: range,\n                            editRange: range,\n                            property: parse ? \"input\" : \"value\",\n                            value: value\n                        }\n                    });\n                }\n            });\n        },\n\n        openDialog: function(name, options) {\n            var that = this,\n                sheet = this._sheet;\n\n            return sheet.withCultureDecimals(function(){\n                var dialog = kendo.spreadsheet.dialogs.create(name, options);\n\n                if (dialog) {\n                    dialog.bind(\"action\", that._executeCommand.bind(that));\n                    dialog.bind(\"deactivate\", () => {\n                        dialog.destroy();\n                        that._destroyDialog();\n                    });\n                    that._dialogs.push(dialog);\n\n                    var ref = sheet.activeCell();\n                    var range = new kendo.spreadsheet.Range(ref, sheet);\n\n                    dialog.open(range);\n                    return dialog;\n                }\n            }.bind(this));\n        },\n\n        showError: function(options, reopenEditor) {\n            var currentDialogs = this._dialogs;\n            var errorMessages = this.options.messages.errors;\n            var hasOpenedError = false;\n\n            if (currentDialogs.length > 0) {\n                currentDialogs.forEach(function(dialog) {\n                    if (dialog.options && dialog.options.title === ERROR) {\n                        hasOpenedError = true;\n                    }\n                });\n            }\n            if (hasOpenedError) {\n                return;\n            }\n\n            var focusButton = function(e) {\n                var cont = e.sender.dialog().element;\n                cont.find(\".k-button\").first().trigger(\"focus\");\n                cont.find(\".k-button, input\").on(\"keydown\", function(ev){\n                    if (ev.keyCode == kendo.keys.ESC) {\n                        e.sender.close();\n                    }\n                });\n            };\n\n            var onClose = function(e) {\n                var dlg = e.sender;\n                this.selectClipboardContents();\n                if (dlg._retry && reopenEditor) {\n                    reopenEditor();\n                }\n            }.bind(this);\n\n            if (kendo.spreadsheet.dialogs.registered(options.type)) {\n                var dialogOptions = {\n                    close: onClose\n                };\n\n                if (options.type === \"validationError\") {\n                    dialogOptions = $.extend(dialogOptions, {\n                        title: options.title || \"Error\",\n                        text: options.body ? options.body : errorMessages[options.type],\n                        activate: focusButton\n                    });\n                }\n\n                this.openDialog(options.type, dialogOptions);\n            } else {\n                this.openDialog(\"message\", {\n                    title : options.title || \"Error\",\n                    text  : options.body ? options.body : errorMessages[options.type],\n                    activate: focusButton,\n                    close: onClose\n                });\n            }\n        },\n\n        destroy: function() {\n            this._dialogs.forEach(function(dialog) {\n                dialog.destroy();\n            });\n\n            if (this.cellContextMenu) {\n                this.cellContextMenu.destroy();\n            }\n\n            this.rowHeaderContextMenu.destroy();\n            this.colHeaderContextMenu.destroy();\n            this.drawingContextMenu.destroy();\n\n            this.cellContextMenu = this.rowHeaderContextMenu =\n                                   this.colHeaderContextMenu =\n                                   this.drawingContextMenu = null;\n\n            if (this.tabstrip) {\n                this.tabstrip.destroy();\n                this.tabstrip = null;\n            }\n\n            if (this.nameEditor) {\n                this.nameEditor.destroy();\n            }\n\n            if (this.formulaInput) {\n                this.formulaInput.destroy();\n            }\n\n            if (this.formulaBar) {\n                this.formulaBar.destroy();\n            }\n\n            this._destroyFilterMenu();\n        },\n\n        _destroyFilterMenu: function() {\n            if (this._filterMenu) {\n                this._filterMenu.destroy();\n                this._filterMenu = undefined;\n                this._filterMenuColumn = undefined;\n            }\n        },\n\n        render: function(reason) {\n            if (!this.element.is(\":visible\")) {\n                return;\n            }\n            var sheet = this._sheet;\n            var focus = sheet.focus();\n            var scrollbarSize = kendo.support.scrollbar();\n            var contentWidth = this.wrapper[0].clientWidth - scrollbarSize;\n            var contentHeight = this.wrapper[0].clientHeight - scrollbarSize;\n\n            if (focus && this.scrollIntoView(focus)) {\n                return;\n            }\n\n            var resizeDirection =\n                !sheet.resizingInProgress() ? \"none\" :\n                sheet.resizeHandlePosition().col === -Infinity ? \"column\" :\n                \"row\";\n\n            this.wrapper\n                .toggleClass(viewClassNames.editContainer, this.editor.isActive())\n                .toggleClass(viewClassNames.horizontalResize, resizeDirection == \"row\")\n                .toggleClass(viewClassNames.verticalResize, resizeDirection == \"column\");\n\n            var grid = sheet._grid;\n            var content = [];\n            var args = {\n                scroller: this.scroller,\n                toplevelElements: content,\n                contentWidth: contentWidth,\n                contentHeight: contentHeight\n            };\n            this.panes.forEach(function(pane) {\n                content.push(pane.render(args));\n            });\n\n            var topCorner = kendo.dom.element(\"div\", {\n                style: { width: grid._headerWidth + \"px\", height: grid._headerHeight + \"px\" },\n                className: View.classNames.topCorner\n            });\n\n            content.push(topCorner);\n\n            if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                content.push(this.renderResizeHint());\n            }\n\n            this.tree.render(content);\n\n            $(this.container).css({\n                width: contentWidth,\n                height: contentHeight\n            });\n\n            if (this.editor.isActive()) {\n                this.editor.toggleTooltip(this.activeCellRectangle());\n            } else if (!(reason.resize ||\n                         reason.comment ||\n                         sheet.selectionInProgress() ||\n                         sheet.resizingInProgress() ||\n                         sheet.draggingInProgress() ||\n                         sheet.isInEditMode())) {\n                this.renderClipboardContents();\n            }\n        },\n\n        // this renders the big blue line during resizing\n        renderResizeHint: function() {\n            var sheet = this._sheet;\n            var ref = sheet.resizeHandlePosition();\n\n            var horizontal = ref.col !== -Infinity;\n\n            var style;\n            if (horizontal) {\n                style = {\n                    height: this.scroller.clientHeight + \"px\",\n                    width: RESIZE_HANDLE_WIDTH + \"px\",\n                    left: sheet.resizeHintPosition().x + \"px\",\n                    top: \"0px\"\n                };\n            } else {\n                style = {\n                    height: RESIZE_HANDLE_WIDTH + \"px\",\n                    width: this.scroller.clientWidth + \"px\",\n                    top: sheet.resizeHintPosition().y + \"px\",\n                    left: \"0px\"\n                };\n            }\n\n            var classNames = Pane.classNames;\n\n            return kendo.dom.element(\"div\", {\n                className: classNames.resizeHint + (!horizontal ? \" \" + classNames.resizeHintVertical : \"\"),\n                style: style\n            },[\n                kendo.dom.element(\"div\", { className: classNames.resizeHintHandle }),\n                kendo.dom.element(\"div\", { className: classNames.resizeHintMarker })\n            ]);\n        },\n\n        renderClipboardContents: function() {\n            var sheet = this._sheet;\n            var grid = sheet._grid;\n\n            // if (sheet._activeDrawing && sheet._activeDrawing.image) {\n            //     var url = this._workbook.imageUrl(sheet._activeDrawing.image);\n            //     var img = kendo.dom.element(\"img\", {\n            //         src: url,\n            //         style: {\n            //             width: sheet._activeDrawing.width + \"px\",\n            //             height: sheet._activeDrawing.height + \"px\"\n            //         }\n            //     });\n            //     this.clipboardContents.render([ img ]);\n            //     this.selectClipboardContents();\n            //     return;\n            // }\n\n            var selection = grid.normalize(sheet.select().toRangeRef());\n            var status = this._workbook.clipboard().canCopy();\n            if (status.canCopy === false && status.multiSelection) {\n                this.clipboardContents.render([]);\n                this.selectClipboardContents();\n                return;\n            }\n\n            selection = sheet.trim(selection);\n\n            var table = new HtmlTable();\n\n            var selectionView = grid.rangeDimensions(selection);\n\n            selectionView.rows.forEach(function(height) {\n                table.addRow(height);\n            });\n\n            selectionView.columns.forEach(function(width) {\n                table.addColumn(width);\n            });\n\n            var tmp = sheet._getMergedCells(selection);\n            var primaryMergedCells = tmp.primary;\n            var secondaryMergedCells = tmp.secondary;\n\n            sheet.forEach(selection, function(row, col, cell) {\n                var location = new CellRef(row, col).print();\n\n                if (!secondaryMergedCells[location]) {\n                    var td = addCell(table, row - selection.topLeft.row, cell);\n\n                    var mergedCell = primaryMergedCells[location];\n\n                    if (mergedCell) {\n                        td.attr.colspan = mergedCell.width();\n                        td.attr.rowspan = mergedCell.height();\n                    }\n                }\n            });\n\n            if (kendo.support.browser.msie) {\n                this.clipboard.empty();\n            }\n\n            this.clipboardContents.render([ table.toDomTree(0, 0, \"kendo-clipboard-\" + this._workbook.clipboard()._uid) ]);\n\n            this.selectClipboardContents();\n        },\n\n        _pane: function(row, column, rowCount, columnCount) {\n            var pane = new Pane(this._sheet, this._sheet._grid.pane({ row: row, column: column, rowCount: rowCount, columnCount: columnCount }));\n            pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n            return pane;\n        }\n    });\n\n    var paneClassNames = {\n        cell: \"k-spreadsheet-cell\",\n        vaxis: \"k-spreadsheet-vaxis\",\n        haxis: \"k-spreadsheet-haxis\",\n        vborder: \"k-spreadsheet-vborder\",\n        hborder: \"k-spreadsheet-hborder\",\n        rowHeader: \"k-spreadsheet-row-header\",\n        columnHeader: \"k-spreadsheet-column-header\",\n        pane: \"k-spreadsheet-pane\",\n        data: \"k-spreadsheet-data\",\n        mergedCell: \"k-spreadsheet-merged-cell\",\n        mergedCellsWrapper: \"k-merged-cells-wrapper\",\n        activeCell: \"k-spreadsheet-active-cell\",\n        selection: \"k-spreadsheet-selection\",\n        selectionWrapper: \"k-selection-wrapper\",\n        autoFillWrapper: \"k-auto-fill-wrapper\",\n        single: \"k-single\",\n        top: \"k-top\",\n        right: \"k-right\",\n        bottom: \"k-bottom\",\n        left: \"k-left\",\n        resizeHandle: \"k-resize-handle\",\n        columnResizeHandle: \"k-column-resize-handle\",\n        rowResizeHandle: \"k-row-resize-handle\",\n        resizeHint: \"k-resize-hint\",\n        resizeHintHandle: \"k-resize-hint-handle\",\n        resizeHintMarker: \"k-resize-hint-marker\",\n        resizeHintVertical: \"k-resize-hint-vertical\",\n        selectionHighlight: \"k-spreadsheet-selection-highlight\",\n        series: [\n            \"k-series-a\",\n            \"k-series-b\",\n            \"k-series-c\",\n            \"k-series-d\",\n            \"k-series-e\",\n            \"k-series-f\"\n        ]\n    };\n\n    var Pane = kendo.Class.extend({\n        init: function(sheet, grid) {\n            this._sheet = sheet;\n            this._grid = grid;\n        },\n\n        refresh: function(width, height) {\n            this._grid.refresh(width, height);\n        },\n\n        isVisible: function(scrollLeft, scrollTop, ref) {\n            return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n        },\n\n        render: function(args) {\n            var scroller = args.scroller;\n            var scrollLeft = scroller.scrollLeft;\n            var scrollTop = scroller.scrollTop;\n\n            if (scrollTop < 0) {\n                scrollTop = 0;\n            }\n\n            if (scrollLeft < 0) {\n                scrollLeft = 0;\n            }\n\n            var classNames = Pane.classNames;\n            var sheet = this._sheet;\n            var grid = this._grid;\n            var view = grid.view(scrollLeft, scrollTop);\n            this._currentView = view;\n            this._currentRect = this._rectangle(view.ref);\n            this._selectedHeaders = sheet.selectedHeaders();\n\n            var children = [];\n\n            children.push(this.renderData(args));\n\n            if (!sheet._activeDrawing) {\n                children.push(this.renderSelection(scroller));\n            }\n\n            children.push(this.renderAutoFill());\n\n            children.push(this.renderEditorSelection());\n\n            children.push(this.renderFilterHeaders());\n\n            if (grid.hasRowHeader) {\n                var rowHeader = kendo.dom.element(\"div\", {\n                    className: classNames.rowHeader,\n                    style: {\n                        width: grid.headerWidth + \"px\",\n                        top: view.rowOffset + \"px\"\n                    }\n                });\n                children.push(rowHeader);\n                sheet.forEach(view.ref.leftColumn(), function(row){\n                    if (!sheet.isHiddenRow(row)) {\n                        var text = row + 1, height = sheet.rowHeight(row);\n                        rowHeader.children.push(kendo.dom.element(\"div\", {\n                            className: this.headerClassName(row, \"row\"),\n                            style: {\n                                width: grid.headerWidth + \"px\",\n                                height: height + \"px\"\n                            }\n                        }, [ kendo.dom.element(\"div\", {\n                            className: \"k-vertical-align-center\"\n                        }, [ kendo.dom.text(text+\"\") ])]));\n                    }\n                }.bind(this));\n            }\n\n            if (grid.hasColumnHeader) {\n                var columnHeader = kendo.dom.element(\"div\", {\n                    className: classNames.columnHeader,\n                    style: {\n                        top: \"0px\",\n                        left: view.columnOffset + \"px\",\n                        width: this._currentRect.width + \"px\",\n                        height: grid.headerHeight + \"px\"\n                    }\n                });\n                children.push(columnHeader);\n                var left = 0;\n                sheet.forEach(view.ref.topRow(), function(row, col){\n                    if (!sheet.isHiddenColumn(col)) {\n                        var text = kendo.spreadsheet.Ref.display(null, Infinity, col),\n                            width = sheet.columnWidth(col);\n                        columnHeader.children.push(kendo.dom.element(\"div\", {\n                            className: this.headerClassName(col, \"col\"),\n                            style: {\n                                position: \"absolute\",\n                                left: left + \"px\",\n                                width: width + \"px\",\n                                height: grid.headerHeight + \"px\"\n                            }\n                        }, [ kendo.dom.element(\"div\", {\n                            className: \"k-vertical-align-center\"\n                        }, [ kendo.dom.text(text+\"\") ])]));\n                        left += width;\n                    }\n                }.bind(this));\n            }\n\n            if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                if (!sheet.resizeHintPosition()) {\n                    this.renderResizeHandle(children);\n                }\n            }\n\n            var paneClasses = [classNames.pane];\n\n            if (grid.hasColumnHeader) {\n                paneClasses.push(classNames.top);\n            }\n\n            if (grid.hasRowHeader) {\n                paneClasses.push(classNames.left);\n            }\n\n            return kendo.dom.element(\"div\", {\n                style: grid.style,\n                className: paneClasses.join(\" \")\n            }, children);\n        },\n\n        headerClassName: function(index, type) {\n            var selectedHeaders = this._selectedHeaders;\n\n            var itemSelection;\n            var allHeaders;\n\n            if (type === \"row\") {\n                itemSelection = selectedHeaders.rows[index];\n                allHeaders = selectedHeaders.allRows;\n            } else {\n                itemSelection = selectedHeaders.cols[index];\n                allHeaders = selectedHeaders.allCols;\n            }\n\n            var className = itemSelection || (selectedHeaders.all ? \"full\" : (allHeaders ? \"partial\" : \"none\"));\n\n            if (className) {\n                className = \"k-selection-\" + className;\n            }\n\n            return className;\n        },\n\n        renderData: function(args) {\n            var sheet = this._sheet;\n            var view = this._currentView;\n            var cont = kendo.dom.element(\"div\", {\n                className: Pane.classNames.data,\n                style: {\n                    position: \"relative\",\n                    left: view.columnOffset + \"px\",\n                    top: view.rowOffset + \"px\"\n                }\n            });\n            var rect = this._currentRect;\n            var layout = kendo.spreadsheet.draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n            var grid = this._grid;\n            var showGridLines = sheet._showGridLines;\n            if (showGridLines) {\n                // draw axis first\n                prev = null;\n                layout.xCoords.forEach(function(x){\n                    if (x !== prev) {\n                        prev = x;\n                        cont.children.push(kendo.dom.element(\"div\", {\n                            className: paneClassNames.vaxis,\n                            style: {\n                                left: x + \"px\",\n                                height: rect.height + \"px\",\n                                borderColor: sheet.gridLinesColor()\n                            }\n                        }));\n                    }\n                });\n                prev = null;\n                layout.yCoords.forEach(function(y){\n                    if (y !== prev) {\n                        prev = y;\n                        cont.children.push(kendo.dom.element(\"div\", {\n                            className: paneClassNames.haxis,\n                            style: {\n                                top: y + \"px\",\n                                width: rect.width + \"px\",\n                                borderColor: sheet.gridLinesColor()\n                            }\n                        }));\n                    }\n                });\n            }\n            var borders = kendo.spreadsheet.draw.Borders();\n            var activeCellRange = sheet.activeCell().toRangeRef();\n            var activeCell = activeCellRange.topLeft;\n\n            layout.cells.forEach(function(cell){\n                var cls = null;\n                var absRow = cell.row + view.ref.topLeft.row;\n                var absCol = cell.col + view.ref.topLeft.col;\n                if (sheet._activeDrawing) {\n                    var ref = sheet._activeDrawing.topLeftCell;\n                    if (ref && ref.row == absRow && ref.col == absCol) {\n                        cls = \"k-spreadsheet-drawing-anchor-cell\";\n                    }\n                } else if (absRow == activeCell.row && absCol == activeCell.col) {\n                    // active cell.  normally we enter here only once.\n                    cls = [\n                        Pane.classNames.activeCell\n                    ].concat(this._activeFormulaColor(),\n                             this._directionClasses(activeCellRange));\n                    if (sheet.singleCellSelection()) {\n                        cls.push(Pane.classNames.single);\n                    }\n                    cls = cls.join(\" \");\n                }\n                borders.add(cell);\n                drawCell(cont.children, cell, cls, showGridLines);\n                if (cell.comment && sheet._commentRef &&\n                    absRow == sheet._commentRef.row && absCol == sheet._commentRef.col) {\n                    var ttOffset = 4;\n                    var left = cell.right + grid.left + view.columnOffset + ttOffset;\n                    var style = { top: (cell.top + grid.top + view.rowOffset) + \"px\" };\n                    if (left + 200 > args.contentWidth) {\n                        style.right = (args.contentWidth - grid.left - cell.left - view.columnOffset + ttOffset) + \"px\";\n                    } else {\n                        style.left = left + \"px\";\n                    }\n                    var div = kendo.dom.element(\"div\", {\n                        className: \"k-tooltip k-spreadsheet-cell-comment\",\n                        style: style\n                    }, [ kendo.dom.text(cell.comment) ]);\n                    args.toplevelElements.push(div);\n                }\n            }, this);\n            borders.vert.forEach(function(a){\n                a.forEach(function(b){\n                    if (!b.rendered) {\n                        b.rendered = true;\n                        var style = {\n                            left        : b.x + \"px\",\n                            top         : b.top + \"px\",\n                            height      : (b.bottom - b.top + 1) + \"px\",\n                            borderWidth : b.size + \"px\",\n                            borderColor : b.color\n                        };\n                        if (b.size != 1) {\n                            style.transform = \"translateX(-\" + (b.size-1)/2 + \"px)\";\n                        }\n                        cont.children.push(kendo.dom.element(\"div\", {\n                            className: paneClassNames.vborder,\n                            style: style\n                        }));\n                    }\n                });\n            });\n            borders.horiz.forEach(function(a){\n                a.forEach(function(b){\n                    if (!b.rendered) {\n                        b.rendered = true;\n                        var style = {\n                            top         : b.y + \"px\",\n                            left        : b.left + \"px\",\n                            width       : (b.right - b.left) + \"px\",\n                            borderWidth : b.size + \"px\",\n                            borderColor : b.color\n                        };\n                        if (b.size != 1) {\n                            style.transform = \"translateY(-\" + (b.size-1)/2 + \"px)\";\n                        }\n                        cont.children.push(kendo.dom.element(\"div\", {\n                            className: paneClassNames.hborder,\n                            style: style\n                        }));\n                    }\n                });\n            });\n            this.renderDrawings(layout, cont.children);\n            return cont;\n        },\n\n        renderDrawings: function(layout, container) {\n            var sheet = this._sheet;\n            var workbook = sheet._workbook;\n            layout.drawings.forEach(function(d){\n                var drawing = d.drawing;\n                var box = d.box;\n                var div = box.toDiv(\"k-spreadsheet-drawing\");\n                if (drawing.image) {\n                    div.children.push(kendo.dom.element(\"div\", {\n                        className: \"k-spreadsheet-drawing-image\",\n                        style: {\n                            backgroundImage: \"url('\" + workbook.imageUrl(drawing.image) + \"')\",\n                            opacity: drawing.opacity\n                        }\n                    }));\n                }\n                if (drawing === sheet._activeDrawing) {\n                    div.attr.className += \" k-spreadsheet-active-drawing\";\n                    drawingResizeHandles(div.children);\n                }\n                container.push(div);\n            });\n        },\n\n        renderResizeHandle: function(container) {\n            var sheet = this._sheet;\n            var ref = sheet.resizeHandlePosition();\n            var rectangle = this._rectangle(ref);\n            var classNames = [ Pane.classNames.resizeHandle ];\n\n            var style;\n            if (ref.col !== -Infinity) {\n                if (this._grid.rows._start > 0) {\n                    return;\n                }\n                style = {\n                    height: this._grid.headerHeight + \"px\",\n                    width: RESIZE_HANDLE_WIDTH + \"px\",\n                    left: rectangle.right - RESIZE_HANDLE_WIDTH/2  + \"px\",\n                    top: \"0px\"\n                };\n                classNames.push(viewClassNames.horizontalResize);\n            } else {\n                if (this._grid.columns._start > 0) {\n                    return;\n                }\n                style = {\n                    height: RESIZE_HANDLE_WIDTH + \"px\",\n                    width:  this._grid.headerWidth + \"px\",\n                    top: rectangle.bottom - RESIZE_HANDLE_WIDTH/2  + \"px\",\n                    left: \"0px\"\n                };\n                classNames.push(viewClassNames.verticalResize);\n            }\n\n            container.push(kendo.dom.element(\"div\", {\n                className: classNames.join(\" \"),\n                style: style\n            }));\n        },\n\n        filterIconRect: function(rect) {\n            var BUTTON_SIZE = 16;\n            var BUTTON_OFFSET = 3;\n\n            return new kendo.spreadsheet.Rectangle(\n                rect.right - BUTTON_SIZE - BUTTON_OFFSET,\n                rect.top + BUTTON_OFFSET,\n                BUTTON_SIZE,\n                BUTTON_SIZE\n            );\n        },\n\n        renderFilterHeaders: function() {\n            var sheet = this._sheet;\n            var children = [];\n            var classNames = View.classNames;\n            var filter = sheet.filter();\n\n            function icon(iconName) {\n                return kendo.dom.element($(kendo.ui.icon(iconName))[0]);\n            }\n\n            function filterButton(classNames, position, index) {\n                var style = {\n                    left: position.left + \"px\",\n                    top: position.top + \"px\"\n                };\n                var filtered = filter && filter.columns.some(function(c) {\n                    return c.index === index;\n                });\n                var classes = classNames.filterButton;\n\n                if (filtered) {\n                    classes += \" \" + classNames.filterButtonSelected;\n                }\n\n                var button = kendo.dom.element(\n                    \"span\",\n                    { className: classes, style: style },\n                    [ icon(classNames.iconFilterDefault) ]\n                );\n\n                return button;\n            }\n\n            if (filter) {\n                this._addDiv(children, filter.ref, classNames.filterRange);\n            }\n\n            sheet.forEachFilterHeader(this._currentView.ref, function(ref) {\n                var rect = this._rectangle(ref);\n                var position = this.filterIconRect(rect);\n                var column = this._sheet.filterColumn(ref);\n                var button = filterButton(classNames, position, column);\n\n                children.push(button);\n            }.bind(this));\n\n            return kendo.dom.element(\"div\", {\n                className: classNames.filterHeadersWrapper\n            }, children);\n\n        },\n\n        renderEditorSelection: function() {\n            var classNames = Pane.classNames;\n            var sheet = this._sheet;\n            var selections = [];\n\n            sheet._formulaSelections.forEach(function(range) {\n                var ref = range.ref;\n\n                if (ref === kendo.spreadsheet.NULLREF) {\n                    return;\n                }\n\n                this._addDiv(selections, ref, classNames.selectionHighlight + \" \" + range.colorClass);\n            }.bind(this));\n\n            return kendo.dom.element(\"div\", { className: classNames.selectionWrapper }, selections);\n\n        },\n\n        renderSelection: function(scroller) {\n            var classNames = Pane.classNames;\n            var selections = [];\n            var selectionClasses = [classNames.selection];\n            var sheet = this._sheet;\n            var activeCell = sheet.activeCell().toRangeRef();\n            var selection = sheet.select();\n\n            selectionClasses = selectionClasses.concat(this._activeFormulaColor());\n\n            if (selection.size() === 1) {\n                selectionClasses.push(\"k-single-selection\");\n            }\n\n            if (this._sheet.autoFillPunch()) {\n                selectionClasses.push(\"k-dim-auto-fill-handle\");\n            }\n\n            selection.forEach(function(ref) {\n                if (ref !== kendo.spreadsheet.NULLREF) {\n                    this._addDiv(selections, ref, selectionClasses.join(\" \"));\n                }\n            }.bind(this));\n\n            this._renderCustomEditorButton(selections, activeCell, scroller);\n\n            return kendo.dom.element(\"div\", { className: classNames.selectionWrapper }, selections);\n        },\n\n        renderAutoFill: function() {\n            var autoFillRectangle = [];\n\n            if (this._sheet.autoFillInProgress()) {\n                var autoFillRef = this._sheet.autoFillRef();\n                var punch = this._sheet.autoFillPunch();\n                var direction = this._sheet._autoFillDirection;\n\n                this._addDiv(autoFillRectangle, autoFillRef, \"k-auto-fill\");\n\n                if (punch) { // collapsing, add overlay\n                    this._addDiv(autoFillRectangle, punch, \"k-auto-fill-punch\");\n                } else if (direction !== undefined) { // expanding - add hint\n                    var ref, cssClass;\n\n                    switch(direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = \"k-auto-fill-br-hint\";\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = \"k-auto-fill-br-hint\";\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = \"k-auto-fill-tr-hint\";\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = \"k-auto-fill-bl-hint\";\n                            break;\n                    }\n\n                    var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                    if (rectangle) {\n                        var hint = kendo.dom.element(\"span\", { className: \"k-tooltip\" }, [ kendo.dom.text(this._sheet._autoFillHint) ]);\n                        rectangle.children.push(hint);\n                    }\n                }\n            }\n\n            return kendo.dom.element(\"div\", { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n        },\n\n        _addDiv: function(collection, ref, className) {\n            var view = this._currentView, div;\n\n            if (view.ref.intersects(ref)) {\n                div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                collection.push(div);\n            }\n            return div;\n        },\n\n        _renderCustomEditorButton: function(collection, ref, scroller) {\n            var self = this;\n            var sheet = self._sheet;\n            var view = self._currentView;\n            var columnCount = self._grid.columns._axis._count;\n            var ed = sheet.activeCellCustomEditor();\n\n            if (ed && view.ref.intersects(ref)) {\n                var rectangle = self._rectangle(ref);\n                sheet.forEach(ref.collapse(), function(row, col, cell) {\n                    cell.left = rectangle.left;\n                    cell.top = rectangle.top;\n                    cell.width = rectangle.width;\n                    cell.height = rectangle.height;\n\n                    var btnClass = \"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-spreadsheet-editor-button\";\n                    var isLastColumn = col == columnCount - 1 || self._buttonOutOfVisiblePane(row, col, scroller);\n                    if (isLastColumn) {\n                        btnClass += \" k-spreadsheet-last-column\";\n                    }\n                    self._editorInLastColumn = isLastColumn;\n                    var btn = kendo.dom.element(\"div\", {\n                        className: btnClass,\n                        style: {\n                            left   : (cell.left + (isLastColumn ? -EDIT_BUTTON_WIDTH : cell.width)) + \"px\",\n                            top    : cell.top + \"px\",\n                            height : cell.height + \"px\"\n                        }\n                    });\n                    if (ed.icon) {\n                        btn.children.push(kendo.dom.element($(kendo.ui.icon(ed.icon.replace(/^k-i-/, \"\")))[0]));\n                    }\n                    collection.push(btn);\n                });\n            }\n        },\n\n        _activeFormulaColor: function() {\n            var activeFormulaSelection;\n            var colorClasses = [];\n\n            if (this._sheet.isInEditMode()) {\n                activeFormulaSelection = this._sheet._formulaSelections.filter(function(sel) { return sel.active && sel.type == \"ref\"; })[0];\n\n                if (activeFormulaSelection) {\n                    colorClasses.push(activeFormulaSelection.colorClass);\n                }\n            }\n\n            return colorClasses;\n        },\n\n        _directionClasses: function(cell) {\n            var cellClasses = [];\n            var classNames = Pane.classNames;\n            var view = this._currentView.ref;\n\n            if (!cell.move(0, -1).intersects(view)) {\n                cellClasses.push(classNames.left);\n            }\n\n            if (!cell.move(-1, 0).intersects(view)) {\n                cellClasses.push(classNames.top);\n            }\n\n            if (!cell.move(0, 1).intersects(view)) {\n                cellClasses.push(classNames.right);\n            }\n\n            if (!cell.move(1, 0).intersects(view)) {\n                cellClasses.push(classNames.bottom);\n            }\n\n            return cellClasses;\n        },\n\n        _rectangle: function(ref) {\n            return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n        },\n\n        _buttonOutOfVisiblePane: function(row, col, scroller) {\n            var self = this;\n            var theGrid = self._grid;\n            var sheet = self._sheet;\n            var ref = sheet.range(row, col)._ref;\n            var boundaries = theGrid.scrollBoundaries(ref);\n            var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n\n            if (boundaries.right + EDIT_BUTTON_WIDTH > scrollLeft || col + 1 === sheet.frozenColumns()) {\n                return true;\n            }\n        }\n    });\n\n    function drawingResizeHandles(container) {\n        [ \"N\", \"NE\", \"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\" ].forEach(function(direction) {\n            container.push(kendo.dom.element(\"div\", {\n                \"className\": \"k-spreadsheet-drawing-handle \" + direction,\n                \"data-direction\": direction\n            }));\n        });\n    }\n\n    kendo.spreadsheet.View = View;\n    kendo.spreadsheet.Pane = Pane;\n    kendo.spreadsheet.drawCell = drawCell;\n\n    $.extend(true, View, { classNames: viewClassNames });\n    $.extend(true, Pane, { classNames: paneClassNames });\n\n})(window.kendo);\n\n(function(kendo) {\n\n    \"use strict\";\n\n\n\n    var $ = kendo.jQuery;\n\n    var EDITORS = {};\n\n    var registerEditor = kendo.spreadsheet.registerEditor = function(name, editor) {\n        EDITORS[name] = editor;\n    };\n\n    kendo.spreadsheet.Sheet.prototype.activeCellCustomEditor = function() {\n        var cell = this.activeCell().first();\n\n        if (this.range(cell).enable()) {\n            var val = this.validation(cell);\n            var key = this._properties.get(\"editor\", this._grid.cellRefIndex(cell));\n            var editor;\n\n            if (key != null) {\n                editor = EDITORS[key];\n            }\n            else if (val && val.showButton) {\n                key = \"_validation_\" + val.dataType;\n                editor = EDITORS[key];\n            }\n\n            if (typeof editor == \"function\") {\n                editor = EDITORS[key] = editor();\n            }\n\n            return editor;\n        }\n    };\n\n    registerEditor(\"_validation_date\", function(){\n        var context, calendar, popup;\n\n        function create() {\n            if (!calendar) {\n                calendar = $(\"<div>\").kendoCalendar();\n                popup = $(\"<div>\").kendoPopup();\n                calendar.appendTo(popup);\n                calendar = calendar.getKendoCalendar();\n                popup = popup.getKendoPopup();\n\n                calendar.bind(\"change\", function(){\n                    popup.close();\n                    var date = calendar.value();\n                    if (!context.range.format()) {\n                        context.range.format(\"yyyy-mm-dd\");\n                    }\n                    context.callback(kendo.spreadsheet.dateToNumber(date));\n                });\n            }\n            popup.setOptions({\n                anchor: context.view.element.find(\".k-spreadsheet-editor-button\"),\n                origin: context.alignLeft ? \"bottom right\" : \"bottom left\",\n                position: context.alignLeft ? \"top right\" : \"top left\"\n            });\n        }\n\n        function open() {\n            create();\n\n            var date = context.range.value();\n            var sheet = context.range.sheet();\n            if (date != null) {\n                calendar.value(kendo.spreadsheet.numberToDate(date));\n            } else {\n                calendar.value(null);\n            }\n            var val = context.validation;\n            if (val) {\n                var min = kendo.ui.Calendar.fn.options.min;\n                var max = kendo.ui.Calendar.fn.options.max;\n                var fromValidation = val.from;\n                var toValidation = val.to;\n                var formula = kendo.spreadsheet.calc.runtime.Formula;\n\n                if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                    if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                        min = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                    } else {\n                        min = kendo.spreadsheet.numberToDate(fromValidation.value);\n                    }\n                }\n                if (val.comparerType == \"between\") {\n                    if(toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                        max = kendo.spreadsheet.numberToDate(sheet.range(toValidation.value.row, toValidation.value.col).value());\n                    } else {\n                        max = kendo.spreadsheet.numberToDate(val.to.value);\n                    }\n                }\n                if (val.comparerType == \"lessThan\" || val.comparerType == \"lessThanOrEqualTo\") {\n                    if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                        max = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                    } else {\n                        max = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                }\n                calendar.setOptions({\n                    disableDates: function(date) {\n                        var from, to;\n\n                        if(fromValidation && fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            from = sheet.range(fromValidation.value.row, fromValidation.value.col).value();\n                        } else {\n                            from = fromValidation ? fromValidation.value|0 : 0;\n                        }\n\n                        if(toValidation && toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                            to = sheet.range(toValidation.value.row, toValidation.value.col).value();\n                        } else {\n                            to = toValidation ? toValidation.value|0 : 0;\n                        }\n\n                        date = kendo.spreadsheet.dateToNumber(date) | 0;\n                        return !kendo.spreadsheet.validation\n                            .validationComparers[val.comparerType](date, from, to);\n                    },\n                    min: min,\n                    max: max\n                });\n            } else {\n                calendar.setOptions({ disableDates: null, min: null, max: null });\n            }\n            popup.open();\n        }\n\n        function _rowAndColPresent(value) {\n            return (value && value.row !== null && value.col !== null && value.row > -1 && value.col > -1);\n        }\n\n        return {\n            edit: function(options) {\n                context = options;\n                open();\n            },\n            icon: \"calendar\"\n        };\n    });\n\n    registerEditor(\"_validation_list\", function(){\n        var context, list, popup;\n        function create() {\n            if (!list) {\n                list = $(\"<ul class='k-list k-reset'/>\").kendoStaticList({\n                    template   : \"#:value#\",\n                    selectable : true,\n                    autoBind   : false\n                });\n                popup = $(\"<div class='k-spreadsheet-list-popup'>\").kendoPopup();\n                list.appendTo(popup);\n                popup = popup.getKendoPopup();\n                list = list.getKendoStaticList();\n\n                list.bind(\"change\", function(){\n                    popup.close();\n                    var item = list.value()[0];\n                    if (item) {\n                        context.callback(item.value);\n                    }\n                });\n            }\n            popup.setOptions({\n                anchor: context.view.element.find(\".k-spreadsheet-editor-button\"),\n                origin: context.alignLeft ? \"bottom right\" : \"bottom left\",\n                position: context.alignLeft ? \"top right\" : \"top left\"\n            });\n        }\n        function open() {\n            create();\n            var items = context.validation.from.value;\n            var data = [], add = function(el){ data.push({ value: el }); };\n            if (items instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                items.each(add);\n            } else {\n                // actually Excel expects a simple string for list\n                // validation (comma-separated labels).\n                (items+\"\").split(/\\s*,\\s*/).forEach(add);\n            }\n            var dataSource = new kendo.data.DataSource({ data: data });\n            list.setDataSource(dataSource);\n            dataSource.read();\n            popup.open();\n        }\n        return {\n            edit: function(options) {\n                context = options;\n                open();\n            },\n            icon: \"caret-alt-down\"\n        };\n    });\n\n})(window.kendo);\n\n(function(kendo) {\n\n    \n\n    var CellRef = kendo.spreadsheet.CellRef;\n    var RangeRef = kendo.spreadsheet.RangeRef;\n    var UnionRef = kendo.spreadsheet.UnionRef;\n\n    var Rectangle = kendo.Class.extend({\n        init: function Rectangle(left, top, width, height) {\n            this.left = left;\n            this.top = top;\n            this.width = width;\n            this.height = height;\n            this.right = this.left + this.width;\n            this.bottom = this.top + this.height;\n        },\n\n        offset: function(left, top) {\n            return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n        },\n\n        resize: function(width, height) {\n            return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n        },\n\n        intersects: function(x, y) {\n            if (x instanceof Rectangle) {\n                return this.intersectsRect(x);\n            }\n            return this.left < x && x < this.left + this.width &&\n                   this.top < y && y < this.top + this.height;\n        },\n\n        intersectsRect: function(b) {\n            var a = this;\n            return a.left <= b.right\n                && b.left <= a.right\n                && a.top <= b.bottom\n                && b.top <= a.bottom;\n        },\n\n        toDiv: function(className) {\n            return kendo.dom.element(\"div\", {\n                className: className,\n                style: {\n                    width:  this.width + \"px\",\n                    height: this.height + \"px\",\n                    top:    this.top + \"px\",\n                    left:   this.left + \"px\"\n                }\n            });\n        }\n    });\n\n    // XXX: can we use ES5 yet? :-/\n    //\n    // Object.defineProperty(Rectangle.prototype, \"right\", {\n    //     get() {\n    //         return this.left + this.width;\n    //     }\n    // });\n    // Object.defineProperty(Rectangle.prototype, \"bottom\", {\n    //     get() {\n    //         return this.top + this.height;\n    //     }\n    // });\n\n    var Grid = kendo.Class.extend({\n        init: function(rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n            this.rowCount = rowCount;\n            this.columnCount = columnCount;\n            this._columns = columns;\n            this._rows = rows;\n            this._headerHeight = headerHeight;\n            this._headerWidth = headerWidth;\n        },\n\n        _resize: function(new_rows, new_cols) {\n            this.rowCount = new_rows;\n            this.columnCount = new_cols;\n        },\n\n        isAxis: function(ref) {\n            ref = ref.toRangeRef();\n            var topLeft = ref.topLeft;\n            var bottomRight = ref.bottomRight;\n            return (topLeft.row === 0 && bottomRight.row === this.rowCount - 1) || (topLeft.col === 0 && bottomRight.col === this.columnCount - 1);\n        },\n\n        width: function(start, end) {\n            return this._columns.sum(start, end);\n        },\n\n        height: function(start, end) {\n            return this._rows.sum(start, end);\n        },\n\n        totalHeight: function() {\n            return this._rows.total + this._headerHeight;\n        },\n\n        totalWidth: function() {\n            return this._columns.total + this._headerWidth;\n        },\n\n        index: function(row, column) {\n            return column * this.rowCount + row;\n        },\n\n        cellRef: function(index) {\n            return new CellRef(index % this.rowCount, (index / this.rowCount) >> 0);\n        },\n\n        rowRef: function(row) {\n            return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n        },\n\n        colRef: function(col) {\n            return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n        },\n\n        cellRefIndex: function(ref) {\n            return this.index(ref.row, ref.col);\n        },\n\n        normalize: function(ref) {\n            if (ref instanceof RangeRef) {\n                return new RangeRef(\n                    this.normalize(ref.topLeft),\n                    this.normalize(ref.bottomRight)\n                ).setSheet(ref.sheet, ref.hasSheet());\n            }\n\n            if (ref instanceof UnionRef) {\n                return ref.map(function(ref) {\n                    return this.normalize(ref);\n                }, this);\n            }\n\n            if (ref instanceof CellRef) {\n                ref = ref.clone();\n                ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n            }\n\n            return ref;\n        },\n\n        rectangle: function(ref) {\n            var topLeft = this.normalize(ref.topLeft);\n            var bottomRight = this.normalize(ref.bottomRight);\n            return new Rectangle(\n                this.width(0, topLeft.col - 1),\n                this.height(0, topLeft.row - 1),\n                this.width(topLeft.col, bottomRight.col),\n                this.height(topLeft.row, bottomRight.row)\n            );\n        },\n\n        pane: function(options) {\n            return new PaneGrid(\n                new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight),\n                new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth),\n                this\n            );\n        },\n\n        rangeDimensions: function(rangeRef) {\n            return {\n                rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n            };\n        },\n\n        forEach: function(ref, callback) {\n            var topLeft = this.normalize(ref.topLeft);\n            var bottomRight = this.normalize(ref.bottomRight);\n\n            for (var ci = topLeft.col; ci <= bottomRight.col; ci ++) {\n                for (var ri = topLeft.row; ri <= bottomRight.row; ri ++) {\n                    callback(new CellRef(ri, ci));\n                }\n            }\n        },\n\n        trim: function(ref, property) {\n            var topLeft = this.normalize(ref.topLeft);\n            var bottomRight = this.normalize(ref.bottomRight);\n            var bottomRightRow = topLeft.row;\n            var bottomRightCol = topLeft.col;\n\n            for (var ci = topLeft.col; ci <= bottomRight.col; ci ++) {\n                var start = this.index(topLeft.row, ci);\n                var end = this.index(bottomRight.row, ci);\n                var values = property.tree.intersecting(start, end);\n                if(values.length) {\n                    var cell = this.cellRef(values[values.length - 1].end);\n                    bottomRightRow = Math.max(bottomRightRow, cell.row);\n                    bottomRightCol = ci;\n                }\n            }\n            return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n        }\n    });\n\n    var PaneGrid = kendo.Class.extend({\n        init: function(rows, columns, grid) {\n            this.rows = rows;\n            this.columns = columns;\n            this._grid = grid;\n\n            this.headerHeight = rows.headerSize;\n            this.headerWidth = columns.headerSize;\n            this.hasRowHeader = columns.hasHeader;\n            this.hasColumnHeader = rows.hasHeader;\n        },\n\n        refresh: function(width, height) {\n            this.columns.viewSize(width);\n            this.rows.viewSize(height);\n\n            var x = this.columns.paneSegment();\n            var y = this.rows.paneSegment();\n\n            this.left = x.offset;\n            this.top = y.offset;\n            this.right = x.offset + x.length;\n            this.bottom = y.offset + y.length;\n\n            this.style = {\n                top: y.offset  + \"px\",\n                left: x.offset + \"px\",\n                height: y.length + \"px\",\n                width: x.length + \"px\"\n            };\n        },\n\n        view: function(left, top) {\n            var rows = this.rows.visible(top);\n            var columns = this.columns.visible(left);\n\n            return {\n                rows: rows,\n                columns: columns,\n\n                rowOffset: rows.offset,\n                columnOffset: columns.offset,\n\n                mergedCellLeft: columns.start,\n                mergedCellTop: rows.start,\n\n                ref: new RangeRef(\n                    new CellRef(rows.values.start, columns.values.start),\n                    new CellRef(rows.values.end, columns.values.end)\n                )\n            };\n        },\n\n        contains: function(ref) {\n            return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) &&\n                this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n        },\n\n        index: function(row, column) {\n            return this._grid.index(row, column);\n        },\n\n        boundingRectangle: function(ref) {\n            return this._grid.rectangle(ref);\n        },\n\n        cellRefIndex: function(ref) {\n            return this._grid.cellRefIndex(ref);\n        },\n\n        scrollBoundaries: function(cell) {\n            var position = this.boundingRectangle(cell);\n\n            var boundaries = {\n                top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                right: position.right - this.columns._viewSize + this.headerWidth,\n                bottom: position.bottom - this.rows._viewSize + this.headerHeight\n            };\n\n            var widthCompensation = this.columns.defaultValue / 2;\n            var heightCompensation = this.rows.defaultValue / 2;\n\n            boundaries.scrollTop = boundaries.top - heightCompensation;\n            boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n\n            boundaries.scrollLeft = boundaries.left - widthCompensation;\n            boundaries.scrollRight = boundaries.right + widthCompensation;\n            return boundaries;\n        }\n    });\n\n    kendo.spreadsheet.Grid = Grid;\n    kendo.spreadsheet.PaneGrid = PaneGrid;\n    kendo.spreadsheet.Rectangle = Rectangle;\n})(kendo);\n\n(function(kendo) {\n\n    var Axis = kendo.Class.extend({\n        init: function(count, value) {\n            this._value = value;\n            this._count = count;\n            this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n            this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n\n            this.scrollBarSize = kendo.support.scrollbar();\n            this._refresh();\n        },\n\n        _resize: function(count) {\n            if (count > this._count) {\n                this.values.value(this._count, count - 1, this._value);\n                this._hidden.value(this._count, count - 1, 0);\n            } else if (count < this._count) {\n                this.values.value(count, this._count - 1, 0);\n                this._hidden.value(count, this._count - 1, 0);\n            }\n            this._count = count;\n            this._refresh();\n        },\n\n        adjust: function(start, delta) {\n            // adjust this axis for insert/remove rows/cols operation\n            if (delta < 0) {\n                // removing -- copy from start+|delta| to start\n                this.values.copy(start - delta, this._count - 1, start);\n                this._hidden.copy(start - delta, this._count - 1, start);\n            } else {\n                // adding -- copy from start to start+delta, and set\n                // values for inserted things to default.\n                this.values.copy(start, this._count, start + delta);\n                this._hidden.copy(start, this._count, start + delta);\n                this.values.value(start, start + delta - 1, this._value);\n                this._hidden.value(start, start + delta - 1, 0);\n            }\n            this._refresh();\n        },\n\n        toJSON: function(field, positions) {\n            var values = [];\n\n            var iterator = this.values.iterator(0, this._count - 1);\n\n            for (var idx = 0; idx < this._count; idx++) {\n                var value = iterator.at(idx);\n                var hidden = this._hidden.value(idx, idx);\n\n                if (value === this._value && !hidden) {\n                    continue;\n                }\n\n                var position = positions[idx];\n\n                if (position === undefined) {\n                    position = values.length;\n\n                    var item = { index: idx };\n\n                    item[field] = value;\n                    if (hidden) {\n                        item.hidden = hidden;\n                    }\n\n                    values.push(item);\n\n                    positions[idx] = position;\n                }\n            }\n\n            return values;\n        },\n\n        fromJSON: function(field, values) {\n            for (var idx = 0; idx < values.length; idx++) {\n                var el = values[idx];\n\n                var index = el.index;\n                if (index === undefined) {\n                    index = idx;\n                }\n\n                // when this particular axis is hidden, the value for\n                // the field (\"height\" or \"width\") will be zero, and\n                // in the \"hidden\" field we'll have the actual value\n                // before it was hidden.\n                // https://github.com/telerik/kendo-ui-core/issues/3523\n                var value = el[field];\n\n                if (value === 0) {\n                    this._hidden.value(index, index, el.hidden || this._value);\n                    this.value(index, index, 0);\n                } else {\n                    this.value(index, index, value);\n                }\n            }\n        },\n\n        hide: function(index) {\n            if (!this.hidden(index)) {\n                var value = this.value(index, index);\n                this._hidden.value(index, index, value);\n                this.value(index, index, 0);\n            }\n        },\n\n        hidden: function(index) {\n            return this._hidden.value(index, index) !== 0;\n        },\n\n        includesHidden: function(start, end) {\n             return this._hidden.intersecting(start, end).length > 1;\n        },\n\n        nextVisible: function(index) {\n            var end = this._count - 1, i = index;\n            while (++i <= end) {\n                if (!this.hidden(i)) {\n                    return i;\n                }\n            }\n            return index;\n        },\n\n        nextUntil: function(index, pred) {\n            var end = this._count - 1, i = index, advanced = false;\n            while (++i <= end) {\n                var val = pred(i, advanced, this.hidden(i));\n                if (typeof val == \"number\") {\n                    return val;\n                } else if (val) {\n                    break;\n                }\n                advanced = true;\n            }\n            return i - 1;\n        },\n\n        nextPage: function(index, pageSize) {\n            return this.index(this.sum(0, index - 1) + pageSize);\n        },\n\n        prevPage: function(index, pageSize) {\n            return this.index(this.sum(0, index) - pageSize);\n        },\n\n        firstVisible: function() {\n            var firstHidden = this._hidden.first();\n            if (firstHidden.value === 0) {\n                return 0;\n            } else {\n                return firstHidden.end + 1;\n            }\n        },\n\n        lastVisible: function() {\n            var lastHidden = this._hidden.last();\n            if (lastHidden.value === 0) {\n                return this._count - 1;\n            } else {\n                return lastHidden.start - 1;\n            }\n        },\n\n        prevVisible: function(index) {\n            var i = index;\n            while (--i >= 0) {\n                if (!this.hidden(i)) {\n                    return i;\n                }\n            }\n            return index;\n        },\n\n        prevUntil: function(index, pred) {\n            var i = index, advanced = false;\n            while (--i >= 0) {\n                var val = pred(i, advanced, this.hidden(i));\n                if (typeof val == \"number\") {\n                    return val;\n                } else if (val) {\n                    break;\n                }\n                advanced = true;\n            }\n            return i + 1;\n        },\n\n        unhide: function(index) {\n            if (this.hidden(index)) {\n                var value = this._hidden.value(index, index);\n                this._hidden.value(index, index, 0);\n                this.value(index, index, value);\n            }\n        },\n\n        value: function(start, end, value) {\n            if (value !== undefined) {\n                this.values.value(start, end, value);\n                this._refresh();\n            } else {\n                return this.values.iterator(start, end).at(0);\n            }\n        },\n\n        sum: function(start, end) {\n            var values = this.values.iterator(start, end);\n\n            var sum = 0;\n\n            for (var idx = start; idx <= end; idx ++) {\n                sum += values.at(idx);\n            }\n\n            return sum;\n        },\n\n        locate: function(start, end, predicate) {\n            var values = this.values.iterator(start, end);\n            var sum = 0;\n            for (var idx = start; idx <= end; idx++) {\n                sum += values.at(idx);\n                var val = predicate(sum);\n                if (val) {\n                    return idx;\n                }\n            }\n            return null;\n        },\n\n        visible: function(start, end) {\n            var startSegment = null;\n            var endSegment = null;\n            var lastPage = false;\n\n            if (end >= this.total + this.scrollBarSize) {\n                lastPage = true;\n            }\n\n            var ranges = this._pixelValues.intersecting(start, end);\n\n            startSegment = ranges[0];\n            endSegment = ranges[ranges.length - 1];\n\n            if (!startSegment) {\n                return { values: this.values.iterator(0, 0), offset: 0 };\n            }\n\n            var startOffset = start - startSegment.start;\n\n            var startIndex = ((startOffset / startSegment.value.value) >> 0) + startSegment.value.start;\n\n            var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n\n            var endOffset = end - endSegment.start;\n            var endIndex = ((endOffset / endSegment.value.value) >> 0) + endSegment.value.start;\n\n            if (endIndex > endSegment.value.end) {\n                endIndex = endSegment.value.end;\n            }\n\n            if (lastPage) {\n                offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n            }\n\n            offset = Math.min(-offset, 0);\n\n            return {\n                values: this.values.iterator(startIndex, endIndex),\n                offset: offset\n            };\n        },\n\n        index: function(value) {\n            var index = 0;\n            var iterator = this.values.iterator(0, this._count - 1);\n            var current = iterator.at(0);\n\n            while (current < value && index < this._count - 1) {\n                current += iterator.at(++index);\n            }\n\n            return index;\n        },\n\n        indexVisible: function(value) {\n            var index = this.index(value);\n            if (this.hidden(index)) {\n                index = this.prevVisible(index);\n            }\n            return index;\n        },\n\n        _refresh: function() {\n            var current = 0;\n            this._pixelValues = this.values.map(function(range) {\n                var start = current;\n                current += (range.end - range.start + 1) * range.value;\n                var end = current - 1;\n                return new kendo.spreadsheet.ValueRange(start, end, range);\n            });\n            this.total = current;\n        },\n\n        getState: function() {\n            return {\n                values: this.values.getState(),\n                hidden: this._hidden.getState(),\n                count: this._count\n            };\n        },\n\n        setState: function(state) {\n            this.values.setState(state.values);\n            this._hidden.setState(state.hidden);\n            var nowCount = this._count;\n            if (nowCount > state.count) {\n                this._count = state.count;\n                this._resize(nowCount); // calls _refresh too\n            } else {\n                this._refresh();\n            }\n        }\n    });\n\n    var PaneAxis = kendo.Class.extend({\n        init: function(axis, start, count, headerSize) {\n           this._axis = axis;\n           this._start = start;\n           this._count = count;\n           this.hasHeader = start === 0;\n           this.headerSize = headerSize;\n           this.defaultValue = axis._value;\n           this.frozen = count > 0;\n        },\n\n        viewSize: function(viewSize) {\n            this._viewSize = viewSize;\n        },\n\n        sum: function(start, end) {\n            return this._axis.sum(start, end - 1);\n        },\n\n        start: function() {\n            return this.sum(0, this._start);\n        },\n\n        size: function() {\n            return this.sum(this._start, this._start + this._count);\n        },\n\n        index: function(value, offset) {\n            return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n        },\n\n        indexVisible: function(value, offset) {\n            return this._axis.indexVisible(value + (this.frozen ? 0 : offset) - this.headerSize);\n        },\n\n        //XXX: rename this method\n        paneSegment: function() {\n            var offset = this.start();\n            var length;\n\n            if (!this.hasHeader) {\n                offset += this.headerSize;\n            }\n\n            if (this.frozen) {\n                length = this.size();\n                if (this.hasHeader) {\n                    length += this.headerSize;\n                } else {\n                    length -= this.headerSize;\n                }\n            } else {\n                length = this._viewSize - offset;\n            }\n\n            return {\n                offset: offset,\n                length: length\n            };\n        },\n\n        visible: function(offset) {\n            var start = this.start();\n            var size;\n\n            if (this.frozen) {\n                size = this.size();\n                if (!this.hasHeader) {\n                    size -= this.headerSize;\n                }\n            } else {\n                size = this._viewSize - start - this.headerSize;\n                start += offset;\n            }\n\n            var result = this._axis.visible(start, start + size - 1);\n\n            if (this.frozen) {\n                result.offset = 0;\n            }\n\n            result.start = start;\n\n            if (this.hasHeader) {\n                result.offset += this.headerSize;\n                result.start -= this.headerSize;\n            }\n\n            return result;\n        },\n\n        contains: function(start, end) {\n            if (this.frozen) {\n                if (start > this._start + this._count) {\n                    return false;\n                }\n                if (end < this._start) {\n                    return false;\n                }\n                return true;\n            } else {\n                return end >= this._start;\n            }\n        }\n    });\n\n    kendo.spreadsheet.Axis = Axis;\n    kendo.spreadsheet.PaneAxis = PaneAxis;\n\n})(kendo);\n\n(function(kendo) {\n\n\n    var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n        prepare: function() {\n        },\n        value: function(cell) {\n            return cell.value;\n        },\n        matches: function() {\n            throw new Error(\"The 'matches' method is not implemented.\");\n        },\n        toJSON: function() {\n            throw new Error(\"The 'toJSON' method is not implemented.\");\n        }\n    });\n\n    Filter.create = function(options) {\n        var filter = options.filter;\n\n        if (!filter) {\n            throw new Error(\"Filter type not specified.\");\n        }\n\n        var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + \"Filter\"];\n\n        if (!constructor) {\n            throw new Error(\"Filter type not recognized.\");\n        }\n\n        return new constructor(options);\n    };\n\n    kendo.spreadsheet.ValueFilter = Filter.extend({\n        _values: [],\n\n        _dates: [],\n\n        _blanks: false,\n\n        init: function ValueFilter(options) {\n            if (options.values !== undefined) {\n                this._values = options.values;\n            }\n\n            if (options.blanks !== undefined) {\n                this._blanks = options.blanks;\n            }\n\n            if (options.dates !== undefined) {\n                this._dates = options.dates;\n            }\n        },\n\n        value: function(cell) {\n            var value = cell.value;\n\n            if (this._dates.length > 0 && cell.format && typeof value === \"number\") {\n                var type = kendo.spreadsheet.formatting.type(value, cell.format);\n\n                if (type === \"date\") {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n            }\n\n            return value;\n        },\n\n        matches: function(value) {\n            if (value === null || value === undefined) {\n                return this._blanks;\n            }\n\n            if (value instanceof Date) {\n                return this._dates.some(function(date) {\n                    return date.year === value.getFullYear() &&\n                        (date.month === undefined || date.month === value.getMonth()) &&\n                        (date.day === undefined || date.day === value.getDate()) &&\n                        (date.hours === undefined || date.hours === value.getHours()) &&\n                        (date.minutes === undefined || date.minutes === value.getMinutes()) &&\n                        (date.seconds === undefined || date.seconds === value.getSeconds());\n                });\n            }\n\n            return this._values.indexOf(value) >= 0;\n        },\n        toJSON: function() {\n            return {\n                filter: \"value\",\n                blanks: this._blanks,\n                values: this._values.slice(0)\n            };\n        }\n    });\n\n    kendo.spreadsheet.CustomFilter = Filter.extend({\n        _logic: \"and\",\n        init: function CustomFilter(options) {\n            if (options.logic !== undefined) {\n                this._logic = options.logic;\n            }\n\n            if (options.criteria === undefined) {\n                throw new Error(\"Must specify criteria.\");\n            }\n\n            this._criteria = options.criteria;\n\n            var expression = kendo.data.Query.filterExpr({\n                logic: this._logic,\n                filters: this._criteria,\n                accentFoldingFiltering: kendo.culture().name\n            }).expression;\n\n            this._matches = new Function(\"d\", \"return \" + expression);\n        },\n        matches: function(value) {\n            if (value === null) {\n                return false;\n            }\n\n            return this._matches(value);\n        },\n        value: function(cell) {\n            var value = cell.value;\n            var criterionValue = this._criteria[0].value;\n            var criterionType = criterionValue instanceof Date ? \"date\" : typeof criterionValue;\n            var valueType = typeof value;\n\n            if (cell.format) {\n                valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n            }\n\n            if (valueType != criterionType) {\n                if (criterionType == \"string\") {\n                    if (cell.format) {\n                        value = kendo.spreadsheet.formatting.text(value, cell.format);\n                    }\n                    value = value + \"\";\n                }\n            } else if (valueType == \"date\") {\n                value = kendo.spreadsheet.numberToDate(value);\n            }\n\n            return value;\n        },\n        toJSON: function() {\n            return {\n                filter: \"custom\",\n                logic: this._logic,\n                criteria: this._criteria\n            };\n        }\n    });\n\n    kendo.spreadsheet.TopFilter = Filter.extend({\n        init: function TopFilter(options) {\n            this._type = options.type;\n            this._value = options.value;\n            this._values = [];\n        },\n\n        prepare: function(cells) {\n            var values = cells.map(this.value)\n            .sort()\n            .filter(function(value, index, array) {\n                return index === 0 || value !== array[index - 1];\n            });\n\n            if (this._type === \"topNumber\" || this._type == \"topPercent\") {\n                values.sort(function(x, y) {\n                    return y - x;\n                });\n            } else {\n                values.sort(function(x, y) {\n                    return x - y;\n                });\n            }\n\n            var count = this._value;\n\n            if (this._type === \"topPercent\" || this._type === \"bottomPercent\") {\n                count = (values.length * count / 100) >> 0;\n            }\n\n            this._values = values.slice(0, count);\n        },\n        matches: function(value) {\n            return this._values.indexOf(value) >= 0;\n        },\n        toJSON: function() {\n            return {\n                filter: \"top\",\n                type: this._type,\n                value: this._value\n            };\n        }\n    });\n\n    kendo.spreadsheet.DynamicFilter = Filter.extend({\n        init: function DynamicFilter(options) {\n            this._type = options.type;\n\n            this._predicate = this[options.type];\n\n            if (typeof this._predicate !== \"function\") {\n                throw new Error(\"DynamicFilter type '\" + options.type + \"' not recognized.\");\n            }\n        },\n        value: function(cell) {\n            var value = cell.value;\n\n            if (cell.format) {\n                var type = kendo.spreadsheet.formatting.type(value, cell.format);\n\n                if (type === \"date\") {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n            }\n\n            return value;\n        },\n        prepare: function(cells) {\n            var sum = 0;\n            var count = 0;\n\n            for (var ci = 0; ci < cells.length; ci++) {\n                var value = this.value(cells[ci]);\n\n                if (typeof value === \"number\") {\n                    sum += value;\n                    count ++;\n                }\n            }\n\n            if (count > 0) {\n                this._average = sum / count;\n            } else {\n                this._average = 0;\n            }\n        },\n        matches: function(value) {\n            return this._predicate(value);\n        },\n        aboveAverage: function(value) {\n            if (value instanceof Date) {\n                value = kendo.spreadsheet.dateToNumber(value);\n            }\n\n            if (typeof value !== \"number\") {\n                return false;\n            }\n\n            return value > this._average;\n        },\n        belowAverage: function(value) {\n            if (value instanceof Date) {\n                value = kendo.spreadsheet.dateToNumber(value);\n            }\n\n            if (typeof value !== \"number\") {\n                return false;\n            }\n\n            return value < this._average;\n        },\n        tomorrow: function(value) {\n            if (value instanceof Date) {\n                var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n\n                return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n            }\n\n            return false;\n        },\n        today: function(value) {\n            if (value instanceof Date) {\n                return kendo.date.isToday(value);\n            }\n\n            return false;\n        },\n        yesterday: function(value) {\n            if (value instanceof Date) {\n                var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n\n                return kendo.date.getDate(value).getTime() === yesterday.getTime();\n            }\n\n            return false;\n        },\n        nextWeek: function(value) {\n            return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n        },\n        thisWeek: function(value) {\n            return sameWeek(kendo.date.today(), value);\n        },\n        lastWeek: function(value) {\n            return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n        },\n        nextMonth: function(value) {\n            return sameMonth(value, 1);\n        },\n        thisMonth: function(value) {\n            return sameMonth(value, 0);\n        },\n        lastMonth: function(value) {\n            return sameMonth(value, -1);\n        },\n        nextQuarter: function(value) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n\n                var diff = quarter(value) - quarter(today);\n\n                return (diff === 1 && today.getFullYear() === value.getFullYear()) ||\n                       (diff == -3 && today.getFullYear() + 1 === value.getFullYear());\n            }\n\n            return false;\n        },\n        thisQuarter: function(value) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n\n                var diff = quarter(value) - quarter(today);\n\n                return diff === 0 && today.getFullYear() === value.getFullYear();\n            }\n\n            return false;\n        },\n        lastQuarter: function(value) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n\n                var diff = quarter(today) - quarter(value);\n\n                return (diff === 1 && today.getFullYear() === value.getFullYear()) ||\n                       (diff == -3 && today.getFullYear() - 1 === value.getFullYear());\n            }\n\n            return false;\n        },\n        nextYear: function(value) {\n            return sameYear(value, 1);\n        },\n        thisYear: function(value) {\n            return sameYear(value, 0);\n        },\n        lastYear: function(value) {\n            return sameYear(value, -1);\n        },\n        yearToDate: function(value) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n\n                return value.getFullYear() === today.getFullYear() && value <= today;\n            }\n\n            return false;\n        },\n        toJSON: function() {\n            return {\n                filter: \"dynamic\",\n                type: this._type\n            };\n        }\n    });\n\n    [1, 2, 3, 4].forEach(function(target) {\n        kendo.spreadsheet.DynamicFilter.prototype[\"quarter\" + target] = function(value) {\n           if (value instanceof Date) {\n              return quarter(value) === target;\n           }\n\n           return false;\n        };\n    });\n\n    kendo.cultures[\"en-US\"].calendar.months.names.forEach(function(month, index) {\n        kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function(value) {\n           if (value instanceof Date) {\n               return value.getMonth() === index;\n           }\n\n           return false;\n        };\n    });\n\n    function quarter(value) {\n        var month = value.getMonth() + 1;\n\n        if (month >= 1 && month <= 3) {\n            return 1;\n        } else if(month >= 4 && month <= 6) {\n            return 2;\n        } else if (month >= 7 && month <= 9) {\n            return 3;\n        } else {\n            return 4;\n        }\n    }\n\n    function sameYear(value, offset) {\n        if (value instanceof Date) {\n            var today = kendo.date.today();\n\n            today.setFullYear(today.getFullYear() + offset);\n\n            return today.getFullYear() === value.getFullYear();\n        }\n\n        return false;\n    }\n\n    function sameMonth(value, offset) {\n        if (value instanceof Date) {\n            var today = kendo.date.firstDayOfMonth(kendo.date.today());\n\n            today.setMonth(today.getMonth() + offset, 1);\n\n            return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n        }\n\n        return false;\n    }\n\n    function sameWeek(a, b) {\n        if (b instanceof Date) {\n            var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n\n            var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n\n            return firstWeek.getTime() === secondWeek.getTime();\n        }\n\n        return false;\n    }\n\n})(kendo);\n\n(function(kendo) {\n\n    var Sorter = kendo.Class.extend({\n        init: function(grid, lists) {\n            this._grid = grid;\n            this._lists = lists;\n        },\n\n        indices: function(rangeRef, list, ascending, indices) {\n            var comparer = Sorter.ascendingComparer;\n\n            if (ascending === false) {\n                comparer = Sorter.descendingComparer;\n            }\n\n            return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft),\n                this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n        },\n\n        sortBy: function(ref, column, list, ascending, indices) {\n            var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n\n            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                var start = this._grid.index(ref.topLeft.row, ci);\n                var end = this._grid.index(ref.bottomRight.row, ci);\n\n                for (var li = 0; li < this._lists.length; li++) {\n                    if (start < this._lists[li].lastRangeStart()) {\n                        this._lists[li].sort(start, end, sortedIndices);\n                    }\n                }\n            }\n\n            return sortedIndices;\n        }\n    });\n\n    Sorter.ascendingComparer = function(a, b) {\n        if (a === null && b === null) {\n            return 0;\n        }\n\n        if (a === null) {\n            return 1;\n        }\n\n        if (b === null) {\n            return -1;\n        }\n\n        var typeA = typeof a;\n        var typeB = typeof b;\n\n        if (typeA === \"number\") {\n            if (typeB === \"number\") {\n                return a - b;\n            } else {\n               return -1;\n            }\n        }\n\n        if (typeA === \"string\") {\n            switch (typeB) {\n                case \"number\":\n                    return 1;\n                case \"string\":\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n            }\n        }\n\n        if (typeA === \"boolean\") {\n            switch (typeB) {\n                case \"number\":\n                    return 1;\n                case \"string\":\n                    return 1;\n                case \"boolean\":\n                    return a - b;\n                default:\n                    return -1;\n            }\n        }\n\n        if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n            if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                return 0;\n            } else {\n                return 1;\n            }\n        }\n\n        throw new Error(\"Cannot compare \" + a + \" and \" + b);\n    };\n\n    Sorter.descendingComparer = function(a, b) {\n        if (a === null && b === null) {\n            return 0;\n        }\n\n        if (a === null) {\n            return 1;\n        }\n\n        if (b === null) {\n            return -1;\n        }\n\n        return Sorter.ascendingComparer(b, a);\n    };\n\n    kendo.spreadsheet.Sorter = Sorter;\n})(kendo);\n\n// -*- fill-column: 100 -*-\n    \"use strict\";\n\n    // WARNING: removing the following jshint declaration and turning\n    // == into === to make JSHint happy will break functionality.\n\n\n\n    var util$1 = kendo.util;\n    var calc$2 = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n\n    /* The proper amount of suffering for whoever designed the Excel\n       Custom Number Format would be to have him implement the\n       formatter himself. */\n\n    function parse(input) {\n        input = calc$2.InputStream(input);\n        var sections = [], haveConditional = false, decimalPart;\n\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n\n        // From https://support.office.com/en-us/article/Create-or-delete-a-custom-number-format-78f2a361-936b-4c03-8772-09fab54be7f4:\n        //\n        //    A number format can have up to four sections of code, separated by semicolons. These\n        //    code sections define the format for positive numbers, negative numbers, zero values,\n        //    and text, in that order.\n        //\n        //    You do not have to include all code sections in your custom number format. If you\n        //    specify only two code sections for your custom number format, the first section is\n        //    used for positive numbers and zeros, and the second section is used for negative\n        //    numbers. If you specify only one code section, it is used for all numbers. If you want\n        //    to skip a code section and include a code section that follows it, you must include\n        //    the ending semicolon for the section that you skip.\n        //\n        // However, if sections have conditionals, it is not clear if:\n        //\n        //    - still at most four are allowed\n        //    - is the last section still for text\n        //\n        // We will assume that if no sections have conditionals, then there must be at most 4, and\n        // they will be interpreted in the order above.  If the first section contains a\n        // conditional, then there can be any number of them; if the last one is not conditional\n        // then it will be interpreted as text format.\n\n        if (!haveConditional) {\n            if (sections.length == 1) {\n                sections[0].cond = \"num\";\n            }\n            else if (sections.length == 2) {\n                sections[0].cond = { op: \">=\", value: 0 };\n                sections[1].cond = { op: \"<\", value: 0 };\n            }\n            else if (sections.length >= 3) {\n                sections[0].cond = { op: \">\", value: 0 };\n                sections[1].cond = { op: \"<\", value: 0 };\n                sections[2].cond = { op: \"=\", value: 0 };\n                if (sections.length > 3) {\n                    sections[3].cond = \"text\";\n                    sections = sections.slice(0, 4);\n                }\n            }\n        }\n\n        return sections;\n\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return { op: m[1], value: val, custom: true };\n                }\n            }\n        }\n\n        function readFormat() {\n            var format = [], tok, prev = null;\n            while (!input.eof() && (tok = readNext())) {\n                // disambiguate: m/mm might mean month or minutes depending on surrounding context.\n                if (tok.type == \"date\") {\n                    if (prev && /^(el)?time$/.test(prev.type) && prev.part == \"h\"\n                        && tok.part == \"m\" && tok.format < 3) {\n                        // m or mm that follows hours should display minutes\n                        tok.type = \"time\";\n                    }\n                } else if (/^(el)?time$/.test(tok.type) && tok.part == \"s\") {\n                    if (prev && prev.type == \"date\" && prev.part == \"m\"\n                        && prev.format < 3) {\n                        // m or mm followed by seconds should display minutes\n                        prev.type = \"time\";\n                    }\n                }\n                if (!(/^(?:str|space|fill)$/.test(tok.type))) {\n                    prev = tok;\n                }\n                format.push(tok);\n            }\n            return format;\n        }\n\n        function maybeFraction(tok) {\n            if (tok.type != \"date\" || (tok.part == \"m\" && tok.format < 3)) {\n                var m = input.skip(/^\\.(0+)/);\n                if (m) {\n                    tok.fraction = m[1].length;\n                    if (tok.type == \"date\") {\n                        tok.type = \"time\";\n                    }\n                }\n            }\n            return tok;\n        }\n\n        function readNext() {\n            var ch, m;\n            // numbers\n            if ((m = input.skip(/^([#0?]+)(?:,([#0?]+))+/))) {\n                // thousands separator.  seems convenient to treat\n                // this as a single token.\n                return { type: \"digit\", sep: true, format: m[1] + m[2], decimal: decimalPart };\n            }\n            if ((m = input.skip(/^[#0?]+/))) {\n                return { type: \"digit\", sep: false, format: m[0], decimal: decimalPart };\n            }\n            // XXX: handle this one!\n            if ((m = input.skip(/^(e)([+-])/i))) {\n                return { type: \"exp\", ch: m[1], sign: m[2] };\n            }\n            // dates\n            if ((m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i))) {\n                m = m[1].toLowerCase();\n                return maybeFraction({ type: \"date\", part: m.charAt(0), format: m.length });\n            }\n            // time (interpret as a date)\n            if ((m = input.skip(/^(hh?|ss?)/i))) { // m and mm are handled above\n                m = m[1].toLowerCase();\n                return maybeFraction({ type: \"time\", part: m.charAt(0), format: m.length });\n            }\n            // elapsed time (interpret as interval of days)\n            if ((m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i))) {\n                m = m[1].toLowerCase();\n                return maybeFraction({ type: \"eltime\", part: m.charAt(0), format: m.length });\n            }\n            if ((m = input.skip(/^(a[.]?m[.]?\\/p[.]?m[.]?|a\\/p)/i))) {\n                m = m[1].split(\"/\");\n                return { type: \"ampm\", am: m[0], pm: m[1] };\n            }\n            switch ((ch = input.next())) { // JSHint sadness\n              case \";\":\n                return null;\n              case \"\\\\\":\n                // quotes next character\n                return { type: \"str\", value: input.next() };\n              case '\"':\n                return { type: \"str\", value: input.readEscaped(ch) };\n              case \"@\":\n                return { type: \"text\" };\n              case \"_\":\n                // whitespace of the width of following character\n                return { type: \"space\", value: input.next() };\n              case \"*\":\n                // fills cell width with the following character\n                return { type: \"fill\", value: input.next() };\n              case \".\":\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: \"dec\" };\n                }\n                return { type: \"str\", value: \".\" };\n              case \"%\":\n                return { type: \"percent\" };\n              case \",\":\n                return { type: \"comma\" };\n            }\n\n            // whatever we can't make sense of, output literally.\n            return { type: \"str\", value: ch };\n        }\n\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color : color,\n                cond  : cond,\n                body  : readFormat()\n            };\n        }\n    }\n\n    function print(sections) {\n        return sections.map(printSection).join(\";\");\n\n        function printSection(sec) {\n            var out = \"\";\n            if (sec.color) {\n                out += \"[\" + sec.color + \"]\";\n            }\n            if (sec.cond) {\n                if (!(sec.cond == \"text\" || sec.cond == \"num\")) {\n                    out += \"[\" + sec.cond.op + sec.cond.value + \"]\";\n                }\n            }\n            out += sec.body.map(printToken).join(\"\");\n            return out;\n        }\n\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += \".\" + padLeft(\"\", tok.fraction, \"0\");\n            }\n            return fmt;\n        }\n\n        function printToken(tok) {\n            if (tok.type == \"digit\") {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + \",\" + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            }\n            else if (tok.type == \"exp\") {\n                return tok.ch + tok.sign;\n            }\n            else if (tok.type == \"date\" || tok.type == \"time\") {\n                return maybeFraction(padLeft(\"\", tok.format, tok.part), tok);\n            }\n            else if (tok.type == \"eltime\") {\n                return maybeFraction(\"[\" + padLeft(\"\", tok.format, tok.part) + \"]\", tok);\n            }\n            else if (tok.type == \"ampm\") {\n                return tok.am + \"/\" + tok.pm;\n            }\n            else if (tok.type == \"str\") {\n                return JSON.stringify(tok.value);\n            }\n            else if (tok.type == \"text\") {\n                return \"@\";\n            }\n            else if (tok.type == \"space\") {\n                return \"_\" + tok.value;\n            }\n            else if (tok.type == \"fill\") {\n                return \"*\" + tok.value;\n            }\n            else if (tok.type == \"dec\") {\n                return \".\";\n            }\n            else if (tok.type == \"percent\") {\n                return \"%\";\n            }\n            else if (tok.type == \"comma\") {\n                return \",\";\n            }\n        }\n    }\n\n    function adjustDecimals(sections, x) {\n        sections.forEach(function(sec) {\n            var diff = x;\n            if (sec.cond == \"text\") {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == \"digit\") {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft(\"\", diff, \"0\");\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == \"digit\" && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == \"dec\") {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                // no decimal part was found, insert one after the last digit token.\n                body.splice(\n                    i + 1, 0, {\n                        type    : \"dec\"\n                    }, {\n                        type    : \"digit\",\n                        sep     : false,\n                        decimal : true,\n                        format  : padLeft(\"\", diff, \"0\")\n                    }\n                );\n            }\n        });\n    }\n\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function() {\n                return parts[index++];\n            },\n            eof: function() {\n                return index >= parts.length;\n            },\n            ahead: function(n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function() {\n                index = 0;\n            }\n        };\n    }\n\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var currency = /[\\$\\xA2-\\xA5\\u058F\\u060B\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20BD\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6]/;\n        var scaleCount = 0;\n        var code = \"var intPart, decPart, isNegative, date, time; \";\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = \"\";\n\n        if (condition == \"text\") {\n            preamble = \"if (typeof value == 'string' || value instanceof kendo.spreadsheet.CalcError) { \";\n        }\n        else if (condition == \"num\") {\n            preamble = \"if (typeof value == 'number') { \";\n        }\n        else if (condition) {\n            var op = condition.op == \"=\" ? \"==\" : condition.op;\n            preamble = \"if (typeof value == 'number' && value \"\n                + op + \" \" + condition.value + \") { \";\n            if (!condition.custom) {\n                code += \"value = Math.abs(value); \";\n            }\n        }\n\n        if (format.color) {\n            code += \"result.color = \" + JSON.stringify(format.color) + \"; \";\n        }\n\n        function checkComma(a, b) {\n            if ((a.type == \"digit\" && b.type == \"comma\") ||\n                (a.type == \"comma\" && a.hidden && b.type == \"comma\"))\n            {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == \"percent\") {\n                percentCount++;\n            }\n            else if (tok.type == \"digit\") {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            }\n            else if (tok.type == \"time\") {\n                hasTime = true;\n            }\n            else if (tok.type == \"date\") {\n                hasDate = true;\n            }\n            else if (tok.type == \"ampm\") {\n                hasAmpm = hasTime = true;\n            }\n        }\n\n        if (percentCount > 0) {\n            code += \"value *= \" + Math.pow(100, percentCount) + \"; \";\n        }\n        if (scaleCount > 0) {\n            code += \"value /= \" + Math.pow(1000, scaleCount) + \"; \";\n        }\n        if (intFormat.length) {\n            code += \"intPart = runtime.formatInt(culture, value, \" + JSON.stringify(intFormat) + \", \" + declen + \", \" + separeThousands + \"); \";\n            code += \"isNegative = parseInt(intPart[0]) < 0;\";\n        }\n        if (decFormat.length) {\n            code += \"decPart = runtime.formatDec(value, \" + JSON.stringify(decFormat) + \", \" + declen + \"); \";\n        }\n        if (intFormat.length || decFormat.length) {\n            code += \"type = 'number'; \";\n        }\n        if (hasDate) {\n            code += \"date = runtime.unpackDate(value); \";\n        }\n        if (hasTime) {\n            code += \"time = runtime.unpackTime(value); \";\n        }\n        if (hasDate || hasTime) {\n            code += \"type = 'date'; \";\n        }\n\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = \"if (typeof value == 'number') { \";\n            }\n        }\n\n        input.restart();\n        code += \"var matchedCurrency = false;\";\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == \"dec\") {\n                code += \"output += culture.numberFormat['.']; \";\n            }\n            else if (tok.type == \"comma\" && !tok.hidden) {\n                code += \"output += ','; \";\n            }\n            else if (tok.type == \"percent\") {\n                code += \"type = 'percent'; \";\n                code += \"output += culture.numberFormat.percent.symbol; \";\n            }\n            else if (tok.type == \"str\") {\n                if (currency.test(tok.value)) {\n                    code += \"type = 'currency'; \";\n                    code += \"if (isNegative) { output += '-'; matchedCurrency = true; }\";\n                }\n                code += \"output += \" + JSON.stringify(tok.value) + \"; \";\n            }\n            else if (tok.type == \"text\") {\n                code += \"type = 'text'; \";\n                code += \"output += value; \";\n            }\n            else if (tok.type == \"space\") {\n                code += \"if (output) result.body.push(output); \";\n                code += \"output = ''; \";\n                code += \"result.body.push({ type: 'space', value: \" + JSON.stringify(tok.value) + \" }); \";\n            }\n            else if (tok.type == \"fill\") {\n                code += \"output += runtime.fill(\" + JSON.stringify(tok.value) + \"); \";\n            }\n            else if (tok.type == \"digit\") {\n                code += \"if (isNegative && intPart[0] && matchedCurrency) {intPart[0] = intPart[0].replace('-', '');}\";\n                code += \"output += \" + (tok.decimal ? \"decPart\" : \"intPart\") + \".shift(); \";\n            }\n            else if (tok.type == \"date\") {\n                code += \"output += runtime.date(culture, date, \"\n                    + JSON.stringify(tok.part) + \", \" + tok.format + \"); \";\n            }\n            else if (tok.type == \"time\") {\n                code += \"output += runtime.time(time, \"\n                    + JSON.stringify(tok.part) + \", \" + tok.format + \", \" + hasAmpm + \", \" + tok.fraction + \"); \";\n            }\n            else if (tok.type == \"eltime\") {\n                code += \"output += runtime.eltime(value, \"\n                    + JSON.stringify(tok.part) + \", \" + tok.format + \", \" + tok.fraction + \"); \";\n            }\n            else if (tok.type == \"ampm\") {\n                // XXX: should use culture?  As per the \"spec\", Excel\n                // displays whatever the token was (AM/PM, a/p etc.)\n                code += \"output += time.hours < 12 ? \" + JSON.stringify(tok.am) + \" : \" + JSON.stringify(tok.pm) + \"; \";\n            }\n        }\n\n        code += \"if (output) result.body.push(output); \";\n        code += \"result.type = type; \";\n        code += \"return result; \";\n\n        if (preamble) {\n            code = preamble + code + \"}\";\n        }\n\n        return code;\n    }\n\n    var TEXT = compileFormatPart({ cond: \"text\", body: [ { type: \"text\" } ] });\n\n    var compile = util$1.memoize(function(format) {\n        var tree = parse(format);\n        var code = tree.map(compileFormatPart);\n        code.push(TEXT);\n        code = code.join(\"\\n\");\n        code = \"'use strict'; return function(value, culture){ \"\n            + \"if (!culture) culture = kendo.culture(); \"\n            + \"var output = '', type = null, result = { body: [] }; \" + code + \"; return result; };\";\n        return new Function(\"runtime\", code)(runtime$3);\n    });\n\n    // Attempts to produce a format compatible with kendo.parseDate from our Excel format.  Needed\n    // in runtime.parseDate (passing Excel format to kendo.parseDate will mess up the month or\n    // minutes).  https://github.com/telerik/kendo-ui-core/issues/3797\n    var makeDateFormat = util$1.memoize(function(format){\n        var tree = parse(format);\n        var section, found = false, hasAmpm = false;\n\n        // locate a section that contains date/time formatting.  only the first will be converted.\n        for (var i = 0; i < tree.length; ++i) {\n            section = tree[i];\n            for (var j = 0; j < section.body.length; ++j) {\n                if (/^(?:date|time|ampm)$/.test(section.body[j].type)) {\n                    found = true;\n                    if (section.body[j].type == \"ampm\") {\n                        hasAmpm = true;\n                    }\n                }\n            }\n            if (found) {\n                break;\n            }\n        }\n        if (!found) {\n            return null;\n        }\n\n        return section.body.map(printToken).join(\"\");\n\n        // a little copy/paste goes a long way\n\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += padLeft(\"\", Math.max(tok.fraction, 3), \"f\");\n            }\n            return fmt;\n        }\n\n        function printToken(tok) {\n            if (tok.type == \"digit\") {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + \",\" + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            }\n            else if (tok.type == \"exp\") {\n                return tok.ch + tok.sign;\n            }\n            else if (tok.type == \"date\" || tok.type == \"time\") {\n                var part = tok.part;\n                if (tok.type == \"date\" && /^m/.test(part)) {\n                    part = \"M\"; // month, not minutes\n                }\n                else if (tok.type == \"time\" && /^h/.test(part)) {\n                    if (!hasAmpm) {\n                        // 24-hours clock is H or HH\n                        part = part.toUpperCase();\n                    }\n                }\n                return maybeFraction(padLeft(\"\", tok.format, part), tok);\n            }\n            else if (tok.type == \"ampm\") {\n                return \"tt\";\n            }\n            else if (tok.type == \"str\") {\n                // XXX: this is a bit wrong.  it doesn't look like kendo.toString / kendo.parseDate\n                // support arbitrary text (in Excel formats that's quoted), for example:\n                //    kendo.toString(new Date(), \"here's the day dude: dd\")\n                //   \"3ere'8 t3e 19ay 19u19e: 19\"   (it's 19th June, 3 o'clock, probably 8 seconds)\n                return tok.value;\n            }\n            else if (tok.type == \"space\") {\n                return \" \";\n            }\n            else if (tok.type == \"dec\") {\n                return \".\";\n            }\n            else if (tok.type == \"percent\") {\n                return \"%\";\n            }\n            else if (tok.type == \"comma\") {\n                return \",\";\n            }\n            else {\n                return \"\";\n            }\n        }\n    });\n\n    var runtime$3 = {\n\n        unpackDate: calc$2.runtime.unpackDate,\n        unpackTime: calc$2.runtime.unpackTime,\n\n        date: function(culture, d, part, length) {\n            switch (part) {\n              case \"d\":\n                switch (length) {\n                  case 1: return d.date;\n                  case 2: return padLeft(d.date, 2, \"0\");\n                  case 3: return culture.calendars.standard.days.namesAbbr[d.day];\n                  case 4: return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n              case \"m\":\n                switch (length) {\n                  case 1: return d.month + 1;\n                  case 2: return padLeft(d.month + 1, 2, \"0\");\n                  case 3: return culture.calendars.standard.months.namesAbbr[d.month];\n                  case 4: return culture.calendars.standard.months.names[d.month];\n                  case 5: return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n              case \"y\":\n                switch (length) {\n                  case 2: return d.year % 100;\n                  case 4: return d.year;\n                }\n                break;\n            }\n            return \"##\";\n        },\n\n        time: function(t, part, length, ampm, fraclen) {\n            var ret, fraction;\n            switch (part) {\n              case \"h\":\n                ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, \"0\");\n                if (fraclen) {\n                    fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                }\n                break;\n              case \"m\":\n                ret = padLeft(t.minutes, length, \"0\");\n                if (fraclen) {\n                    fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                }\n                break;\n              case \"s\":\n                ret = padLeft(t.seconds, length, \"0\");\n                if (fraclen) {\n                    fraction = t.milliseconds / 1000;\n                }\n                break;\n            }\n            if (fraction) {\n                ret += runtime$3.toFixed(fraction, fraclen).replace(/^0+/, \"\");\n            }\n            return ret;\n        },\n\n        eltime: function(value, part, length, fraclen) {\n            var ret, fraction;\n            switch (part) {\n              case \"h\":\n                ret = value * 24;\n                break;\n              case \"m\":\n                ret = value * 24 * 60;\n                break;\n              case \"s\":\n                ret = value * 24 * 60 * 60;\n                break;\n            }\n            if (fraclen) {\n                fraction = ret - (ret | 0);\n            }\n            ret = padLeft(ret | 0, length, \"0\");\n            if (fraction) {\n                ret += runtime$3.toFixed(fraction, fraclen).replace(/^0+/, \"\");\n            }\n            return ret;\n        },\n\n        fill: function(ch) {\n            // XXX: how to implement this?\n            return ch;\n        },\n\n        // formatting integer part is slightly different than decimal\n        // part, so they're implemented in two functions.  For the\n        // integer part we need to walk the value and the format\n        // backwards (right-to-left).\n\n        formatInt: function(culture, value, parts, declen, sep) {\n            // toFixed is perfect for rounding our value; if there is\n            // no format for decimals, for example, we want the number\n            // rounded up.\n            value = runtime$3.toFixed(value, declen).replace(/\\..*$/, \"\");\n            var lastPart = parts[parts.length - 1];\n\n            if (declen > 0 && lastPart[parts.length - 1] != \"0\") {\n                // if the rounded number is zero and we have decimal\n                // format, consider it a non-significant digit (Excel\n                // won't display the leading zero for 0.2 in format #.#).\n                // the zero won't e omitted if using 0.0 format\n                if (value === \"0\") { value = \"\"; }\n                else if (value === \"-0\") { value = \"-\"; }\n            }\n\n            var shouldInsertMinus = false;\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n\n            function add(ch, skipMinus) {\n                if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                    str = culture.numberFormat[\",\"] + str;\n                }\n                if(skipMinus && ch === \"-\") {\n                    shouldInsertMinus = true;\n                    ch = \"0\";\n                }\n                str = ch + str;\n                len++;\n            }\n\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = \"\";\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == \"0\") {\n                            add(\"0\");\n                        } else if (chf == \"?\") {\n                            add(\" \");\n                        }\n                    } else {\n                        if (value == \"0\" && chf == \"?\") {\n                            add(\" \");\n                        } else if (chf == \"0\") {\n                            add(value.charAt(iv), true);\n                        } else {\n                            add(value.charAt(iv));\n                        }\n                        iv--;\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n\n            if(shouldInsertMinus) {\n                result[0] = \"-\" + result[0];\n            }\n\n            return result;\n        },\n\n        // for decimal part we walk in normal direction and pad on the\n        // right if required (for '0' or '?' chars).\n\n        formatDec: function(value, parts, declen) {\n            value = runtime$3.toFixed(value, declen);\n            var pos = value.indexOf(\".\");\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, \"\");\n            } else {\n                value = \"\";\n            }\n\n            var iv = 0;\n            var result = [];\n\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = \"\";\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == \"0\") {\n                        str += \"0\";\n                    } else if (chf == \"?\") {\n                        str += \" \";\n                    }\n                }\n                result.push(str);\n            }\n\n            return result;\n        },\n\n        // JS's toFixed is broken, it's only OK to use it on integers.\n        toFixed: function(value, decimals) {\n            return (function toFixed(value, last) {\n                if (!isFinite(value)) {\n                    return \"#NUM!\";\n                }\n\n                // deal early with the trivial cases\n                if (value < 0) {    // JS's Math.round is broken with negative numbers\n                    return \"-\" + toFixed(-value);\n                }\n\n                if (decimals === 0) { // no decimals\n                    return String(Math.round(value));\n                }\n\n                if (value === Math.round(value) && !/e/i.test(String(value))) { // value is integer and not too big\n                    return value.toFixed(decimals);\n                }\n\n                // this handles cases like 0.3.toFixed(20) == \"0.29999999999999998890\", or\n                // 2.1825.toFixed(20) = \"2.18250000000000010658\".\n                // https://github.com/telerik/kendo-ui-core/issues/3520#issuecomment-333768221\n                // https://twitter.com/mcbazon/status/1035828655652593665\n                var num = digNumber(value);\n                var intpart = num.intpart;\n                var decpart = num.decpart;\n                if (decpart.length <= decimals) {\n                    while (decpart.length < decimals) {\n                        decpart += \"0\";\n                    }\n                    return intpart + \".\" + decpart;\n                }\n\n                if (last) {\n                    // \"we should definitely not get here\" (famous last words).  Let's MAKE SURE\n                    // there's no more recursion.\n                    return intpart + \".\" + decpart.substr(0, decimals);\n                }\n\n                // if there are more decimals than wanted, round and try again.\n                // it should not recurse more than once.\n                var f = Math.pow(10, decimals);\n                return toFixed(Math.round(value * f) / f, true);\n\n            })(Number(value.toFixed(14))); /* restrict to 14 decimals, because 0.1 + 0.2 ===\n                                                 * 0.30000000000000004 */\n        }\n\n    };\n\n    function padLeft(val, width, ch) {\n        val += \"\";\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n\n    function padRight(val, width, ch) {\n        val += \"\";\n        while (val.length < width) {\n            val += ch;\n        }\n        return val;\n    }\n\n    // given a number, return { intpart, decpart } as strings.  the main difficulty here is that JS\n    // will stringify really large values in scientific notation (e.g. 1.23e+30, which is actually\n    // the integer 1230000000000000000000000000000).\n    function digNumber(num) {\n        var str = String(num).toLowerCase();\n        var intpart, decpart, m;\n        var pos = str.indexOf(\".\");\n        if (pos < 0) {\n            pos = str.indexOf(\"e\");\n            if (pos < 0) {\n                intpart = str;\n                decpart = \"\";\n            } else {\n                intpart = str.substr(0, pos);\n                decpart = str.substr(pos);\n            }\n        } else {\n            intpart = str.substr(0, pos);\n            decpart = str.substr(pos + 1);\n        }\n        if ((m = /(\\d*)e([-+]?\\d+)/.exec(decpart))) {\n            var exp = parseInt(m[2], 10);\n            if (exp >= 0) {\n                decpart = padRight(m[1], exp, \"0\");\n                intpart += decpart.substr(0, exp);\n                decpart = decpart.substr(exp);\n            } else {\n                intpart = padLeft(intpart, -exp, \"0\");\n                decpart = intpart.substr(exp) + m[1];\n                intpart = intpart.substr(0, intpart.length + exp);\n            }\n        }\n        return { intpart: intpart || \"0\", decpart: decpart };\n    }\n\n    /* -----[ exports ]----- */\n\n    function text(f) {\n        var a = f.body;\n        var text = \"\";\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == \"string\") {\n                text += el;\n            } else if (el.type == \"space\") {\n                text += \" \";\n            }\n        }\n        return text;\n    }\n\n    kendo.spreadsheet.formatting = {\n        compile : compile,\n        parse: parse,\n        format: function(value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element(\"span\");\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == \"string\") {\n                    span.children.push(dom.text(el));\n                } else if (el.type == \"space\") {\n                    span.children.push(dom.element(\"span\", {\n                        style: { visibility: \"hidden\" }\n                    }, [ dom.text(el.value) ]));\n                }\n            }\n            return span;\n        },\n        text: function(value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function(value, format, culture) {\n            var f = compile(format)(value, culture);\n            return { text: text(f), color: f.color, type: f.type };\n        },\n        type: function(value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function(format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        },\n        makeDateFormat: makeDateFormat\n    };\n\n// -*- fill-column: 100 -*-\n    \"use strict\";\n\n    // WARNING: removing the following jshint declaration and turning\n    // == into === to make JSHint happy will break functionality.\n\n\n\n    var util = kendo.util;\n    var spreadsheet$3 = kendo.spreadsheet;\n    var calc$1 = spreadsheet$3.calc;\n    var runtime$2 = calc$1.runtime;\n    var defineFunction$1 = runtime$2.defineFunction;\n    var defineAlias = runtime$2.defineAlias;\n    var CalcError$1 = runtime$2.CalcError;\n    var RangeRef = spreadsheet$3.RangeRef;\n    var CellRef$1 = spreadsheet$3.CellRef;\n    var UnionRef = spreadsheet$3.UnionRef;\n    var Matrix = runtime$2.Matrix;\n    var Ref = spreadsheet$3.Ref;\n    var NameRef = spreadsheet$3.NameRef;\n    var daysInMonth$1 = runtime$2.daysInMonth;\n    var packDate$1 = runtime$2.packDate;\n    var unpackDate$1 = runtime$2.unpackDate;\n    var daysInYear$1 = runtime$2.daysInYear;\n    var limitPrecision = runtime$2.limitPrecision;\n\n    function _days_360$1(start, end, method) {\n        var d1 = unpackDate$1(start);\n        var d2 = unpackDate$1(end);\n\n        // https://en.wikipedia.org/wiki/360-day_calendar\n        // humanity is a mess.\n        if (method) {\n            // EU method\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            // US method\n            if (d1.month == 1 && d2.month == 1\n                && d1.date == daysInMonth$1(d1.year, 1)\n                && d2.date == daysInMonth$1(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth$1(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n\n        return (360 * (d2.year - d1.year)\n                + 30 * (d2.month - d1.month)\n                + (d2.date - d1.date));\n    }\n\n    runtime$2._days_360 = _days_360$1;\n\n    runtime$2.deferInit(() => {\n        /* -----[ Math functions ]----- */\n\n        [ \"abs\", \"cos\", \"sin\", \"acos\", \"asin\", \"tan\", \"atan\", \"exp\", \"sqrt\" ].forEach(function(name){\n            defineFunction$1(name, Math[name]).args([\n                [ \"*n\", \"number\" ]\n            ]);\n        });\n\n        defineFunction$1(\"ln\", Math.log).args([\n            [ \"*n\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"log\", function(num, base){\n            return Math.log(num) / Math.log(base);\n        }).args([\n            [ \"*num\", \"number++\" ],\n            [ \"*base\", [ \"or\", \"number++\", [ \"null\", 10 ] ] ],\n            [ \"?\", [ \"assert\", \"$base != 1\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction$1(\"log10\", function(num){\n            return Math.log(num) / Math.log(10);\n        }).args([\n            [ \"*num\", \"number++\" ]\n        ]);\n\n        defineFunction$1(\"pi\", function(){\n            return Math.PI;\n        }).args([]);\n\n        defineFunction$1(\"sqrtpi\", function(n){\n            return Math.sqrt(n * Math.PI);\n        }).args([\n            [ \"*num\", \"number+\" ]\n        ]);\n\n        defineFunction$1(\"degrees\", function(rad){\n            return ((180 * rad) / Math.PI) % 360;\n        }).args([\n            [ \"*radians\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"radians\", function(deg){\n            return Math.PI * deg / 180;\n        }).args([\n            [ \"*degrees\", \"number\" ]\n        ]);\n\n        function _cosh(n){\n            return (Math.exp(n) + Math.exp(-n)) / 2;\n        }\n\n        defineFunction$1(\"cosh\", _cosh).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"acosh\", function(n){\n            return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n        }).args([\n            [ \"*num\", \"number\" ],\n            [ \"?\", [ \"assert\", \"$num >= 1\" ] ]\n        ]);\n\n        function _sinh(n){\n            return (Math.exp(n) - Math.exp(-n)) / 2;\n        }\n\n        defineFunction$1(\"sinh\", _sinh).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"asinh\", function(n){\n            return Math.log(n + Math.sqrt(n * n + 1));\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"sec\", function(n){\n            return 1 / Math.cos(n);\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"sech\", function(n){\n            return 1 / _cosh(n);\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"csc\", function(n){\n            return 1 / Math.sin(n);\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"csch\", function(n){\n            return 1 / _sinh(n);\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"atan2\", function(x, y){\n            return Math.atan(y / x);\n        }).args([\n            [ \"*x\", \"divisor\" ],\n            [ \"*y\", \"number\" ]\n        ]);\n\n        function _tanh(n) {\n            return _sinh(n) / _cosh(n);\n        }\n\n        defineFunction$1(\"tanh\", _tanh).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"atanh\", function(n){\n            return Math.log(Math.sqrt(1 - n*n) / (1 - n));\n        }).args([\n            [ \"*num\", [ \"and\", \"number\", [ \"(between)\", -1, 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"cot\", function(n){\n            return 1 / Math.tan(n);\n        }).args([\n            [ \"*num\", \"divisor\" ]\n        ]);\n\n        defineFunction$1(\"coth\", function(n){\n            return 1 / _tanh(n);\n        }).args([\n            [ \"*num\", \"divisor\" ]\n        ]);\n\n        defineFunction$1(\"acot\", function(n){\n            return Math.PI / 2 - Math.atan(n);\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"acoth\", function(n){\n            return Math.log((n + 1) / (n - 1)) / 2;\n        }).args([\n            [ \"*num\", \"number\" ],\n            [ \"?\", [ \"or\",\n                    [ \"assert\", \"$num < -1\"],\n                    [ \"assert\", \"$num > 1\" ] ] ]\n        ]);\n\n        defineFunction$1(\"power\", function(a, b){\n            return Math.pow(a, b);\n        }).args([\n            [ \"*a\", \"number\" ],\n            [ \"*b\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"mod\", function(a, b){\n            return a % b;\n        }).args([\n            [ \"*a\", \"number\" ],\n            [ \"*b\", \"divisor\" ]\n        ]);\n\n        defineFunction$1(\"quotient\", function(a, b){\n            return Math.floor(a / b);\n        }).args([\n            [ \"*a\", \"number\" ],\n            [ \"*b\", \"divisor\" ]\n        ]);\n\n        defineFunction$1(\"ceiling\", function(num, s){\n            return s ? s * Math.ceil(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", \"number\" ],\n            [ \"?\", [ \"assert\", \"$significance >= 0 || $number < 0\" ] ]\n        ]);\n\n        defineFunction$1(\"ceiling.precise\", function(num, s){\n            s = Math.abs(s);\n            return s ? s * Math.ceil(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineAlias(\"iso.ceiling\", \"ceiling.precise\");\n\n        // XXX: how do we know if this function is correct?\n        //\n        // https://support.office.com/en-gb/article/CEILING-MATH-function-80f95d2f-b499-4eee-9f16-f795a8e306c8\n        //\n        // There are many combinations of Significance and Mode values that affect rounding of negative\n        // numbers in different ways.  right, thanks for the info. :-\\\n        defineFunction$1(\"ceiling.math\", function(num, s, mode){\n            if (!s || !num) {\n                return 0;\n            }\n            if (num < 0 && ((!mode && s < 0) || (mode && s > 0))) {\n                s = -s;\n            }\n            return s ? s * Math.ceil(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", [ \"or\", \"number\", [ \"null\", \"$number < 0 ? -1 : 1\" ] ] ],\n            [ \"*mode\", [ \"or\", \"logical\", [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction$1(\"floor\", function(num, s){\n            return s ? s * Math.floor(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", \"number\" ],\n            [ \"?\", [ \"assert\", \"$significance >= 0 || $number < 0\" ] ]\n        ]);\n\n        defineFunction$1(\"floor.precise\", function(num, s){\n            s = Math.abs(s);\n            return s ? s * Math.floor(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n        ]);\n\n        // XXX: check this\n        defineFunction$1(\"floor.math\", function(num, s, mode){\n            if (!s || !num) {\n                return 0;\n            }\n            if (num < 0 && ((!mode && s < 0) || (mode && s > 0))) {\n                s = -s;\n            }\n            return s ? s * Math.floor(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", [ \"or\", \"number\", [ \"null\", \"$number < 0 ? -1 : 1\" ] ] ],\n            [ \"*mode\", [ \"or\", \"logical\", [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction$1(\"int\", Math.floor).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"mround\", function(num, mult){\n            return mult ? mult * Math.round(num / mult) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*multiple\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"round\", function(num, digits){\n            var sign = num < 0 ? -1 : 1;\n            if (sign < 0) { num = -num; }\n            digits = Math.pow(10, digits);\n            num = limitPrecision(num * digits);\n            num = Math.round(num);\n            return sign * num / digits;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*digits\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"roundup\", function(num, digits){\n            digits = Math.pow(10, digits);\n            num = limitPrecision(num * digits);\n            num = num < 0 ? Math.floor(num) : Math.ceil(num);\n            return num / digits;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*digits\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"rounddown\", function(num, digits){\n            digits = Math.pow(10, digits);\n            num = limitPrecision(num * digits);\n            num = num < 0 ? Math.ceil(num) : Math.floor(num);\n            return num / digits;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*digits\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"even\", function(num){\n            var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n            return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n        }).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"odd\", function(num){\n            var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n            return n % 2 ? n : n + (n < 0 ? -1 : 1);\n        }).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"sign\", function(num){\n            return num < 0 ? -1 : num > 0 ? 1 : 0;\n        }).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        function _gcd(a, b) {\n            while (b) {\n                var r = a % b;\n                a = b;\n                b = r;\n            }\n            return a;\n        }\n\n        function _lcm(a, b) {\n            return Math.abs(a * b) / _gcd(a, b);\n        }\n\n        defineFunction$1(\"gcd\", function(args){\n            var a = args[0];\n            for (var i = 1; i < args.length; ++i) {\n                a = _gcd(a, args[i]);\n            }\n            return a;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"lcm\", function(args){\n            var a = args[0];\n            for (var i = 1; i < args.length; ++i) {\n                a = _lcm(a, args[i]);\n            }\n            return a;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"sum\", function(numbers){\n            return numbers.reduce(function(sum, num){\n                return sum + num;\n            }, 0);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"product\", function(numbers){\n            return numbers.reduce(function(prod, num){\n                return prod * num;\n            }, 1);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"sumproduct\", function(first, rest) {\n            var sum = 0;\n            first.each(function(p, row, col){\n                if (typeof p == \"number\") {\n                    for (var i = 0; i < rest.length; ++i) {\n                        var v = rest[i].get(row, col);\n                        if (typeof v != \"number\") {\n                            return;\n                        }\n                        p *= v;\n                    }\n                    sum += p;\n                }\n            });\n            return sum;\n        }).args([\n            [ \"a1\", \"matrix\" ],\n            [ \"+\",\n            [ \"a2\", [ \"and\", \"matrix\",\n                        [ \"assert\", \"$a2.width == $a1.width\" ],\n                        [ \"assert\", \"$a2.height == $a1.height\" ] ] ] ]\n        ]);\n\n        defineFunction$1(\"sumsq\", function(numbers){\n            return numbers.reduce(function(sum, num){\n                return sum + num * num;\n            }, 0);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"sumx2my2\", function(a, b){\n            var sum = 0;\n            a.each(function(x, row, col){\n                var y = b.get(row, col);\n                if (typeof x == \"number\" && typeof y == \"number\") {\n                    sum += x*x - y*y;\n                }\n            });\n            return sum;\n        }).args([\n            [ \"a\", \"matrix\" ],\n            [ \"b\", [ \"and\", \"matrix\",\n                    [ \"assert\", \"$b.width == $a.width\" ],\n                    [ \"assert\", \"$b.height == $a.height\" ] ] ]\n        ]);\n\n        defineFunction$1(\"sumx2py2\", function(a, b){\n            var sum = 0;\n            a.each(function(x, row, col){\n                var y = b.get(row, col);\n                if (typeof x == \"number\" && typeof y == \"number\") {\n                    sum += x*x + y*y;\n                }\n            });\n            return sum;\n        }).args([\n            [ \"a\", \"matrix\" ],\n            [ \"b\", [ \"and\", \"matrix\",\n                    [ \"assert\", \"$b.width == $a.width\" ],\n                    [ \"assert\", \"$b.height == $a.height\" ] ] ]\n        ]);\n\n        defineFunction$1(\"sumxmy2\", function(a, b){\n            var sum = 0;\n            a.each(function(x, row, col){\n                var y = b.get(row, col);\n                if (typeof x == \"number\" && typeof y == \"number\") {\n                    sum += (x - y) * (x - y);\n                }\n            });\n            return sum;\n        }).args([\n            [ \"a\", \"matrix\" ],\n            [ \"b\", [ \"and\", \"matrix\",\n                    [ \"assert\", \"$b.width == $a.width\" ],\n                    [ \"assert\", \"$b.height == $a.height\" ] ] ]\n        ]);\n\n        defineFunction$1(\"seriessum\", function(x, n, m, a){\n            var sum = 0;\n            a.each(function(coef){\n                if (typeof coef != \"number\") {\n                    throw new CalcError$1(\"VALUE\");\n                }\n                sum += coef * Math.pow(x, n);\n                n += m;\n            });\n            return sum;\n        }).args([\n            [ \"x\", \"number\" ],\n            [ \"y\", \"number\" ],\n            [ \"m\", \"number\" ],\n            [ \"a\", \"matrix\" ]\n        ]);\n\n        defineFunction$1(\"min\", function(numbers){\n            return numbers.length ? Math.min.apply(Math, numbers) : 0;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number!\" ] ]\n        ]);\n\n        defineFunction$1(\"max\", function(numbers){\n            return numbers.length ? Math.max.apply(Math, numbers) : 0;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number!\" ] ]\n        ]);\n\n        defineFunction$1(\"counta\", function(values){\n            return values.length;\n        }).args([\n            [ \"values\", [ \"#collect\", \"anyvalue\" ] ]\n        ]);\n\n        defineFunction$1(\"count\", function(numbers){\n            return numbers.length;\n        }).args([\n            [ \"numbers\", [ \"#collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"countunique\", function(values){\n            var count = 0, seen = [];\n            values.forEach(function(val){\n                if (seen.indexOf(val) < 0) {\n                    count++;\n                    seen.push(val);\n                }\n            });\n            return count;\n        }).args([\n            [ \"values\", [ \"#collect\", \"anyvalue\" ] ]\n        ]);\n\n        defineFunction$1(\"countblank\", function(a){\n            var count = 0;\n            function add(val) {\n                if (val == null || val === \"\") {\n                    count++;\n                }\n            }\n            function loop(args){\n                for (var i = 0; i < args.length; ++i) {\n                    var x = args[i];\n                    if (x instanceof Matrix) {\n                        x.each(add, true);\n                    } else {\n                        add(x);\n                    }\n                }\n            }\n            loop(a);\n            return count;\n        }).args([\n            [ \"+\", [ \"args\", [ \"or\", \"matrix\", \"anyvalue\" ] ] ]\n        ]);\n\n        defineFunction$1(\"iseven\", function(num){\n            return num % 2 === 0;\n        }).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"isodd\", function(num){\n            return num % 2 !== 0;\n        }).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"n\", function(val){\n            if (typeof val == \"boolean\") {\n                return val ? 1 : 0;\n            }\n            if (typeof val == \"number\") {\n                return val;\n            }\n            return 0;\n        }).args([\n            [ \"*value\", \"anyvalue\" ]\n        ]);\n\n        defineFunction$1(\"na\", function(){\n            return new CalcError$1(\"N/A\");\n        }).args([]);\n\n        /* -----[ the \"*IFS\" functions ]----- */\n\n        // helper function: take `args` like COUNTIFS (see Excel docs) and\n        // calls `f` for each cell matching all criteria.  `f` receives\n        // `chunks` (parsed args containing matrix and predicate) and\n        // row,col of matching cells.\n        function forIFS(args, f) {\n            var chunks = [], i = 0, matrix = args[0];\n            while (i < args.length) {\n                chunks.push({\n                    matrix: args[i++],\n                    pred: parseCriteria(args[i++])\n                });\n            }\n            ROW: for (var row = 0; row < matrix.height; ++row) {\n                COL: for (var col = 0; col < matrix.width; ++col) {\n                    for (i = 0; i < chunks.length; ++i) {\n                        var val = chunks[i].matrix.get(row, col);\n                        if (!chunks[i].pred(val == null || val === \"\" ? 0 : val)) {\n                            continue COL;\n                        }\n                    }\n                    f(row, col);\n                }\n            }\n        }\n\n        var ARGS_COUNTIFS = [\n            [ \"m1\", \"matrix\" ],\n            [ \"c1\", \"anyvalue\" ],\n            [ [ \"m2\", \"matrix\" ],\n            [ \"c2\", \"anyvalue\" ] ]\n        ];\n\n        defineFunction$1(\"countifs\", function(m1, c1, rest){\n            var count = 0;\n            rest.unshift(m1, c1);\n            forIFS(rest, function(){ count++; });\n            return count;\n        }).args(ARGS_COUNTIFS);\n\n        var ARGS_SUMIFS = [\n            [ \"range\", \"matrix\" ]\n        ].concat(ARGS_COUNTIFS);\n\n        defineFunction$1(\"sumifs\", function(range, m1, c1, args){\n            // hack: insert a predicate that filters out non-numeric\n            // values; should also accept blank cells.  it's safe to\n            // modify args.\n            args.unshift(range, numericPredicate, m1, c1);\n            var sum = 0;\n            forIFS(args, function(row, col){\n                var val = range.get(row, col);\n                if (val) {\n                    sum += val;\n                }\n            });\n            return sum;\n        }).args(ARGS_SUMIFS);\n\n        // similar to sumifs, but compute average of matching cells\n        defineFunction$1(\"averageifs\", function(range, m1, c1, args){\n            args.unshift(range, numericPredicate, m1, c1);\n            var sum = 0, count = 0;\n            forIFS(args, function(row, col){\n                var val = range.get(row, col);\n                if (val == null || val === \"\") {\n                    val = 0;\n                }\n                sum += val;\n                count++;\n            });\n            return count ? sum / count : new CalcError$1(\"DIV/0\");\n        }).args(ARGS_SUMIFS);\n\n        defineFunction$1(\"countif\", function(matrix, criteria){\n            criteria = parseCriteria(criteria);\n            var count = 0;\n            matrix.each(function(val){\n                if (criteria(val)) {\n                    count++;\n                }\n            });\n            return count;\n        }).args([\n            [ \"range\", \"matrix\" ],\n            [ \"*criteria\", \"anyvalue\" ]\n        ]);\n\n        var ARGS_SUMIF = [\n            [ \"range\", \"matrix\" ],\n            [ \"*criteria\", \"anyvalue\" ],\n            [ \"sumRange\", [ \"or\", \"area\", \"#matrix\", [ \"null\", \"$range\" ] ] ]\n        ];\n\n        function fetchSumRange(continuation) {\n            return function(callback, range, criteria, sumRange) {\n                var self = this;\n                if (sumRange instanceof Ref) {\n                    // make sure it covers the same area as `range`, as the spec mentions:\n                    //\n                    //     The sum_range argument does not have to be the same size and shape as the\n                    //     range argument. The actual cells that are added are determined by using the\n                    //     upper leftmost cell in the sum_range argument as the beginning cell, and then\n                    //     including cells that correspond in size and shape to the range argument.\n                    //\n                    // It does make one wonder, since only the top-left cell in `sumRange` matters, why\n                    // should it be a range at all?  Oh well, Excel.\n                    var r = sumRange.clone().toRangeRef();\n                    if (r.width() != range.width || r.height() != range.height) {\n                        if (!isFinite(r.topLeft.row)) {\n                            r.topLeft.row = 0;\n                        }\n                        if (!isFinite(r.topLeft.col)) {\n                            r.topLeft.col = 0;\n                        }\n                        r.bottomRight.row = r.topLeft.row + range.height - 1;\n                        r.bottomRight.col = r.topLeft.col + range.width - 1;\n                        return self.resolveCells([ r ], function(){\n                            callback(continuation(range, criteria, self.asMatrix(r)));\n                        });\n                    }\n                }\n                callback(continuation(range, criteria, self.asMatrix(sumRange)));\n            };\n        }\n\n        defineFunction$1(\"sumif\", fetchSumRange(function(range, criteria, sumRange){\n            var sum = 0;\n            criteria = parseCriteria(criteria);\n            range.each(function(val, row, col){\n                if (criteria(val)) {\n                    var v = sumRange.get(row, col);\n                    if (numericPredicate(v)) {\n                        sum += v || 0;\n                    }\n                }\n            });\n            return sum;\n        })).argsAsync(ARGS_SUMIF);\n\n        defineFunction$1(\"averageif\", fetchSumRange(function(range, criteria, sumRange){\n            var sum = 0, count = 0;\n            criteria = parseCriteria(criteria);\n            range.each(function(val, row, col){\n                if (criteria(val)) {\n                    var v = sumRange.get(row, col);\n                    if (numericPredicate(v)) {\n                        sum += v || 0;\n                        count++;\n                    }\n                }\n            });\n            return count ? sum / count : new CalcError$1(\"DIV/0\");\n        })).argsAsync(ARGS_SUMIF);\n\n        (function(def){\n            def(\"large\", function(numbers, nth){\n                return numbers.sort(descending)[nth];\n            });\n            def(\"small\", function(numbers, nth){\n                return numbers.sort(ascending)[nth];\n            });\n        })(function(name, handler){\n            defineFunction$1(name, function(matrix, nth){\n                var numbers = [];\n                var error = matrix.each(function(val){\n                    if (val instanceof CalcError$1) {\n                        return val;\n                    }\n                    if (typeof val == \"number\") {\n                        numbers.push(val);\n                    }\n                });\n                if (error) {\n                    return error;\n                }\n                if (nth > numbers.length) {\n                    return new CalcError$1(\"NUM\");\n                }\n                return handler(numbers, nth - 1);\n            }).args([\n                [ \"array\", \"matrix\" ],\n                [ \"*nth\", \"number++\" ]\n            ]);\n        });\n\n        function _avg(numbers) {\n            return numbers.reduce(function(sum, num){\n                return sum + num;\n            }, 0) / numbers.length;\n        }\n\n        function _var_sp(numbers, divisor, avg) {\n            if (avg == null) {\n                avg = _avg(numbers);\n            }\n            return numbers.reduce(function(sum, num){\n                return sum + Math.pow(num - avg, 2);\n            }, 0) / divisor;\n        }\n\n        function _stdev_sp(numbers, divisor) {\n            return Math.sqrt(_var_sp(numbers, divisor));\n        }\n\n        // https://support.office.com/en-sg/article/STDEV-S-function-7d69cf97-0c1f-4acf-be27-f3e83904cc23\n        defineFunction$1(\"stdev.s\", function(numbers){\n            return _stdev_sp(numbers, numbers.length - 1);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n        ]);\n\n        // https://support.office.com/en-sg/article/STDEV-P-function-6e917c05-31a0-496f-ade7-4f4e7462f285\n        defineFunction$1(\"stdev.p\", function(numbers){\n            return _stdev_sp(numbers, numbers.length);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number!\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 1\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"var.s\", function(numbers){\n            return _var_sp(numbers, numbers.length - 1);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"var.p\", function(numbers){\n            return _var_sp(numbers, numbers.length);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"median\", function(numbers){\n            var n = numbers.length;\n            numbers.sort(ascending);\n            if (n % 2) {\n                // when length is odd, the median is the number in the middle\n                return numbers[n >> 1];\n            }\n            // that's the average of the two middle numbers, written in in a fancy way\n            return (numbers[n >>= 1] + numbers[n - 1]) / 2;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction$1(\"mode.sngl\", function(numbers){\n            numbers.sort(ascending);\n            var prev = null, count = 0, max = 1, mode = null;\n            for (var i = 0; i < numbers.length; ++i) {\n                var n = numbers[i];\n                if (n != prev) {\n                    count = 1;\n                    prev = n;\n                } else {\n                    count++;\n                }\n                if (count > max) {\n                    max = count;\n                    mode = n;\n                }\n            }\n            return mode == null ? new CalcError$1(\"N/A\") : mode;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"mode.mult\", function(numbers){\n            var seen = Object.create(null), max = 2, res = [];\n            numbers.forEach(function(num){\n                var s = seen[num] || 0;\n                seen[num] = ++s;\n                if (s == max) {\n                    res.push(num);\n                } else if (s > max) {\n                    max = s;\n                    res = [ num ];\n                }\n            });\n            var m = new Matrix(this);\n            res.forEach(function(num, i){\n                m.set(i, 0, num);\n            });\n            return m;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"geomean\", function(numbers){\n            var n = numbers.length;\n            var p = numbers.reduce(function(p, num){\n                if (num < 0) {\n                    throw new CalcError$1(\"NUM\");\n                }\n                return p * num;\n            }, 1);\n            return Math.pow(p, 1/n);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"harmean\", function(numbers){\n            var n = numbers.length;\n            var s = numbers.reduce(function(s, num){\n                if (!num) {\n                    throw new CalcError$1(\"DIV/0\");\n                }\n                return s + 1 / num;\n            }, 0);\n            return n / s;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"trimmean\", function(numbers, p){\n            var n = numbers.length;\n            numbers.sort(ascending);\n            var discard = Math.floor(n * p);\n            if (discard % 2) {\n                --discard;\n            }\n            discard /= 2;\n            var sum = 0;\n            for (var i = discard; i < n-discard; ++i) {\n                sum += numbers[i];\n            }\n            return sum / (n - discard * 2);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"percent\", [ \"and\", \"number\", [ \"[between)\", 0, 1 ] ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"frequency\", function(data, bins){\n            // apparently this always returns a vertical matrix in Excel, so we collect all numbers in\n            // bins instead of receiving it as a Matrix and try to mimic its shape.\n            data.sort(ascending);\n            bins.sort(ascending);\n            var prev = -Infinity;\n            var i = 0;\n            function count(max) {\n                var n = 0;\n                while (i < data.length && data[i] > prev && data[i] <= max) {\n                    ++n; ++i;\n                }\n                return n;\n            }\n            var m = new Matrix(this);\n            bins.forEach(function(val, i){\n                var n = count(val);\n                prev = val;\n                m.set(i, 0, n);\n            });\n            m.set(m.height, 0, data.length - i);\n            return m;\n        }).args([\n            [ \"data\", [ \"collect\", \"number\", 1 ] ],\n            [ \"bins\", [ \"collect\", \"number\", 1 ] ]\n        ]);\n\n        defineFunction$1(\"rank.eq\", function(val, numbers, asc) {\n            numbers.sort(asc ? ascending : descending);\n            var pos = numbers.indexOf(val);\n            return pos < 0 ? new CalcError$1(\"N/A\") : pos + 1;\n        }).args([\n            [ \"value\", \"number\" ],\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"order\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n        ]);\n\n        defineAlias(\"rank\", \"rank.eq\");\n\n        defineFunction$1(\"rank.avg\", function(val, numbers, asc) {\n            numbers.sort(asc ? ascending : descending);\n            var pos = numbers.indexOf(val);\n            if (pos < 0) {\n                return new CalcError$1(\"N/A\");\n            }\n            for (var i = pos; numbers[i] == val; ++i){}\n            return (pos + i + 1) / 2;\n        }).args([\n            [ \"value\", \"number\" ],\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"order\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n        ]);\n\n        // formula available at https://support.office.microsoft.com/en-us/article/KURT-function-cbbc2312-dfa6-4cc4-b5c0-1b3c59cc9377\n        defineFunction$1(\"kurt\", function(numbers){\n            var n = numbers.length;\n            var avg = _avg(numbers);\n            var variance = _var_sp(numbers, n-1, avg);\n            var stddev = Math.sqrt(variance);\n            var sum = numbers.reduce(function(sum, num){\n                return sum + Math.pow((num - avg) / stddev, 4);\n            }, 0);\n            return n*(n+1)/((n-1)*(n-2)*(n-3)) * sum\n                - 3*Math.pow(n-1, 2)/((n-2)*(n-3));\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 4\", \"NUM\" ] ]\n        ]);\n\n        function _percentrank(numbers, x, exc) {\n            var nlt = 0, ngt = 0, left = null, right = null, found = false;\n            numbers.forEach(function(num){\n                if (num < x) {\n                    nlt++;\n                    left = left == null ? num : Math.max(left, num);\n                } else if (num > x) {\n                    ngt++;\n                    right = right == null ? num : Math.min(right, num);\n                } else {\n                    found = true;\n                }\n            });\n            if (!nlt && !ngt) {\n                return new CalcError$1(\"N/A\");\n            }\n            if (found) {\n                if (exc) {\n                    return (nlt + 1) / (numbers.length + 1);\n                }\n                return nlt / (nlt + ngt);\n            }\n            return ((right - x) * _percentrank(numbers, left, exc) +\n                    (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n        }\n\n        var ARGS_PERCENTRANK = [\n            [ \"array\", [ \"collect\", \"number\", 1 ] ],\n            [ \"x\", \"number\" ],\n            [ \"significance\", [ \"or\", [ \"null\", 3 ], \"integer++\" ] ],\n            [ \"?\", [ \"assert\", \"$array.length > 0\", \"NUM\" ] ]\n        ];\n\n        defineFunction$1(\"percentrank.inc\", function(numbers, x, significance) {\n            var p = _percentrank(numbers, x, 0);\n            p = p.toFixed(significance + 1);\n            return parseFloat(p.substr(0, p.length - 1));\n        }).args(ARGS_PERCENTRANK);\n\n        defineFunction$1(\"percentrank.exc\", function(numbers, x, significance) {\n            var p = _percentrank(numbers, x, 1);\n            p = p.toFixed(significance + 1);\n            return parseFloat(p.substr(0, p.length - 1));\n        }).args(ARGS_PERCENTRANK);\n\n        defineAlias(\"percentrank\", \"percentrank.inc\");\n\n        function _covariance(x, y, divisor) {\n            var sum = 0;\n            var ax = _avg(x);\n            var ay = _avg(y);\n            var n = x.length;\n            for (var i = 0; i < n; ++i) {\n                sum += (x[i] - ax) * (y[i] - ay);\n            }\n            return sum / divisor;\n        }\n\n        defineFunction$1(\"covariance.p\", function(x, y){\n            return _covariance(x, y, x.length);\n        }).args([\n            [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n            [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$array1.length == $array2.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$array1.length > 0\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction$1(\"covariance.s\", function(x, y){\n            return _covariance(x, y, x.length - 1);\n        }).args([\n            [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n            [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$array1.length == $array2.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$array1.length > 1\", \"DIV/0\" ] ]\n        ]);\n\n        defineAlias(\"covar\", \"covariance.p\");\n\n        /* -----[ Factorials ]----- */\n\n        var _fact = util.memoize(function(n){\n            for (var i = 2, fact = 1; i <= n; ++i) {\n                fact *= i;\n            }\n            return fact;\n        });\n\n        defineFunction$1(\"fact\", _fact).args([\n            [ \"*n\", \"integer+\" ]\n        ]);\n\n        defineFunction$1(\"factdouble\", function(n){\n            for (var i = 2 + (n&1), fact = 1; i <= n; i += 2) {\n                fact *= i;\n            }\n            return fact;\n        }).args([\n            [ \"*n\", \"integer+\" ]\n        ]);\n\n        defineFunction$1(\"multinomial\", function(numbers){\n            var div = 1, sum = 0;\n            numbers.forEach(function(n){\n                if (n < 0) {\n                    throw new CalcError$1(\"NUM\");\n                }\n                sum += n;\n                div *= _fact(n);\n            });\n            return _fact(sum) / div;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        var _combinations = util.memoize(function (n, k){\n            for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n                p1 *= f1;\n                p2 *= f2;\n            }\n            return p1/p2;\n        });\n\n        defineFunction$1(\"combin\", _combinations).args([\n            [ \"*n\", \"integer++\" ],\n            [ \"*k\", [ \"and\", \"integer\", [ \"[between]\", 0, \"$n\" ] ] ]\n        ]);\n\n        defineFunction$1(\"combina\", function(n, k){\n            return _combinations(n + k - 1, n - 1);\n        }).args([\n            [ \"*n\", \"integer++\" ],\n            [ \"*k\", [ \"and\", \"integer\", [ \"[between]\", 1, \"$n\" ] ] ]\n        ]);\n\n        /* -----[ Statistical functions ]----- */\n\n        defineFunction$1(\"average\", function(numbers){\n            var sum = numbers.reduce(function(sum, num){\n                return sum + num;\n            }, 0);\n            return sum / numbers.length;\n        }).args([\n            // most numeric functions must treat booleans as numbers (1 for TRUE\n            // and 0 for FALSE), but AVERAGE shouldn't.\n            [ \"numbers\", [ \"collect\", \"number!\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction$1(\"averagea\", function(values){\n            var sum = 0, count = 0;\n            values.forEach(function(num){\n                if (typeof num != \"string\") {\n                    sum += num;\n                }\n                ++count;\n            });\n            return count ? sum / count : new CalcError$1(\"DIV/0\");\n        }).args([\n            [ \"values\", [ \"collect\", \"anyvalue\" ] ]\n        ]);\n\n        function _percentile(numbers, rank) {\n            numbers.sort(ascending);\n            var n = numbers.length;\n            var k = rank | 0, d = rank - k;\n            if (k === 0) {\n                return numbers[0];\n            }\n            if (k >= n) {\n                return numbers[n - 1];\n            }\n            --k;\n            return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n        }\n\n        function _percentile_inc(numbers, p){\n            // algorithm from https://en.wikipedia.org/wiki/Percentile#Microsoft_Excel_method\n            var rank = p * (numbers.length - 1) + 1;\n            return _percentile(numbers, rank);\n        }\n\n        function _percentile_exc(numbers, p){\n            // https://en.wikipedia.org/wiki/Percentile#NIST_method\n            var rank = p * (numbers.length + 1);\n            return _percentile(numbers, rank);\n        }\n\n        defineFunction$1(\"percentile.inc\", _percentile_inc).args([\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"percentile.exc\", _percentile_exc).args([\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"p\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"quartile.inc\", function(numbers, quarter){\n            return _percentile_inc(numbers, quarter / 4);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"quarter\", [ \"values\", 0, 1, 2, 3, 4 ] ]\n        ]);\n\n        defineFunction$1(\"quartile.exc\", function(numbers, quarter){\n            return _percentile_exc(numbers, quarter / 4);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"quarter\", [ \"values\", 0, 1, 2, 3, 4 ] ]\n        ]);\n\n        defineAlias(\"quartile\", \"quartile.inc\");\n        defineAlias(\"percentile\", \"percentile.inc\");\n\n        var AGGREGATE_FUNCS = [\n            \"AVERAGE\", \"COUNT\", \"COUNTA\", \"MAX\", \"MIN\", \"PRODUCT\",\n            \"STDEV.S\", \"STDEV.P\", \"SUM\", \"VAR.S\", \"VAR.P\", \"MEDIAN\",\n            \"MODE.SNGL\", \"LARGE\", \"SMALL\", \"PERCENTILE.INC\",\n            \"QUARTILE.INC\", \"PERCENTILE.EXC\", \"QUARTILE.EXC\"\n        ];\n\n        function fetchValuesForAggregate(self, args, options) {\n            var values = [];\n            var opt_ignore_hidden_rows = 1;\n            var opt_ignore_errors = 2;\n            var opt_use_aggregates = 4;\n            (function fetchValues(args) {\n                if (args instanceof Ref) {\n                    self.getRefCells(args, true).forEach(function(cell){\n                        var value = cell.value;\n                        if ((options & opt_ignore_hidden_rows) && cell.hidden) {\n                            return;\n                        }\n                        if (cell.formula) {\n                            // XXX: formula.print is fast, but still, can't we do any better here?\n                            //      perhaps access the input string directly somehow?\n                            var str = cell.formula.print(cell.row, cell.col);\n                            if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                                if (!(options & opt_use_aggregates)) {\n                                    return;\n                                }\n                            }\n                        }\n                        if ((options & opt_ignore_errors) && value instanceof CalcError$1) {\n                            return;\n                        }\n                        if (typeof value == \"number\" || value instanceof CalcError$1) {\n                            values.push(value);\n                        }\n                    });\n                } else if (Array.isArray(args)) {\n                    for (var i = 0; i < args.length; ++i) {\n                        fetchValues(args[i]);\n                    }\n                } else if (args instanceof Matrix) {\n                    args.each(fetchValues);\n                } else if (typeof args == \"number\") {\n                    values.push(args);\n                } else if (args instanceof CalcError$1 && !(options & opt_ignore_errors)) {\n                    values.push(args);\n                }\n            })(args);\n            return values;\n        }\n\n        // AGGREGATE function\n        //\n        // https://support.office.com/en-SG/article/aggregate-function-c8caed56-07df-4aeb-9741-23693ffbe525\n        //\n        // we can only partially type-check this function.  also, we need to use the async version in\n        // order to resolve references and delegate values to the function to aggregate.\n        defineFunction$1(\"aggregate\", function(callback, funcId, options, args){\n            // options is a bit field.  that makes sense; it's the documentation which doesn't.\n            var self = this;\n            self.resolveCells(args, function(){\n                var values;\n                if (funcId > 12) {\n                    // \"array form\"\n                    values = fetchValuesForAggregate(self, args[0], options);\n                    var k = args[1];\n                    if (k instanceof CellRef$1) {\n                        k = self.getRefData(k);\n                    }\n                    if (typeof k != \"number\") {\n                        return callback(new CalcError$1(\"VALUE\"));\n                    }\n                } else {\n                    values = fetchValuesForAggregate(self, args, options);\n                }\n                self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n            });\n        }).argsAsync([\n            [ \"funcId\", [ \"values\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,\n                        11, 12, 13, 14, 15, 16, 17, 18, 19 ] ],\n            [ \"options\", [ \"or\",\n                        [ \"null\", 0 ],\n                        [ \"values\", 0, 1, 2, 3, 4, 5, 6, 7  ] ] ],\n            [ \"args\", \"rest\" ]\n        ]);\n\n        defineFunction$1(\"subtotal\", function(callback, funcId){\n            var self = this;\n            var ignoreHidden = funcId > 100;\n            if (ignoreHidden) {\n                funcId -= 100;\n            }\n            var args = [];\n            for (var i = 2; i < arguments.length; ++i) {\n                args.push(arguments[i]);\n            }\n            self.resolveCells(args, function(){\n                var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n                self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n            });\n        }).argsAsync([\n            [ \"funcId\", [ \"values\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,\n                        101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111 ] ],\n            [ \"+\", [ \"ref\", [ \"or\", \"ref\", \"#matrix\" ] ] ]\n        ]);\n\n        // https://support.office.com/en-sg/article/AVEDEV-function-ec78fa01-4755-466c-9a2b-0c4f9eacaf6d\n        defineFunction$1(\"avedev\", function(numbers){\n            var avg = numbers.reduce(function(sum, num){\n                return sum + num;\n            }, 0) / numbers.length;\n            return numbers.reduce(function(sum, num){\n                return sum + Math.abs(num - avg);\n            }, 0) / numbers.length;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n        ]);\n\n        function _binom_dist(x, n, p, cumulative) {\n            if (!cumulative) {\n                return _combinations(n, x) * Math.pow(p, x) * Math.pow(1-p, n-x);\n            } else {\n                var sum = 0;\n                for (var j = 0; j <= x; ++j) {\n                    sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1-p, n-j);\n                }\n                return sum;\n            }\n        }\n\n        defineFunction$1(\"binom.dist\", _binom_dist).args([\n            [ \"successes\", \"integer+\" ],\n            [ \"trials\", [ \"and\", \"integer\", [ \"assert\", \"$trials >= $successes\" ] ] ],\n            [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineAlias(\"binomdist\", \"binom.dist\");\n\n        defineFunction$1(\"binom.inv\", function(n, p, alpha){\n            // XXX: could a binary search be faster?\n            for (var x = 0; x <= n; ++x) {\n                if (_binom_dist(x, n, p, true) >= alpha) {\n                    return x;\n                }\n            }\n            return new CalcError$1(\"N/A\"); // XXX: is this right?\n        }).args([\n            [ \"trials\", \"integer+\" ],\n            [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"alpha\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n        ]);\n\n        defineAlias(\"critbinom\", \"binom.inv\");\n\n        defineFunction$1(\"binom.dist.range\", function(n, p, s, s2){\n            var sum = 0;\n            for (var k = s; k <= s2; ++k) {\n                sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1-p, n-k);\n            }\n            return sum;\n        }).args([\n            [ \"trials\", \"integer+\" ],\n            [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"successes_min\", [ \"and\", \"integer\", [ \"[between]\", 0, \"$trials\" ] ] ],\n            [ \"successes_max\", [ \"or\",\n                                [ \"and\", \"integer\",\n                                [ \"[between]\", \"$successes_min\", \"$trials\" ] ],\n                                [ \"null\", \"$successes_min\" ] ] ]\n        ]);\n\n        defineFunction$1(\"negbinom.dist\", function(x, k, p, cumulative){\n            if (cumulative) {\n                var sum = 0;\n                while (x >= 0) {\n                    sum += _combinations(x+k-1, x) * Math.pow(p, k) * Math.pow(1-p, x);\n                    x--;\n                }\n                return sum;\n            }\n            return _combinations(x+k-1, x) * Math.pow(p, k) * Math.pow(1-p, x);\n        }).args([\n            [ \"number_f\", \"integer+\" ],\n            [ \"number_s\", \"integer+\" ],\n            [ \"probability_s\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineAlias(\"negbinomdist\", \"negbinom.dist\");\n\n        /* -----[ lookup functions ]----- */\n\n        defineFunction$1(\"address\", function(row, col, abs, a1, sheet){\n            // by some lucky coincidence, we get the corret `rel` value by just subtracting 1 from the\n            // abs argument\n            var cell = new CellRef$1(row - 1, col - 1, abs - 1);\n            if (sheet) {\n                cell.setSheet(sheet, true);\n            }\n            return a1 ? cell.print(0, 0) : cell.print();\n        }).args([\n            [ \"row\", \"integer++\" ],\n            [ \"col\", \"integer++\" ],\n            [ \"abs\", [ \"or\", [ \"null\", 1 ], [ \"values\", 1, 2, 3, 4 ]]],\n            [ \"a1\", [ \"or\", [ \"null\", true ], \"logical\" ]],\n            [ \"sheet\", [ \"or\", \"null\", \"string\" ]]\n        ]);\n\n        defineFunction$1(\"areas\", function(ref){\n            var count = 0;\n            (function loop(x){\n                if (x instanceof CellRef$1 || x instanceof RangeRef) {\n                    count++;\n                } else if (x instanceof UnionRef) {\n                    x.refs.forEach(loop);\n                }\n                // XXX: NameRef if we add support\n            })(ref);\n            return count;\n        }).args([\n            [ \"ref\", \"ref\" ]\n        ]);\n\n        defineFunction$1(\"choose\", function(index, args){\n            if (index > args.length) {\n                return new CalcError$1(\"N/A\");\n            } else {\n                return args[index - 1];\n            }\n        }).args([\n            [ \"*index\", \"integer\" ],\n            [ \"+\", [ \"value\", \"anything\" ] ]\n        ]);\n\n        defineFunction$1(\"column\", function(ref){\n            if (!ref) {\n                return this.formula.col + 1;\n            }\n            if (ref instanceof CellRef$1) {\n                return ref.col + 1;\n            }\n            return this.asMatrix(ref).mapCol(function(col){\n                return col + ref.topLeft.col + 1;\n            });\n        }).args([\n            [ \"ref\", [ \"or\", \"area\", \"null\" ]]\n        ]);\n\n        defineFunction$1(\"columns\", function(m){\n            return m instanceof Ref ? m.width() : m.width;\n        }).args([\n            [ \"ref\", [ \"or\", \"area\", \"#matrix\" ] ]\n        ]);\n\n        defineFunction$1(\"formulatext\", function(ref){\n            var cell = this.getRefCells(ref)[0]; // XXX: overkill, but oh well.\n            if (!cell.formula) {\n                return new CalcError$1(\"N/A\");\n            }\n            return cell.formula.print(cell.row, cell.col);\n        }).args([\n            [ \"ref\", \"ref\" ]\n        ]);\n\n        defineFunction$1(\"hlookup\", function(value, m, row, approx){\n            var resultCol = null;\n            m.eachCol(function(col){\n                var data = m.get(0, col);\n                if (approx) {\n                    if (data > value) {\n                        return true;\n                    }\n                    resultCol = col;\n                } else if (data === value) {\n                    resultCol = col;\n                    return true;\n                }\n            });\n            if (resultCol == null) {\n                return new CalcError$1(\"N/A\");\n            }\n            return m.get(row - 1, resultCol);\n        }).args([\n            [ \"value\", \"anyvalue\" ],\n            [ \"range\", \"matrix\" ],\n            [ \"row\", \"integer++\" ],\n            [ \"approx\", [ \"or\", \"logical\", [ \"null\", true ]]]\n        ]);\n\n        defineFunction$1(\"index\", function(callback, ref, row, col, areanum){\n            var self = this;\n            if (ref instanceof UnionRef) {\n                ref = ref.refs[areanum - 1];\n            }\n            if ((!row && !col) || !ref) {\n                return callback(new CalcError$1(\"N/A\"));\n            }\n            if (ref instanceof CellRef$1) {\n                ref = ref.toRangeRef();\n            }\n            if (ref instanceof RangeRef) {\n                if (row && col) {\n                    if (col > ref.width() || row > ref.height()) {\n                        return callback(new CalcError$1(\"REF\"));\n                    }\n                    // fetching a single cell\n                    var cell = ref.toCell(row - 1, col - 1);\n                    self.resolveCells([ cell ], function(){\n                        callback(self.getRefData(cell));\n                    });\n                    return;\n                }\n                if (!row) {\n                    // fetch a full column\n                    var colRange = ref.toColumn(col - 1);\n                    self.resolveCells([ colRange ], function(){\n                        callback(self.asMatrix(colRange));\n                    });\n                    return;\n                }\n                if (!col) {\n                    // fetch a full row\n                    var rowRange = ref.toRow(row - 1);\n                    self.resolveCells([ rowRange ], function(){\n                        callback(self.asMatrix(rowRange));\n                    });\n                    return;\n                }\n            }\n            else if (ref instanceof Matrix) {\n                if (ref.width > 1 && ref.height > 1) {\n                    if (row && col) {\n                        return callback(ref.get(row - 1, col - 1));\n                    }\n                    if (!row) {\n                        return callback(ref.mapRow(function(row){\n                            return ref.get(row, col - 1);\n                        }));\n                    }\n                    if (!col) {\n                        return callback(ref.mapCol(function(col){\n                            return ref.get(row - 1, col);\n                        }));\n                    }\n                }\n                if (ref.width == 1) {\n                    return callback(ref.get((row || 1) - 1, 0));\n                }\n                if (ref.height == 1) {\n                    return callback(ref.get(0, (col || 1) - 1));\n                }\n            }\n            else {\n                callback(new CalcError$1(\"REF\"));\n            }\n        }).argsAsync([\n            [ \"range\", [ \"or\", \"ref\", \"matrix\" ] ],\n            [ \"row\", [ \"or\", \"integer+\", \"null\" ] ],\n            [ \"col\", [ \"or\", \"integer+\", \"null\" ] ],\n            [ \"areanum\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"indirect\", function(thing){\n            try {\n                // XXX: does more work than needed.  we could go for parseReference, but that one\n                // doesn't (yet?) support \"SheetName!\" prefix.\n                var f = this.formula;\n                var exp = calc$1.parseFormula(f.sheet, f.row, f.col, thing);\n                var ref = exp.ast;\n                if (ref instanceof NameRef) {\n                    ref = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n                }\n                if (!(ref instanceof Ref)) {\n                    throw 1;\n                }\n                return ref.absolute(f.row, f.col);\n            } catch(ex) {\n                return new CalcError$1(\"REF\");\n            }\n        }).args([\n            [ \"thing\", \"string\" ]\n        ]);\n\n        // XXX: LOOKUP.  seems to be deprecated in favor of HLOOKUP/VLOOKUP\n\n        // XXX: double-check this one.\n        defineFunction$1(\"match\", function(val, m, type){\n            var index = 1, cmp;\n            if (type === 0) {\n                cmp = parseCriteria(val);\n            } else if (type === -1) {\n                cmp = parseCriteria(\"<=\" + val);\n            } else if (type === 1) {\n                cmp = parseCriteria(\">=\" + val);\n            }\n            if (m.each(function(el){\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n                return index;\n            } else {\n                return new CalcError$1(\"N/A\");\n            }\n        }).args([\n            [ \"value\", \"anyvalue\" ],\n            [ \"range\", \"matrix\" ],\n            [ \"type\", [ \"or\",\n                        [ \"values\", -1, 0, 1 ],\n                        [ \"null\", 1 ]]]\n        ]);\n\n        defineFunction$1(\"offset\", function(ref, rows, cols, height, width){\n            var topLeft = (ref instanceof CellRef$1 ? ref : ref.topLeft).clone();\n            topLeft.row += rows;\n            topLeft.col += cols;\n            if (topLeft.row < 0 || topLeft.col < 0) {\n                return new CalcError$1(\"VALUE\");\n            }\n            if (height > 1 || width > 1) {\n                return new RangeRef(topLeft, new CellRef$1(topLeft.row + height - 1,\n                                                        topLeft.col + width - 1))\n                    .setSheet(ref.sheet, ref.hasSheet());\n            }\n            return topLeft;\n        }).args([\n            [ \"ref\", \"area\" ],\n            [ \"*rows\", \"integer\" ],\n            [ \"*cols\", \"integer\" ],\n            [ \"*height\", [ \"or\", \"integer++\", [ \"null\", \"$ref.height()\" ]]],\n            [ \"*width\", [ \"or\", \"integer++\", [ \"null\", \"$ref.width()\" ]]]\n        ]);\n\n        defineFunction$1(\"row\", function(ref){\n            if (!ref) {\n                return this.formula.row + 1;\n            }\n            if (ref instanceof CellRef$1) {\n                return ref.row + 1;\n            }\n            return this.asMatrix(ref).mapRow(function(row){\n                return row + ref.topLeft.row + 1;\n            });\n        }).args([\n            [ \"ref\", [ \"or\", \"area\", \"null\" ]]\n        ]);\n\n        defineFunction$1(\"rows\", function(m){\n            return m instanceof Ref ? m.height() : m.height;\n        }).args([\n            [ \"ref\", [ \"or\", \"area\", \"#matrix\" ] ]\n        ]);\n\n        defineFunction$1(\"vlookup\", function(value, m, col, approx){\n            var resultRow = null;\n            if (typeof value != \"number\") {\n                approx = false;\n            }\n            if (typeof value == \"string\") {\n                value = value.toLowerCase();\n            }\n            m.eachRow(function(row){\n                var data = m.get(row, 0);\n                if (approx) {\n                    if (data > value) {\n                        return true;\n                    }\n                    resultRow = row;\n                } else {\n                    if (typeof data == \"string\") {\n                        data = data.toLowerCase();\n                    }\n                    if (data === value) {\n                        resultRow = row;\n                        return true;\n                    }\n                }\n            });\n            if (resultRow == null) {\n                return new CalcError$1(\"N/A\");\n            }\n            return m.get(resultRow, col - 1);\n        }).args([\n            [ \"value\", \"anyvalue\" ],\n            [ \"range\", \"matrix\" ],\n            [ \"col\", \"integer++\" ],\n            [ \"approx\", [ \"or\", \"logical\", [ \"null\", true ]]]\n        ]);\n\n        /* -----[ Date and time functions ]----- */\n\n        defineFunction$1(\"date\", function(year, month, date){\n            return packDate$1(year, month-1, date);\n        }).args([\n            [ \"*year\", \"integer\" ],\n            [ \"*month\", \"integer\" ],\n            [ \"*date\", \"integer\" ]\n        ]);\n\n        defineFunction$1(\"day\", function(date){\n            return unpackDate$1(date).date;\n        }).args([\n            [ \"*date\", \"date\" ]\n        ]);\n\n        defineFunction$1(\"month\", function(date){\n            return unpackDate$1(date).month + 1;\n        }).args([\n            [ \"*date\", \"date\" ]\n        ]);\n\n        defineFunction$1(\"year\", function(date){\n            return unpackDate$1(date).year;\n        }).args([\n            [ \"*date\", \"date\" ]\n        ]);\n\n        defineFunction$1(\"weekday\", function(date){\n            // XXX: TODO type\n            return unpackDate$1(date).day + 1;\n        }).args([\n            [ \"*date\", \"date\" ]\n        ]);\n\n        // https://support.office.com/en-GB/article/WEEKNUM-function-e5c43a03-b4ab-426c-b411-b18c13c75340\n        // XXX: this is a mess.\n        defineFunction$1(\"weeknum\", function(date, type){\n            var fw = packDate$1(unpackDate$1(date).year, 0, 1);\n            var sy = unpackDate$1(fw);\n            var diff;\n            if (type == 21) {\n                // Monday-based weeks, first week is the one containing the first Thursday of the year\n                // we want to place in fw and sy the first Thursday\n                diff = 3 - (sy.day + 6) % 7;\n                if (diff < 0) {\n                    diff += 7;\n                }\n                fw += diff;\n                sy.date += diff;\n                sy.day = 4;         // Thursday.\n                type = 1;\n            } else {\n                if (type == 1) {\n                    type = 0;\n                } else if (type == 2) {\n                    type = 1;\n                } else {\n                    type = (type - 10) % 7;\n                }\n                // finally compatible with what we got:\n                // type == 0 means week starts on Sunday\n                //         1                      Monday\n                //         2                      Tuesday\n                // ...\n            }\n            diff = sy.day - type;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw -= diff;\n            return Math.ceil((date + 1 - fw) / 7);\n        }).args([\n            [ \"*date\", \"date\" ],\n            [ \"*type\", [ \"or\", [ \"null\", 1 ],\n                        [ \"values\", 1, 2, 11, 12, 13, 14, 15, 16, 17, 21 ] ] ]\n        ]);\n\n        function weeksInYear(year) {\n            var d = unpackDate$1(packDate$1(year, 0, 1));\n            if ((d.day == 4) || (d.day == 3 && runtime$2.isLeapYear(year))) {\n                // long year\n                return 53;\n            }\n            return 52;\n        }\n\n        defineFunction$1(\"isoweeknum\", function isoweeknum(date){\n            // https://en.wikipedia.org/wiki/ISO_week_date#Calculating_the_week_number_of_a_given_date\n            var d = unpackDate$1(date);\n            var dow = d.day || 7;\n            var wk = Math.floor((d.ord - dow + 10) / 7);\n            if (wk < 1) {\n                return weeksInYear(d.year - 1);\n            } else if (wk == 53 && wk > weeksInYear(d.year)) {\n                return 1;\n            }\n            return wk;\n        }).args([\n            [ \"*date\", \"date\" ]\n        ]);\n\n        defineFunction$1(\"now\", function(){\n            return runtime$2.dateToSerial(new Date());\n        }).args([]);\n\n        defineFunction$1(\"today\", function(){\n            return runtime$2.dateToSerial(new Date()) | 0;\n        }).args([]);\n\n        defineFunction$1(\"time\", function(hh, mm, ss){\n            return runtime$2.packTime(hh, mm, ss, 0);\n        }).args([\n            [ \"*hours\", \"integer\" ],\n            [ \"*minutes\", \"integer\" ],\n            [ \"*seconds\", \"integer\" ]\n        ]);\n\n        defineFunction$1(\"hour\", function(time){\n            return runtime$2.unpackTime(time).hours;\n        }).args([\n            [ \"*time\", \"datetime\" ]\n        ]);\n\n        defineFunction$1(\"minute\", function(time){\n            return runtime$2.unpackTime(time).minutes;\n        }).args([\n            [ \"*time\", \"datetime\" ]\n        ]);\n\n        defineFunction$1(\"second\", function(time){\n            return runtime$2.unpackTime(time).seconds;\n        }).args([\n            [ \"*time\", \"datetime\" ]\n        ]);\n\n        defineFunction$1(\"edate\", function(base, months){\n            var d = unpackDate$1(base);\n            var m = d.month + months;\n            var y = d.year + Math.floor(m/12);\n            m %= 12;\n            if (m < 0) {\n                m += 12;\n            }\n            d = Math.min(d.date, daysInMonth$1(y, m));\n            return packDate$1(y, m, d);\n        }).args([\n            [ \"*start_date\", \"date\" ],\n            [ \"*months\", \"integer\" ]\n        ]);\n\n        defineFunction$1(\"eomonth\", function(base, months){\n            var d = unpackDate$1(base);\n            var m = d.month + months;\n            var y = d.year + Math.floor(m/12);\n            m %= 12;\n            if (m < 0) {\n                m += 12;\n            }\n            d = daysInMonth$1(y, m);\n            return packDate$1(y, m, d);\n        }).args([\n            [ \"*start_date\", \"date\" ],\n            [ \"*months\", \"integer\" ]\n        ]);\n\n        defineFunction$1(\"workday\", function(date, n, holidays){\n            // XXX: the algorithm here is pretty dumb, can we do better?\n            var inc = n > 0 ? 1 : -1;\n            n = Math.abs(n);\n            var dow = unpackDate$1(date).day;\n            while (n > 0) {\n                date += inc;\n                dow = (dow + inc) % 7;\n                if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                    --n;\n                }\n            }\n            return date;\n        }).args([\n            [ \"start_date\", \"date\" ],\n            [ \"days\", \"integer\" ],\n            [ \"holidays\", [ \"collect\", \"date\" ] ]\n        ]);\n\n        defineFunction$1(\"networkdays\", function(date, end, holidays){\n            // XXX: the algorithm here is pretty dumb, can we do better?\n            if (date > end) {\n                var tmp = date;\n                date = end;\n                end = tmp;\n            }\n            var count = 0;\n            var dow = unpackDate$1(date).day;\n            while (date <= end) {\n                if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                    count++;\n                }\n                date++;\n                dow = (dow + 1) % 7;\n            }\n            return count;\n        }).args([\n            [ \"start_date\", \"date\" ],\n            [ \"end_date\", \"date\" ],\n            [ \"holidays\", [ \"collect\", \"date\" ] ]\n        ]);\n\n        defineFunction$1(\"days\", function(end, start){\n            return end - start;\n        }).args([\n            [ \"*start_date\", \"date\" ],\n            [ \"*end_date\", \"date\" ]\n        ]);\n\n        defineFunction$1(\"days360\", _days_360$1).args([\n            [ \"*start_date\", \"date\" ],\n            [ \"*end_date\", \"date\" ],\n            [ \"*method\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n        ]);\n\n        defineFunction$1(\"yearfrac\", function(start, end, method){\n            switch (method) {\n            case 0:\n                return _days_360$1(start, end, false) / 360;\n            case 1:\n                return (end - start) / daysInYear$1(unpackDate$1(start).year);\n            case 2:\n                return (end - start) / 360;\n            case 3:\n                return (end - start) / 365;\n            case 4:\n                return _days_360$1(start, end, true) / 360;\n            }\n        }).args([\n            [ \"*start_date\", \"date\" ],\n            [ \"*end_date\", \"date\" ],\n            [ \"*method\", [ \"or\", [ \"null\", 0 ], [ \"values\", 0, 1, 2, 3, 4 ] ] ]\n        ]);\n\n        defineFunction$1(\"datevalue\", function(text){\n            var date = runtime$2.parseDate(text);\n            if (date) {\n                return runtime$2.dateToSerial(date);\n            }\n            return new CalcError$1(\"VALUE\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"timevalue\", function(text){\n            var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n            if (m) {\n                var hh = parseFloat(m[1]);\n                var mm = parseFloat(m[2]);\n                var ss = m[3] ? parseFloat(m[4]) : 0;\n                //var ms = m[5] ? parseFloat(m[6]) : 0;\n                var ampm = m[7];\n                if (ampm && (hh > 12 || hh < 1)) {\n                    return new CalcError$1(\"VALUE\");\n                }\n                if (/^p/.test(ampm)) {\n                    hh += 12;\n                }\n                return runtime$2.packTime(hh, mm, ss, 0);\n            }\n            return new CalcError$1(\"VALUE\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        /* -----[ Matrix functions ]----- */\n\n        defineFunction$1(\"mdeterm\", function(m){\n            var error = m.each(function(val){\n                if (typeof val != \"number\") {\n                    return new CalcError$1(\"VALUE\");\n                }\n            }, true);\n            return error || m.determinant();\n        }).args([\n            [ \"m\", [ \"and\", \"matrix\",\n                    [ \"assert\", \"$m.width == $m.height\" ] ] ]\n        ]);\n\n        defineFunction$1(\"transpose\", function(m){\n            return m.transpose();\n        }).args([\n            [ \"range\", \"matrix\" ]\n        ]);\n\n        defineFunction$1(\"mmult\", function(a, b){\n            return a.multiply(b);\n        }).args([\n            [ \"a\", \"matrix\" ],\n            [ \"b\", [ \"and\", \"matrix\",\n                    [ \"assert\", \"$b.height == $a.width\" ] ] ]\n        ]);\n\n        defineFunction$1(\"munit\", function(n){\n            return new Matrix(this).unit(n);\n        }).args([\n            [ \"n\", \"integer+\" ]\n        ]);\n\n        defineFunction$1(\"minverse\", function(m){\n            var error = m.each(function(val){\n                if (typeof val != \"number\") {\n                    return new CalcError$1(\"VALUE\");\n                }\n            }, true);\n            return error || m.inverse() || new CalcError$1(\"VALUE\");\n        }).args([\n            [ \"m\", [ \"and\", \"matrix\",\n                    [ \"assert\", \"$m.width == $m.height\" ] ] ]\n        ]);\n\n        /* -----[ Other ]----- */\n\n        defineFunction$1(\"rand\", function() {\n            return Math.random();\n        }).args([]);\n\n        defineFunction$1(\"randbetween\", function(min, max){\n            return min + Math.floor((max - min + 1) * Math.random());\n        }).args([\n            [ \"min\", \"integer\" ],\n            [ \"max\", [ \"and\", \"integer\", [ \"assert\", \"$max >= $min\" ] ] ]\n        ]);\n\n        defineFunction$1(\"true\", function(){\n            return true;\n        }).args([]);\n\n        defineFunction$1(\"false\", function(){\n            return true;\n        }).args([]);\n\n        defineFunction$1(\"roman\", function(num){\n            return util.arabicToRoman(num).toUpperCase();\n        }).args([\n            [ \"*number\", \"integer\" ]\n        ]);\n\n        defineFunction$1(\"arabic\", function(rom){\n            var num = util.romanToArabic(rom);\n            return num == null ? new CalcError$1(\"VALUE\") : num;\n        }).args([\n            [ \"*roman\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"base\", function(number, radix, minLen){\n            var str = number.toString(radix).toUpperCase();\n            while (str.length < minLen) {\n                str = \"0\" + str;\n            }\n            return str;\n        }).args([\n            [ \"*number\", \"integer\" ],\n            [ \"*radix\", [ \"and\", \"integer\", [ \"[between]\", 2, 36 ] ] ],\n            [ \"*minLen\", [ \"or\", \"integer+\", [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction$1(\"decimal\", function(text, radix){\n            text = text.toUpperCase();\n            var val = 0;\n            for (var i = 0; i < text.length; ++i) {\n                var d = text.charCodeAt(i);\n                if (d >= 48 && d <= 57) {\n                    d -= 48;\n                } else if (d >= 65 && d < (55 + radix)) {\n                    d -= 55;\n                } else {\n                    return new CalcError$1(\"VALUE\");\n                }\n                val = val * radix + d;\n            }\n            return val;\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*radix\", [ \"and\", \"integer\", [ \"[between]\", 2, 36 ] ] ]\n        ]);\n\n        /* -----[ String functions ]----- */\n\n        defineFunction$1(\"char\", function(code){\n            return String.fromCharCode(code);\n        }).args([\n            [ \"*code\", \"integer+\" ]\n        ]);\n\n        // From XRegExp\n        var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n\n        defineFunction$1(\"clean\", function(text){\n            return text.replace(RX_NON_PRINTABLE, \"\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"code\", function(text){\n            return text.charAt(0);\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineAlias(\"unichar\", \"char\");\n        defineAlias(\"unicode\", \"code\");\n\n        defineFunction$1(\"concatenate\", function(args){\n            var out = \"\";\n            for (var i = 0; i < args.length; ++i) {\n                out += args[i];\n            }\n            return out;\n        }).args([\n            [ \"+\",\n            [ \"*text\", \"string\" ] ]\n        ]);\n\n        defineFunction$1(\"dollar\", function(number, decimals){\n            var format = \"$#,##0DECIMALS;($#,##0DECIMALS)\";\n            var dec = \"\";\n            var denomitator = 1;\n\n            while (decimals-- > 0) {\n            dec += \"0\";\n            }\n\n            while (++decimals < 0) {\n            denomitator *= 10;\n            }\n\n            if (dec !== \"\") {\n            dec = \".\" + dec;\n            } else if (denomitator !== 1) {\n                number = Math.round(number / denomitator) * denomitator;\n            }\n\n            format = format.replace(/DECIMALS/g, dec);\n\n            return spreadsheet$3.formatting.text(number, format);\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*decimals\", [ \"or\", \"integer\", [ \"null\", 2 ] ] ]\n        ]);\n\n        defineFunction$1(\"exact\", function(a, b){\n            return a === b;\n        }).args([\n            [ \"*text1\", \"string\" ],\n            [ \"*text2\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"find\", function(substring, string, start){\n            var pos = string.indexOf(substring, start - 1);\n            return pos < 0 ? new CalcError$1(\"VALUE\") : pos + 1;\n        }).args([\n            [ \"*substring\", \"string\" ],\n            [ \"*string\", \"string\" ],\n            [ \"*start\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"fixed\", function(number, decimals, noCommas){\n            var scale = Math.pow(10, decimals);\n            number = Math.round(number * scale) / scale;\n            var format = noCommas ? \"0\" : \"#,##0\";\n            if (decimals > 0) {\n                format += \".\";\n                while (decimals-- > 0) { format += \"0\"; }\n            }\n            return spreadsheet$3.formatting.text(number, format);\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*decimals\", [ \"or\", \"integer\", [ \"null\", 2 ] ] ],\n            [ \"*noCommas\", [ \"or\", \"boolean\", [ \"null\", false ] ] ]\n        ]);\n\n        defineFunction$1(\"left\", function(text, length){\n            return text.substr(0, length);\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*length\", [ \"or\", \"integer+\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"right\", function(text, length){\n            return text.substr(-length);\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*length\", [ \"or\", \"integer+\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"len\", function(text){\n            return text.length;\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"lower\", function(text){\n            return text.toLowerCase();\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"upper\", function(text){\n            return text.toUpperCase();\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"ltrim\", function(text){\n            return text.replace(/^\\s+/, \"\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"rtrim\", function(text){\n            return text.replace(/\\s+$/, \"\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"trim\", function(text){\n            return text.replace(/^\\s+|\\s+$/, \"\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"mid\", function(text, start, length){\n            return text.substr(start - 1, length);\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*start\", \"integer++\" ],\n            [ \"*length\", \"integer+\" ]\n        ]);\n\n        defineFunction$1(\"proper\", function(text){\n            return text.toLowerCase().replace(/\\b./g, function(s){\n                return s.toUpperCase();\n            });\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"replace\", function(text, start, length, newText){\n            return text.substr(0, --start) + newText + text.substr(start + length);\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*start\", \"integer++\" ],\n            [ \"*length\", \"integer+\" ],\n            [ \"*newText\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"rept\", function(text, number){\n            var out = \"\";\n            while (number-- > 0) { out += text; }\n            return out;\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*number\", \"integer+\" ]\n        ]);\n\n        defineFunction$1(\"search\", function(substring, string, start){\n            var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n            return pos < 0 ? new CalcError$1(\"VALUE\") : pos + 1;\n        }).args([\n            [ \"*substring\", \"string\" ],\n            [ \"*string\", \"string\" ],\n            [ \"*start\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"substitute\", function(text, oldText, newText, nth){\n            if (oldText === newText) {\n                return text;\n            }\n            var a = text.split(oldText);\n            if (nth == null) {\n                return a.join(newText);\n            }\n            text = \"\";\n            nth--;\n            for (var i = 0; i < a.length; ++i) {\n                text += a[i];\n                if (i < a.length - 1) {\n                    if (i === nth) {\n                        text += newText;\n                    } else {\n                        text += oldText;\n                    }\n                }\n            }\n            return text;\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*oldText\", \"string\" ],\n            [ \"*newText\", \"string\" ],\n            [ \"*nth\", [ \"or\", \"integer++\", \"null\" ] ]\n        ]);\n\n        defineFunction$1(\"t\", function(value){\n            return typeof value == \"string\" ? value : \"\";\n        }).args([\n            [ \"*value\", \"anyvalue\" ]\n        ]);\n\n        defineFunction$1(\"text\", function(value, format){\n            return spreadsheet$3.formatting.text(value, format);\n        }).args([\n            [ \"*value\", \"anyvalue\" ],\n            [ \"*format\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"value\", function(value){\n            if (typeof value == \"number\") {\n                return value;\n            }\n            if (typeof value == \"boolean\") {\n                return +value;\n            }\n            // XXX: this is dirty.  we need it so we can parse i.e. \"$12,345.50\"\n            value = (value+\"\").replace(/[$,]/g, \"\");\n            value = parseFloat(value);\n            return isNaN(value) ? new CalcError$1(\"VALUE\") : value;\n        }).args([\n            [ \"*value\", \"anyvalue\" ]\n        ]);\n\n        function Hyperlink(link, text) {\n            this.link = link;\n            this.text = text;\n        }\n        Hyperlink.prototype.toString = function() {\n            return this.text;\n        };\n\n        defineFunction$1(\"hyperlink\", function(link, text){\n            return new Hyperlink(link, text);\n        }).args([\n            [ \"*link\", \"string\" ],\n            [ \"*text\", [ \"or\", \"string\", [ \"null\", \"$link\" ] ] ]\n        ]);\n\n        //// other misc functions\n\n        defineFunction$1(\"iferror\", function(value, valueIfError){\n            return value instanceof CalcError$1 ? valueIfError : value;\n        }).args([\n            [ \"*value\", \"forced!\" ],\n            [ \"*value_if_error\", \"anyvalue!\" ]\n        ]);\n\n        //// utils\n\n        var parseCriteria = (function(){\n            var RXCACHE = Object.create(null);\n\n            function makeComparator(cmp, x) {\n                if (typeof x == \"string\") {\n                    var num = parseFloat(x);\n                    if (!isNaN(num) && num == x) {\n                        x = num;\n                    }\n                }\n                return function(a) {\n                    var b = x;\n                    if (typeof a == \"string\" && typeof b == \"string\") {\n                        a = a.toLowerCase();\n                        b = b.toLowerCase();\n                    }\n                    return cmp(a, b);\n                };\n            }\n\n            function lc(a) {\n                var num, str;\n                if (typeof a == \"string\") {\n                    a = a.toLowerCase();\n                }\n                if (/^[0-9.]+%$/.test(a)) {\n                    str = a.substr(0, a.length - 1);\n                    num = parseFloat(str);\n                    if (!isNaN(num) && num == str) {\n                        a = num / 100;\n                    }\n                } else if (/^[0-9.]+$/.test(a)) {\n                    num = parseFloat(a);\n                    if (!isNaN(num) && num == a) {\n                        a = num;\n                    }\n                }\n                return a;\n            }\n\n            function compLT(a, b) { return lc(a) < lc(b); }\n            function compLTE(a, b) { return lc(a) <= lc(b); }\n            function compGT(a, b) { return lc(a) > lc(b); }\n            function compGTE(a, b) { return lc(a) >= lc(b); }\n            function compNE(a, b) { return !compEQ(a, b); }\n            function compEQ(a, b) {\n                if (b instanceof RegExp) {\n                    return b.test(a);\n                }\n                if (typeof a == \"string\" || typeof b == \"string\") {\n                    // if either one is string, make sure both are strings\n                    a = String(a);\n                    b = String(b);\n                }\n                return lc(a) == lc(b);\n            }\n\n            return function(cmp) {\n                if (typeof cmp == \"function\") {\n                    return cmp;\n                }\n                var m;\n                if ((m = /^=(.*)$/.exec(cmp))) {\n                    return makeComparator(compEQ, m[1]);\n                }\n                if ((m = /^<>(.*)$/.exec(cmp))) {\n                    return makeComparator(compNE, m[1]);\n                }\n                if ((m = /^<=(.*)$/.exec(cmp))) {\n                    return makeComparator(compLTE, m[1]);\n                }\n                if ((m = /^<(.*)$/.exec(cmp))) {\n                    return makeComparator(compLT, m[1]);\n                }\n                if ((m = /^>=(.*)$/.exec(cmp))) {\n                    return makeComparator(compGTE, m[1]);\n                }\n                if ((m = /^>(.*)$/.exec(cmp))) {\n                    return makeComparator(compGT, m[1]);\n                }\n                if (/[?*]/.exec(cmp)) {\n                    // has wildchars\n                    var rx = RXCACHE[cmp];\n                    if (!rx) {\n                        rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function(s){\n                            switch (s) {\n                            case \"~?\" : return \"\\\\?\";\n                            case \"~*\" : return \"\\\\*\";\n                            case \"?\"  : return \".\";\n                            case \"*\"  : return \".*\";\n                            default   : return \"\\\\\" + s;\n                            }\n                        });\n                        rx = RXCACHE[cmp] = new RegExp(\"^\" + rx + \"$\", \"i\");\n                    }\n                    return makeComparator(compEQ, rx);\n                }\n                return makeComparator(compEQ, cmp);\n            };\n        })();\n\n        function numericPredicate(val) {\n            return typeof val == \"number\"\n                || typeof val == \"boolean\"\n                || val == null\n                || val === \"\";\n        }\n\n        function ascending(a, b) {\n            return a === b ? 0 : a < b ? -1 : 1;\n        }\n\n        function descending(a, b) {\n            return a === b ? 0 : a < b ? 1 : -1;\n        }\n\n        // var m = new Matrix();\n        // m.data = [[1, 2, 3], [4, 1, 6], [7, 8, 9]];\n        // //m.data = [[0, 2, 1], [2, 6, 1], [1, 1, 4]];\n        // //m.data = [[1,4,1,1], [1,4,0,1], [2,3,1,2], [3,2,6,4]];\n        // m.width = m.height = 3;\n        // var x = m.inverse();\n        // x.dump();\n    });\n\n// -*- fill-column: 100 -*-\n    \"use strict\";\n\n    // WARNING: removing the following jshint declaration and turning\n    // == into === to make JSHint happy will break functionality.\n\n\n\n    var spreadsheet$2 = kendo.spreadsheet;\n    var calc = spreadsheet$2.calc;\n    var runtime$1 = calc.runtime;\n    var defineFunction = runtime$1.defineFunction;\n    var CalcError = runtime$1.CalcError;\n    var packDate = runtime$1.packDate;\n    var unpackDate = runtime$1.unpackDate;\n    var isLeapYear = runtime$1.isLeapYear;\n    var daysInMonth = runtime$1.daysInMonth;\n    var _days_360 = runtime$1._days_360;\n\n    runtime$1.deferInit(() => {\n        /* -----[ Spreadsheet API ]----- */\n        defineFunction(\"ERF\", function(ll, ul) {\n            if (ul == null) {\n                return ERF(ll);\n            }\n            return ERF(ul) - ERF(ll);\n        }).args([\n            [ \"lower_limit\", \"number\" ],\n            [ \"upper_limit\", [ \"or\", \"number\", \"null\" ] ]\n        ]);\n\n        defineFunction(\"ERFC\", ERFC).args([\n            [ \"x\", \"number\" ]\n        ]);\n\n        defineFunction(\"GAMMALN\", GAMMALN).args([\n            [ \"x\", \"number++\" ]\n        ]);\n\n        defineFunction(\"GAMMA\", GAMMA).args([\n            [ \"x\", \"number\" ]\n        ]);\n\n        defineFunction(\"GAMMA.DIST\", GAMMA_DIST).args([\n            [ \"x\", \"number+\" ],\n            [ \"alpha\", \"number++\" ],\n            [ \"beta\", \"number++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"GAMMA.INV\", GAMMA_INV).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"alpha\", \"number++\" ],\n            [ \"beta\", \"number++\" ]\n        ]);\n\n        defineFunction(\"NORM.S.DIST\", NORM_S_DIST).args([\n            [ \"z\", \"number\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"NORM.S.INV\", NORM_S_INV).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n        ]);\n\n        defineFunction(\"NORM.DIST\", NORM_DIST).args([\n            [ \"x\", \"number\" ],\n            [ \"mean\", \"number\" ],\n            [ \"stddev\", \"number++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"NORM.INV\", NORM_INV).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"mean\", \"number\" ],\n            [ \"stddev\", \"number++\" ]\n        ]);\n\n        defineFunction(\"BETADIST\", BETADIST).args([\n            [ \"x\", \"number\" ],\n            [ \"alpha\", \"number++\" ],\n            [ \"beta\", \"number++\" ],\n            [ \"A\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"B\", [ \"or\", \"number\", [ \"null\", 1 ] ] ],\n            [ \"?\", [ \"assert\", \"$x >= $A\", \"NUM\" ] ],\n            [ \"?\", [ \"assert\", \"$x <= $B\", \"NUM\" ] ],\n            [ \"?\", [ \"assert\", \"$A < $B\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"BETA.DIST\", BETA_DIST).args([\n            [ \"x\", \"number\" ],\n            [ \"alpha\", \"number++\" ],\n            [ \"beta\", \"number++\" ],\n            [ \"cumulative\", \"logical\" ],\n            [ \"A\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"B\", [ \"or\", \"number\", [ \"null\", 1 ] ] ],\n            [ \"?\", [ \"assert\", \"$x >= $A\", \"NUM\" ] ],\n            [ \"?\", [ \"assert\", \"$x <= $B\", \"NUM\" ] ],\n            [ \"?\", [ \"assert\", \"$A < $B\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"BETA.INV\", BETA_INV).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"alpha\", \"number++\" ],\n            [ \"beta\", \"number++\" ],\n            [ \"A\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"B\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction(\"CHISQ.DIST\", chisq_left).args([\n            [ \"x\", \"number+\" ],\n            [ \"deg_freedom\", \"integer++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"CHISQ.DIST.RT\", chisq_right).args([\n            [ \"x\", \"number+\" ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"CHISQ.INV\", chisq_left_inv).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"CHISQ.INV.RT\", chisq_right_inv).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"CHISQ.TEST\", function(ac, ex){\n            return chisq_test(ac.data, ex.data);\n        }).args([\n            [ \"actual_range\", \"matrix\" ],\n            [ \"expected_range\", \"matrix\" ],\n            [ \"?\", [ \"assert\", \"$actual_range.width == $expected_range.width\" ] ],\n            [ \"?\", [ \"assert\", \"$actual_range.height == $expected_range.height\" ] ]\n        ]);\n\n        defineFunction(\"EXPON.DIST\", expon).args([\n            [ \"x\", \"number+\" ],\n            [ \"lambda\", \"number++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"POISSON.DIST\", poisson).args([\n            [ \"x\", \"integer+\" ],\n            [ \"mean\", \"number+\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"F.DIST\", Fdist).args([\n            [ \"x\", \"number+\" ],\n            [ \"deg_freedom1\", \"integer++\" ],\n            [ \"deg_freedom2\", \"integer++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"F.DIST.RT\", Fdist_right).args([\n            [ \"x\", \"number+\" ],\n            [ \"deg_freedom1\", \"integer++\" ],\n            [ \"deg_freedom2\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"F.INV\", Finv).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"deg_freedom1\", \"integer++\" ],\n            [ \"deg_freedom2\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"F.INV.RT\", Finv_right).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"deg_freedom1\", \"integer++\" ],\n            [ \"deg_freedom2\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"F.TEST\", Ftest).args([\n            [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n            [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$array1.length >= 2\", \"DIV/0\" ] ],\n            [ \"?\", [ \"assert\", \"$array2.length >= 2\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction(\"FISHER\", fisher).args([\n            [ \"x\", [ \"and\", \"number\", [ \"(between)\", -1, 1 ] ] ]\n        ]);\n\n        defineFunction(\"FISHERINV\", fisherinv).args([\n            [ \"y\", \"number\" ]\n        ]);\n\n        defineFunction(\"T.DIST\", Tdist).args([\n            [ \"x\", \"number\" ],\n            [ \"deg_freedom\", \"integer++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"T.DIST.RT\", Tdist_right).args([\n            [ \"x\", \"number\" ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"T.DIST.2T\", Tdist_2tail).args([\n            [ \"x\", \"number+\" ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"T.INV\", Tdist_inv).args([\n            [ \"p\", [ \"and\", \"number\", [ \"(between]\", 0, 1 ] ] ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"T.INV.2T\", Tdist_2tail_inv).args([\n            [ \"p\", [ \"and\", \"number\", [ \"(between]\", 0, 1 ] ] ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"T.TEST\", Tdist_test).args([\n            [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n            [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n            [ \"tails\", [ \"and\", \"integer\", [ \"values\", 1, 2 ] ] ],\n            [ \"type\", [ \"and\", \"integer\", [ \"values\", 1, 2, 3 ] ] ],\n            [ \"?\", [ \"assert\", \"$type != 1 || $array1.length == $array2.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$array1.length >= 2\", \"DIV/0\" ] ],\n            [ \"?\", [ \"assert\", \"$array2.length >= 2\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction(\"CONFIDENCE.T\", confidence_t).args([\n            [ \"alpha\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ],\n            [ \"standard_dev\", \"number++\" ],\n            [ \"size\", [ \"and\", \"integer++\",\n                        [ \"assert\", \"$size != 1\", \"DIV/0\" ] ] ]\n        ]);\n\n        defineFunction(\"CONFIDENCE.NORM\", confidence_norm).args([\n            [ \"alpha\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ],\n            [ \"standard_dev\", \"number++\" ],\n            [ \"size\", [ \"and\", \"integer++\" ] ]\n        ]);\n\n        defineFunction(\"GAUSS\", gauss).args([\n            [ \"z\", \"number\" ]\n        ]);\n\n        defineFunction(\"PHI\", phi).args([\n            [ \"x\", \"number\" ]\n        ]);\n\n        defineFunction(\"LOGNORM.DIST\", lognorm_dist).args([\n            [ \"x\", \"number++\" ],\n            [ \"mean\", \"number\" ],\n            [ \"standard_dev\", \"number++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"LOGNORM.INV\", lognorm_inv).args([\n            [ \"probability\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ],\n            [ \"mean\", \"number\" ],\n            [ \"standard_dev\", \"number++\" ]\n        ]);\n\n        defineFunction(\"PROB\", prob).args([\n            [ \"x_range\", [ \"collect\", \"number\", 1 ] ],\n            [ \"prob_range\", [ \"collect\", \"number\", 1 ] ],\n            [ \"lower_limit\", \"number\" ],\n            [ \"upper_limit\", [ \"or\", \"number\", [ \"null\", \"$lower_limit\" ] ] ],\n            [ \"?\", [ \"assert\", \"$prob_range.length == $x_range.length\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"SLOPE\", slope).args([\n            [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n            [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"INTERCEPT\", intercept).args([\n            [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n            [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"PEARSON\", pearson).args([\n            [ \"array1\", [ \"collect!\", \"anything\", 1 ] ],\n            [ \"array2\", [ \"collect!\", \"anything\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$array2.length == $array1.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$array2.length > 0 && $array1.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"RSQ\", rsq).args([\n            [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n            [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length != 1 && $known_y.length != 1\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"STEYX\", steyx).args([\n            [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n            [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length >= 3 && $known_y.length >= 3\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction(\"FORECAST\", forecast).args([\n            [ \"x\", \"number\" ],\n            [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n            [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"LINEST\", linest).args([\n            [ \"known_y\", \"matrix\" ],\n            [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ],\n            [ \"stats\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n        ]);\n\n        defineFunction(\"LOGEST\", logest).args([\n            [ \"known_y\", \"matrix\" ],\n            [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ],\n            [ \"stats\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n        ]);\n\n        defineFunction(\"TREND\", trend).args([\n            [ \"known_y\", \"matrix\" ],\n            [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"new_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ]\n        ]);\n\n        defineFunction(\"GROWTH\", growth).args([\n            [ \"known_y\", \"matrix\" ],\n            [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"new_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ]\n        ]);\n\n        defineFunction(\"FV\", FV).args([\n            [ \"rate\", \"number\" ],\n            [ \"nper\", \"number\" ],\n            [ \"pmt\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"pv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"?\", [ \"assert\", \"$pmt || $pv\" ] ]\n        ]);\n\n        defineFunction(\"PV\", PV).args([\n            [ \"rate\", \"number\" ],\n            [ \"nper\", \"number\" ],\n            [ \"pmt\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction(\"PMT\", PMT).args([\n            [ \"rate\", \"number\" ],\n            [ \"nper\", \"number\" ],\n            [ \"pmt\", \"number\" ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction(\"NPER\", NPER).args([\n            [ \"rate\", \"number\" ],\n            [ \"pmt\", \"number\" ],\n            [ \"pv\", \"number\" ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction(\"RATE\", RATE).args([\n            [ \"nper\", \"number\" ],\n            [ \"pmt\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"pv\", \"number\" ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"guess\", [ \"or\", \"number++\", [ \"null\", 0.01 ] ] ],\n            [ \"?\", [ \"assert\", \"$pmt || $fv\" ] ]\n        ]);\n\n        defineFunction(\"IPMT\", IPMT).args([\n            [ \"rate\", \"number\" ],\n            [ \"per\", \"number++\" ],\n            [ \"nper\", \"number++\" ],\n            [ \"pv\", \"number\" ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"?\", [ \"assert\", \"$per >= 1 && $per <= $nper\" ] ]\n        ]);\n\n        defineFunction(\"PPMT\", PPMT).args([\n            [ \"rate\", \"number\" ],\n            [ \"per\", \"number++\" ],\n            [ \"nper\", \"number++\" ],\n            [ \"pv\", \"number\" ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"?\", [ \"assert\", \"$per >= 1 && $per <= $nper\" ] ]\n        ]);\n\n        defineFunction(\"CUMPRINC\", CUMPRINC).args([\n            [ \"rate\", \"number++\" ],\n            [ \"nper\", \"number++\" ],\n            [ \"pv\", \"number++\" ],\n            [ \"start_period\", \"number++\" ],\n            [ \"end_period\", \"number++\" ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"?\", [ \"assert\", \"$end_period >= $start_period\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"CUMIPMT\", CUMIPMT).args([\n            [ \"rate\", \"number++\" ],\n            [ \"nper\", \"number++\" ],\n            [ \"pv\", \"number++\" ],\n            [ \"start_period\", \"number++\" ],\n            [ \"end_period\", \"number++\" ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"?\", [ \"assert\", \"$end_period >= $start_period\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"NPV\", NPV).args([\n            [ \"rate\", \"number\" ],\n            [ \"values\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$values.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"IRR\", IRR).args([\n            [ \"values\", [ \"collect\", \"number\", 1 ] ],\n            [ \"guess\", [ \"or\", \"number\", [ \"null\", 0.1 ] ] ]\n        ]);\n\n        defineFunction(\"EFFECT\", EFFECT).args([\n            [ \"nominal_rate\", \"number++\" ],\n            [ \"npery\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"NOMINAL\", NOMINAL).args([\n            [ \"effect_rate\", \"number++\" ],\n            [ \"npery\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"XNPV\", XNPV).args([\n            [ \"rate\", \"number\" ],\n            [ \"values\", [ \"collect\", \"number\", 1 ] ],\n            [ \"dates\", [ \"collect\", \"date\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$values.length == $dates.length\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"XIRR\", XIRR).args([\n            [ \"values\", [ \"collect\", \"number\", 1 ] ],\n            [ \"dates\", [ \"collect\", \"date\", 1 ] ],\n            [ \"guess\", [ \"or\", \"number\", [ \"null\", 0.1 ] ] ],\n            [ \"?\", [ \"assert\", \"$values.length == $dates.length\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"ISPMT\", ISPMT).args([\n            [ \"rate\", \"number\" ],\n            [ \"per\", \"number++\" ],\n            [ \"nper\", \"number++\" ],\n            [ \"pv\", \"number\" ],\n            [ \"?\", [ \"assert\", \"$per >= 1 && $per <= $nper\" ] ]\n        ]);\n\n        defineFunction(\"DB\", DB).args([\n            [ \"cost\", \"number\" ],\n            [ \"salvage\", \"number\" ],\n            [ \"life\", \"number++\" ],\n            [ \"period\", \"number++\" ],\n            [ \"month\", [ \"or\", \"number\", [ \"null\", 12 ] ] ]\n        ]);\n\n        defineFunction(\"DDB\", DDB).args([\n            [ \"cost\", \"number\" ],\n            [ \"salvage\", \"number\" ],\n            [ \"life\", \"number++\" ],\n            [ \"period\", \"number++\" ],\n            [ \"factor\", [ \"or\", \"number\", [ \"null\", 2 ] ] ]\n        ]);\n\n        defineFunction(\"SLN\", SLN).args([\n            [ \"cost\", \"number\" ],\n            [ \"salvage\", \"number\" ],\n            [ \"life\", \"number++\" ]\n        ]);\n\n        defineFunction(\"SYD\", SYD).args([\n            [ \"cost\", \"number\" ],\n            [ \"salvage\", \"number\" ],\n            [ \"life\", \"number++\" ],\n            [ \"per\", \"number++\" ]\n        ]);\n\n        defineFunction(\"VDB\", VDB).args([\n            [ \"cost\", \"number+\" ],\n            [ \"salvage\", \"number+\" ],\n            [ \"life\", \"number++\" ],\n            [ \"start_period\", \"number+\" ],\n            [ \"end_period\", \"number+\" ],\n            [ \"factor\", [ \"or\", \"number+\", [ \"null\", 2 ] ] ],\n            [ \"no_switch\", [ \"or\", \"logical\", [ \"null\", false ] ] ],\n            [ \"?\", [ \"assert\", \"$end_period >= $start_period\", \"NUM\" ] ]\n        ]);\n\n        var COUPS_ARGS = [\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"frequency\", [ \"and\", \"integer\", [ \"values\", 1, 2, 4 ] ] ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                        [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ];\n\n        defineFunction(\"COUPDAYBS\", COUPDAYBS).args(COUPS_ARGS);\n\n        defineFunction(\"COUPDAYS\", COUPDAYS).args(COUPS_ARGS);\n\n        defineFunction(\"COUPDAYSNC\", COUPDAYSNC).args(COUPS_ARGS);\n\n        defineFunction(\"COUPPCD\", COUPPCD).args(COUPS_ARGS);\n\n        defineFunction(\"COUPNCD\", COUPNCD).args(COUPS_ARGS);\n\n        defineFunction(\"COUPNUM\", COUPNUM).args(COUPS_ARGS);\n\n        defineFunction(\"ACCRINTM\", ACCRINTM).args([\n            [ \"issue\", \"date\" ],\n            [ \"settlement\", \"date\" ],\n            [ \"rate\", \"number++\" ],\n            [ \"par\", [ \"or\", [ \"null\", 1000 ], \"number++\" ] ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                        [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$issue < $settlement\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"ACCRINT\", ACCRINT).args([\n            [ \"issue\", \"date\" ],\n            [ \"first_interest\", \"date\" ],\n            [ \"settlement\", \"date\" ],\n            [ \"rate\", \"number++\" ],\n            [ \"par\", [ \"or\", [ \"null\", 1000 ], \"number++\" ] ],\n            [ \"frequency\", [ \"and\", \"integer\", [ \"values\", 1, 2, 4 ] ] ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                        [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"calc_method\", [ \"or\", \"logical\", [ \"null\", true ] ] ],\n            [ \"?\", [ \"assert\", \"$issue < $settlement\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"DISC\", DISC).args([\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"pr\", \"number++\" ],\n            [ \"redemption\", \"number++\" ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                        [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"INTRATE\", INTRATE).args([\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"investment\", \"number++\" ],\n            [ \"redemption\", \"number++\" ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                        [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"RECEIVED\", RECEIVED).args([\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"investment\", \"number++\" ],\n            [ \"discount\", \"number++\" ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                        [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"PRICE\", PRICE).args([\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"rate\", \"number++\" ],\n            [ \"yld\", \"number++\" ],\n            [ \"redemption\", \"number++\" ],\n            [ \"frequency\", [ \"and\", \"integer\", [ \"values\", 1, 2, 4 ] ] ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                        [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"PRICEDISC\", PRICEDISC).args([\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"discount\", \"number++\" ],\n            [ \"redemption\", \"number++\" ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                        [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ]);\n    });\n    /* -----[ utils ]----- */\n\n    // function resultAsMatrix(f) {\n    //     return function() {\n    //         var a = f.apply(this, arguments);\n    //         return this.asMatrix(a);\n    //     };\n    // }\n\n    /* -----[ definitions: statistical functions ]----- */\n\n    var MAX_IT = 300,     // Maximum allowed number of iterations\n        EPS = 2.2204e-16, // Relative accuracy; 1-3*(4/3-1) = 2.220446049250313e-16\n        FP_MIN = 1.0e-30, // Near the smallest representable as floating-point, number.\n        f_abs = Math.abs;\n\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2*x*x/(2*n+1);\n        }\n        return S*2/Math.sqrt(Math.PI)*x*Math.exp(-x*x)*m;\n    }\n\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n/frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1\n            ? Math.exp(-x*x)/Math.sqrt(Math.PI)*frac\n            : 2 - Math.exp(-x*x)/Math.sqrt(Math.PI)*frac;\n    }\n\n    function GAMMALN(x) { // Returns the value ln[(x)] for x > 0.\n        var cof = [\n            1.000000000190015, 76.18009172947146, -86.50532032941677,\n            24.01409824083091, -1.231739572450155, 0.1208650973866179e-2, -0.5395239384953e-5\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2*Math.PI) * ser / x); // log((x)) = log((x+1)) - log(x)\n    }\n\n    function GAMMA(x) { // returns Infinity for 0 or negative _integer argument.\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x; // For x<0 we use the reflection formula: (x)(1-x) = PI / sin(PI*x)\n        return -pi / (y*GAMMA(y)*Math.sin(pi*y));\n    }\n\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a+b);\n    }\n\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n\n    function gamma_inc(a, x) { // returns the normalized incomplete gamma function P(a, x); x > 0.\n        return x < a+1.0 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n\n    function g_series(a, x) { // evaluate P(a, x) by its series representation (converges quickly for x < a+1).\n        var sum = 1/a,\n            frac = sum,\n            ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x/ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum)*EPS) {\n                break; // already the last frac is too small versus the current sum value\n            }\n        }\n        return sum * Math.exp(-x + a*Math.log(x) - gln); // e^{-x} * x^a * (a) * sum\n    }\n\n    function g_contfrac(a, x) { // Q(a, x) by its continued fraction representation (converges quickly for x > a + 1); modified Lentzs method (Numerical Recipes (The Art of Scientific Computing), 2rd Edition $5.2)\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n\t    if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n\t    c = bj + aj / c;\n\t    if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n\t    d = 1 / d;\n\t    var delta = c * d;\n\t    f *= delta;\n    \t    if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n\t    bj += 2;\n\t    aj = -i * (i - a);\n\t}\n\treturn f * Math.exp(-x - gln + a * Math.log(x));\n    }\n\n    function GAMMA_DIST(x, a, b, cumulative) { // a > 0, b > 0; x >= 0\n        if (!cumulative) {\n            return Math.pow(x/b, a-1)*Math.exp(-x/b)/(b*GAMMA(a)); // the PDF of the Gamma distribution\n        }\n        return gamma_inc(a, x/b); // (else) compute the CDF (using the incomplete Gamma function)\n    }\n\n    function GAMMA_INV(p, a, b) { // the quantile function of the Gamma distribution\n\tif (p === 0) {\n            return 0;\n        }\n\tif (p == 1) {\n            return Infinity;\n        }\n\tvar m = 0, M = 10, x = 0, ab = a*b;\n\tif (ab > 1) {\n            M *= ab;\n        }\n\tfor (var i = 0; i < MAX_IT; i++) {\n\t    x = 0.5*(m + M); // console.log(x);\n\t    var q = GAMMA_DIST(x, a, b, true);\n\t    if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n\t    if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n\t}\n\treturn x;\n    }\n\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x*x/2)/Math.sqrt(2*Math.PI);\n        }\n        return 0.5 + 0.5*ERF(x/Math.sqrt(2));\n    }\n\n    function NORM_S_INV(p) { // see [1] $26.2.3 and http://home.online.no/~pjacklam/notes/invnorm/#References\n        // Coefficients in rational approximations.\n        var a = [-3.969683028665376e+01,  2.209460984245205e+02,\n                 -2.759285104469687e+02,  1.383577518672690e+02,\n                 -3.066479806614716e+01,  2.506628277459239e+00],\n            b = [-5.447609879822406e+01,  1.615858368580409e+02,\n                 -1.556989798598866e+02,  6.680131188771972e+01,\n                 -1.328068155288572e+01],\n            c = [-7.784894002430293e-03, -3.223964580411365e-01,\n                 -2.400758277161838e+00, -2.549732539343734e+00,\n                 4.374664141464968e+00,  2.938163982698783e+00],\n            d = [ 7.784695709041462e-03,  3.224671290700398e-01,\n                  2.445134137142996e+00,  3.754408661907416e+00];\n        // Define break-points.\n        var plow  = 0.02425,\n            phigh = 1 - plow;\n        var q, r;\n        // Rational approximation for lower region:\n        if (p < plow) {\n            q = Math.sqrt(-2*Math.log(p));\n            return (((((c[0]*q+c[1])*q+c[2])*q+c[3])*q+c[4])*q+c[5]) / ((((d[0]*q+d[1])*q+d[2])*q+d[3])*q+1);\n        }\n        // Rational approximation for upper region:\n        if (phigh < p) {\n            q = Math.sqrt(-2*Math.log(1-p));\n            return -(((((c[0]*q+c[1])*q+c[2])*q+c[3])*q+c[4])*q+c[5]) / ((((d[0]*q+d[1])*q+d[2])*q+d[3])*q+1);\n        }\n        // Rational approximation for central region:\n        q = p - 0.5;\n        r = q*q;\n        return (((((a[0]*r+a[1])*r+a[2])*r+a[3])*r+a[4])*r+a[5])*q / (((((b[0]*r+b[1])*r+b[2])*r+b[3])*r+b[4])*r+1);\n    }\n\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x-m)*(x-m)/(2*s*s))/(s*Math.sqrt(2*Math.PI)); // NORM_S_DIST((x-m)/s)/s;\n        }\n        return NORM_S_DIST((x-m)/s, true);\n    }\n\n    function NORM_INV(p, m, s) {\n        return m + s*NORM_S_INV(p);\n    }\n\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a-1)*Math.log(x) + (b-1)*Math.log(1-x) - BETALN(a, b));\n    }\n\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a*Math.log(x) + b*Math.log(1-x) - BETALN(a, b));\n        return x < (a+1)/(a+b+2) ? k*beta_lentz(a, b, x)/a : 1 - k*beta_lentz(b, a, 1-x)/b;\n    }\n\n    function beta_lentz(a, b, x) { // estimates continued fraction by modified Lentzs method ([2] $8.17.22)\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b; // These qs will be used in factors that occur in the coefficients d_n\n        qap = a + 1;\n        qam = a - 1;\n        c = 1; // First step of Lentzs method.\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1/d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2*m;\n            aa = m*(b - m)*x / ((qam + m2)*(a + m2));\n            d = 1 + aa*d; // One step (the even one) of the recurrence.\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa/c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1/d;\n            h *= d*c;\n            aa = -(a + m)*(qab + m)*x / ((a + m2)*(qap + m2));\n            d = 1 + aa*d; // Next step of the recurrence (the odd one).\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa/c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1/d;\n            del = d*c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h; // if(m > MAX_IT) throw new Error(\"a or b too big, or MAX_IT too small\");\n    }\n\n    function betastd_inv(p, a, b) { // the quantile function of the standard Beta distribution\n\tvar m = 0, M = 1, x = 0;\n\tfor (var i = 0; i < MAX_IT; i++) {\n\t    x = 0.5*(m + M);\n\t    var q = betastd_cdf(x, a, b);\n\t    if (f_abs(p - q) < EPS) {\n                break;\n            }\n\t    if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n\t}\n\treturn x;\n    }\n\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x-m)/(M-m), a, b);\n    }\n\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x-m)/(M-m), a, b);\n        }\n        return betastd_pdf((x-m)/(M-m), a, b) / (M-m);\n    }\n\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M-m)*betastd_inv(p, a, b);\n    }\n\n    function chisq_left(x, n, cds) {  // CHISQ.DIST(x,deg_freedom,cumulative)\n        return GAMMA_DIST(x, n/2, 2, cds);\n    }\n\n    function chisq_right(x, n) { // CHISQ.DIST.RT(x,deg_freedom)\n        return 1 - chisq_left(x, n, true);\n    }\n\n    function chisq_left_inv(p, n) { // CHISQ.INV( probability, degrees_freedom )\n        return GAMMA_INV(p, n/2, 2);\n    }\n\n    function chisq_right_inv(p, n) { // CHISQ.INV.RT(probability,deg_freedom)\n        return chisq_left_inv(1-p, n);\n    }\n\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta/eij;\n            }\n        }\n        var n = (rows - 1)*(cols - 1);\n        return chisq_right(x, n);\n    }\n\n    function expon(x, r, cdf) { // EXPON.DIST(x, lambda, cumulative)\n        if (cdf) {\n            return 1 - Math.exp(-r*x);\n        }\n        return r * Math.exp(-r*x);\n    }\n\n    function poisson(k, m, cdf) { // POISSON.DIST(x, mean, cumulative)\n        if (cdf) {\n            return 1 - chisq_left(2*m, 2*(k+1), true);\n        }\n        //return chisq_left(2*m, 2*k, true) - chisq_left(2*m, 2*(k+1), true);\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i); // compute log(k!)\n        }\n        return Math.exp(k*Math.log(m) - m - lnf);\n    }\n\n    function Fdist(x, n, d, cdf) { //F.DIST(x,deg_freedom1,deg_freedom2,cumulative)\n        if (cdf) {\n            return betastd_cdf(n*x/(d+n*x), n/2, d/2);\n        }\n        var u = n/d;\n        n /= 2; d /= 2;\n        return u/BETA(n, d) * Math.pow(u*x, n-1) / Math.pow(1+u*x, n+d);\n    }\n\n    function Fdist_right(x, n, d) { // F.DIST.RT(x,deg_freedom1,deg_freedom2)\n        return 1 - Fdist(x, n, d, true);\n    }\n\n    function Finv_right(p, n, d) { // F.INV.RT(probability,deg_freedom1,deg_freedom2\n        return d/n*(1/BETA_INV(p, d/2, n/2, 0, 1) - 1);\n    }\n\n    function Finv(p, n, d) { // F.INV(probability,deg_freedom1,deg_freedom2\n        return d/n*(1/BETA_INV(1-p, d/2, n/2, 0, 1) - 1);\n    }\n\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n\n    function _var_sq(arr, m) { // returns the (n-1)-part of the sum of the squares of deviations from m (= VAR)\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta*delta;\n        }\n        return v / (n-1);\n    }\n\n    function Ftest(arr1, arr2) { // F.TEST(array1,array2)\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)),\n            va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError(\"DIV/0\");\n        }\n        return 2*Fdist(va1 / va2, n1, n2, true);\n    }\n\n    function fisher(x) { // FISHER(x)\n        return 0.5*Math.log((1+x)/(1-x));\n    }\n\n    function fisherinv(x) { // FISHERINV(x)\n        var e2 = Math.exp(2*x);\n        return (e2 - 1)/(e2 + 1);\n    }\n\n    function Tdist(x, n, cdf) { // T.DIST(x,deg_freedom, cumulative)\n        if (cdf) {\n            return 1 - 0.5*betastd_cdf(n/(x*x+n), n/2, 0.5);\n        }\n        return 1/(Math.sqrt(n)*BETA(0.5, n/2)) * Math.pow(1 + x*x/n, -(n+1)/2);\n    }\n\n    function Tdist_right(x, n) { // T.DIST.RT(x,deg_freedom)\n        return 1 - Tdist(x, n, true);\n    }\n\n    function Tdist_2tail(x, n) { // T.DIST.2T(x,deg_freedom)\n        if (x < 0) {\n            x = -x;\n        }\n        return 2*Tdist_right(x, n);\n    }\n\n    function Tdist_inv(p, n) { // T.INV(probability,deg_freedom)\n        var x = betastd_inv(2*Math.min(p, 1-p), n/2, 0.5); // ibetainv();\n        x = Math.sqrt(n * (1 - x) / x);\n        return (p > 0.5) ? x : -x;\n    }\n\n    function Tdist_2tail_inv(p, n) { // T.INV.2T(probability,deg_freedom)\n        // T2 = 2T_r = p => T_r(x,n) = p/2 => 1 - T(x,n,true) = p/2 => x = T^-1(1-p/2, n)\n        return Tdist_inv(1-p/2, n);\n    }\n\n    function Tdist_test(gr1, gr2, tail, type) { // T.TEST(array1,array2,tails,type)\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df; // the t-statistic and the \"degree of freedom\"\n        if (type == 1) { // paired (dependent) samples\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta*delta;\n            }\n            var md = d/n1; //, md2 = d2 / n1;\n            t_st = md / Math.sqrt((d2 - d*md)/(n1*(n1-1))); // has a \"Student T\" distribution\n            return tail == 1 ? Tdist_right(t_st, n1-1) : Tdist_2tail(t_st, n1-1);\n        }\n        // unpaired (independent) samples\n        var m1 = _mean(gr1), m2 = _mean(gr2),\n            v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) { // unpaired, unequal variances\n            var u1 = v1/n1, u2 = v2/n2, u = u1 + u2;\n            var q1 = u1/u, q2 = u2/u; // u==0 must be invalidated\n            df = 1/(q1*q1/(n1-1) + q2*q2/(n2-1));\n            t_st =  f_abs(m1-m2)/Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n        else { // (type == 2) unpaired, equal variances (\"equal\" in the sense that there is no significant difference in variance in both groups - a prealable F-test could revealed that)\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1-m2)*Math.sqrt(df*n1*n2/((n1+n2)*((n1-1)*v1+(n2-1)*v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n\n    function confidence_t(alpha, stddev, size) { // CONFIDENCE.T(alpha,standard_dev,size)\n        return -Tdist_inv(alpha/2, size-1)*stddev/Math.sqrt(size);\n    }\n\n    function confidence_norm(alpha, stddev, size) { // CONFIDENCE.NORM(alpha,standard_dev,size)\n        return -NORM_S_INV(alpha/2)*stddev/Math.sqrt(size);\n    }\n\n    function gauss(z) { // GAUSS(z)\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n\n    function phi(x) { // PHI(x)\n        return NORM_S_DIST(x);\n    }\n\n    function lognorm_dist(x, m, s, cumulative) { // LOGNORM.DIST(x,mean,standard_dev,cumulative)\n        if (cumulative) {\n            return 0.5 + 0.5*ERF((Math.log(x)-m)/(s*Math.sqrt(2)));\n        }\n        var t = Math.log(x)-m;\n        return Math.exp(-t*t/(2*s*s))/(x*s*Math.sqrt(2*Math.PI));\n    }\n\n    function lognorm_inv(p, m, s) { //LOGNORM.INV(probability, mean, standard_dev)\n        return Math.exp(NORM_INV(p, m, s));\n    }\n\n    function prob(x_, p_, lw, up) { //PROB(x_range, prob_range, [lower_limit], [upper_limit])\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError(\"NUM\");\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError(\"NUM\");\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n\n    function slope(y_, x_) { // SLOPE(known_y's, known_x's)\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t*(y_[i] - my);\n            b2 += t*t;\n        }\n        return b1/b2;\n    }\n\n    function intercept(y_, x_) { // INTERCEPT(known_y's, known_x's)\n        var mx = _mean(x_), my = _mean(y_);\n        // return my - mx*slope(y_, x_);  //but repeating the calls for _mean()\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t*(y_[i] - my);\n            b2 += t*t;\n        }\n        return my - b1*mx/b2;\n    }\n\n    function pearson(x_, y_) { // PEARSON(array1, array2)\n        whipNumberArrays(x_, y_);\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for(var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1*t2;\n            s2 += t1*t1;\n            s3 += t2*t2;\n        }\n        return s1/Math.sqrt(s2*s3);\n    }\n\n    function rsq(x_, y_) { // RSQ(known_y's,known_x's)\n        var r = pearson(x_, y_);\n        return r*r;\n    }\n\n    function steyx(y_, x_) { //STEYX(known_y's, known_x's)\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2*t2;\n            s2 += t1*t2;\n            s3 += t1*t1;\n        }\n        return Math.sqrt((s1 - s2*s2/s3)/(n-2));\n    }\n\n    function forecast(x, y_, x_) { //FORECAST(x, known_y's, known_x's)\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1*t2;\n            s2 += t1*t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError(\"N/A\");\n        }\n        var b = s1/s2, a = my - b*mx;\n        return a + b*x;\n    }\n\n    function _mat_mean(Mat) { // returns the mean value of a Matrix(n, 1)\n        var n = Mat.height, sum = 0;\n        for (var i=0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum/n;\n    }\n\n    function _mat_devsq(Mat, mean) { // returns the sum of squares of deviations for a Matrix(n, 1)\n        var n = Mat.height, sq = 0;\n        for (var i=0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x*x;\n        }\n        return sq;\n    }\n\n    function linest(Y, X, konst, stats) { // LINEST(known_y's, [known_x's], [const], [stats])\n        var i = 0;\n\n        if (!X) {\n            // if not passed, X should default to array {1, 2, 3, ...} (same size as Y)\n            X = Y.map(function(){ return ++i; });\n        }\n\n        if (konst) { // adding 1's column is unnecessary when const==false (meaning that y_intercept==0)\n            X = X.clone();\n            X.eachRow(function(row){\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y); // the last square estimate of the coefficients\n        var line_1 = [];\n        for (i = B.height-1; i >= 0; i--) {\n            line_1.push(B.data[i][0]); // regression coefficients ('slopes') and the y_intercept\n        }\n        if (!konst) {\n            line_1.push(0); // display 0 for y_intercept, when const==false\n        }\n        if (!stats) {\n            return this.asMatrix([ line_1 ]); // don't display statistics about the regression, when stats==false\n        }\n\n        var Y1 = X.multiply(B); // the predicted Y values\n        var y_y1 = Y.adds(Y1, true); // the errors of the predictions (= Y - Y1)\n        var mp = !konst? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp); // The regression sum of squares\n        var me = !konst? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me); // The residual sum of squares\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid); // The coefficient of determination\n        var degfre = Y.height - X.width; // The degrees of freedom\n        var err_est = Math.sqrt(SSresid / degfre); // The standard error for the y estimate\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? (R2/X.width)/((1-R2)/(degfre)) : (SSreg/(X.width-1))/(SSresid/degfre); // The F statistic\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i=SCP.height-1; i >= 0; i--) { // The standard errors (of coefficients an y-intercept)\n            line_2.push(Math.sqrt(SCP.data[i][i]*SSresid/degfre));\n        }\n        return this.asMatrix([line_1, line_2, line_3, line_4, line_5]);\n    }\n\n    function logest(Y, X, konst, stats) { // LOGEST(known_y's, [known_x's], [const], [stats])\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n\n    function trend(Y, X, W, konst) { // TREND(known_y's, [known_x's], [new_x's], [const])\n        var i = 0;\n\n        if (!X) {\n            // if not passed, X should default to array {1, 2, 3, ...} (same size as Y)\n            X = Y.map(function(){ return ++i; });\n        }\n\n        if (konst) { // adding 1's column is unnecessary when const==false (meaning that y_intercept==0)\n            X = X.clone();\n            X.eachRow(function(row){\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y); // the last square estimate of the coefficients\n\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) { // for non-zero y_intercept\n                W = W.clone();\n                W.eachRow(function(row){\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B); // the predicted Y values for the W values\n    }\n\n    function growth(Y, X, new_X, konst) { // GROWTH(known_y's, [known_x's], [new_x's], [const])\n        // = EXP(TREND(LN(Y_), X_, new_X, const))\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n\n    /*\n      [1] Handbook of Mathematical Functions (NIST, 1964-2010):\n      https://en.wikipedia.org/wiki/Abramowitz_and_Stegun\n      http://dlmf.nist.gov/\n      http://www.aip.de/groups/soe/local/numres/\n\n      [2] https://en.wikibooks.org/wiki/Statistics/Numerical_Methods/Numerics_in_Excel\n    */\n\n    /* -----[ financial functions ]----- */\n\n    //// find the root of a function known an initial guess (Newton's method) ////\n    function root_newton(func, guess, max_it, eps) { // func(x) must return [value_F(x), value_F'(x)]\n        var MAX_IT = max_it || 20, // maximum number of iterations\n            EPS = eps || 1E-7; // accuracy\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root),\n                f = f_d[0], // the value of the function\n                df = f_d[1]; // the value of the derivative\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError(\"NUM\");\n    }\n\n\n    /* https://support.office.com/en-us/article/PV-function-23879d31-0e02-4321-be01-da16e8168cbd\n       if(rate==0):\n       PMT * nper + PV + FV = 0\n       else: //the basic equation (with six variables) implied in financial problems\n       PV * (1+rate)^nper + PMT * (1+rate*type) * ((1+rate)^nper-1) / rate + FV = 0         [1]\n    */\n\n\n\n    //// FV (final or future value) ////\n    /* I initially invest 1000 in a saving scheme and then at the end of each month I invest an\n       extra 50. If the interest rate is 0.5% per month and I continue this process for two year,\n       how much will my saving be worth: =FV(0.005, 24, -50, -1000, 0) */\n    function FV(rate, nper, pmt, pv, type) { // FV(rate,nper,pmt,[pv],[type])\n        var h1 = Math.pow(1+rate, nper);\n        var h2 = rate ? (h1 - 1)/rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate*type));\n    }\n\n    //// PV (present value of investment) ////\n    /* If I wish to accumulate 5000 in four years time by depositing 75 per month in a fixed\n       rate account with interest rate of 0.4% per month, what initial investment must I also\n       make: =PV(0.004, 4*12, -75, 5000, 0) */\n    function PV(rate, nper, pmt, fv, type) { // PV(rate, nper, pmt, [fv], [type])\n        if (!rate) {\n            return -fv - pmt*nper;\n        }\n        var h1 = Math.pow(1+rate, nper);\n        return -(fv + pmt * (h1 - 1)/rate * (1 + rate*type)) / h1;\n    }\n\n    //// PMT monthly payments (= principal part PPMT + interest part IPMT) ////\n    /* How much will the monthly repayments be if I borrow 100,000 over 20 years with an\n       effective monthly interest rate is 0.5%: =PMT(0.005, 12*20, 100000, 0, 0) */\n    function PMT(rate, nper, pv, fv, type) { // PMT(rate, nper, pv, [fv], [type])\n        if (!rate) {\n            return -(fv + pv)/nper;\n        }\n        var h1 = Math.pow(1+rate, nper);\n        return -rate*(fv + pv*h1)/((1 + rate*type)*(h1 - 1));\n    }\n\n    //// NPER (number of periods for an investment) ////\n    /* How long would it take me to pay off a loan of 10,000 at a rate of 0.5% per month if I\n       can afford to pay 100 per month: =NPER(0.5%, -100, 10000, 0, 0) */\n    function NPER(rate, pmt, pv, fv, type) { // NPER(rate,pmt,pv,[fv],[type])\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt*(1 + rate*type);\n        return Math.log((h1 - fv*rate)/(h1 + pv*rate)) / Math.log(1 + rate);\n    }\n\n    //// RATE (the interest rate per period) ////\n    /* I borrow 1000 over 1 year making payments of 100 per month at the end of each\n       month. What is the monthly interest rate: =RATE(12, 100, 1000, 0, 0, 0) */\n\n    function RATE (nper, pmt, pv, fv, type, guess) { // RATE(nper, pmt, pv, [fv], [type], [guess])\n        function xfd(x) { // returns F(x) and F'(x), where F is given by the equation [1]\n            var h2 = Math.pow(1+x, nper-1), h1 = h2*(1+x);\n            return [ pv*h1 + pmt*(1/x + type)*(h1 - 1) + fv,\n                     nper*pv*h2 + pmt*(-(h1 - 1)/(x*x) + (1/x + type)*nper*h2) ];\n        }\n        return root_newton(xfd, guess); // a root of the equation F(x)=0\n    }\n\n    //// IPMT (interest part of a loan or investment) ////\n    //// PPMT (principal part of a loan) ////\n\n    function IPMT(rate, per, nper, pv, fv, type) { // IPMT(rate, per, nper, pv, [fv], [type])\n        if(type==1 && per==1) { // interest before beginnig of the payments... = ZERO\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt/(1 + rate) : ipmt;\n    }\n\n    function PPMT(rate, per, nper, pv, fv, type) { // PPMT(rate, per, nper, pv, [fv], [type])\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n\n    //// CUMPRINC (cumulative principal paid) ////\n    /* The amount financed is $200,000 at an interest rate of 7.25% for 30 years. How much is the amount of principal\n       and the amount of interest paid in the first year: CUMPRINC(0.0725/12, 12*30, 200000, 1, 12, 0)\n       and CUMIPMT(0.0725/12, 12*30, 200000, 1, 12, 0) */\n    function CUMPRINC(rate, nper, pv, start, end, type) { // CUMPRINC(rate, nper, pv, start_period, end_period, type)\n        if(type == 1) { // start >= 1 (as in Excel), but if pay at beginning of the period (type==1),\n            start --;    // then periods must be counted from Zero (decreasing given start and end parameters)\n            end --;\n        }\n        var tn = Math.pow(1 + rate, nper),\n            ts = Math.pow(1 + rate, start-1),\n            te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - ((ts - 1) / rate) * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - ((te - 1) / rate) * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n\n    //// CUMIPMT (cumulative  interest paid) ////\n    function CUMIPMT(rate, nper, pv, start, end, type) { // CUMIPMT(rate, nper, pv, start_period, end_period, type)\n        var cip = 0;\n        for(var i=start; i<=end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n\n    //// NPV (Net Present Value of an investment based on a series of periodic cash flows and a discount rate) ////\n    function NPV(rate, flows) { // NPV(rate,value1,[value2],...)\n        var npv = 0;\n        for(var i=0, n=flows.length; i < n; i++) {\n            npv += flows[i]*Math.pow(1 + rate, -i-1);\n        }\n        return npv;\n    }\n\n    //// IRR (Internal Rate of Return on an investment based on a series of periodic cash flows) ////\n    function IRR(flows, guess) { // IRR(values, [guess])\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for(var j=0, n=flows.length; j < n; j++) {\n                npv += flows[j]*Math.pow(1 + x, -j-1); // construct the NPV(x) value,\n                npv1 += -j*flows[j]*Math.pow(1+x, -j-2); // the value in x of the NPV()-derivative\n            }\n            return [npv, npv1];\n        }\n        return root_newton(xfd, guess);\n    }\n\n    //// EFFECT (effective annual interest rate) ////\n    /* which investment option is better - one that pays 5 percent after one year, or a\n       savings account that pays a monthly interest of 4.75 percent:\n       = (5% - EFFECT(4.75%, 12)) * 10000 */\n    function EFFECT(nominal_rate, npery) { // EFFECT(nominal_rate, npery)\n        return Math.pow(1 + nominal_rate/npery, npery) - 1;\n    }\n\n    //// NOMINAL (nominal annual interest rate) ////\n    function NOMINAL(effect_rate, npery) { // NOMINAL(effect_rate, npery)\n        return npery*(Math.pow(effect_rate + 1, 1/npery) - 1);\n    }\n\n    //// XNPV (Net Present Value of a series of cashflows at irregular intervals) ////\n    function XNPV(rate, values, dates) { // XNPV(rate, values, dates)\n        var npv = 0;\n        for(var i=0, n=values.length; i < n; i++) {\n            npv += values[i]*Math.pow(1 + rate, (dates[0]-dates[i])/365);\n        }\n        return npv;\n    }\n\n    //// XIRR (Internal Rate of Return of a series of cashflows at irregular intervals) ////\n    function XIRR(values, dates, guess) { // XIRR(values, dates, [guess])\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for(var j=1, n=values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j]*Math.pow(1 + x, delta); // construct the XNPV(x) value,\n                npv1 += delta*values[j]*Math.pow(1+x, delta - 1); // the value in x of the XNPV()-derivative\n            }\n            return [npv, npv1];\n        }\n        return root_newton(xfd, guess); // , 100, 0.1);\n    }\n\n    //// ISPMT (Interest paid during a Specific Period of an investment) ////\n    function ISPMT(rate, per, nper, pv) { // ISPMT(rate, per, nper, pv)\n        var tmp = -pv*rate;\n        return tmp*(1 - per/nper);\n    }\n\n    //// DB (Declining Balance depreciation) ////\n    function DB(cost, salvage, life, period, month) { // DB(cost, salvage, life, period, [month])\n        var rate = 1 - Math.pow(salvage/cost, 1/life);\n        rate = Math.floor(rate*1000 + 0.5) / 1000; // rounded to three decimals\n        var db = cost * rate * month / 12;\n        if(period == 1) {\n            return db;\n        }\n        for(var i=1; i < life; i++) {\n            if(i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n\n    //// DDB (Double Declining Balance depreciation) ////\n    function DDB(cost, salvage, life, period, factor) { // DDB(cost, salvage, life, period, [factor])\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1-f, period-1) - 1);\n        var dep = (cost - prior) * f;\n        /* Depreciation cannot exceed book value.  */\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n\n    //// SLN (straight-line depreciation) ////\n    function SLN(cost, salvage, life) { // SLN(cost, salvage, life)\n        return (cost - salvage) / life;\n    }\n\n    //// SYD (Sum-of-Years' digits Depreciation) ////\n    function SYD(cost, salvage, life, per) { // SYD(cost, salvage, life, per)\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n\n    //// VDB (Variable Declining Balance) ////\n    //\n    // Code adapted from Gnumeric, which in turn took it from OpenOffice.  The original code is\n    // available under GNU Lesser General Public License (LGPL).\n    // https://github.com/GNOME/gnumeric/blob/master/plugins/fn-financial/sc-fin.c\n    function VDB (cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n\n    /*************************************************************************************/\n\n    /*   (from  http://beginnersinvest.about.com)\n         an investor agrees to loan money to a company or government in exchange for a predetermined interest rate for a pre-determined length of time.\n\n         If an investor wanted to buy a $25,000 Coca-Cola bond with a 30 year maturity and an 10% coupon, it would work like this: He would send in the $25,000 from his savings account and get a $25,000 engraved bond certificate in exchange. After 30 years, he would be able to get his whole $25,000 back from the Coca-Cola company (of course, he can always sell it before then if he needs the money).\n\n         Every year, hes entitled to receive 10% interest on the money he lent, or $2,500. Since most companies in the United States pay interest semi-annually, he would likely have 60 coupons attached to his bond for $1,250 each.\n         Every June 30th and December 31st, the investor would go down, clip the proper coupon, send it in, and get their money.\n\n         Although the practice is now defunct, the terminology stuck and interest payments on bonds will forever be known as coupons.\n    */\n\n\n    // \"Use EDATE to calculate maturity dates or due dates that fall on the same day of the month as the date of issue.\"\n    // See also: DATEDIF, DAY, DAYS, DAY360, EOMONTH (wich can be useful to determine limits of coupon periods)\n    function _edate(base, months) { // EDATE(start_date, months)\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m/12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) { // Actual/Actual || Actual/360 || Actual/365\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n\n    // Find coupon dates that enclose the settlement date, counting backward from the maturity date.\n    /* independent of the 'basis' convention to count days - here we have no need to count days */\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12/freq;\n        do {\n            periods++;\n            prev = _edate(maturity, - periods*months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, - periods*months);\n        return [ prev, next ];\n    }\n\n    // Find coupon dates that enclose the settlement date, counting forward from the first-coupon payment.\n    /* independent of the 'basis' convention to count days - here we have no need to count days */\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12/freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods*months);\n        }\n        return [ next, prev ];\n    }\n\n    //// COUPDAYBS (COUPon DAYs Beginning to Settlement) ////\n    /* returns the number of days from the beginning of the coupon period to the settlement date */\n    function COUPDAYBS(settlement, maturity, frequency, basis) { // COUPDAYBS(settlement, maturity, frequency, [basis])\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n\n    //// COUPDAYS (COUPon DAYs containing Settlement) ////\n    /* Returns the number of days in the coupon period that contains the settlement date */\n    function COUPDAYS(settl, matur, freq, basis) { // COUPDAYS(settlement, maturity, frequency, [basis])\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365/freq;\n        }\n        return 360/freq;\n    }\n\n    //// COUPDAYSNC (COUPon DAYs Settlement to Next Coupon) ////\n    /* Returns the number of days from the settlement date to the next coupon date */\n    function COUPDAYSNC(settl, matur, freq, basis) { // COUPDAYSNC(settlement, maturity, frequency, [basis])\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n\n    //// COUPPCD (COUPon, Previous Coupon Date) ////\n    /* Returns the previous coupon date before the settlement date */\n    function COUPPCD(settl, matur, freq/*, basis*/) { // COUPPCD(settlement, maturity, frequency, [basis])\n        // It is no need to count days, so 'basis' becomes a inutil parameter.\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n\n    //// COUPNCD (COUPon, Next Coupon Date) ////\n    /* Returns the next coupon date after the settlement date */\n    function COUPNCD(settl, matur, freq/*, basis*/) { // COUPNCD(settlement, maturity, frequency, [basis])\n        // It is no need to count days, so 'basis' becomes a inutil parameter.\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n\n    function COUPNUM(settl, matur, freq/*, basis*/) { // COUPNUM(settlement, maturity, frequency, [basis])\n        var sett = unpackDate(settl),\n            mat = unpackDate(matur);\n        var months = 12*(mat.year - sett.year) + mat.month - sett.month;\n        //// Discount the last month if there are not enough days? Finally - we decide to not discount.\n        //// (if this \"last month\" have 2 days, Excel.COUPNUM returns 6 but GoogleSpreads give only 5)\n        //    var res = _edate(matur, -months);\n        //    if (sett.date >= unpackDate(res).date) {\n        //        months--; // an incomplete last month correspond to a qvasi-coupon period\n        //    }\n        return 1 + (months * freq / 12 | 0);\n    }\n\n    function daysInYear(yr, basis) {\n        if (basis == 3) { return 365; }\n        if (basis == 1) { return isLeapYear(yr) ? 366 : 365; }\n        return 360;\n    }\n\n    //// ACCRINTM  the accrued interest for a security that pays interest at maturity ////\n    function ACCRINTM(issue, maturity, rate, par, basis) { // ACCRINTM(issue, settlement, rate, par, [basis])\n        var year_days = daysInYear(unpackDate(maturity).year, basis); // 360;\n        return rate*par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n\n        var annual = basis % 2 === 0 ? 360 : 365; // only if to >> from, we eventually need to count leap years\n        function _numCoupons(from, to) { // better than COUPNUM(from, to, freq, basis)-1\n            return (to - from)*freq/annual | 0;\n        }\n\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl); // when settl==next, days are counted implicitly by nrc\n            return cost *\n                (nrc +\n                 _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) +\n                 (settl < next? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl); // COUPNUM(first, settl, freq, basis) - 1;\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) { return accr; } // Only the accrued interest between first and settlement dates.\n            brace = _borderCoupons(issue, first, freq); // Add the accrued interest between issue and first dates.\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr; // accrued interest between issue and settlement dates\n        }\n    }\n\n    //// DISC  the discount rate for a security (given price and redemption values per 100$ face value) ////\n    function DISC(settl, matur, pr, redemption, basis) { // DISC(settlement, maturity, pr, redemption, [basis])\n        var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate(settl).year) ? 366 : 365);\n        return (redemption - pr)/redemption*annual/_daysBetween(settl, matur, basis);\n    }\n\n    //// INTRATE  the interest rate for a fully invested security ////\n    function INTRATE(settl, matur, investment, redemption, basis) { // INTRATE(settlement, maturity, investment, redemption, [basis])\n        var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate(settl).year) ? 366 : 365);\n        return (redemption - investment)/investment*annual/_daysBetween(settl, matur, basis);\n    }\n\n    //// RECEIVED  the amount received at maturity for a fully invested security ////\n    function RECEIVED(settl, matur, investment, discount, basis) { // RECEIVED(settlement, maturity, investment, discount, [basis])\n        var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate(settl).year) ? 366 : 365);\n        return investment/(1 - discount*_daysBetween(settl, matur, basis)/annual);\n    }\n\n    //// PRICE  the price per $100 face value of a security that pays periodic interest ////\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) { // PRICE(settlement, maturity, rate, yld, redemption, frequency, [basis])\n        var N = 1 + ((matur - settl)*freq/(basis % 2 === 0 ? 360 : 365) | 0); // coupons playable between settlement and maturity dates\n        var brace = _borderCoupons(settl, matur, freq),\n            prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis),\n            settl_end = _daysBetween(settl, next, basis),\n            beg_end = _daysBetween(prev, next, basis);\n        var den = 100*rate/freq,\n            yf = yld/freq,\n            frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den)/(1 + frac*yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N-1+frac)\n            + den * Math.pow(1 + yf, 1-N-frac) * (Math.pow(1+yf, N) - 1) / yf\n            - beg_settl / beg_end * den;\n    }\n\n    //// PRICEDISC  the price per $100 face value of a discounted security ////\n    function PRICEDISC(settl, matur, discount, redemption, basis) { // PRICEDISC(settlement, maturity, discount, redemption, [basis])\n        var dsm = _daysBetween(settl, matur, basis),\n            dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount*redemption*dsm/dy;\n    }\n\n    // Used in PEARSON, more could follow.  In some situations Excel appears to silently ignore\n    // missing or non-numeric values, for example if some value in a is missing a corresponding\n    // value in b, then the one in a is going to be ignored as if not present.  Arrays must have the\n    // same number of elements.  I couldn't come up with a good name for this function.\n    function whipNumberArrays(a, b) {\n        for (var i = a.length; --i >= 0;) {\n            if (typeof a[i] != \"number\" || typeof b[i] != \"number\") {\n                a.splice(i, 1);\n                b.splice(i, 1);\n            }\n        }\n    }\n\n(function(kendo) {\n\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            \"allBorders\",\n            \"insideBorders\",\n            \"insideHorizontalBorders\",\n            \"insideVerticalBorders\",\n            \"outsideBorders\",\n            \"leftBorder\",\n            \"topBorder\",\n            \"rightBorder\",\n            \"bottomBorder\",\n            \"noBorders\"\n        ];\n        var BORDER_TYPES_ICONS = {\n           allBorders: \"bordersAll\",\n           insideBorders: \"bordersInside\",\n           insideHorizontalBorders: \"bordersInsideHorizontal\",\n           insideVerticalBorders: \"bordersInsideVertical\",\n           outsideBorders: \"bordersOutside\",\n           leftBorder: \"borderLeft\",\n           topBorder: \"borderTop\",\n           rightBorder: \"borderRight\",\n           bottomBorder: \"borderBottom\",\n           noBorders: \"bordersNone\"\n        };\n\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: \"All borders\",\n            insideBorders: \"Inside borders\",\n            insideHorizontalBorders: \"Inside horizontal borders\",\n            insideVerticalBorders: \"Inside vertical borders\",\n            outsideBorders: \"Outside borders\",\n            leftBorder: \"Left border\",\n            topBorder: \"Top border\",\n            rightBorder: \"Right border\",\n            bottomBorder: \"Bottom border\",\n            noBorders: \"No border\"\n        };\n\n        var colorPickerPalette = [ //metro palette\n            \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n            \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n            \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n            \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n            \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n            \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n        ];\n\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                kendo.ui.Widget.call(this, element, options);\n\n                this.element = element;\n                this.color = \"#000\";\n\n                this.element.addClass(\"k-spreadsheet-popup\");\n\n                this._borderTypePalette();\n                this._borderColorPalette();\n            },\n\n            options: {\n                name: \"BorderPalette\"\n            },\n\n            events: [\n                \"change\"\n            ],\n\n            destroy: function() {\n                this.colorChooser.destroy();\n                kendo.destroy(this.element.find(\".k-spreadsheet-border-type-palette\"));\n            },\n\n            value: function() {\n                return { type: this.type, color: this.color };\n            },\n\n            _borderTypePalette: function() {\n                var that = this;\n                var messages = BORDER_PALETTE_MESSAGES;\n\n                var element = $(\"<div />\", {\n                    \"class\": \"k-spreadsheet-border-type-palette\"\n                });\n\n                $('<span class=\"k-column-menu-group-header\"><span class=\"k-column-menu-group-header-text\">Border type</span></span>').appendTo(this.element);\n\n                element.appendTo(this.element);\n\n                BORDER_TYPES.map(function(type) {\n                    $('<button title=\"' + messages[type] + '\" aria-label=\"' + messages[type] + '\" data-border-type=\"' + type + '\">')\n                        .appendTo(element)\n                        .kendoToggleButton({\n                            icon: kendo.toHyphens(BORDER_TYPES_ICONS[type]),\n                            toggle: that._toggle.bind(that)\n                        });\n                });\n            },\n\n            _borderColorPalette: function() {\n                var element = $(\"<div />\", {\n                    \"class\": \"k-spreadsheet-border-color-palette\"\n                });\n\n                $('<span class=\"k-column-menu-group-header\"><span class=\"k-column-menu-group-header-text\">Border color</span></span>').appendTo(this.element);\n                element.appendTo(this.element);\n\n                this.colorChooser = new kendo.ui.FlatColorPicker(element, {\n                    buttons: !this.options.change,\n                    color: this.color,\n                    view: \"palette\",\n                    palette: colorPickerPalette,\n                    input: false,\n                    change: this._change.bind(this)\n                });\n\n                this.colorChooser.wrapper.find(\".k-coloreditor-apply\").on(\"click\", this._apply.bind(this));\n                this.colorChooser.wrapper.find(\".k-coloreditor-cancel\").on(\"click\", this._cancel.bind(this));\n            },\n\n            _change: function() {\n                this.color = this.colorChooser.value();\n            },\n\n            _toggle: function(e) {\n                var type = e.target.data(\"borderType\"),\n                    previous = e.target.siblings(\".k-selected\").data(\"kendoToggleButton\");\n\n                if (e.checked === true) {\n                    if (previous) {\n                        previous.toggle(false);\n                    }\n\n                    this.type = type;\n                } else {\n                    this.type = null;\n                }\n            },\n\n            _apply: function() {\n                this.trigger(\"change\", { type: this.type, color: this.color });\n            },\n\n            _cancel: function() {\n                this.trigger(\"change\", { type: null, color: null });\n            }\n        });\n\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n\n    })(window.kendo);\n\n(function(kendo) {\n    var $ = kendo.jQuery;\n\n    function getDefaultToolElement(firstIconName) {\n        return `<button role=\"button\">${kendo.ui.icon({ icon: firstIconName, iconClass: \"k-button-icon\" })}<span class=\"k-button-text\">${kendo.ui.icon(\"caret-alt-down\")}</span></button>`\n    };\n\n    var ToolBar = kendo.ui.ToolBar;\n\n    var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n        addColumnLeft: \"Add column left\",\n        addColumnRight: \"Add column right\",\n        addRowAbove: \"Add row above\",\n        addRowBelow: \"Add row below\",\n        alignment: \"Alignment\",\n        alignmentButtons: {\n            justifyLeft: \"Align left\",\n            justifyCenter: \"Center\",\n            justifyRight: \"Align right\",\n            justifyFull: \"Justify\",\n            alignTop: \"Align top\",\n            alignMiddle: \"Align middle\",\n            alignBottom: \"Align bottom\"\n        },\n        backgroundColor: \"Background\",\n        bold: \"Bold\",\n        borders: \"Borders\",\n        copy: \"Copy\",\n        cut: \"Cut\",\n        deleteColumn: \"Delete column\",\n        deleteRow: \"Delete row\",\n        filter: \"Filter\",\n        fontFamily: \"Font\",\n        fontSize: \"Font size\",\n        format: \"Custom format...\",\n        formatTypes: {\n            automatic: \"Automatic\",\n            text: \"Text\",\n            number: \"Number\",\n            percent: \"Percent\",\n            financial: \"Financial\",\n            currency: \"Currency\",\n            date: \"Date\",\n            time: \"Time\",\n            dateTime: \"Date time\",\n            duration: \"Duration\",\n            moreFormats: \"More formats...\"\n        },\n        formatDecreaseDecimal: \"Decrease decimal\",\n        formatIncreaseDecimal: \"Increase decimal\",\n        freeze: \"Freeze panes\",\n        freezeButtons: {\n            freezePanes: \"Freeze panes\",\n            freezeRows: \"Freeze rows\",\n            freezeColumns: \"Freeze columns\",\n            unfreeze: \"Unfreeze panes\"\n        },\n        insertComment: \"Insert comment\",\n        insertImage: \"Insert image\",\n        italic: \"Italic\",\n        merge: \"Merge cells\",\n        mergeButtons: {\n            mergeCells: \"Merge all\",\n            mergeHorizontally: \"Merge horizontally\",\n            mergeVertically: \"Merge vertically\",\n            unmerge: \"Unmerge\"\n        },\n        open: \"Open...\",\n        paste: \"Paste\",\n        quickAccess: {\n            redo: \"Redo\",\n            undo: \"Undo\"\n        },\n        exportAs: \"Export...\",\n        toggleGridlines: \"Toggle gridlines\",\n        sort: \"Sort\",\n        sortButtons: {\n            // sortSheetAsc: \"Sort sheet A to Z\",\n            // sortSheetDesc: \"Sort sheet Z to A\",\n            sortRangeAsc: \"Sort range A to Z\",\n            sortRangeDesc: \"Sort range Z to A\"\n        },\n        textColor: \"Text Color\",\n        textWrap: \"Wrap text\",\n        underline: \"Underline\",\n        validation: \"Data validation...\",\n        hyperlink: \"Link\"\n    };\n\n    var defaultTools = {\n        home: [\n            \"open\",\n            \"exportAs\",\n            \"separator\",\n            [ \"cut\", \"copy\", \"paste\" ],\n            \"separator\",\n            \"fontFamily\",\n            \"fontSize\",\n            [ \"bold\", \"italic\", \"underline\" ],\n            \"separator\",\n            \"textColor\",\n            \"separator\",\n            \"backgroundColor\",\n            \"borders\",\n            \"separator\",\n            \"alignment\",\n            \"textWrap\",\n            \"separator\",\n            [ \"formatDecreaseDecimal\", \"formatIncreaseDecimal\" ],\n            \"separator\",\n            \"filter\",\n            \"format\",\n            \"hyperlink\",\n            \"separator\",\n            \"insertImage\",\n            \"insertComment\",\n            \"separator\",\n            \"freeze\",\n            \"merge\",\n            \"toggleGridlines\"\n        ],\n        insert: [\n            [ \"addColumnLeft\", \"addColumnRight\", \"addRowBelow\", \"addRowAbove\" ],\n            \"separator\",\n            [ \"deleteColumn\", \"deleteRow\" ]\n        ],\n        data: [\n            \"sort\",\n            \"separator\",\n            \"filter\",\n            \"separator\",\n            \"validation\"\n        ]\n    };\n\n    var defaultFormats = kendo.spreadsheet.formats = {\n        automatic: null,\n        text: \"@\",\n        number: \"#,0.00\",\n        percent: \"0.00%\",\n        financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n        currency: \"$#,##0.00;[Red]$#,##0.00\",\n        date: \"m/d/yyyy\",\n        time: \"h:mm:ss AM/PM\",\n        dateTime: \"m/d/yyyy h:mm\",\n        duration: \"[h]:mm:ss\"\n    };\n\n    var colorPickerPalette = [ //metro palette\n        \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n        \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n        \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n        \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n        \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n        \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n    ];\n\n    var COLOR_PICKER_MESSAGES = kendo.spreadsheet.messages.colorPicker = {\n        reset: \"Reset color\",\n        customColor: \"Custom color...\",\n        apply: \"Apply\",\n        cancel: \"Cancel\"\n    };\n\n    var toolDefaults = {\n        separator: { type: \"separator\" },\n        //home tab\n        open: {\n            type: \"open\",\n            name: \"open\",\n            icon: \"folder-open\",\n            extensions: \".xlsx\",\n            command: \"OpenCommand\"\n        },\n        exportAs: {\n            type: \"button\",\n            name: \"exportAs\",\n            dialog: \"exportAs\",\n            overflow: \"never\",\n            icon: \"download\"\n        },\n        bold: {\n            type: \"button\",\n            command: \"PropertyChangeCommand\",\n            property: \"bold\",\n            value: true,\n            icon: \"bold\",\n            togglable: true\n        },\n        italic: {\n            type: \"button\",\n            command: \"PropertyChangeCommand\",\n            property: \"italic\",\n            value: true,\n            icon: \"italic\",\n            togglable: true\n        },\n        underline: {\n            type: \"button\",\n            command: \"PropertyChangeCommand\",\n            property: \"underline\",\n            value: true,\n            icon: \"underline\",\n            togglable: true\n        },\n        formatDecreaseDecimal: {\n            type: \"button\",\n            name: \"formatDecreaseDecimal\",\n            command: \"AdjustDecimalsCommand\",\n            value: -1,\n            icon: \"decimal-decrease\"\n        },\n        formatIncreaseDecimal: {\n            type: \"button\",\n            name: \"formatIncreaseDecimal\",\n            command: \"AdjustDecimalsCommand\",\n            value: +1,\n            icon: \"decimal-increase\"\n        },\n        textWrap: {\n            type: \"button\",\n            name: \"textWrap\",\n            command: \"TextWrapCommand\",\n            property: \"wrap\",\n            value: true,\n            icon: \"text-wrap\",\n            togglable: true\n        },\n        cut: {\n            type: \"button\",\n            name: \"cut\",\n            command: \"ToolbarCutCommand\",\n            icon: \"cut\"\n        },\n        copy: {\n            type: \"button\",\n            name: \"copy\",\n            command: \"ToolbarCopyCommand\",\n            icon: \"copy\"\n        },\n        paste: {\n            type: \"button\",\n            name: \"paste\",\n            command: \"ToolbarPasteCommand\",\n            icon: \"clipboard\"\n        },\n        alignment: {\n            type: \"component\",\n            name: \"alignment\",\n            property: \"alignment\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"align-left\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"alignment\",\n                icon: \"align-left\"\n            },\n            componentOptions: {\n                items: [\n                    { attributes: { \"data-value\": \"left\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-left\", text: MESSAGES.alignmentButtons.justifyLeft },\n                    { attributes: { \"data-value\": \"center\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-center\", text: MESSAGES.alignmentButtons.justifyCenter },\n                    { attributes: { \"data-value\": \"right\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-right\", text: MESSAGES.alignmentButtons.justifyRight },\n                    { attributes: { \"data-value\": \"justify\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-justify\", text: MESSAGES.alignmentButtons.justifyFull },\n                    { attributes: { class: \"k-separator\" } },\n                    { attributes: { \"data-value\": \"top\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-top\", text: MESSAGES.alignmentButtons.alignTop },\n                    { attributes: { \"data-value\": \"center\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-middle\", text: MESSAGES.alignmentButtons.alignMiddle },\n                    { attributes: { \"data-value\": \"bottom\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-bottom\", text: MESSAGES.alignmentButtons.alignBottom }\n                ],\n                commandOn: \"click\"\n            }\n        },\n        backgroundColor: {\n            type: \"component\",\n            name: \"backgroundColor\",\n            commandOn: \"change\",\n            command: \"PropertyChangeCommand\",\n            property: \"background\",\n            component: \"ColorPicker\",\n            componentOptions: {\n                view: \"palette\",\n                toolIcon: \"droplet\",\n                palette: colorPickerPalette,\n                clearButton: true,\n                messages: COLOR_PICKER_MESSAGES,\n                input: false,\n                commandOn: \"change\"\n            },\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"colorPicker\",\n                icon: \"droplet\"\n            }\n        },\n        textColor: {\n            type: \"component\",\n            name: \"textColor\",\n            commandOn: \"change\",\n            command: \"PropertyChangeCommand\",\n            property: \"color\",\n            component: \"ColorPicker\",\n            componentOptions: {\n                view: \"palette\",\n                toolIcon: \"foreground-color\",\n                palette: colorPickerPalette,\n                clearButton: true,\n                messages: COLOR_PICKER_MESSAGES,\n                input: false,\n                commandOn: \"change\"\n            },\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"colorPicker\",\n                icon: \"foreground-color\"\n            }\n        },\n        fontFamily: {\n            type: \"component\",\n            name: \"fontFamily\",\n            command: \"PropertyChangeCommand\",\n            property: \"fontFamily\",\n            component: \"DropDownList\",\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"fontFamily\",\n                icon: \"font-family\"\n            },\n            componentOptions: {\n                dataSource: [\"Arial\", \"Courier New\", \"Georgia\", \"Times New Roman\", \"Trebuchet MS\", \"Verdana\"],\n                value: \"Arial\" ,\n                commandOn: \"change\"\n            }\n        },\n        fontSize: {\n            type: \"component\",\n            name: \"fontSize\",\n            command: \"PropertyChangeCommand\",\n            property: \"fontSize\",\n            component: \"ComboBox\",\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"fontSize\",\n                icon: \"font-size\"\n            },\n            componentOptions: {\n                dataSource: [8, 9, 10, 11, 12, 13, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72],\n                value: 12,\n                commandOn: \"change\"\n            }\n        },\n        format: {\n            type: \"component\",\n            name: \"format\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"custom-format\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"formatCells\",\n                icon: \"custom-format\"\n            },\n            componentOptions: {\n                items: [\n                    { attributes: { \"data-value\": defaultFormats.automatic, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.automatic },\n                    { attributes: { \"data-value\": defaultFormats.text, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.text },\n                    { attributes: { \"data-value\": defaultFormats.number, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.number, sample: \"1,499.99\" },\n                    { attributes: { \"data-value\": defaultFormats.percent, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.percent, sample: \"14.50%\" },\n                    { attributes: { \"data-value\": defaultFormats.financial, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.financial, sample: \"(1,000.12)\" },\n                    { attributes: { \"data-value\": defaultFormats.currency, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.currency, sample: \"$1,499.99\" },\n                    { attributes: { \"data-value\": defaultFormats.date, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.date, sample: \"4/21/2012\" },\n                    { attributes: { \"data-value\": defaultFormats.time, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.time, sample: \"5:49:00 PM\" },\n                    { attributes: { \"data-value\": defaultFormats.dateTime, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.dateTime, sample: \"4/21/2012 5:49:00\" },\n                    { attributes: { \"data-value\": defaultFormats.duration, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.duration, sample: \"168:05:00\" },\n                    { attributes: { \"data-value\": \"popup\", \"data-popup\": \"formatCells\" }, text: MESSAGES.formatTypes.moreFormats },\n                ],\n                itemTemplate:\n                    '<span class=\"k-link k-menu-link\"><span class=\"k-menu-link-text\">' +\n                        \"# if (data.sample) { #\" +\n                            \"<span class='k-spreadsheet-sample'>#: data.sample #</span>\" +\n                        \"# } #\" +\n                        \"#: data.text #\" +\n                    '</span></span>',\n                commandOn: \"click\"\n            }\n        },\n        filter: {\n            type: \"button\",\n            name: \"filter\",\n            property: \"hasFilter\",\n            icon: \"filter\",\n            command: \"FilterCommand\",\n            togglable: true,\n            enable: false\n        },\n        merge: {\n            type: \"component\",\n            name: \"merge\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"cells-merge\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"merge\",\n                icon: \"cells-merge\"\n            },\n            componentOptions: {\n                items: [\n                    { attributes: { \"data-value\": \"cells\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge\", text: MESSAGES.mergeButtons.mergeCells },\n                    { attributes: { \"data-value\": \"horizontally\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge-horizontally\", text: MESSAGES.mergeButtons.mergeHorizontally },\n                    { attributes: { \"data-value\": \"vertically\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge-vertically\", text: MESSAGES.mergeButtons.mergeVertically },\n                    { attributes: { \"data-value\": \"unmerge\", \"data-command\": \"MergeCellCommand\" }, icon: \"table-unmerge\", text: MESSAGES.mergeButtons.unmerge }\n                ],\n                commandOn: \"click\"\n            }\n        },\n        freeze: {\n            type: \"component\",\n            name: \"freeze\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"pane-freeze\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"freeze\",\n                icon: \"pane-freeze\"\n            },\n            componentOptions: {\n                items: [\n                    { attributes: { \"data-value\": \"panes\", \"data-command\": \"FreezePanesCommand\" }, icon: \"pane-freeze\", text: MESSAGES.freezeButtons.freezePanes },\n                    { attributes: { \"data-value\": \"rows\", \"data-command\": \"FreezePanesCommand\" }, icon: \"row-freeze\", text: MESSAGES.freezeButtons.freezeRows },\n                    { attributes: { \"data-value\": \"columns\", \"data-command\": \"FreezePanesCommand\" }, icon: \"column-freeze\", text: MESSAGES.freezeButtons.freezeColumns },\n                    { attributes: { \"data-value\": \"unfreeze\", \"data-command\": \"FreezePanesCommand\" }, icon: \"table-unmerge\", text: MESSAGES.freezeButtons.unfreeze }\n                ],\n                commandOn: \"click\"\n            }\n        },\n        borders: {\n            type: \"popupButton\",\n            name: \"borders\",\n            icon: \"borders-all\",\n            popupComponent: kendo.spreadsheet.BorderPalette,\n            commandOn: \"change\",\n            command: \"BorderChangeCommand\",\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"borders\"\n            }\n        },\n        formatCells: {\n            type: \"button\",\n            dialog: \"formatCells\",\n            overflow: \"never\"\n        },\n        hyperlink: {\n            type: \"button\",\n            name: \"hyperlink\",\n            dialog: \"hyperlink\",\n            icon: \"link\"\n        },\n        toggleGridlines: {\n            type: \"button\",\n            name: \"toggleGridlines\",\n            command: \"GridLinesChangeCommand\",\n            property: \"gridLines\",\n            value: true,\n            icon: \"borders-none\",\n            togglable: true,\n            selected: true\n        },\n        insertComment: {\n            type: \"button\",\n            name: \"insertComment\",\n            dialog: \"insertComment\",\n            property: \"comment\",\n            togglable: true,\n            icon: \"comment\"\n        },\n        insertImage: {\n            type: \"button\",\n            name: \"insertImage\",\n            dialog: \"insertImage\",\n            icon: \"image\",\n        },\n\n        //insert tab\n        addColumnLeft: {\n            type: \"button\",\n            name: \"addColumnLeft\",\n            command: \"AddColumnCommand\",\n            value: \"left\",\n            icon: \"table-column-insert-left\"\n        },\n        addColumnRight: {\n            type: \"button\",\n            name: \"addColumnRight\",\n            command: \"AddColumnCommand\",\n            value: \"right\",\n            icon: \"table-column-insert-right\"\n        },\n        addRowBelow: {\n            type: \"button\",\n            name: \"addRowBelow\",\n            command: \"AddRowCommand\",\n            value: \"below\",\n            icon: \"table-row-insert-below\"\n        },\n        addRowAbove: {\n            type: \"button\",\n            name: \"addRowAbove\",\n            command: \"AddRowCommand\",\n            value: \"above\",\n            icon: \"table-row-insert-above\"\n        },\n        deleteColumn: {\n            type: \"button\",\n            name: \"deleteColumn\",\n            command: \"DeleteColumnCommand\",\n            icon: \"table-column-delete\"\n        },\n        deleteRow: {\n            type: \"button\",\n            name: \"deleteRow\",\n            command: \"DeleteRowCommand\",\n            icon: \"table-row-delete\"\n        },\n\n        //data tab\n        sort: {\n            type: \"component\",\n            name: \"sort\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"sort-desc\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"sort\",\n                icon: \"sort-desc\"\n            },\n            componentOptions: {\n                items: [\n                    { attributes: { \"data-value\": \"asc\", \"data-command\": \"SortCommand\" }, sheet: false, text: MESSAGES.sortButtons.sortRangeAsc, icon: \"sort-asc\" },\n                    { attributes: { \"data-value\": \"desc\", \"data-command\": \"SortCommand\" }, sheet: false, text: MESSAGES.sortButtons.sortRangeDesc, icon: \"sort-desc\" },\n                ],\n                commandOn: \"click\"\n            }\n        },\n        validation: {\n            type: \"button\",\n            name: \"validation\",\n            dialog: \"validation\",\n            icon: \"exclamation-circle\"\n        }\n    };\n\n    var SpreadsheetToolBar = ToolBar.extend({\n        init: function(element, options) {\n            Object.keys(toolDefaults).forEach((t) => {\n                if (t !== \"validation\") {\n                    toolDefaults[t].showText = \"overflow\";\n                }\n            });\n\n            options.tools = options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName];\n            options.parentMessages = MESSAGES;\n            options.defaultTools = toolDefaults;\n\n            ToolBar.fn.init.call(this, element, options);\n            var handleClick = this._click.bind(this);\n\n            this.element.addClass(\"k-spreadsheet-toolbar k-toolbar-md\");\n\n            this.bind({\n                click: handleClick,\n                toggle: handleClick,\n                change: handleClick\n            });\n        },\n        _click: function(e) {\n            var target = e.target,\n                property = target.data(\"property\"),\n                value = e.value || target.data(\"value\") || e.target.val(),\n                commandType = target.data(\"command\"),\n                dialog = target.data(\"dialog\"),\n                options = target.data(\"options\") || {};\n\n            if (value === \"popup\") {\n                // Special case to open custom format dialog from option of the format DDL\n                dialog = target.data(\"popup\");\n            }\n\n            options.property = property || null;\n            options.value = value || null;\n\n            if (dialog) {\n                this.dialog({\n                    name: dialog,\n                    options: options\n                });\n                return;\n            }\n\n            if (!commandType) {\n                return;\n            }\n\n            var args = {\n                command: commandType,\n                options: options\n            };\n\n            if (typeof args.options.value === \"boolean\") {\n                args.options.value = e.checked ? true : null;\n            }\n\n            this.action(args);\n        },\n        events: [\n            \"action\",\n            \"dialog\"\n        ],\n        options: {\n            name: \"SpreadsheetToolBar\",\n            resizable: true,\n            tools: defaultTools\n        },\n        action: function(args) {\n            this.trigger(\"action\", args);\n        },\n        dialog: function(args) {\n            this.trigger(\"dialog\", args);\n        },\n        refresh: function(activeCell) {\n            var range = activeCell,\n                tools = this._tools();\n\n            for (var i = 0; i < tools.length; i++) {\n                var property = tools[i].property,\n                    tool = tools[i].tool,\n                    value = kendo.isFunction(range[property]) ? range[property]() : range;\n\n                if (property == \"gridLines\") {\n                    // this isn't really a property of the range, it's per-sheet.\n                    value = range.sheet().showGridLines();\n                }\n\n                this._updateTool(tool, value, property, range);\n            }\n\n            this.resize(true);\n        },\n        _tools: function() {\n            return this.element.find(\"[data-property]\").toArray().map(function(element) {\n                element = $(element);\n                return {\n                    property: element.attr(\"data-property\"),\n                    tool: this._getItem(element)\n                };\n            }.bind(this));\n        },\n        _updateTool: function(tool, value, property, range) {\n            var component = tool.component,\n                toolbarEl = tool.toolbarEl,\n                widget = kendo.widgetInstance(toolbarEl.find(\"[data-role]\")),\n                menuItem = tool.menuItem,\n                toggle = false,\n                vertical, text, menu, selection, enabled, label;\n\n            if (property === \"hasFilter\") {\n                selection = range.sheet().selection();\n\n                if (selection && selection._ref && selection._ref.height) {\n                    enabled = value || selection._ref.height() > 1;\n\n                    this.enable(toolbarEl, enabled);\n                }\n            } else if (property === \"alignment\") {\n                vertical = value.verticalAlign();\n                text = value.textAlign();\n                menu = component.menu.element;\n\n                menu.find(\".k-item .k-link\").removeClass(\"k-selected\");\n                menu.find(\".k-item[data-property=textAlign][data-value=\" + text + \"] .k-link\").addClass(\"k-selected\");\n                menu.find(\".k-item[data-property=verticalAlign][data-value=\" + vertical + \"] .k-link\").addClass(\"k-selected\");\n            } else if (property === \"background\" || property === \"color\") {\n                widget.value(value);\n            } else if (property === \"fontFamily\" || property === \"fontSize\") {\n                label = menuItem.find(\".k-menu-link-text\").text().split(\"(\")[0].trim();\n                menuItem.find(\".k-menu-link-text\").text(label + \" (\" + value + \") ...\");\n                widget.value(value);\n            }\n\n            if (component && component.toggle) {\n                if (typeof value === \"boolean\") {\n                    toggle = !!value;\n                } else if (typeof value === \"string\") {\n                    if (toolbarEl.data(\"value\")) {\n                        toggle = toolbarEl.data(\"value\") === value;\n                    } else {\n                        // if no value is specified in the tool options,\n                        // assume it should be ON if the range value is not null, and OFF otherwise.\n                        toggle = value != null;\n                    }\n                }\n\n                this.toggle(toolbarEl, toggle);\n            }\n        }\n    });\n\n    kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n\n    kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n        init: function(element, options) {\n            kendo.ui.TabStrip.fn.init.call(this, element, options);\n            element.addClass(\"k-spreadsheet-tabstrip\");\n            this._quickAccessButtons();\n\n            this.toolbars = {};\n\n            var tabs = options.dataSource;\n\n            this.contentElements.each(function(idx, element) {\n                this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n            }.bind(this));\n\n            this.bind(\"activate\", function(e) { //force resize of the tabstrip after TabStrip tab is opened\n                var toolbar = $(e.contentElement).find(\".k-toolbar\").data(\"kendoSpreadsheetToolBar\");\n\n                toolbar._tabIndex();\n                this.wrapper.removeAttr(\"tabindex\");\n                this.wrapper.find(\".k-tabstrip-content\").removeAttr(\"tabindex\");\n            });\n        },\n\n        events: kendo.ui.TabStrip.fn.events.concat([ \"action\", \"dialog\" ]),\n\n        destroy: function() {\n            this.quickAccessToolBar.off(\"click\");\n            kendo.ui.TabStrip.fn.destroy.call(this);\n            for (var name in this.toolbars) {\n                this.toolbars[name].destroy();\n            }\n        },\n\n        action: function(args) {\n            this.trigger(\"action\", args);\n        },\n\n        dialog: function(args) {\n            this.trigger(\"dialog\", args);\n        },\n\n        refreshTools: function(range, reason) {\n            var toolbars = this.toolbars;\n\n            if (!reason.overElement && !reason.comment) {\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            }\n        },\n\n        _quickAccessButtons: function() {\n            var buttons = [\n                { title: MESSAGES.quickAccess.undo, icon: \"undo\", action: \"undo\" },\n                { title: MESSAGES.quickAccess.redo, icon: \"redo\", action: \"redo\" }\n            ];\n            var buttonTemplate = kendo.template(\"<a role='button' href='\\\\#' title='#= title #' data-action='#= action #' class='k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button' aria-label='#= title #'>#=kendo.ui.icon(icon)#</a>\");\n\n            this.quickAccessToolBar = $(\"<div />\", {\n                \"class\": \"k-spreadsheet-quick-access-toolbar\",\n                \"html\": kendo.render(buttonTemplate, buttons)\n            }).insertBefore(this.wrapper);\n\n            this.quickAccessToolBar.on(\"click\", \".k-button\", function(e) {\n                e.preventDefault();\n\n                var action = $(e.currentTarget).attr(\"data-action\");\n                this.action({ action: action });\n            }.bind(this));\n\n            this.quickAccessAdjust();\n        },\n\n        quickAccessAdjust: function() {\n            this.tabGroup.css(\"padding-left\", kendo._outerWidth(this.quickAccessToolBar));\n        },\n\n        _toolbar: function(container, name, tools) {\n            var element;\n            var options;\n\n            if (this.toolbars[name]) {\n                this.toolbars[name].destroy();\n                container.children(\".k-toolbar\").remove();\n            }\n\n            if (tools) {\n                element = container.html(\"<div></div>\").children(\"div\");\n\n                element.attr(\"aria-label\", name);\n\n                options = {\n                    tools: typeof tools === \"boolean\" ? undefined : tools,\n                    toolbarName: name,\n                    action: this.action.bind(this),\n                    dialog: this.dialog.bind(this)\n                };\n\n                this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n            }\n        }\n\n    });\n\n})(window.kendo);\n\n(function(kendo) {\n\n\n\n\n\n    var $ = kendo.jQuery;\n    var ObservableObject = kendo.data.ObservableObject;\n\n    var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n        apply: \"Apply\",\n        save: \"Save\",\n        cancel: \"Cancel\",\n        remove: \"Remove\",\n        retry: \"Retry\",\n        revert: \"Revert\",\n        okText: \"OK\",\n        formatCellsDialog: {\n            title: \"Format\",\n            categories: {\n                number: \"Number\",\n                currency: \"Currency\",\n                date: \"Date\"\n            }\n        },\n        fontFamilyDialog: {\n            title: \"Font\"\n        },\n        fontSizeDialog: {\n            title: \"Font size\"\n        },\n        bordersDialog: {\n            title: \"Borders\"\n        },\n        alignmentDialog: {\n            title: \"Alignment\",\n            buttons: {\n                justifyLeft: \"Align left\",\n                justifyCenter: \"Center\",\n                justifyRight: \"Align right\",\n                justifyFull: \"Justify\",\n                alignTop: \"Align top\",\n                alignMiddle: \"Align middle\",\n                alignBottom: \"Align bottom\"\n            }\n        },\n        mergeDialog: {\n            title: \"Merge cells\",\n            buttons: {\n                mergeCells: \"Merge all\",\n                mergeHorizontally: \"Merge horizontally\",\n                mergeVertically: \"Merge vertically\",\n                unmerge: \"Unmerge\"\n            }\n        },\n        freezeDialog: {\n            title: \"Freeze panes\",\n            buttons: {\n                freezePanes: \"Freeze panes\",\n                freezeRows: \"Freeze rows\",\n                freezeColumns: \"Freeze columns\",\n                unfreeze: \"Unfreeze panes\"\n            }\n        },\n        confirmationDialog: {\n            text: \"Are you sure you want to remove this sheet?\",\n            title: \"Sheet remove\"\n        },\n        validationDialog: {\n            title: \"Data Validation\",\n            hintMessage: \"Please enter a valid {0} value {1}.\",\n            hintTitle: \"Validation {0}\",\n            criteria: {\n                any: \"Any value\",\n                number: \"Number\",\n                text: \"Text\",\n                date: \"Date\",\n                custom: \"Custom Formula\",\n                list: \"List\"\n            },\n            comparers: {\n                greaterThan: \"greater than\",\n                lessThan: \"less than\",\n                between: \"between\",\n                notBetween: \"not between\",\n                equalTo: \"equal to\",\n                notEqualTo: \"not equal to\",\n                greaterThanOrEqualTo: \"greater than or equal to\",\n                lessThanOrEqualTo: \"less than or equal to\"\n            },\n            comparerMessages: {\n                greaterThan: \"greater than {0}\",\n                lessThan: \"less than {0}\",\n                between: \"between {0} and {1}\",\n                notBetween: \"not between {0} and {1}\",\n                equalTo: \"equal to {0}\",\n                notEqualTo: \"not equal to {0}\",\n                greaterThanOrEqualTo: \"greater than or equal to {0}\",\n                lessThanOrEqualTo: \"less than or equal to {0}\",\n                custom: \"that satisfies the formula: {0}\"\n            },\n            labels: {\n                criteria: \"Criteria\",\n                comparer: \"Comparer\",\n                min: \"Min\",\n                max: \"Max\",\n                value: \"Value\",\n                start: \"Start\",\n                end: \"End\",\n                onInvalidData: \"On invalid data\",\n                rejectInput: \"Reject input\",\n                showWarning: \"Show warning\",\n                showHint: \"Show hint\",\n                hintTitle: \"Hint title\",\n                hintMessage: \"Hint message\",\n                ignoreBlank: \"Ignore blank\",\n                showListButton: \"Display button to show list\",\n                showCalendarButton: \"Display button to show calendar\"\n            },\n            placeholders: {\n                typeTitle: \"Type title\",\n                typeMessage: \"Type message\"\n            }\n        },\n        exportAsDialog: {\n            title: \"Export...\",\n            defaultFileName: \"Workbook\",\n            xlsx: {\n                description: \"Excel Workbook (.xlsx)\"\n            },\n            pdf: {\n                description: \"Portable Document Format (.pdf)\",\n                area: {\n                    workbook: \"Entire Workbook\",\n                    sheet: \"Active Sheet\",\n                    selection: \"Selection\"\n                },\n                paper: {\n                    a2        : \"A2 (420 mm  594 mm)\",\n                    a3        : \"A3 (297 mm x 420 mm)\",\n                    a4        : \"A4 (210 mm x 297 mm)\",\n                    a5        : \"A5 (148 mm x 210 mm)\",\n                    b3        : \"B3 (353 mm  500 mm)\",\n                    b4        : \"B4 (250 mm x 353 mm)\",\n                    b5        : \"B5 (176 mm x 250 mm)\",\n                    folio     : 'Folio (8.5\" x 13\")',\n                    legal     : 'Legal (8.5\" x 14\")',\n                    letter    : 'Letter (8.5\" x 11\")',\n                    tabloid   : 'Tabloid (11\" x 17\")',\n                    executive : 'Executive (7.25\" x 10.5\")'\n                },\n                margin: {\n                    normal: \"Normal\",\n                    narrow: \"Narrow\",\n                    wide: \"Wide\"\n                }\n            },\n            labels: {\n                scale: \"Scale\",\n                fit: \"Fit to page\",\n                fileName: \"File name\",\n                saveAsType: \"Save as type\",\n                exportArea: \"Export\",\n                paperSize: \"Paper size\",\n                margins: \"Margins\",\n                orientation: \"Orientation\",\n                print: \"Print\",\n                guidelines: \"Guidelines\",\n                center: \"Center\",\n                horizontally: \"Horizontally\",\n                vertically: \"Vertically\"\n            }\n        },\n        modifyMergedDialog: {\n            errorMessage: \"Cannot change part of a merged cell.\"\n        },\n        rangeDisabledDialog: {\n            errorMessage: \"Destination range contains disabled cells.\"\n        },\n        intersectsArrayDialog: {\n            errorMessage: \"You cannot alter part of an array\"\n        },\n        incompatibleRangesDialog: {\n            errorMessage: \"Incompatible ranges\"\n        },\n        noFillDirectionDialog: {\n            errorMessage: \"Cannot determine fill direction\"\n        },\n        duplicateSheetNameDialog: {\n            errorMessage: \"Duplicate sheet name\"\n        },\n        overflowDialog: {\n            errorMessage: \"Cannot paste, because the copy area and the paste area are not the same size and shape.\"\n        },\n        useKeyboardDialog: {\n            title: \"Copying and pasting\",\n            errorMessage: \"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:\",\n            labels: {\n                forCopy: \"for copy\",\n                forCut: \"for cut\",\n                forPaste: \"for paste\"\n            }\n        },\n        unsupportedSelectionDialog: {\n            errorMessage: \"That action cannot be performed on multiple selection.\"\n        },\n        linkDialog: {\n            title: \"Hyperlink\",\n            labels: {\n                text: \"Text\",\n                url: \"Address\",\n                removeLink: \"Remove link\"\n            }\n        },\n        insertCommentDialog: {\n            title: \"Insert comment\",\n            labels: {\n                comment: \"Comment\",\n                removeComment: \"Remove comment\"\n            }\n        },\n        insertImageDialog: {\n            title: \"Insert image\",\n            info: \"Drag an image here, or click to select\",\n            typeError: \"Please select a JPEG, PNG or GIF image\"\n        }\n    };\n\n    var registry = {};\n    kendo.spreadsheet.dialogs = {\n        register: function(name, dialogClass) {\n            registry[name] = dialogClass;\n        },\n        registered: function(name) {\n            return !!registry[name];\n        },\n        create: function(name, options) {\n            var dialogClass = registry[name];\n\n            if (dialogClass) {\n                return new dialogClass(options);\n            }\n        }\n    };\n\n    var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n        init: function(options) {\n            kendo.Observable.fn.init.call(this, options);\n\n            this.options = translate($.extend(true, {}, this.options, options));\n\n            this.bind(this.events, options);\n        },\n        events: [\n            \"close\",\n            \"activate\"\n        ],\n        options: {\n            autoFocus: true\n        },\n        dialog: function() {\n            if (!this._dialog) {\n                var options = {\n                    autoFocus: false,\n                    scrollable: false,\n                    resizable: false,\n                    modal: true,\n                    visible: false,\n                    width: this.options.width || 320,\n                    title: this.options.title,\n                    open: function() {\n                        this.center();\n                    },\n                    close: this._onDialogClose.bind(this),\n                    activate: this._onDialogActivate.bind(this),\n                    deactivate: this._onDialogDeactivate.bind(this)\n                };\n                this._dialog = $(\"<div class='k-spreadsheet-window k-action-window k-popup-edit-form' />\")\n                    .addClass(this.options.className || \"\")\n                    .append(kendo.template(this.options.template)({\n                        messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                        ns: kendo.ns,\n\n                        // this is for ImportErrorDialog.  ugly that\n                        // we need this line here, but I couldn't\n                        // figure out a better way\n                        errors: this.options.errors\n                    }))\n                    .kendoWindow(options)\n                    .data(\"kendoWindow\");\n            }\n\n            return this._dialog;\n        },\n        _onDialogClose: function() {\n            this.trigger(\"close\", {\n                action: this._action\n            });\n        },\n        _onDialogActivate: function() {\n            this.trigger(\"activate\");\n        },\n        _onDialogDeactivate: function() {\n            this.trigger(\"deactivate\");\n            this.destroy();\n        },\n        destroy: function() {\n            if (this._dialog) {\n                this._dialog.destroy();\n                this._dialog = null;\n            }\n        },\n        open: function() {\n            this.dialog().open();\n            this.dialog().element.find(\".k-button-solid-primary\").trigger(\"focus\");\n        },\n        apply: function() {\n            this.close();\n        },\n        close: function() {\n            this._action = \"close\";\n\n            this.dialog().close();\n        }\n    });\n\n    function formattedValue(value, format) {\n        return kendo.spreadsheet.formatting.text(value, format);\n    }\n\n    var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n        init: function(options) {\n            ObservableObject.fn.init.call(this, options);\n\n            this.useCategory(this.category);\n        },\n        useCategory: function(category) {\n            var type = category && category.type || \"number\";\n            var formatCurrency = type == \"currency\";\n\n            this.category = category;\n\n            this.set(\"showCurrencyFilter\", formatCurrency && this.currencies.length > 1);\n\n            if (!formatCurrency) {\n                this.set(\"formats\", this.allFormats[type + \"Formats\"]);\n            } else {\n                this.currency(this.currencies[0]);\n            }\n\n            this.useFirstFormat();\n        },\n        useFirstFormat: function() {\n            if (this.formats.length) {\n                this.set(\"format\", this.formats[0].value);\n            }\n        },\n        currency: function(currency) {\n            if (currency !== undefined) {\n                this._currency = currency;\n\n                var info = currency.value;\n                var formats = [\n                    { currency: info, decimals: true },\n                    { currency: info, decimals: true, iso: true },\n                    { currency: info, decimals: false }\n                ];\n\n                formats = formats.map(function(format) {\n                    format = FormatCellsViewModel.convert.currency(format);\n\n                    return { value: format, name: formattedValue(1000, format) };\n                });\n\n                this.set(\"formats\", formats);\n\n                this.useFirstFormat();\n            }\n\n            return this._currency || this.currencies[0];\n        },\n        categoryFilter: function(category) {\n            if (category !== undefined) {\n                this.useCategory(category);\n            }\n\n            return this.category;\n        },\n        preview: function() {\n            var format = this.get(\"format\");\n            var value = this.value || 0;\n\n            if (format && format.length) {\n                return formattedValue(value, format);\n            } else {\n                return value;\n            }\n        }\n    });\n\n    FormatCellsViewModel.convert = {\n        currency: function(options) {\n            function repeat(token, n) {\n                return new Array(n+1).join(token);\n            }\n\n            // convert culture info to spreadsheet format\n            var info = options.currency;\n            var format = info.pattern[1];\n\n            if (options.decimals) {\n                format = format.replace(/n/g, \"n\" + info[\".\"] + repeat(\"0\", info.decimals));\n            }\n\n            if (options.iso) {\n                format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, \"\");\n            } else {\n                format = format.replace(/\\$/g, JSON.stringify(info.symbol));\n            }\n\n            format = format.replace(/n/g, \"?\");\n\n            return format;\n        },\n        date: function(format) {\n            if ((/T|Z/).test(format)) {\n                return \"\";\n            }\n\n            return format.toLowerCase().replace(/tt/g, \"AM/PM\").replace(/'/g, '\"');\n        }\n    };\n\n    function uniqueBy(field, array) {\n        var result = [];\n        var values = [];\n\n        for (var i = 0; i < array.length; i++) {\n            if ($.inArray(array[i][field], values) == -1) {\n                result.push(array[i]);\n                values.push(array[i][field]);\n            }\n        }\n\n        return result;\n    }\n\n    var FormatCellsDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                categories: [\n                    { type: \"number\", name: messages.categories.number },\n                    { type: \"currency\", name: messages.categories.currency },\n                    { type: \"date\", name: messages.categories.date }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._generateFormats();\n        },\n        options: {\n            className: \"k-spreadsheet-format-cells\",\n            template:\n                \"<div class='k-edit-form-container'>\" +\n\n                    \"<div class='k-root-tabs' data-#:ns#role='tabstrip' \" +\n                        \"data-#:ns#text-field='name' \" +\n                        \"data-#:ns#bind='source: categories, value: categoryFilter' \" +\n                        \"data-#:ns#animation='false'></div>\" +\n\n                    \"<div class='k-spreadsheet-preview' data-#:ns#bind='text: preview'></div>\" +\n\n                    \"<script type='text/x-kendo-template' id='format-item-template'>\" +\n                        \"\\\\#: data.name \\\\#\" +\n                    \"</script>\" +\n\n                    \"<select data-#:ns#role='dropdownlist' class='k-format-filter' \" +\n                        \"data-#:ns#text-field='description' \" +\n                        \"data-#:ns#value-field='value.name' \" +\n                        \"data-#:ns#bind='visible: showCurrencyFilter, value: currency, source: currencies'></select>\" +\n\n                    \"<ul data-#:ns#role='staticlist' tabindex='0' \" +\n                        \"id='formats-list' \" +\n                        \"aria-label='formats list' \" +\n                        \"class='k-list k-reset' \" +\n                        \"data-#:ns#template='format-item-template' \" +\n                        \"data-#:ns#value-primitive='true' \" +\n                        \"data-#:ns#value-field='value' \" +\n                        \"data-#:ns#bind='source: formats, value: format'></ul>\" +\n\n                    \"<div class='k-actions'>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                    \"</div>\"+\n\n                \"</div>\"\n        },\n        _generateFormats: function() {\n            var options = this.options;\n\n            if (!options.currencies) {\n                options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n            }\n\n            if (!options.numberFormats) {\n                options.numberFormats = [\n                    { value: \"#.00%\", name: \"100.00%\" },\n                    { value: \"#%\", name: \"100%\" },\n                    { value: \"#.00\", name: \"1024.00\" },\n                    { value: \"#,###.00\", name: \"1,024.00\" }\n                ];\n            }\n\n            if (!options.dateFormats) {\n                var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n\n                options.dateFormats = uniqueBy(\"value\", $.map(calendarPatterns, function(format) {\n                    format = FormatCellsViewModel.convert.date(format);\n\n                    if (!format) {\n                        return;\n                    }\n\n                    return { value: format, name: formattedValue(34567.7678, format) };\n                }));\n            }\n        },\n        open: function(range) {\n            var options = this.options;\n            var value = range.value();\n            var categories = options.categories.slice(0);\n            var element;\n\n            this.viewModel = new FormatCellsViewModel({\n                currencies: options.currencies.slice(0),\n                allFormats: {\n                    numberFormats: options.numberFormats.slice(0),\n                    dateFormats: options.dateFormats.slice(0)\n                },\n                categories: categories,\n                format: range.format(),\n                category: value instanceof Date ? categories[2] : categories[0],\n                apply: this.apply.bind(this),\n                close: this.close.bind(this),\n                value: value\n            });\n\n            SpreadsheetDialog.fn.open.call(this);\n\n            element = this.dialog().element;\n\n            kendo.bind(element, this.viewModel);\n\n            var currencyFilter = element.find(\"select.k-format-filter\").data(\"kendoDropDownList\");\n\n            if (options.currencies.length > 10) {\n                currencyFilter.setOptions({ filter: \"contains\" });\n            }\n\n            element.find(kendo.roleSelector(\"staticlist\")).parent().addClass(\"k-list-wrapper\");\n\n            element.find(\".k-tabstrip-item\").attr(\"aria-controls\", \"formats-list\");\n        },\n        apply: function() {\n            var format = this.viewModel.format;\n\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: \"format\",\n                    value: format\n                }\n            });\n        }\n    });\n\n    FormatCellsDialog.currenciesFrom = function (cultures) {\n        return uniqueBy(\"description\", $.map(cultures, function(culture, name) {\n            if (!(/-/).test(name)) {\n                return;\n            }\n\n            var currency = culture.numberFormat.currency;\n            var description = kendo.format(\n                \"{0} ({1}, {2})\",\n                currency.name,\n                currency.abbr,\n                currency.symbol\n            );\n\n            return { description: description, value: currency };\n        }));\n    };\n\n    kendo.spreadsheet.dialogs.register(\"formatCells\", FormatCellsDialog);\n\n    kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n\n    var MessageDialog = SpreadsheetDialog.extend({\n        options: {\n            className: \"k-spreadsheet-message\",\n            title: \"\",\n            messageId: \"\",\n            text: \"\",\n            template:\n                \"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>\" +\n                \"<div class='k-actions'>\" +\n                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>\" +\n                        \"<span class='k-button-text'>#= messages.okText #</span>\" +\n                    \"</button>\" +\n                \"</div>\"\n        },\n        open: function() {\n            SpreadsheetDialog.fn.open.call(this);\n\n            var options = this.options;\n            var text = options.text;\n\n            if (options.messageId) {\n                text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n            }\n\n            kendo.bind(this.dialog().element, {\n                text: text,\n                close: this.close.bind(this)\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"message\", MessageDialog);\n\n    var ConfirmationDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                text: messages.text\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n        },\n        options: {\n            className: \"k-spreadsheet-message\",\n            messageId: \"\",\n            template:\n                \"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>\" +\n                \"<div class='k-actions'>\" +\n                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: confirm'>\" +\n                        \"<span class='k-button-text'>#= messages.okText #</span>\" +\n                    \"</button>\" +\n                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'>\" +\n                        \"<span class='k-button-text'>#= messages.cancel #</span>\" +\n                    \"</button>\" +\n                \"</div>\"\n        },\n        open: function() {\n            SpreadsheetDialog.fn.open.call(this);\n\n            var options = this.options;\n            var text = options.text;\n\n            if (options.messageId) {\n                text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n            }\n\n            kendo.bind(this.dialog().element, {\n                text: text,\n                confirm: this.confirm.bind(this),\n                cancel: this.close.bind(this)\n            });\n        },\n        isConfirmed: function() {\n            return this._confirmed;\n        },\n        confirm: function() {\n            this._confirmed = true;\n            this.close();\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"confirmation\", ConfirmationDialog);\n\n    var ValidationErrorDialog = SpreadsheetDialog.extend({\n        options: {\n            className: \"k-spreadsheet-message\",\n            title: \"\",\n            messageId: \"\",\n            text: \"\",\n            template:\n            \"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>\" +\n            \"<div class='k-actions'>\" +\n                \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: retry'>\" +\n                    \"<span class='k-button-text'>#= messages.retry #</span>\" +\n                \"</button>\" +\n                \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'>\" +\n                    \"<span class='k-button-text'>#= messages.cancel #</span>\" +\n                \"</button>\" +\n            \"</div>\"\n        },\n        open: function() {\n            SpreadsheetDialog.fn.open.call(this);\n\n            var options = this.options;\n            var text = options.text;\n\n            if (options.messageId) {\n                text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n            }\n\n            kendo.bind(this.dialog().element, {\n                text: text,\n                retry: this.retry.bind(this),\n                cancel: this.close.bind(this)\n            });\n        },\n        retry: function() {\n            this._retry = true;\n            this.close();\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"validationError\", ValidationErrorDialog);\n\n    var FontFamilyDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n\n            SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n            this._list();\n        },\n        options: {\n            template: \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n            var fonts = this.options.options;\n            var defaultFont = this.options.default;\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: fonts }),\n                template: \"#: data #\",\n                value: defaultFont,\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: \"fontFamily\",\n                    value: e.sender.value()[0]\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"fontFamily\", FontFamilyDialog);\n\n    var FontSizeDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n\n            SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n            this._list();\n        },\n        options: {\n            template: \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n            var sizes = this.options.options;\n            var defaultSize = this.options.default;\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: sizes }),\n                template: \"#: data #\",\n                value: defaultSize,\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: \"fontSize\",\n                    value: kendo.parseInt(e.sender.value()[0])\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"fontSize\", FontSizeDialog);\n\n    var BordersDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n\n            SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n            this.element = this.dialog().element;\n            this._borderPalette();\n\n            this.viewModel = kendo.observable({\n                apply: this.apply.bind(this),\n                close: this.close.bind(this)\n            });\n\n            kendo.bind(this.element.find(\".k-actions\"), this.viewModel);\n        },\n        options: {\n            template:   \"<div></div>\" +\n                        \"<div class='k-actions'>\" +\n                            \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>\" +\n                            \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                        \"</div>\"\n        },\n        apply: function() {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            var state = this.borderPalette.value();\n\n            if (state.color && state.type) {\n                this.trigger(\"action\", {\n                    command: \"BorderChangeCommand\",\n                    options: {\n                        border: state.type,\n                        style: { size: 1, color: state.color }\n                    }\n                });\n            }\n        },\n        _borderPalette: function() {\n            var element = this.dialog().element.find(\"div\").first();\n\n            this.borderPalette = new kendo.spreadsheet.BorderPalette(element, {\n                change: this.value.bind(this)\n            });\n        },\n        value: function(state) {\n            if (state === undefined) {\n                return this._state;\n            } else {\n                this._state = state;\n            }\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"borders\", BordersDialog);\n\n    var ColorChooser = SpreadsheetDialog.extend({\n        init: function(options) {\n            SpreadsheetDialog.fn.init.call(this, options);\n\n            this.element = this.dialog().element;\n            this.property = options.property;\n            this.options.title = options.title;\n\n            this.viewModel = kendo.observable({\n                apply: this.apply.bind(this),\n                close: this.close.bind(this)\n            });\n\n            kendo.bind(this.element.find(\".k-actions\"), this.viewModel);\n        },\n        options: {\n            template:   \"<div></div>\" +\n                        \"<div class='k-actions'>\" +\n                            \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>\" +\n                            \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                        \"</div>\"\n        },\n        apply: function() {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: this.property,\n                    value: this.value()\n                }\n            });\n        },\n        value: function(e) {\n            if (e === undefined) {\n                return this._value;\n            } else {\n                this._value = e.value;\n            }\n        }\n    });\n\n    var ColorPickerDialog = ColorChooser.extend({\n        init: function(options) {\n            options.width = 177;\n            ColorChooser.fn.init.call(this, options);\n            this._colorPalette();\n        },\n        _colorPalette: function() {\n            var element = this.dialog().element.find(\"div\").first();\n            this.colorPalette = element.kendoColorPalette({\n                palette: [ //metro palette\n                    \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n                    \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n                    \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n                    \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n                    \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n                    \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n                ],\n                change: this.value.bind(this)\n            }).data(\"kendoColorPalette\");\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"colorPicker\", ColorPickerDialog);\n\n    var CustomColorDialog = ColorChooser.extend({\n        init: function(options) {\n            options.width = 268;\n            ColorChooser.fn.init.call(this, options);\n            this.dialog().setOptions({ animation: false });\n            this.dialog().one(\"activate\", this._colorPicker.bind(this));\n        },\n        _colorPicker: function() {\n            var element = this.dialog().element.find(\"div\").first();\n            this.colorPicker = element.kendoFlatColorPicker({\n                change: this.value.bind(this)\n            }).data(\"kendoFlatColorPicker\");\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"customColor\", CustomColorDialog);\n\n    var AlignmentDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                buttons: [\n                    { property: \"textAlign\",     value: \"left\",    iconClass: \"align-left\",   text: messages.buttons.justifyLeft },\n                    { property: \"textAlign\",     value: \"center\",  iconClass: \"align-center\", text: messages.buttons.justifyCenter },\n                    { property: \"textAlign\",     value: \"right\",   iconClass: \"align-right\",  text: messages.buttons.justifyRight },\n                    { property: \"textAlign\",     value: \"justify\", iconClass: \"align-justify\",   text: messages.buttons.justifyFull },\n                    { property: \"verticalAlign\", value: \"top\",     iconClass: \"align-top\",      text: messages.buttons.alignTop },\n                    { property: \"verticalAlign\", value: \"center\",  iconClass: \"align-middle\",   text: messages.buttons.alignMiddle },\n                    { property: \"verticalAlign\", value: \"bottom\",  iconClass: \"align-bottom\",   text: messages.buttons.alignBottom }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._list();\n        },\n        options: {\n            template: \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                template: \"<a role='button' title='#=text#' data-property='#=property#' data-value='#=value#'>\" +\n                                \"#= kendo.ui.icon(iconClass) #\" +\n                                \"#=text#\" +\n                           \"</a>\",\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            var dataItem = e.sender.value()[0];\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: dataItem.property,\n                    value: dataItem.value\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"alignment\", AlignmentDialog);\n\n    var MergeDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                buttons: [\n                    { value: \"cells\",        iconClass: \"cells-merge\",        text: messages.buttons.mergeCells },\n                    { value: \"horizontally\", iconClass: \"cells-merge-horizontally\", text: messages.buttons.mergeHorizontally },\n                    { value: \"vertically\",   iconClass: \"cells-merge-vertically\",   text: messages.buttons.mergeVertically },\n                    { value: \"unmerge\",      iconClass: \"table-unmerge\",      text: messages.buttons.unmerge }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._list();\n        },\n        options: {\n            template: \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                template: \"<a role='button' title='#=text#' data-value='#=value#'>\" +\n                            \"#= kendo.ui.icon(iconClass) ##=text#\" +\n                          \"</a>\",\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            var dataItem = e.sender.value()[0];\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"MergeCellCommand\",\n                options: {\n                    value: dataItem.value\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"merge\", MergeDialog);\n\n    var FreezeDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                buttons: [\n                    { value: \"panes\",    iconClass: \"pane-freeze\",  text: messages.buttons.freezePanes },\n                    { value: \"rows\",     iconClass: \"row-freeze\",    text: messages.buttons.freezeRows },\n                    { value: \"columns\",  iconClass: \"column-freeze\",    text: messages.buttons.freezeColumns },\n                    { value: \"unfreeze\", iconClass: \"table-unmerge\", text: messages.buttons.unfreeze }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._list();\n        },\n        options: {\n            template: \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                template: \"<a role='button' title='#=text#' data-value='#=value#'>\" +\n                            \"#= kendo.ui.icon(iconClass) ##=text#\" +\n                          \"</a>\",\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            var dataItem = e.sender.value()[0];\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"FreezePanesCommand\",\n                options: {\n                    value: dataItem.value\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"freeze\", FreezeDialog);\n\n    var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n        init: function(options) {\n            ObservableObject.fn.init.call(this, options);\n\n            this.bind(\"change\", (function(e) {\n\n                if (e.field === \"criterion\") {\n                    this.reset();\n\n                    if (this.criterion === \"custom\" || this.criterion === \"list\") {\n                        this.setHintMessageTemplate();\n                    }\n                }\n\n                if (e.field === \"comparer\") {\n                    this.setHintMessageTemplate();\n                }\n\n                if ((e.field == \"hintMessage\" || e.field == \"hintTitle\") && !this._mute) {\n                    this.shouldBuild = false;\n                }\n\n                if ((e.field == \"from\" || e.field == \"to\" || e.field == \"hintMessageTemplate\" || e.field == \"type\") && this.shouldBuild) {\n                    this.buildMessages();\n                }\n            }).bind(this));\n\n            this.reset();\n        },\n        buildMessages: function() {\n            this._mute = true;\n            this.set(\"hintTitle\", this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : \"\");\n            this.set(\"hintMessage\", this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : \"\");\n            this._mute = false;\n        },\n        reset: function() {\n            this.setComparers();\n            this.set(\"comparer\", this.comparers[0].type);\n            this.set(\"from\", null);\n            this.set(\"to\", null);\n\n            this.set(\"useCustomMessages\", false);\n\n            this.shouldBuild = true;\n\n            this.hintTitleTemplate = this.defaultHintTitle;\n            this.buildMessages();\n        },\n        //TODO: refactor\n        setComparers: function() {\n            var all = this.defaultComparers;\n            var comparers = [];\n\n            if (this.criterion === \"text\") {\n                var text_comparers = [\"equalTo\", \"notEqualTo\"];\n                for (var idx = 0; idx < all.length; idx++) {\n                    if (text_comparers[0] == all[idx].type) {\n                        comparers.push(all[idx]);\n                        text_comparers.shift();\n                    }\n                }\n            } else {\n                comparers = all.slice();\n            }\n\n            this.set(\"comparers\", comparers);\n        },\n        setHintMessageTemplate: function() {\n           if (this.criterion !== \"custom\" && this.criterion !== \"list\") {\n               this.set(\"hintMessageTemplate\", kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n           } else {\n               this.set(\"hintMessageTemplate\", \"\");\n               this.set(\"hintMessage\", \"\");\n           }\n        },\n        isAny: function() {\n            return this.get(\"criterion\") === \"any\";\n        },\n        isNumber: function() {\n            return this.get(\"criterion\") === \"number\";\n        },\n        showToForNumber: function() {\n            return this.showTo() && this.isNumber();\n        },\n        showToForDate: function() {\n            return this.showTo() && this.isDate();\n        },\n        isText: function() {\n            return this.get(\"criterion\") === \"text\";\n        },\n        isDate: function() {\n            return this.get(\"criterion\") === \"date\";\n        },\n        isList: function() {\n            return this.get(\"criterion\") === \"list\";\n        },\n        isCustom: function() {\n            return this.get(\"criterion\") === \"custom\";\n        },\n        showRemove: function() {\n            return this.get(\"hasValidation\");\n        },\n        showTo: function() {\n            return this.get(\"comparer\") == \"between\" || this.get(\"comparer\") == \"notBetween\";\n        },\n        update: function(validation) {\n            this.set(\"hasValidation\", !!validation);\n\n            if (validation) {\n                this.fromValidationObject(validation);\n            }\n        },\n        fromValidationObject: function(validation) {\n            this.set(\"criterion\", validation.dataType);\n            this.set(\"comparer\", validation.comparerType);\n            this.set(\"from\", validation.from);\n            this.set(\"to\", validation.to);\n            this.set(\"type\", validation.type);\n            this.set(\"ignoreBlank\", validation.allowNulls);\n            this.set(\"showButton\", validation.showButton);\n\n            if (validation.messageTemplate || validation.titleTemplate) {\n                this.hintMessageTemplate = validation.messageTemplate;\n                this.hintMessage = validation.messageTemplate;\n                this.hintTitleTemplate = validation.titleTemplate;\n                this.hintTitle = validation.titleTemplate;\n                this.useCustomMessages = true;\n                this.buildMessages();\n            } else {\n                this.useCustomMessages = false;\n            }\n        },\n        toValidationObject: function() {\n            if (this.criterion === \"any\") {\n                return null;\n            }\n\n            var options = {\n                type: this.type,\n                dataType: this.criterion,\n                comparerType: this.comparer,\n                from: this.from,\n                to: this.to,\n                allowNulls: this.ignoreBlank,\n                showButton: this.showButton\n            };\n\n            if (this.useCustomMessages) {\n                options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                options.titleTemplate = this.hintTitle;\n            }\n\n            return options;\n        }\n    });\n\n    var ValidationDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                hintMessage: messages.hintMessage,\n                hintTitle: messages.hintTitle,\n                criteria: [\n                    { type: \"any\", name: messages.criteria.any },\n                    { type: \"number\", name: messages.criteria.number },\n                    { type: \"text\", name: messages.criteria.text },\n                    { type: \"date\", name: messages.criteria.date },\n                    { type: \"custom\", name: messages.criteria.custom },\n                    { type: \"list\", name: messages.criteria.list }\n                ],\n                comparers: [\n                    { type: \"greaterThan\", name: messages.comparers.greaterThan },\n                    { type: \"lessThan\",    name: messages.comparers.lessThan },\n                    { type: \"between\",     name: messages.comparers.between },\n                    { type: \"notBetween\",  name: messages.comparers.notBetween },\n                    { type: \"equalTo\",     name: messages.comparers.equalTo },\n                    { type: \"notEqualTo\",  name: messages.comparers.notEqualTo },\n                    { type: \"greaterThanOrEqualTo\", name: messages.comparers.greaterThanOrEqualTo },\n                    { type: \"lessThanOrEqualTo\",    name: messages.comparers.lessThanOrEqualTo }\n                ],\n                comparerMessages: messages.comparerMessages\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n        },\n        options: {\n            width: 450,\n            criterion: \"any\",\n            type: \"reject\",\n            ignoreBlank: true,\n            showButton: true,\n            useCustomMessages: false,\n            errorTemplate:\n                '<div class=\"k-tooltip k-tooltip-error k-validator-tooltip\">' +\n                    kendo.ui.icon({ icon: \"exclamation-circle\", iconClass: \"k-tooltip-icon\" }) +\n                    '<span class=\"k-tooltip-content\">#= message #</span>' +\n                    '<span class=\"k-callout k-callout-n\"></span>' +\n                '</div>',\n            template:\n                '<div class=\"k-edit-form-container\">' +\n                    '<div class=\"k-edit-label\"><label for=\"criteria\">#: messages.validationDialog.labels.criteria #:</label></div>' +\n                    '<div class=\"k-edit-field\">' +\n                        '<select id=\"criteria\" data-#:ns#role=\"dropdownlist\" ' +\n                            'title=\"#: messages.validationDialog.labels.criteria #\"' +\n                            'data-#:ns#text-field=\"name\" ' +\n                            'data-#:ns#value-field=\"type\" ' +\n                            'data-#:ns#bind=\"value: criterion, source: criteria\"></select>' +\n                    '</div>' +\n\n                    '<div data-#:ns#bind=\"visible: isNumber\">' +\n                        '<div class=\"k-edit-label\"><label for=\"number-comparer\">#: messages.validationDialog.labels.comparer #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<select id=\"number-comparer\" data-#:ns#role=\"dropdownlist\" ' +\n                                'title=\"#: messages.validationDialog.labels.comparer #\"' +\n                                'data-#:ns#text-field=\"name\" ' +\n                                'data-#:ns#value-field=\"type\" ' +\n                                'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' +\n                        '</div>' +\n                        '<div class=\"k-edit-label\"><label for=\"comparer-min\">#: messages.validationDialog.labels.min #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"comparer-min\" name=\"#: messages.validationDialog.labels.min #\" title=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isNumber\" required=\"required\" /></span>' +\n                        '</div>' +\n                        '<div data-#:ns#bind=\"visible: showTo\">' +\n                            '<div class=\"k-edit-label\"><label for=\"comparer-max\">#: messages.validationDialog.labels.max #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"comparer-max\" name=\"#: messages.validationDialog.labels.max #\" title=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-input-inner\" data-#:ns#bind=\"value: to, enabled: showToForNumber\" required=\"required\" /></span>' +\n                            '</div>' +\n                        '</div>' +\n                    '</div>' +\n\n                    '<div data-#:ns#bind=\"visible: isText\">' +\n                        '<div class=\"k-edit-label\"><label for=\"text-comparer\">#: messages.validationDialog.labels.comparer #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<select id=\"text-comparer\" data-#:ns#role=\"dropdownlist\" ' +\n                                'title=\"#: messages.validationDialog.labels.comparer #\"' +\n                                'data-#:ns#text-field=\"name\" ' +\n                                'data-#:ns#value-field=\"type\" ' +\n                                'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' +\n                        '</div>' +\n                        '<div class=\"k-edit-label\"><label for=\"text-comparer-value\">#: messages.validationDialog.labels.value #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"text-comparer-value\" name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isText\" required=\"required\" /></span>' +\n                        '</div>' +\n                    '</div>' +\n\n                    '<div data-#:ns#bind=\"visible: isDate\">' +\n                        '<div class=\"k-edit-label\"><label for=\"date-comparer\">#: messages.validationDialog.labels.comparer #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<select id=\"date-comparer\" data-#:ns#role=\"dropdownlist\" ' +\n                                'title=\"#: messages.validationDialog.labels.comparer #\"' +\n                                'data-#:ns#text-field=\"name\" ' +\n                                'data-#:ns#value-field=\"type\" ' +\n                                'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' +\n                        '</div>' +\n                        '<div class=\"k-edit-label\"><label for=\"date-comparer-start\">#: messages.validationDialog.labels.start #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"date-comparer-start\" name=\"#: messages.validationDialog.labels.start #\" title=\"#: messages.validationDialog.labels.start #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isDate\" required=\"required\" /></span>' +\n                        '</div>' +\n                        '<div data-#:ns#bind=\"visible: showTo\">' +\n                            '<div class=\"k-edit-label\"><label for=\"date-comparer-end\">#: messages.validationDialog.labels.end #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"date-comparer-end\" name=\"#: messages.validationDialog.labels.end #\" title=\"#: messages.validationDialog.labels.end #\" class=\"k-input-inner\" data-#:ns#bind=\"value: to, enabled: showToForDate\" required=\"required\" /></span>' +\n                            '</div>' +\n                        '</div>' +\n                    '</div>' +\n\n                    '<div data-#:ns#bind=\"visible: isCustom\">' +\n                        '<div class=\"k-edit-label\"><label for=\"custom-comparer-value\">#: messages.validationDialog.labels.value #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"custom-comparer-value\" name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isCustom\" required=\"required\" /></span>' +\n                        '</div>' +\n                    '</div>' +\n\n                    '<div data-#:ns#bind=\"visible: isList\">' +\n                        '<div class=\"k-edit-label\"><label for=\"list-comparer-value\">#: messages.validationDialog.labels.value #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"list-comparer-value\" name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isList\" required=\"required\" /></span>' +\n                        '</div>' +\n                    '</div>' +\n\n                    '<div data-#:ns#bind=\"visible: isList\">' +\n                        '<div class=\"k-edit-field\">' +\n                            '<input type=\"checkbox\" name=\"showButton\" id=\"listShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: showButton\"/>' +\n                            '<label for=\"listShowButton\" class=\"k-checkbox-label\">' +\n                                ' #: messages.validationDialog.labels.showListButton #' +\n                            '</label>' +\n                        '</div>' +\n                    \"</div>\" +\n\n                    '<div data-#:ns#bind=\"visible: isDate\">' +\n                        '<div class=\"k-edit-field\">' +\n                            '<input type=\"checkbox\" name=\"showButton\" id=\"dateShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: showButton\"/>' +\n                            '<label for=\"dateShowButton\" class=\"k-checkbox-label\">' +\n                                ' #: messages.validationDialog.labels.showCalendarButton #' +\n                            '</label>' +\n                        '</div>' +\n                    \"</div>\" +\n\n                    '<div data-#:ns#bind=\"invisible: isAny\">' +\n                        '<div class=\"k-edit-field\">' +\n                            '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.ignoreBlank #\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: ignoreBlank\"/>' +\n                            '<label for=\"ignoreBlank\" class=\"k-checkbox-label\">' +\n                                ' #: messages.validationDialog.labels.ignoreBlank #' +\n                            '</label>' +\n                        '</div>' +\n                    '</div>' +\n\n                    '<div data-#:ns#bind=\"invisible: isAny\">' +\n                        '<div class=\"k-hr\"></div>' +\n                        '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<input type=\"radio\" title=\"#: messages.validationDialog.labels.rejectInput #\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-#:ns#bind=\"checked: type\" class=\"k-radio k-radio-md\" />' +\n                            '<label for=\"validationTypeReject\" class=\"k-radio-label\">' +\n                                 \"#: messages.validationDialog.labels.rejectInput #\" +\n                            '</label> ' +\n                            '<input type=\"radio\" title=\"#: messages.validationDialog.labels.showWarning #\" id=\"validationTypeWarning\"  name=\"validationType\" value=\"warning\" data-#:ns#bind=\"checked: type\" class=\"k-radio k-radio-md\" />' +\n                            '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' +\n                                 \"#: messages.validationDialog.labels.showWarning #\" +\n                            '</label>' +\n                        '</div>' +\n                    '</div>' +\n\n                    '<div data-#:ns#bind=\"invisible: isAny\" class=\"hint-wrapper\">' +\n                        '<div class=\"k-edit-field\">' +\n                            '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.showHint #\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: useCustomMessages\" />' +\n                            '<label class=\"k-checkbox-label\" for=\"useCustomMessages\">'+\n                                ' #: messages.validationDialog.labels.showHint #' +\n                            '</label>' +\n                        '</div>' +\n                        '<div data-#:ns#bind=\"visible: useCustomMessages\">' +\n                            '<div class=\"k-edit-label\"><label for=\"hint-title\">#: messages.validationDialog.labels.hintTitle #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"hint-title\" name=\"hint-title\" class=\"k-input-inner\" title=\"#: messages.validationDialog.labels.hintTitle #\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-#:ns#bind=\"value: hintTitle\" /></span>' +\n                            '</div>' +\n                            '<div class=\"k-edit-label\"><label for=\"hint-message\">#: messages.validationDialog.labels.hintMessage #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"hint-message\" class=\"k-input-inner\" title=\"#: messages.validationDialog.labels.hintMessage #\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-#:ns#bind=\"value: hintMessage\" /></span>' +\n                            '</div>' +\n                        '</div>' +\n                    '</div>' +\n\n                    '<div class=\"k-actions\">' +\n                        '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-#:ns#bind=\"visible: showRemove, click: remove\"><span class=\"k-button-text\">#: messages.remove #</span></button>' +\n                        '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\" data-#:ns#bind=\"click: apply\"><span class=\"k-button-text\">#: messages.apply #</span></button>' +\n                        '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-#:ns#bind=\"click: close\"><span class=\"k-button-text\">#: messages.cancel #</span></button>' +\n                    \"</div>\" +\n                \"</div>\"\n        },\n        open: function(range) {\n            var options = this.options;\n            var element;\n\n            this.viewModel = new ValidationViewModel({\n                type: options.type,\n                defaultHintMessage: options.hintMessage,\n                defaultHintTitle: options.hintTitle,\n                defaultComparers: options.comparers.slice(0),\n                comparerMessages: options.comparerMessages,\n                criteria: options.criteria.slice(0),\n                criterion: options.criterion,\n                ignoreBlank: options.ignoreBlank,\n                showButton: options.showButton,\n                apply: this.apply.bind(this),\n                close: this.close.bind(this),\n                remove: this.remove.bind(this)\n            });\n\n            this.viewModel.update(range.validation());\n\n            SpreadsheetDialog.fn.open.call(this);\n\n            element = this.dialog().element;\n\n            if (this.validatable) {\n                this.validatable.destroy();\n            }\n\n            kendo.bind(element, this.viewModel);\n\n            this.validatable = new kendo.ui.Validator(element.find(\".k-edit-form-container\"), {\n                validateOnBlur: false,\n                errorTemplate: this.options.errorTemplate || undefined\n            });\n        },\n        apply: function() {\n\n            if (this.validatable.validate()) {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"EditValidationCommand\",\n                    options: {\n                        value: this.viewModel.toValidationObject()\n                    }\n                });\n            }\n        },\n        remove: function() {\n            this.viewModel.set(\"criterion\", \"any\");\n            this.apply();\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"validation\", ValidationDialog);\n    kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n\n    function PDF_PAPER_SIZE(size) {\n        return {\n            value: size,\n            text: TEXT(\"exportAsDialog.pdf.paper.\" + size)\n        };\n    }\n\n    var ExportAsDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            SpreadsheetDialog.fn.init.call(this, options);\n            options = this.options;\n\n            this.viewModel = kendo.observable({\n                title: options.title,\n                name: options.name,\n                extension: options.extension,\n                fileFormats:options.fileFormats,\n                excel: options.excelExport,\n                pdf: {\n                    proxyURL: options.pdfExport.proxyURL,\n                    forceProxy: options.pdfExport.forceProxy,\n                    title: options.pdfExport.title,\n                    author: options.pdfExport.author,\n                    autoPrint: options.pdfExport.autoPrint,\n                    subject: options.pdfExport.subject,\n                    keywords: options.pdfExport.keywords,\n                    creator: options.pdfExport.creator,\n                    date: options.pdfExport.date,\n\n                    fitWidth: options.pdf.fitWidth,\n                    area: options.pdf.area,\n                    areas: options.pdf.areas,\n                    paperSize: options.pdf.paperSize,\n                    paperSizes: options.pdf.paperSizes,\n                    margin: options.pdf.margin,\n                    margins: options.pdf.margins,\n                    landscape: options.pdf.landscape,\n                    guidelines: options.pdf.guidelines,\n                    hCenter: options.pdf.hCenter,\n                    vCenter: options.pdf.vCenter\n                },\n                apply: this.apply.bind(this),\n                close: this.close.bind(this)\n            });\n\n            var dialog = this.dialog();\n            this.viewModel.bind(\"change\", function(e) {\n                if (e.field === \"extension\") {\n                    this.set(\"showPdfOptions\", this.extension === \".pdf\" ? true : false);\n                    dialog.center();\n                }\n            });\n\n            kendo.bind(dialog.element, this.viewModel);\n        },\n        options: {\n            title: TEXT(\"exportAsDialog.title\", \"Export...\"),\n            name: TEXT(\"exportAsDialog.defaultFileName\", \"Workbook\"),\n            extension: \".xlsx\",\n            fileFormats: [{\n                description: TEXT(\"exportAsDialog.xlsx.description\", \"Excel Workbook (.xlsx)\"),\n                extension: \".xlsx\"\n            }, {\n                description: TEXT(\"exportAsDialog.pdf.description\", \"Portable Document Format (.pdf)\"),\n                extension: \".pdf\"\n            }],\n            pdf: {\n                fitWidth: true,\n                area: \"workbook\",\n                areas: [{\n                    area: \"workbook\",\n                    text: TEXT(\"exportAsDialog.pdf.area.workbook\", \"Entire Workbook\")\n                },{\n                    area: \"sheet\",\n                    text: TEXT(\"exportAsDialog.pdf.area.sheet\", \"Active Sheet\")\n                },{\n                    area: \"selection\",\n                    text: TEXT(\"exportAsDialog.pdf.area.selection\", \"Selection\")\n                }],\n                paperSize: \"a4\",\n                paperSizes: [\n                    \"a2\", \"a3\", \"a4\", \"a5\", \"b3\", \"b4\", \"b5\", \"folio\", \"legal\", \"letter\", \"tabloid\", \"executive\"\n                ].map(PDF_PAPER_SIZE),\n                margin: {bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\"},\n                margins: [\n                    { value: { bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\" },\n                      text: TEXT(\"exportAsDialog.pdf.margin.normal\", \"Normal\")\n                    },\n                    { value: { bottom: \"0.75in\", left: \"0.25in\", right: \"0.25in\", top: \"0.75in\" },\n                      text: TEXT(\"exportAsDialog.pdf.margin.narrow\", \"Narrow\")\n                    },\n                    { value: { bottom: \"1in\", left: \"1in\", right: \"1in\", top: \"1in\" },\n                      text: TEXT(\"exportAsDialog.pdf.margin.wide\", \"Wide\")\n                    }\n                ],\n                landscape: true,\n                guidelines: true,\n                hCenter: true,\n                vCenter: true\n            },\n            width: 520,\n            template:\n                \"<div class='k-edit-label'><label id='name-label'>#: messages.exportAsDialog.labels.fileName #:</label></div>\" +\n                \"<div class='k-edit-field'>\" +\n                    \"<span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input aria-labelledby='name-label' class='k-input-inner' data-#:ns#bind='value: name' /></span>\" +\n                \"</div>\" +\n                \"<div >\" +\n                    \"<div class='k-edit-label'><label id='file-format-label'>#: messages.exportAsDialog.labels.saveAsType #:</label></div>\" +\n                    \"<div class='k-edit-field'>\" +\n                    \"<select aria-labelledby='file-format-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                        \"data-#:ns#text-field='description' \" +\n                        \"data-#:ns#value-field='extension' \" +\n                        \"data-#:ns#bind='value: extension, source: fileFormats'></select>\" +\n                    \"</div>\" +\n                \"</div>\" +\n                \"<div class='k-export-config' data-#:ns#bind='visible: showPdfOptions'>\" +\n                    \"<hr class='k-hr' />\" +\n                    \"<div class='k-edit-label'><label id='export-area-label'>#: messages.exportAsDialog.labels.exportArea #:</label></div>\" +\n                    \"<div class='k-edit-field'>\" +\n                        \"<select aria-labelledby='export-area-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                            \"data-#:ns#text-field='text' \" +\n                            \"data-#:ns#value-field='area' \" +\n                            \"data-#:ns#bind='value: pdf.area, source: pdf.areas'></select>\" +\n                    \"</div>\" +\n                    \"<div class='k-edit-label'><label id='paper-size-label'>#: messages.exportAsDialog.labels.paperSize#:</label></div>\" +\n                    \"<div class='k-edit-field'>\" +\n                        \"<select aria-labelledby='paper-size-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                            \"data-#:ns#text-field='text' \" +\n                            \"data-#:ns#value-field='value' \" +\n                            \"data-#:ns#bind='value: pdf.paperSize, source: pdf.paperSizes'></select>\" +\n                    \"</div>\" +\n                    \"<div class='k-edit-label'><label id='margins-label'>#: messages.exportAsDialog.labels.margins #:</label></div>\" +\n                    \"<div class='k-edit-field'>\" +\n                        \"<select aria-labelledby='margins-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                            \"data-#:ns#value-primitive='true'\" +\n                            \"data-#:ns#text-field='text' \" +\n                            \"data-#:ns#value-field='value' \" +\n                            \"data-#:ns#bind='value: pdf.margin, source: pdf.margins'></select>\" +\n                    \"</div>\" +\n                    \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>\" +\n                    \"<div class='k-edit-field'>\" +\n                        \"<div class='k-button-group'>\" +\n                            \"<input type='radio' id='k-orientation-portrait' aria-label='orientation portrait' name='orientation' data-#:ns#type='boolean' data-#:ns#bind='checked: pdf.landscape' value='false' />\" +\n                            `<label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-start k-orientation-button' for='k-orientation-portrait'>${kendo.ui.icon({ icon: \"file\", iconClass: \"k-button-icon\" })}</label>` +\n                            \"<input type='radio' id='k-orientation-landscape' aria-label='orientation landscape' name='orientation' data-#:ns#type='boolean' data-#:ns#bind='checked: pdf.landscape' value='true' />\" +\n                            `<label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-end k-orientation-button' for='k-orientation-landscape'>${kendo.ui.icon({ icon: \"file-horizontal\", iconClass: \"k-button-icon\" })}</label>` +\n                        \"</div>\" +\n                    \"</div>\" +\n                    \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.print #:</label></div>\" +\n                    \"<div class='k-edit-field'>\" +\n                        \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='guidelines' type='checkbox' data-#:ns#bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>#: messages.exportAsDialog.labels.guidelines#</label>\" +\n                    \"</div>\" +\n                    \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.scale #:</label></div>\" +\n                    \"<div class='k-edit-field'>\" +\n                        \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='fitWidth' type='checkbox' data-#:ns#bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>#: messages.exportAsDialog.labels.fit #</label>\" +\n                    \"</div>\" +\n                    \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.center #:</label></div>\" +\n                    \"<div class='k-edit-field'>\" +\n                        \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='hCenter' type='checkbox' data-#:ns#bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>#: messages.exportAsDialog.labels.horizontally #</label>\" +\n                        \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='vCenter' type='checkbox' data-#:ns#bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>#: messages.exportAsDialog.labels.vertically #</label>\" +\n                    \"</div>\" +\n                    \"<div class='k-page-orientation'>\" +\n                        kendo.ui.icon($(\"<span data-#:ns#bind='invisible: pdf.landscape'></span>\"), { icon: \"file\" }) +\n                        kendo.ui.icon($(\"<span data-#:ns#bind='visible: pdf.landscape'></span>\"), { icon: \"file-horizontal\" }) +\n                    \"</div>\" +\n                \"</div>\" +\n                \"<div class='k-actions'>\" +\n                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.save #</span></button>\" +\n                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                \"</div>\"\n        },\n        apply: function() {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"SaveAsCommand\",\n                options: this.viewModel\n            });\n        }\n    });\n    kendo.spreadsheet.dialogs.register(\"exportAs\", ExportAsDialog);\n\n    function basicErrorDialog(id, msg) {\n        kendo.spreadsheet.dialogs.register(\n            id,\n            MessageDialog.extend({\n                options: { messageId: msg }\n            })\n        );\n    }\n\n    basicErrorDialog(\"modifyMerged\", \"modifyMergedDialog.errorMessage\");\n    basicErrorDialog(\"rangeDisabled\", \"rangeDisabledDialog.errorMessage\");\n    basicErrorDialog(\"intersectsArray\", \"intersectsArrayDialog.errorMessage\");\n    basicErrorDialog(\"overflow\", \"overflowDialog.errorMessage\");\n    basicErrorDialog(\"unsupportedSelection\", \"unsupportedSelectionDialog.errorMessage\");\n    basicErrorDialog(\"incompatibleRanges\", \"incompatibleRangesDialog.errorMessage\");\n    basicErrorDialog(\"noFillDirection\", \"noFillDirectionDialog.errorMessage\");\n    basicErrorDialog(\"duplicateSheetName\", \"duplicateSheetNameDialog.errorMessage\");\n\n    var ImportErrorDialog = MessageDialog.extend({\n        options: {\n            width: 640,\n            title: \"Errors in import\",\n            template:\n                \"<div class='k-spreadsheet-message-content k-spreadsheet-import-errors'>\" +\n                  \"<div class='k--header-message'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div>\" +\n                  \"<div class='k--errors'>\" +\n                    \"<table>\" +\n                      \"<thead>\" +\n                        \"<tr><th>Context</th><th>Error message</th></tr>\" +\n                      \"</thead>\" +\n                      \"# for (var i = 0; i < errors.length; ++i) { #\" +\n                        \"# var err = errors[i]; #\" +\n                        \"<tr><td>#: err.context #</td><td>#: err.error #</td></tr>\" +\n                      \"# } #\" +\n                    \"</table>\" +\n                  \"</div>\" +\n                \"</div>\" +\n                \"<div class='k-actions'>\" +\n                  \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>\" +\n                    \"<span class='k-button-text'>#: messages.okText #</span>\" +\n                  \"</button>\" +\n                \"</div>\"\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"importError\", ImportErrorDialog);\n\n    var UseKeyboardDialog = MessageDialog.extend({\n        options: {\n            title: TEXT(\"useKeyboardDialog.title\", \"Copying and pasting\"),\n            template:\n                \"#: messages.useKeyboardDialog.errorMessage #\" +\n                \"<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>\" +\n                \"<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>\" +\n                \"<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>\" +\n                '<div class=\"k-actions\">' +\n                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>\" +\n                        \"<span class='k-button-text'>#= messages.okText #</span>\" +\n                    \"</button>\" +\n                \"</div>\"\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"useKeyboard\", UseKeyboardDialog);\n\n    var HyperlinkDialog = SpreadsheetDialog.extend({\n        options: {\n            title: TEXT(\"linkDialog.title\", \"Hyperlink\"),\n            template:\n            (\"<div class='k-edit-label'><label id='url-label'>#: messages.linkDialog.labels.url #:</label></div>\" +\n             \"<div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input class='k-input-inner' data-#:ns#bind='value: url' title='#: messages.linkDialog.labels.url #' aria-labelledby='url-label'/></span></div>\" +\n             \"<div class='k-actions'>\" + (\n                 (\"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left' data-#:ns#bind='click: remove'><span class='k-button-text'>#= messages.linkDialog.labels.removeLink #</span></button>\" +\n                  \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#= messages.okText #</span></button>\" +\n                  \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\")\n             ) + \"</div>\"\n            ),\n            autoFocus: false\n        },\n        open: function(range) {\n            var self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            var element = self.dialog().element;\n            var model = kendo.observable({\n                url: range.link(),\n                apply: function() {\n                    if (!/\\S/.test(model.url)) {\n                        model.url = null;\n                    }\n                    self.trigger(\"action\", {\n                        command: \"HyperlinkCommand\",\n                        options: {\n                            link: model.url\n                        }\n                    });\n                    self.close();\n                },\n                remove: function() {\n                    model.url = null;\n                    model.apply();\n                },\n                cancel: self.close.bind(self)\n            });\n            kendo.bind(element, model);\n\n            // it would be nice if we could easily handle that in one\n            // place for all dialogs, but it doesn't seem easily\n            // doable.\n            element.find(\"input\")\n                .trigger(\"focus\")\n                .on(\"keydown\", function(ev){\n                    if (ev.keyCode == 13 /*ENTER*/) {\n                        model.url = $(this).val(); // there won't be a \"change\" event and the model wouldn't update :-\\\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27 /*ESC*/) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"hyperlink\", HyperlinkDialog);\n\n    var InsertCommentDialog = SpreadsheetDialog.extend({\n        options: {\n            className: \"k-spreadsheet-insert-comment\",\n            template: \"\\\n<div class='k-edit-label'><label id='comment-label'>#: messages.insertCommentDialog.labels.comment #:</label></div>\\\n<div class='k-edit-field'><span class='k-input k-textarea k-input-solid k-input-md k-rounded-md'><textarea aria-labelledby='comment-label' rows='5' class='k-input-inner' data-#:ns#bind='value: comment'></textarea></span></div>\\\n<div class='k-actions'>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left' data-#:ns#bind='click: remove'><span class='k-button-text'>#: messages.insertCommentDialog.labels.removeComment #</span></button>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.okText #</span></button>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\\\n</div>\\\n\",\n            title: TEXT(\"insertCommentDialog.title\", \"Insert comment\"),\n            autoFocus: false,\n            width: 450\n        },\n        open: function(range) {\n            var self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            var element = self.dialog().element;\n            var model = kendo.observable({\n                comment: range.comment(),\n                apply: function() {\n                    if (!/\\S/.test(model.comment)) {\n                        model.comment = null;\n                    }\n                    self.trigger(\"action\", {\n                        command: \"InsertCommentCommand\",\n                        options: {\n                            value: model.comment\n                        }\n                    });\n                    self.close();\n                },\n                remove: function() {\n                    model.comment = null;\n                    model.apply();\n                },\n                cancel: self.close.bind(self)\n            });\n            kendo.bind(element, model);\n\n            element.find(\"textarea\").trigger(\"focus\");\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"insertComment\", InsertCommentDialog);\n\n    var InsertImageDialog = SpreadsheetDialog.extend({\n        options: {\n            template: \"\\\n<div class='k-spreadsheet-insert-image-dialog'>\\\n  <label data-#:ns#bind='style: { background-image: imageUrl },\\\n                    css: { k-spreadsheet-has-image: hasImage, k-hover: isHovered },\\\n                    events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }'>\\\n    <div data-#:ns#bind='text: info'></div>\\\n    <input type='file' data-#:ns#bind='events: { change: change }'\\\n           accept='image/png, image/jpeg, image/gif' />\\\n  </label>\\\n</div>\\\n<div class='k-actions'>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='enabled: okEnabled, click: apply'><span class='k-button-text'>#: messages.okText #</span></button>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\\\n</div>\",\n            title: TEXT(\"insertImageDialog.title\", \"Insert image\"),\n            width: \"auto\"\n        },\n        open: function() {\n            var self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            var element = self.dialog().element;\n            var model = kendo.observable({\n                okEnabled: false,\n                info: kendo.spreadsheet.messages.dialogs.insertImageDialog.info,\n                imageUrl: \"\",\n                hasImage: false,\n                isHovered: false,\n                _url: null,\n                _image: null,\n                apply: function() {\n                    window.URL.revokeObjectURL(model._url);\n                    self.trigger(\"action\", {\n                        command: \"InsertImageCommand\",\n                        options: {\n                            blob   : model._image,\n                            width  : model._width,\n                            height : model._height\n                        }\n                    });\n                    self.close();\n                },\n                cancel: self.close.bind(self),\n                stopEvent: function(ev) {\n                    ev.stopPropagation();\n                    ev.preventDefault();\n                },\n                drop: function(ev) {\n                    model.stopEvent(ev);\n                    model.selectFile(ev.originalEvent.dataTransfer.files);\n                    model.set(\"isHovered\", false);\n                },\n                dragEnter: function(ev) {\n                    model.stopEvent(ev);\n                    model.set(\"isHovered\", true);\n                },\n                dragLeave: function(ev) {\n                    model.stopEvent(ev);\n                    model.set(\"isHovered\", false);\n                },\n                change: function(ev) {\n                    model.selectFile(ev.target.files);\n                },\n                selectFile: function(files) {\n                    var image;\n                    for (var i = 0; i < files.length; ++i) {\n                        if (/^image\\//i.test(files[i].type)) {\n                            image = files[i];\n                            break;\n                        }\n                    }\n                    if (model._url) {\n                        window.URL.revokeObjectURL(model._url);\n                    }\n                    if (image) {\n                        model._image = image;\n                        model._url = window.URL.createObjectURL(image);\n                        var img = new Image();\n                        img.src = model._url;\n                        img.onload = function() {\n                            model._width = img.width;\n                            model._height = img.height;\n                            model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.info);\n                            model.set(\"okEnabled\", true);\n                            model.set(\"imageUrl\", \"url('\" + model._url + \"')\");\n                            model.set(\"hasImage\", true);\n                        };\n                    } else {\n                        model._image = null;\n                        model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.typeError);\n                        model.set(\"okEnabled\", false);\n                        model.set(\"imageUrl\", \"\");\n                        model.set(\"hasImage\", false);\n                    }\n                }\n            });\n            kendo.bind(element, model);\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"insertImage\", InsertImageDialog);\n\n    function Localizable(path, def) {\n        this.path = path.split(\".\");\n        this.def = def;\n    }\n\n    Localizable.prototype.trans = function() {\n        var msg = kendo.spreadsheet.messages.dialogs;\n        for (var i = 0; i < this.path.length; ++i) {\n            msg = msg[this.path[i]];\n            if (!msg) {\n                return this.def;\n            }\n        }\n        return msg;\n    };\n\n    function TEXT(path, def) {\n        return new Localizable(path, def);\n    }\n\n    function translate(thing) {\n        if (thing instanceof Localizable) {\n            return thing.trans();\n        }\n        else if (Array.isArray(thing)) {\n            return thing.map(translate);\n        }\n        else if (thing != null && typeof thing == \"object\") {\n            return Object.keys(thing).reduce(function(ret, key){\n                ret[key] = translate(thing[key]);\n                return ret;\n            }, {});\n        }\n        return thing;\n    }\n\n})(window.kendo);\n\n(function(kendo) {\n\n\n\n    var identity = function(o) { return o; };\n\n    var SheetDataSourceBinder = kendo.Class.extend({\n        init: function(options) {\n\n            this.options = kendo.jQuery.extend({}, this.options, options);\n\n            this.columns = this._normalizeColumns(this.options.columns);\n\n            this._sheet();\n            this._dataSource();\n\n            this._header();\n\n            this._boundRowsCount = 0;\n\n            this.dataSource.fetch();\n        },\n\n        _sheet: function() {\n            this.sheet = this.options.sheet;\n\n            this._sheetChangeHandler = this._sheetChange.bind(this);\n            this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n            this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n\n            this.sheet.bind(\"change\", this._sheetChangeHandler)\n                .bind(\"afterDeleteRow\", this._sheetDeleteRowHandler)\n                .bind(\"afterInsertRow\", this._sheetInsertRowHandler);\n        },\n\n        _sheetInsertRow: function(e) {\n            if (e.index !== undefined) {\n                this.dataSource.insert(Math.max(e.index - 1, 0), {});\n            }\n        },\n\n        _sheetDeleteRow: function(e) {\n            if (e.index !== undefined) {\n                var dataSource = this.dataSource;\n                var model = dataSource.view()[e.index - 1];\n\n                if (model) {\n                    dataSource.remove(model);\n                }\n            }\n        },\n\n        _header: function() {\n            this.sheet.batch(function() {\n                this.columns.forEach(function(column, index) {\n                    this.sheet.range(0,index).value(column.title);\n                }.bind(this));\n            }.bind(this));\n        },\n\n        _sheetChange: function(e) {\n            if (e.insertRow || e.deleteRow) {\n                // these actions are handled via custom events\n                return;\n            }\n\n            if (e.recalc && e.ref && e.isValue) {\n                var UnionRef = kendo.spreadsheet.UnionRef;\n                var dataSource = this.dataSource;\n                var data = dataSource.view();\n                var columns = this.columns;\n                var values = [];\n                var sheet = this.sheet;\n                var fields, getters, normalizedRef, i, rangeRef, normalizedRefs;\n                var setValues = function(ref) {\n                    ref = ref.toRangeRef();\n                    var record;\n                    var valueIndex = 0;\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        record = data[ri - 1]; // skip header row\n\n                        if (!record) {\n                            record = dataSource.insert(ri - 1, {});\n                            data = dataSource.view();\n                        }\n\n                        var colValueIndex = 0;\n                        for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                            var currentValue = values[i][valueIndex][colValueIndex++];\n                            record.set(columns[ci].field, getters[ci](currentValue));\n                        }\n                        valueIndex++;\n                    }\n                };\n\n                if (dataSource.reader.model) {\n                    fields = dataSource.reader.model.fields;\n                }\n\n                if (!columns.length && data.length) {\n                    columns = Object.keys(data[0].toJSON());\n                }\n\n                getters = columns.map(function(column) {\n                    var field = column.field;\n                    if (field && fields && fields[field] && fields[field].type == \"date\") {\n                        return numberToDate;\n                    }\n                    return identity;\n                });\n\n                this._skipRebind = true;\n                normalizedRef = sheet._grid.normalize(e.ref);\n\n                if(!(normalizedRef instanceof UnionRef)) {\n                    normalizedRef = new UnionRef([normalizedRef]);\n                }\n\n                normalizedRefs = normalizedRef.refs;\n\n                normalizedRefs.forEach(function(ref) {\n                    values.push(sheet.range(ref).values());\n                });\n\n                for(i = 0; i < normalizedRefs.length; i++) {\n                    rangeRef = normalizedRefs[i];\n                    rangeRef.forEach(setValues);\n                }\n\n                this._boundRowsCount = dataSource.view().length;\n\n                this._skipRebind = false;\n            }\n        },\n\n        _normalizeColumns: function(columns) {\n            return columns.map(function(column) {\n                var field = column.field || column;\n                return {\n                    field: field,\n                    title: column.title || field\n                };\n            });\n        },\n\n        _dataSource: function() {\n            var options = this.options;\n            var dataSource = options.dataSource;\n\n            dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n\n            if (this.dataSource && this._changeHandler) {\n                this.dataSource.unbind(\"change\", this._changeHandler)\n                    .unbind(\"progress\", this._progressHandler)\n                    .unbind(\"error\", this._errorHandler);\n            } else {\n                this._changeHandler = this._change.bind(this);\n                this._progressHandler = this._requestStart.bind(this);\n                this._errorHandler = this._error.bind(this);\n            }\n\n            this.dataSource = kendo.data.DataSource.create(dataSource)\n                .bind(\"change\", this._changeHandler)\n                .bind(\"progress\", this._progressHandler)\n                .bind(\"error\", this._errorHandler);\n        },\n\n        _error: function() {\n            this._progress(false);\n        },\n\n        _requestStart: function() {\n            this._progress(true);\n        },\n\n        _progress: function(toggle) {\n            this.sheet.trigger(\"progress\", {\n                toggle: toggle\n            });\n        },\n\n        _change: function() {\n            if (this._skipRebind) {\n                return;\n            }\n\n            if (this.sheet.trigger(\"dataBinding\")) {\n                return;\n            }\n\n            var data = this.dataSource.view();\n            var columns = this.columns;\n\n            if (!columns.length && data.length) {\n                this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                this._header();\n            }\n\n            var getters = columns.map(function(column) {\n                return kendo.getter(column.field);\n            });\n\n            this.sheet.batch(function() {\n                var length = Math.max(data.length, this._boundRowsCount, this.sheet._grid.rowCount - 1);\n\n                for (var idx = 0; idx < length; idx++) {\n                    for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                        var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n\n                        //skip header row\n                        this.sheet.range(idx + 1, getterIdx).value(value);\n                    }\n                }\n            }.bind(this));\n\n            this._boundRowsCount = data.length;\n\n            this._progress(false);\n            this.sheet.trigger(\"dataBound\");\n        },\n\n        destroy: function() {\n            this.dataSource.unbind(\"change\", this._changeHandler)\n                .unbind(\"progress\", this._progressHandler)\n                .unbind(\"error\", this._errorHandler);\n\n            this.sheet.unbind(\"change\", this._sheetChangeHandler)\n                .unbind(\"deleteRow\", this._sheetDeleteRowHandler)\n                .unbind(\"insertRow\", this._sheetInsertRowHandler);\n        },\n\n        options: {\n            columns: []\n        }\n    });\n\n    function numberToDate(val) {\n        return val == null ? null : kendo.spreadsheet.numberToDate(val);\n    }\n\n    kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n})(kendo);\n\n(function(kendo) {\n\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: \"k-details\",\n            button: \"k-button\",\n            detailsSummary: \"k-details-summary\",\n            detailsContent: \"k-details-content\",\n            icon: \"k-icon\",\n            iconCollapseName: \"caret-br\",\n            iconExpandName: \"caret-alt-right\",\n            iconSearchName: \"search\",\n            textbox: \"k-textbox\",\n            wrapper: \"k-spreadsheet-filter-menu\",\n            filterByCondition: \"k-spreadsheet-condition-filter\",\n            filterByValue: \"k-spreadsheet-value-filter\",\n            valuesTreeViewWrapper: \"k-spreadsheet-value-treeview-wrapper\",\n            actionButtons: \"k-actions\"\n        };\n\n        kendo.spreadsheet.messages.filterMenu = {\n            all: \"All\",\n            sortAscending: \"Sort range A to Z\",\n            sortDescending: \"Sort range Z to A\",\n            filterByValue: \"Filter by value\",\n            filterByCondition: \"Filter by condition\",\n            apply: \"Apply\",\n            search: \"Search\",\n            addToCurrent: \"Add to current selection\",\n            clear: \"Clear\",\n            blanks: \"(Blanks)\",\n            operatorNone: \"None\",\n            and: \"AND\",\n            or: \"OR\",\n            operators: {\n                string: {\n                    contains: \"Text contains\",\n                    doesnotcontain: \"Text does not contain\",\n                    startswith: \"Text starts with\",\n                    endswith: \"Text ends with\",\n                    matches: \"Text matches\",\n                    doesnotmatch: \"Text does not match\"\n                },\n                date: {\n                    eq:  \"Date is\",\n                    neq: \"Date is not\",\n                    lt:  \"Date is before\",\n                    gt:  \"Date is after\"\n                },\n                number: {\n                    eq: \"Is equal to\",\n                    neq: \"Is not equal to\",\n                    gte: \"Is greater than or equal to\",\n                    gt: \"Is greater than\",\n                    lte: \"Is less than or equal to\",\n                    lt: \"Is less than\"\n                }\n            }\n        };\n\n        var Details = Widget.extend({\n            init: function(element, options) {\n                Widget.fn.init.call(this, element, options);\n\n                this.element.addClass(FilterMenu.classNames.details);\n\n                this._summary = this.element.find(\".\" + FilterMenu.classNames.detailsSummary)\n                    .on(\"click\", this._toggle.bind(this));\n\n                var iconName = options.expanded ? FilterMenu.classNames.iconCollapseName : FilterMenu.classNames.iconExpandName;\n                this._icon = $(kendo.ui.icon(iconName))\n                    .prependTo(this._summary);\n\n                this._container = kendo.wrap(this._summary.next(), true);\n\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: {\n                name: \"Details\"\n            },\n            events: [ \"toggle\" ],\n            visible: function() {\n                return this.options.expanded;\n            },\n            toggle: function(show) {\n                var animation = kendo.fx(this._container).expand(\"vertical\");\n\n                animation.stop()[show ? \"reverse\" : \"play\"]();\n                kendo.ui.icon(this._icon, { icon: show ? FilterMenu.classNames.iconExpandName : FilterMenu.classNames.iconCollapseName });\n\n                this.options.expanded = !show;\n            },\n            _toggle: function() {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger(\"toggle\", { show: show });\n            }\n        });\n\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function(element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n\n                this._change = this.change.bind(this);\n                $(this.element).on(\"change\", this._change);\n            },\n            refresh: function() {\n                var that = this,\n                    value = that.bindings.spreadsheetFilterValue.get(); //get the value from the View-Model\n\n                $(that.element).val(value instanceof Date ? \"\" : value);\n            },\n            change: function() {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value); //update the View-Model\n            }\n        });\n\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function(widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n\n                this.widget = widget;\n                this._change = this.change.bind(this);\n                this.widget.first(\"change\", this._change);\n            },\n            refresh: function() {\n                var binding = this.bindings.spreadsheetFilterValue,\n                    value = binding.get(),\n                    type = $(this.widget.element).data(\"filterType\");\n\n                if ((type === \"date\" && value instanceof Date) || (type === \"number\" && !isNaN(value))) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function() {\n                var value = this.widget.value(),\n                    binding = this.bindings.spreadsheetFilterValue;\n\n                binding.set(value);\n            }\n        });\n\n        var templates = {\n            filterByValue:\n                \"<div class='\" + classNames.detailsSummary + \"'>#= messages.filterByValue #</div>\" +\n                \"<div class='\" + classNames.detailsContent + \"'>\" +\n                    \"<div class='k-searchbox k-input k-input-md k-rounded-md k-input-solid'>\" +\n                        kendo.ui.icon({ icon: \"search\", iconClass: \"k-input-icon\" }) +\n                        \"<input class='k-input-inner' autocomplete='off' placeholder='#= messages.search #' data-#=ns#bind='events: { input: filterValues }' />\" +\n                    \"</div>\" +\n                    \"<div data-#=ns#bind='visible: hasActiveSearch'><input class='k-checkbox k-checkbox-md k-rounded-md' type='checkbox' data-#=ns#bind='checked: appendToSearch' id='_#=guid#'/><label class='k-checkbox-label' for='_#=guid#'>#= messages.addToCurrent #</label></div>\" +\n                    \"<div class='\" + classNames.valuesTreeViewWrapper + \"'>\" +\n                        \"<div data-#=ns#role='treeview' \" +\n                            \"data-#=ns#checkboxes='{ checkChildren: true }' \"+\n                            \"data-#=ns#bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' \"+\n                            \"></div>\" +\n                    \"</div>\" +\n                \"</div>\",\n            filterByCondition:\n                \"<div class='\" + classNames.detailsSummary + \"'>#= messages.filterByCondition #</div>\" +\n                \"<div class='\" + classNames.detailsContent + \"'>\" +\n                    '<div>' +\n                        '<select ' +\n                            'aria-label=\"#= messages.filterByCondition #\" ' +\n                            'data-#=ns#role=\"dropdownlist\"' +\n                            'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' +\n                            'data-#=ns#value-primitive=\"false\"' +\n                            'data-#=ns#option-label=\"#=messages.operatorNone#\"' +\n                            'data-#=ns#height=\"auto\"' +\n                            'data-#=ns#text-field=\"text\"' +\n                            'data-#=ns#value-field=\"unique\">'+\n                        '</select>'+\n                    '</div>' +\n\n                    '<div data-#=ns#bind=\"visible: isString\">' +\n                        '<input aria-label=\"string-value\" data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />'+\n                    '</div>' +\n\n                    '<div data-#=ns#bind=\"visible: isNumber\">' +\n                        '<input aria-label=\"number-value\" data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />'+\n                    '</div>' +\n\n                    '<div data-#=ns#bind=\"visible: isDate\">' +\n                        '<input aria-label=\"date-value\" data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />'+\n                    '</div>' +\n                \"</div>\",\n            menuItem:\n                \"<li data-command='#=command#' data-dir='#=dir#'>\" +\n                    \"#= kendo.ui.icon(iconClass) ##=text#\" +\n                \"</li>\",\n            actionButtons:\n                \"<button data-#=ns#bind='click: apply' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'><span class='k-button-text'>#=messages.apply#</span></button>\" +\n                \"<button data-#=ns#bind='click: clear' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'><span class='k-button-text'>#=messages.clear#</span></button>\"\n        };\n\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n\n            return result;\n        }\n\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            var valuesFilter = this;\n            var values = this.values;\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLocaleLowerCase(kendo.culture().name);\n                var itemVisible = query === true || query === \"\" || text.indexOf(query) >= 0;\n                var filterSpread = filter.bind(valuesFilter);\n                var anyVisibleChildren = filterSpread(item.children, query); // pass true if parent matches\n\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n\n                if (query.length || (values && !values.length)) {\n                    item.checked = !item.hidden;\n                } else if (values && values.indexOf(item.text) != -1){\n                    item.checked = true;\n                }\n            }\n\n            if (data) {\n                // re-apply filter on children\n                dataSource.filter({ field: \"hidden\", operator: \"neq\", value: true });\n            }\n\n            return hasVisibleChildren;\n        }\n\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function(e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function(item) {\n                    return item.checked;\n                };\n                var value = function(item) {\n                    return item.dataType === \"date\" ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function(value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data.toJSON()[0].items;\n                var blanks = values.filter(function(item) {\n                    return item.dataType === \"blank\";\n                });\n\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n\n                this.set(\"valueFilter\", {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function(e) {\n                e.preventDefault();\n\n                var node = e.sender.dataItem(e.node);\n                node.set(\"checked\", !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function(e) {\n                var query = typeof e == \"string\" ? e : $(e.target).val().toLocaleLowerCase(kendo.culture().name);\n                var dataSource = this.valuesDataSource;\n\n                this.set(\"hasActiveSearch\", !!query);\n\n                var filterSpread = filter.bind(this.valueFilter);\n                uncheckAll(dataSource);\n                filterSpread(dataSource, query);\n            },\n            reset: function() {\n                this.set(\"customFilter\", { logic: \"and\", criteria: [ { operator: null, value: null } ] });\n                this.set(\"valueFilter\", { values: [] });\n            },\n            operatorChange: function(e) {\n                var dataItem = e.sender.dataItem();\n                this.set(\"operatorType\", dataItem.type);\n\n                // https://github.com/telerik/kendo-ui-core/issues/3317 - when switching from Value\n                // filter to filter by condition, the customFilter property is lost.\n                if (!this.get(\"customFilter\")) {\n                    this.reset();\n                }\n\n                this.set(\"customFilter.criteria[0].operator\", dataItem.value);\n            },\n            isNone: function() {\n                return this.get(\"operatorType\") === undefined;\n            },\n            isString: function() {\n                return this.get(\"operatorType\") === \"string\";\n            },\n            isNumber: function() {\n                return this.get(\"operatorType\") === \"number\";\n            },\n            isDate: function() {\n                return this.get(\"operatorType\") === \"date\";\n            }\n        });\n\n        function flattenOperators(operators) {\n            var messages = kendo.spreadsheet.messages.filterMenu.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + \"_\" + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function(range, column) {\n                return [{\n                    text: kendo.spreadsheet.messages.filterMenu.all,\n                    expanded: true,\n                    checked: false,\n                    items: this.values(range.resize({ top: 1 }), column)\n                }];\n            },\n            values: function(range, column) {\n                var values = [];\n                var messages = kendo.spreadsheet.messages.filterMenu;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n\n                columnRange.forEachCell(function(row, col, cell) {\n                    var checked = true;\n                    if (sheet.isHiddenRow(row)) {\n                        checked = false;\n                    }\n\n                    var value = cell.value;\n                    var dataType = cell.dataType;\n                    var text = cell.text;\n\n                    if (value === undefined) {\n                        dataType = \"blank\";\n                    } else if (cell.format) {\n                        dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                    } else {\n                        dataType = typeof value;\n                    }\n\n                    if (value !== null && cell.format) {\n                        text = kendo.spreadsheet.formatting.text(value, cell.format);\n                    } else {\n                        text = dataType == \"blank\" ? messages.blanks : value;\n                    }\n\n                    if (dataType === \"percent\" || dataType === \"currency\") { //treat percent as number\n                        dataType = \"number\";\n                    }\n\n                    if (dataType === \"date\") {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n\n                    values.push({\n                        dataType: dataType,\n                        value: value,\n                        text: text,\n                        checked: checked\n                    });\n                });\n\n                values = distinctValues(values);\n\n                values.sort(function(a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n\n                    if (a.dataType === \"blank\" || b.dataType === \"blank\") {\n                        return a.dataType === \"blank\" ? -1 : 1;\n                    }\n\n                    if (a.dataType === \"number\" || b.dataType === \"number\") {\n                        return a.dataType === \"number\" ? -1 : 1;\n                    }\n\n                    if (a.dataType === \"date\" || b.dataType === \"date\") {\n                        return a.dataType === \"date\" ? -1 : 1;\n                    }\n\n                    return 0;\n                });\n\n                return values;\n            },\n\n            filterType: function(range, column) {\n                // 1. try to infer type from current filter\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n\n                filter = filter && filter.filter.toJSON();\n\n                if (filter && filter.filter == \"custom\") {\n                    var value = filter.criteria[0].value;\n\n                    if (value instanceof Date) {\n                        type = \"date\";\n                    } else if (typeof value == \"string\") {\n                        type = \"string\";\n                    } else if (typeof value == \"number\") {\n                        type = \"number\";\n                    }\n                }\n\n                if (!type) {\n                    // 2. try to infer type from column data\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n\n                    if (type == \"blank\") {\n                        type = null;\n                    }\n                }\n\n                return type;\n            },\n\n            filterForColumn: function(column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n\n                if (allFilters) {\n                    filters =  allFilters.columns.filter(function(item) {\n                        return item.index === column;\n                    })[0];\n                }\n\n                return filters;\n            },\n\n            filter: function(column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n\n                if (!columnFilters) {\n                    return;\n                }\n\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n\n                delete options.filter;\n\n                var result = {\n                    type: type,\n                    options: options\n                };\n\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n\n                return result;\n            }\n        };\n\n        var FilterMenu = Widget.extend({\n            init: function(element, options) {\n                Widget.call(this, element, options);\n\n                this.element.addClass(FilterMenu.classNames.wrapper);\n\n                this.viewModel = new FilterMenuViewModel({\n                    active: \"value\",\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n\n            options: {\n                name: \"FilterMenu\",\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: \"Text contains\",\n                        doesnotcontain: \"Text does not contain\",\n                        startswith: \"Text starts with\",\n                        endswith: \"Text ends with\",\n                        matches: \"Text matches\",\n                        doesnotmatch: \"Text does not match\"\n                    },\n                    date: {\n                        eq:  \"Date is\",\n                        neq: \"Date is not\",\n                        lt:  \"Date is before\",\n                        gt:  \"Date is after\"\n                    },\n                    number: {\n                        eq: \"Is equal to\",\n                        neq: \"Is not equal to\",\n                        gte: \"Is greater than or equal to\",\n                        gt: \"Is greater than\",\n                        lte: \"Is less than or equal to\",\n                        lt: \"Is less than\"\n                    }\n                }\n            },\n\n            events: [\n                \"action\"\n            ],\n\n            destroy: function() {\n                Widget.fn.destroy.call(this);\n\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n\n            openFor: function(anchor, event) {\n                if ($(anchor).hasClass(\"k-spreadsheet-view-size\")) {\n                    // on touch devices this element will sit above to\n                    // enable scrolling; it's not useful as an anchor,\n                    // use event coords instead.\n                    this.popup.open(event.pageX, event.pageY);\n                } else {\n                    this.popup.setOptions({ anchor: anchor });\n                    this.popup.open();\n                }\n            },\n\n            close: function() {\n                this.popup.close();\n            },\n\n            clear: function() {\n                this.action({\n                    command: \"ClearFilterCommand\",\n                    options: {\n                        column: this.options.column\n                    }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n\n            apply: function() {\n                this._active();\n\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n\n                var valueFilter;\n                var customFilter;\n\n                if (this.viewModel.active === \"value\") {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n\n                    if (valueFilter.blanks || (valueFilter.values && valueFilter.values.length)) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === \"custom\") {\n                    customFilter = this.viewModel.customFilter.toJSON();\n\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n\n                if (options.valueFilter || options.customFilter) {\n                    this.action({ command: \"ApplyFilterCommand\", options: options });\n                }\n            },\n\n            action: function(options) {\n                this.trigger(\"action\", $.extend({ }, options));\n            },\n\n            _filterInit: function() {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n\n                    this.viewModel.set(\"active\", activeFilter.type);\n                    this.viewModel.set(activeFilter.type + \"Filter\", activeFilter.options);\n\n                    if (activeFilter.type == \"custom\") {\n                        this.viewModel.set(\"operator\", filterType + \"_\" + activeFilter.operator);\n                        this.viewModel.set(\"operatorType\", filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n\n            _popup: function() {\n                this.popup = this.element.kendoPopup({\n                    copyAnchorStyles: false\n                }).data(\"kendoPopup\");\n            },\n\n            _sort: function() {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = kendo.spreadsheet.messages.filterMenu;\n                var items = [\n                    { command: \"sort\", dir: \"asc\", text: messages.sortAscending, iconClass: \"sort-asc\" },\n                    { command: \"sort\", dir: \"desc\", text: messages.sortDescending, iconClass: \"sort-desc\" }\n                ];\n\n                var ul = $(\"<ul></ul>\", {\n                    \"html\": kendo.render(template, items)\n                }).appendTo(this.element);\n\n                this.menu = ul.kendoMenu({\n                    orientation: \"vertical\",\n                    select: function(e) {\n                        var dir = $(e.item).data(\"dir\");\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n\n                        this.action({ command: \"SortCommand\", options: options });\n                    }.bind(this)\n                }).data(\"kendoMenu\");\n            },\n\n            _appendTemplate: function(template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $(\"<div class='\" + className + \"'/>\").html(compiledTemplate({\n                    messages: kendo.spreadsheet.messages.filterMenu,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n\n                this.element.append(wrapper);\n\n                if (details) {\n                    details = new Details(wrapper, { expanded: expanded, toggle: this._detailToggle.bind(this) });\n                }\n\n                kendo.bind(wrapper, this.viewModel);\n\n                return wrapper;\n            },\n\n            _detailToggle: function(e) {\n                this.element\n                    .find(\"[\" + kendo.attr(\"role\") + \"=details]\")\n                    .not(e.sender.element)\n                    .data(\"kendoDetails\")\n                    .toggle(!e.show);\n            },\n\n            _filterByCondition: function() {\n                var isExpanded = this.viewModel.active === \"custom\";\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n\n            _filterByValue: function() {\n                var isExpanded = this.viewModel.active === \"value\";\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n\n                this.valuesTreeView = wrapper.find(\"[\" + kendo.attr(\"role\") + \"=treeview]\").data(\"kendoTreeView\");\n\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n\n                this.viewModel.set(\"valuesDataSource\", new kendo.data.HierarchicalDataSource({ data: values, accentFoldingFiltering: kendo.culture().name }));\n            },\n\n            _actionButtons: function() {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n\n            _active: function() {\n                var activeContainer = this.element.find(\"[\" + kendo.attr(\"role\") + \"=details]\").filter(function(index, element) {\n                    return $(element).data(\"kendoDetails\").visible();\n                });\n\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set(\"active\", \"value\");\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set(\"active\", \"custom\");\n                }\n            }\n        });\n\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, { classNames: classNames, templates: templates });\n\n    })(window.kendo);\n\n(function(kendo) {\n\n    var SheetEditor = kendo.Observable.extend({\n        init: function(view) {\n            kendo.Observable.fn.init.call(this);\n\n            this.view = view;\n            this.formulaBar = view.formulaBar;\n            this._active = false;\n\n            this.barInput = view.formulaBar.formulaInput;\n            this.cellInput = view.formulaInput;\n\n            this.barInput.syncWith(this.cellInput);\n            this.cellInput.syncWith(this.barInput);\n\n            this.barInput.bind(\"keyup\", this._triggerUpdate.bind(this));\n            this.cellInput.bind(\"keyup\", this._triggerUpdate.bind(this));\n\n            this.barInput.bind(\"blur\", this._blur.bind(this));\n            this.cellInput.bind(\"blur\", this._blur.bind(this));\n        },\n\n        events: [\n            \"activate\",\n            \"deactivate\",\n            \"change\",\n            \"update\"\n        ],\n\n        _blur: function() {\n            this.deactivate();\n        },\n\n        _triggerUpdate: function() {\n            this.trigger(\"update\", { value: this.value() });\n        },\n\n        activeEditor: function() {\n            var editor = null;\n            var activeElement = kendo._activeElement();\n\n            if (this.barElement()[0] === activeElement) {\n                editor = this.barInput;\n            } else if (this.cellElement()[0] === activeElement) {\n                editor = this.cellInput;\n            }\n\n            return editor;\n        },\n\n        activate: function(options) {\n            var viewElement = this.view.element,\n                viewWidth, scrollerElement, scrollbarWidth;\n\n            this._active = true;\n            this._rect = options.rect;\n            this._range = options.range;\n\n            this.cellInput.position(options.rect);\n            this.cellInput.resize(options.rect);\n            this.cellInput.tooltip(options.tooltip);\n            this.cellInput.activeCell = this.barInput.activeCell = this._range.topLeft();\n            this.cellInput.activeSheet = this.barInput.activeSheet = this._range._sheet;\n\n            if(viewElement) {\n                viewWidth = viewElement.width();\n                scrollerElement = viewElement.find(\".k-spreadsheet-scroller\")[0];\n                scrollbarWidth = scrollerElement.offsetWidth - scrollerElement.clientWidth;\n\n                this.cellInput.element.css(\"max-width\", viewWidth - scrollbarWidth - this.cellInput.element.position().left + \"px\");\n            }\n\n            this.trigger(\"activate\");\n\n            return this;\n        },\n\n        deactivate: function(noChange) {\n            var cellInput = this.cellInput;\n\n            if (!this._active) {\n                return;\n            }\n\n            this._active = false;\n\n            if (!noChange && cellInput.value() != this._value) {\n                this.trigger(\"change\", {\n                    value: cellInput.value(),\n                    range: this._range\n                });\n            }\n\n            this._rect = null;\n            cellInput.hide();\n            this.trigger(\"deactivate\");\n        },\n\n        enable: function(enable) {\n            this.barInput.enable(enable);\n            this.cellInput.enable(enable);\n        },\n\n        barElement: function() {\n            return this.barInput.element;\n        },\n\n        cellElement: function() {\n            return this.cellInput.element;\n        },\n\n        focus: function(inputType) {\n            inputType = inputType || \"cell\";\n\n            if (inputType === \"cell\") {\n                this.cellInput.element.trigger(\"focus\");\n                this.cellInput.end();\n            } else {\n                this.barInput.element.trigger(\"focus\");\n            }\n        },\n\n        isActive: function() {\n            return this._active;\n        },\n\n        isFiltered: function() {\n            return this.barInput.popup.visible() || this.cellInput.popup.visible();\n        },\n\n        canInsertRef: function(isKeyboardAction) {\n            var editor = this.activeEditor();\n            return editor && editor.canInsertRef(isKeyboardAction);\n        },\n\n        highlightedRefs: function() {\n            var editor = this.activeEditor();\n            var refs = [];\n\n            if (editor) {\n                refs = editor.highlightedRefs();\n            }\n\n            return refs;\n        },\n\n        scale: function() {\n            this.cellInput.scale();\n        },\n\n        toggleTooltip: function(rect) {\n            this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n        },\n\n        value: function(value, isArrayFormula) {\n            if (value === undefined) {\n                return this.barInput.value();\n            }\n\n            if (value === null) {\n                value = \"\";\n            }\n\n            this._value = value;\n\n            this.barInput.value(value);\n            this.cellInput.value(value);\n\n            this.barInput.element.toggleClass(\"k-spreadsheet-array-formula\", !!isArrayFormula);\n        },\n\n        insertNewline: function() {\n            this.activeEditor().insertNewline();\n            this.scale();\n        },\n\n        select: function() {\n            this.activeEditor().select();\n        }\n    });\n\n    function notEqual(oldRect, newRect) {\n        return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n    }\n\n    kendo.spreadsheet.SheetEditor = SheetEditor;\n})(kendo);\n\n// -*- fill-column: 100 -*-\n    \"use strict\";\n\n    var spreadsheet$1 = kendo.spreadsheet;\n    var Range = spreadsheet$1.Range;\n    var runtime = spreadsheet$1.calc.runtime;\n    var Formula = runtime.Formula;\n\n    var ERR_INCOMPATIBLE = \"incompatibleRanges\";\n    var ERR_NO_DIRECTION = \"noFillDirection\";\n\n    var FillError = Range.FillError = function(msg) {\n        this.code = msg;\n    };\n\n    // `srcRange`: the range containing data that we wish to fill.  `direction`: 0, 1, 2, 3.  So\n    // when bit 0 is set we're doing horizontal filling, and when bit 1 is set we're doing it in\n    // reverse order.\n    Range.prototype._previewFillFrom = function(srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == \"string\") {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef().clone().setSheet(sheet.name());\n        var dest = destRange._ref.toRangeRef().clone().setSheet(sheet.name());\n\n        if (src.intersects(dest)) {\n            // the UI will send e.g. C2:C8.fillFrom(C7:D8) (intersecting ranges).  this figures out\n            // the actual destination range.\n            if (src.eq(dest)) {\n                return null; // nothing to do\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n\n        if (direction == null) {\n            // try to determine based on ranges location/geometry\n            if (src.topLeft.col == dest.topLeft.col) {\n                // assume vertical filling\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new FillError(ERR_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if ((horizontal && src.height() != dest.height()) ||\n            (!horizontal && src.width() != dest.width())) {\n            throw new FillError(ERR_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        var hint = null;\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - (j % s.length) - 1 : (j % s.length);\n                var cell = a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n                if (cell.value != null) {\n                    hint = cell.value;\n                }\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return { props: fill, direction: direction, dest: destRange, hint: hint };\n    };\n\n    Range.prototype.fillFrom = function(srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        x.dest._properties(x.props, true);\n        return x.dest;\n    };\n\n    // This is essentially the FORECAST function, see ./runtime.functions.2.js.\n    // It receives an array of values, and returns a function that \"predicts\"\n    // the value in cell N.\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function(a, b){\n            return a + b;\n        }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = (i + 1) - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function(N){\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function(N) {\n            return a + b * (N + 1);\n        };\n    }\n\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i-1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function(v){\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function(x){\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function(begin, end, type, a){\n            var f, values;\n            if (type == \"number\") {\n                values = getData(a);\n\n                // This code would increase a date even if a single cell was selected.  Seems it's\n                // not desirable so I commented it out.\n                // https://github.com/telerik/kendo-ui-core/issues/3565\n                //\n                // if (values.length == 1 && (begin > 0 || end < data.length ||\n                //                            formatType(values[0], properties[begin].format) == \"date\")) {\n                //     values.push(values[0] + 1);\n                // }\n\n                f = linearRegression(values);\n            } else if (type == \"string\" || type == \"formula\" || type == \"boolean\") {\n                // formulas are simply copied over; the sheet will internally clone the objects\n                f = function(N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function(N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    // figure out the step\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        // seemingly no pattern, just repeat those strings\n                        f = function(N) {\n                            return a[(N) % a.length].value;\n                        };\n                    } else {\n                        f = function(N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != \"null\") {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function(N, i) {\n                    return data[i].replace(/^(.*[\\D0]+)\\d+/, \"$1\" + values(N, i));\n                };\n            } else {\n                f = function() { return null; };\n            }\n            var s = { f: f, begin: begin, end: end, len: end - begin };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function(N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone$1(properties[i]);\n            delete props.enable;\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n\n    // function formatType(value, format) {\n    //     if (format != null) {\n    //         return spreadsheet.formatting.type(value, format);\n    //     }\n    // }\n\n    function clone$1(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function(key){\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n\n    function getType(el) {\n        if (typeof el == \"number\") {\n            return { type: \"number\", number: el };\n        }\n        if (typeof el == \"string\") {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, \"$1-######\");\n                return { type: el, match: m, number: parseFloat(m[2]) };\n            }\n            return { type: \"string\" };\n        }\n        if (typeof el == \"boolean\") {\n            return { type: \"boolean\" };\n        }\n        if (el == null) {\n            return { type: \"null\" };\n        }\n        if (el instanceof Formula) {\n            return { type: \"formula\" };\n        }\n        window.console.error(el);\n        throw new Error(\"Cannot fill data\");\n    }\n\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return { type: a, number: j, value: str };\n                }\n            }\n        }\n    }\n\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n\n(function(kendo) {\n\n    var $ = kendo.jQuery;\n\n    var CLASS_NAMES = {\n        input: \"k-spreadsheet-name-editor\",\n        list: \"k-spreadsheet-name-list\"\n    };\n\n    var NameEditor = kendo.ui.Widget.extend({\n        init: function(element, options) {\n            kendo.ui.Widget.call(this, element, options);\n            element.addClass(CLASS_NAMES.input);\n\n            var comboBoxTitle = options.messages.nameBox || \"Name Box\";\n            var dataSource = new kendo.data.DataSource({\n                transport: {\n                    read: function(options) {\n                        var data = [];\n                        this._workbook.forEachName(function(def){\n                            if (!def.hidden && def.value instanceof kendo.spreadsheet.Ref) {\n                                data.push({ name: def.name });\n                            }\n                        });\n                        options.success(data);\n                    }.bind(this),\n                    cache: false\n                }\n            });\n\n            var comboElement = $(\"<input />\")\n                .attr(\"title\", comboBoxTitle)\n                .attr(\"aria-label\", comboBoxTitle);\n\n            this.combo = comboElement.appendTo(element)\n                .kendoComboBox({\n                    clearButton: false,\n                    dataTextField: \"name\",\n                    dataValueField: \"name\",\n                    template: \"#:data.name#<a role='button' class='k-button-delete' href='\\\\#'>\" + kendo.ui.icon(\"x\") + \"</a>\",\n                    dataSource: dataSource,\n                    autoBind: false,\n                    ignoreCase: true,\n                    change: this._on_listChange.bind(this),\n                    noDataTemplate: \"<div></div>\",\n                    open: function() {\n                        dataSource.read();\n                    }\n                }).getKendoComboBox();\n\n            this.combo.input\n                .on(\"keydown\", this._on_keyDown.bind(this))\n                .on(\"focus\", this._on_focus.bind(this));\n\n            this.combo.popup.element\n                .addClass(\"k-spreadsheet-names-popup\")\n\n                .on(\"mousemove\", function(ev){\n                    // XXX: should remove this when we find a better\n                    // solution for the popup closing as we hover the\n                    // resize handles.\n                    ev.stopPropagation();\n                })\n\n                .on(\"click\", \".k-button-delete\", function(ev){\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                    var item = $(ev.target).closest(\".k-list-item\");\n                    item = this.combo.dataItem(item);\n                    this._deleteItem(item.name);\n                }.bind(this));\n        },\n        destroy: function() {\n            if (this.combo) {\n                this.combo.destroy();\n            }\n\n            kendo.ui.Widget.fn.destroy.call(this);\n        },\n        value: function(val) {\n            if (val === undefined) {\n                return this.combo.value();\n            } else {\n                this.combo.value(val);\n            }\n        },\n        _deleteItem: function(name) {\n            this.trigger(\"delete\", { name: name });\n        },\n        _on_keyDown: function(ev) {\n            switch (ev.keyCode) {\n              case 27:\n                this.combo.value(this._prevValue);\n                this.trigger(\"cancel\");\n                break;\n              case 13:\n                this.trigger(\"enter\");\n                break;\n            }\n        },\n        _on_focus: function() {\n            this._prevValue = this.combo.value();\n        },\n        _on_listChange: function() {\n            var name = this.combo.value();\n            if (name) {\n                this.trigger(\"select\", { name: name });\n            }\n        }\n    });\n\n    kendo.spreadsheet.NameEditor = NameEditor;\n})(window.kendo);\n\n\"use strict\";\n\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var kdrw = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n\n    var GUIDELINE_WIDTH = 0.8;\n\n\n\n\n    // This takes a list of row heights and the page height, and\n    // produces a list of Y coordinates for each row, such that rows\n    // are not truncated across pages.  However, the algorithm will\n    // decide to truncate a row in the event that more than\n    // `maxEmpty` (default 0.2) of the available space would\n    // otherwise be left blank.\n    //\n    // It will be used for horizontal splitting too (will receive\n    // column widths and page width, and produce a list of X coords).\n    //\n    // If the third argument (headerRows) is not null, it specifies a\n    // number of rows to repeat on each page.  On pages other than the\n    // first, the necessary space will be skipped at the top.  Header\n    // coordinates (except for the first page) are pushed in\n    // headerCoords.\n    function distributeCoords(heights, pageHeight, maxEmpty, headerRows, headerCoords) {\n        var curr = 0;\n        var out = [];\n        var bottom = pageHeight;\n        var header = 0;\n        if (pageHeight && maxEmpty) {\n            maxEmpty *= pageHeight;\n        }\n        heights.forEach(function(h, i){\n            if (headerRows != null && i < headerRows) {\n                header += h;\n            }\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < maxEmpty) {\n                    // align to next page\n                    curr = pageHeight * Math.ceil(curr / pageHeight) + header;\n                    if (header > 0) {\n                        headerCoords.push(curr - header);\n                    }\n                }\n                // update bottom anyway; don't just add pageHeight, as\n                // we might need multiple pages for the pathological\n                // case of one row higher than the page.\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n\n    function doLayout(sheet, range, options) {\n        // normalize reference so we don't have to deal with Infinity here.\n        var grid = sheet._grid;\n        range = grid.normalize(range);\n\n        var wholeRect = grid.rectangle(range);\n        var drawings = [];\n        sheet._drawings.forEach(function(d) {\n            var box = sheet.drawingBoundingBox(d);\n            if (box.intersects(wholeRect)) {\n                drawings.push({\n                    drawing: d,\n                    box: box.offset(-wholeRect.left, -wholeRect.top)\n                });\n            }\n        });\n\n        // 1. obtain the list of cells that need to be printed, the\n        //    row heights and column widths.  Place in each cell row,\n        //    col (relative to range, i.e. first is 0,0), rowspan,\n        //    colspan and merged.  also place a list of drawings\n        //    anchored to that cell.\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = sheet._getMergedCells(range);\n\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function(row, col, cell){\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            var rh = sheet.rowHeight(row);\n            var cw = sheet.columnWidth(col);\n            if (!options.forScreen) {\n                // for printing we'll need the list of anchored\n                // drawings so that we can adjust them after page\n                // splitting.\n                cell.drawings = drawings.filter(function(d){\n                    var tl = d.drawing.topLeftCell;\n                    if (tl && tl.row == row && tl.col == col) {\n                        maxRow = Math.max(maxRow, sheet._rows.index(d.box.bottom));\n                        maxCol = Math.max(maxCol, sheet._columns.index(d.box.right));\n                        return true;\n                    }\n                });\n            }\n            if (!relcol) {\n                rowHeights.push(rh);\n            }\n            if (!relrow) {\n                colWidths.push(cw);\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            if (!sheet._grid._columns.sum(col, col + cell.colspan - 1) ||\n                !sheet._grid._rows.sum(row, row + cell.rowspan - 1)) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow + cell.rowspan - 1);\n                maxCol = Math.max(maxCol, relcol + cell.colspan - 1);\n            } else {\n                cell.empty = true;\n            }\n            cells.push(cell);\n        });\n\n        if (!options.forScreen) {\n            // keep only the drawable area\n            rowHeights = rowHeights.slice(0, maxRow + 1);\n            colWidths = colWidths.slice(0, maxCol + 1);\n        }\n\n        var pageWidth = options.pageWidth;\n        var pageHeight = options.pageHeight;\n        var scaleFactor = options.scale || 1;\n\n        // when fitWidth is requested, we must update the page size\n        // with the corresponding scale factor; the algorithm below\n        // (2) will continue to work, just drawing on a bigger page.\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n            }\n        }\n        pageWidth = Math.ceil(pageWidth / scaleFactor);\n        pageHeight = Math.ceil(pageHeight / scaleFactor);\n\n        // 2. calculate top, left, bottom, right, width and height for\n        //    printable cells.  Merged cells will be split across\n        //    pages, unless the first row/col is shifted to next page.\n        //    boxWidth and boxHeight get the complete drawing size.\n        //    Note that cell coordinates keep increasing, i.e. they\n        //    are not reset to zero for a new page.  The print\n        //    function translates the view to current page.\n        var hyCoords = []; // will receive header Y coordinates, if needed\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0, options.maxEmpty,\n                                       options.headerRows, hyCoords);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0, options.maxEmpty);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        var headerCells = [];\n        cells = cells.filter(function(cell){\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            if (options.headerRows && cell.row < options.headerRows) {\n                headerCells.push(cell);\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            if (!options.forScreen) {\n                // page breaking will shift cell coordinates.  adjust\n                // anchored drawings.\n                cell.drawings.forEach(function(d){\n                    var box = d.box;\n                    box.left = cell.left + d.drawing.offsetX;\n                    box.top = cell.top + d.drawing.offsetY;\n                    box.right = box.left + box.width;\n                    box.bottom = box.top + box.height;\n                });\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n\n        // 3. if any merged cells remain in \"primary\", they start\n        //    outside the printed range and we should still display\n        //    them partially.\n        Object.keys(mergedCells.primary).forEach(function(id){\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function(row, col, cell){\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.width();\n                cell.rowspan = ref.height();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                if (cell.height > 0 && cell.width > 0) {\n                    // zero means a fully hidden merged cell (all rows/columns are hidden)\n                    // https://github.com/telerik/kendo-ui-core/issues/1794\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                    cell.row = relrow;\n                    cell.col = relcol;\n                    cells.push(cell);\n                }\n            });\n        });\n\n        // 4. replicate header rows on all pages\n        if (options.headerRows) {\n            hyCoords.forEach(function(y){\n                headerCells.forEach(function(cell){\n                    cell = clone(cell);\n                    cell.top += y;\n                    cell.bottom = cell.top + cell.height;\n                    cells.push(cell);\n                });\n                yCoords.push(y);\n            });\n            yCoords.sort(orderCoords);\n        }\n\n        return {\n            width    : boxWidth,\n            height   : boxHeight,\n            cells    : cells.sort(orderCells),\n            scale    : scaleFactor,\n            xCoords  : xCoords,\n            yCoords  : yCoords,\n            drawings : drawings\n        };\n    }\n\n    function clone(hash, target) {\n        if (!target) {\n            target = {};\n        }\n        if (Object.assign) {\n            return Object.assign(target, hash);\n        }\n        return Object.keys(hash).reduce(function(copy, key){\n            copy[key] = hash[key];\n            return copy;\n        }, target);\n    }\n\n    function sameBorder(a, b) {\n        return a.size === b.size && a.color === b.color;\n    }\n\n    function sum(a, b) {\n        return a + b;\n    }\n\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n\n    function shouldDrawCell(cell) {\n        return cell.value != null\n            || cell.merged\n            || cell.background != null\n            || cell.borderRight != null\n            || cell.borderBottom != null\n            || cell.dBorders != null\n            || (cell.validation != null && !cell.validation.value)\n            || (cell.drawings && cell.drawings.length);\n    }\n\n    function orderCells(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n\n    function orderCoords(a, b) {\n        return a < b ? -1 : a > b ? 1 : 0;\n    }\n\n    function drawLayout(sheet, layout, group, options) {\n        // options:\n        // - pageWidth\n        // - pageHeight\n        // - fitWidth\n        // - hCenter\n        // - vCenter\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = Math.ceil(options.pageWidth / layout.scale);\n        var pageHeight = Math.ceil(options.pageHeight / layout.scale);\n\n        for (var j = 0; j < nrows; ++j) {\n            for (var i = 0; i < ncols; ++i) {\n                addPage(j, i);\n            }\n        }\n\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n\n            function isInside(box) {\n                if (box.right <= left || box.left >= right ||\n                    box.bottom <= top || box.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(box.bottom, endbottom);\n                endright = Math.max(box.right, endright);\n                return true;\n            }\n\n            // XXX: this can be optimized - discard cells that won't\n            // be used again, and don't walk cells that stand no\n            // chance to fit.\n            var cells = layout.cells.filter(isInside);\n\n            var drawings = layout.drawings.filter(function(d){\n                return isInside(d.box);\n            });\n\n            // merged cells might stretch beyond page; limit to that\n            endbottom = Math.min(endbottom, bottom);\n            endright = Math.min(endright, right);\n\n            if (cells.length || drawings.length) {\n                var page = new kdrw.Group();\n                group.append(page);\n                // page.clip(drawing.Path.fromRect(\n                //     new geo.Rect([ 0, 0 ],\n                //                  [ options.pageWidth, options.pageHeight ])));\n\n                var content = new kdrw.Group();\n                page.append(content);\n\n                content.clip(kdrw.Path.fromRect(\n                    new geo.Rect([ left - 1, top - 1 ], [ endright + 1, endbottom + 1 ])\n                ));\n\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale)\n                    .multiplyCopy(geo.Matrix.translate(-left, -top));\n\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(\n                        geo.Matrix.translate(\n                            options.hCenter ? (right - endright) / 2 : 0,\n                            options.vCenter ? (bottom - endbottom) / 2 : 0)\n                    );\n                }\n\n                content.transform(matrix);\n\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function(x){\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(\n                                new kdrw.Path()\n                                    .moveTo(x, top)\n                                    .lineTo(x, endbottom)\n                                    .close()\n                                    .stroke(options.guideColor, GUIDELINE_WIDTH)\n                            );\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function(y){\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(\n                                new kdrw.Path()\n                                    .moveTo(left, y)\n                                    .lineTo(endright, y)\n                                    .close()\n                                    .stroke(options.guideColor, GUIDELINE_WIDTH)\n                            );\n                        }\n                    });\n                }\n\n                var borders = Borders(); \n                cells.forEach(function(cell){\n                    drawCell(cell, content, options);\n                    borders.add(cell, sheet);\n                });\n\n                var bordersGroup = new kdrw.Group();\n                borders.vert.forEach(function(a){\n                    a.forEach(function(b){\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            bordersGroup.append(\n                                new kdrw.Path()\n                                    .moveTo(b.x, b.top)\n                                    .lineTo(b.x, b.bottom)\n                                    .close()\n                                    .stroke(b.color, b.size)\n                            );\n                        }\n                    });\n                });\n                borders.horiz.forEach(function(a){\n                    a.forEach(function(b){\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            bordersGroup.append(\n                                new kdrw.Path()\n                                    .moveTo(b.left, b.y)\n                                    .lineTo(b.right, b.y)\n                                    .close()\n                                    .stroke(b.color, b.size)\n                            );\n                        }\n                    });\n                });\n                content.append(bordersGroup);\n\n                drawings.forEach(function(d){\n                    var drawing = d.drawing;\n                    var image = drawing.image;\n                    if (image != null) {\n                        var box = d.box;\n                        var url = sheet._workbook.imageUrl(image);\n                        content.append(\n                            new kdrw.Image(url, new geo.Rect(\n                                [ box.left, box.top ],\n                                [ box.width, box.height ]\n                            )).opacity(drawing.opacity)\n                        );\n                    }\n                });\n            }\n        }\n    }\n\n    function drawCell(cell, content, options) {\n        var g = new kdrw.Group();\n        content.append(g);\n        var rect = new geo.Rect([ cell.left, cell.top ],\n                                [ cell.width, cell.height ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH/2 + 0.1;\n                r2d2.origin.y += GUIDELINE_WIDTH/2 + 0.1;\n                r2d2.size.width -= GUIDELINE_WIDTH + 0.2;\n                r2d2.size.height -= GUIDELINE_WIDTH + 0.2;\n            }\n            g.append(\n                new kdrw.Rect(r2d2)\n                    .fill(cell.background || \"#fff\")\n                    .stroke(null)\n            );\n        }\n        if (cell.dBorders) {\n            if (cell.dBorders.type & 2) {\n                g.append(\n                    new kdrw.Path()\n                        .moveTo(cell.left, cell.bottom)\n                        .lineTo(cell.right, cell.top)\n                        .stroke(cell.dBorders.color, cell.dBorders.size)\n                );\n            }\n            if (cell.dBorders.type & 1) {\n                g.append(\n                    new kdrw.Path()\n                        .moveTo(cell.left, cell.top)\n                        .lineTo(cell.right, cell.bottom)\n                        .stroke(cell.dBorders.color, cell.dBorders.size)\n                );\n            }\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == \"number\" ? \"number\" : null;\n            var clip = new kdrw.Group();\n            clip.clip(kdrw.Path.fromRect(rect));\n            g.append(clip);\n            var f, format = cell.format;\n            if (!format && type == \"number\" && val != Math.floor(val)) {\n                format = \"0.##############\";\n            }\n            if (format) {\n                f = formatting.textAndColor(val, format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += \"\";\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                  case \"number\":\n                  case \"date\":\n                  case \"percent\":\n                  case \"currency\":\n                    cell.textAlign = \"right\";\n                    break;\n                  case \"boolean\":\n                    cell.textAlign = \"center\";\n                    break;\n                }\n            }\n            drawText(val, (f && f.color) || cell.color || \"#000\", cell, clip);\n        }\n    }\n\n    function applyIndent(cell, style) {\n        if (cell.indent) {\n            // OOXML spec states the indent is \"An integer value,\n            // where an increment of 1 represents 3 spaces\".  This, of\n            // course, bears no resemblance to what Excel actually\n            // does, so we need magic numbers here.\n            var indent = 1.4 * cell.indent;\n            switch (style.textAlign) {\n              case null:\n              case \"left\":\n                style.paddingLeft = indent + \"ch\";\n                break;\n              case \"right\":\n                style.paddingRight = indent + \"ch\";\n                break;\n              case \"center\":\n                style.paddingLeft = indent/2 + \"ch\";\n                style.paddingRight = indent/2 + \"ch\";\n                break;\n            }\n        }\n    }\n\n    var CONT;\n    function drawText(text, color, cell, group) {\n        if (!CONT) {\n            CONT = document.createElement(\"div\");\n            CONT.style.position = \"fixed\";\n            CONT.style.left = \"0px\";\n            CONT.style.top = \"0px\";\n            CONT.style.visibility = \"hidden\";\n            CONT.style.overflow = \"hidden\";\n            CONT.style.boxSizing = \"border-box\";\n            CONT.style.lineHeight = \"normal\";\n            document.body.appendChild(CONT);\n        }\n\n        if (CONT.firstChild) {\n            CONT.removeChild(CONT.firstChild);\n        }\n\n        CONT.style.padding = \"2px 4px\";\n        CONT.style.color = color;\n        CONT.style.font = makeFontDef(cell);\n        CONT.style.width = cell.width + \"px\";\n        CONT.style.textAlign = cell.textAlign || \"left\";\n        CONT.style.textDecoration = cell.underline ? \"underline\" : \"none\";\n\n        applyIndent(cell, CONT.style);\n\n        if (cell.wrap) {\n            CONT.style.whiteSpace = \"pre-wrap\";\n            CONT.style.overflowWrap = CONT.style.wordWrap = \"break-word\";\n        } else {\n            CONT.style.whiteSpace = \"pre\";\n            CONT.style.overflowWrap = CONT.style.wordWrap = \"normal\";\n        }\n\n        CONT.appendChild(document.createTextNode(text));\n\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n          case \"center\":\n            vtrans = (cell.height - CONT.offsetHeight) >> 1;\n            break;\n\n          case undefined:\n          case null:\n          case \"bottom\":\n            vtrans = (cell.height - CONT.offsetHeight);\n            break;\n        }\n        if (vtrans < 0) { vtrans = 0; }\n\n        var text_group  = kendo.drawing.drawDOM.drawText(CONT);\n        text_group.transform(geo.Matrix.translate(cell.left, cell.top + vtrans));\n        group.append(text_group);\n    }\n\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push(\"italic\");\n        }\n        if (cell.bold) {\n            font.push(\"bold\");\n        }\n        font.push((cell.fontSize || 12) + \"px\");\n        font.push((cell.fontFamily || \"Arial\"));\n        return font.join(\" \");\n    }\n\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range\n                || range instanceof spreadsheet.Ref\n                || typeof range == \"string\") {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize  : \"A4\",\n            landscape  : true,\n            margin     : \"1cm\",\n            guidelines : true,\n            guideColor : \"#aaa\",\n            emptyCells : true,\n            fitWidth   : false,\n            center     : false,\n            headerRows : null,\n            maxEmpty   : 0.2,\n            scale      : 1\n        }, options);\n        var group = new kdrw.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set(\"pdf\", {\n            author    : options.author,\n            creator   : options.creator,\n            date      : options.date,\n            keywords  : options.keywords,\n            margin    : paper.margin,\n            multiPage : true,\n            paperSize : paper.paperSize,\n            subject   : options.subject,\n            title     : options.title,\n            autoPrint : options.autoPrint\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right + 1;\n            pageHeight -= paper.margin.top + paper.margin.bottom + 1;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(sheet, layout, group, options);\n        callback(group);\n    }\n\n    spreadsheet.Sheet.prototype.draw = function(range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function(){\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n\n    // Hack: since we index the border arrays by relative row/col we\n    // could end up with negative indexes, i.e. horiz[-2] = border.\n    // Array forEach will ignore these, so we provide a simple\n    // container here (outside code only needs forEach at this time).\n    function Container() {}\n    Container.prototype = {\n        forEach: function(f) {\n            Object.keys(this).forEach(function(key){\n                f(this[key], key, this);\n            }, this);\n        }\n    };\n\n    function Borders() {\n        var horiz = new Container();\n        var vert = new Container();\n        function add(cell, sheet) {\n            if (sheet) {\n                // reset borders here; the propertybag doesn't keep track of merged cells :-/ this\n                // is ugly, but the inner details of data storage have leaked everywhere anyway.\n                var pb = sheet._properties;\n                var grid = sheet._grid;\n                cell.borderLeft    = pb.get(\"vBorders\", grid.index(cell.row, cell.col));\n                cell.borderRight   = pb.get(\"vBorders\", grid.index(cell.row, cell.col + cell.colspan));\n                cell.borderTop     = pb.get(\"hBorders\", grid.index(cell.row, cell.col));\n                cell.borderBottom  = pb.get(\"hBorders\", grid.index(cell.row + cell.rowspan, cell.col));\n            }\n            if (cell.borderLeft) {\n                addVert(cell.row, cell.col, cell.borderLeft,\n                        cell.left, cell.top, cell.bottom);\n            }\n            if (cell.borderRight) {\n                addVert(cell.row, cell.col + cell.colspan, cell.borderRight,\n                        cell.right, cell.top, cell.bottom);\n            }\n            if (cell.borderTop) {\n                addHoriz(cell.row, cell.col, cell.borderTop,\n                         cell.top, cell.left, cell.right);\n            }\n            if (cell.borderBottom) {\n                addHoriz(cell.row + cell.rowspan, cell.col, cell.borderBottom,\n                         cell.bottom, cell.left, cell.right);\n            }\n        }\n        function addVert(row, col, border, x, top, bottom) {\n            var a = vert[col] || (vert[col] = new Container());\n            var prev = row > 0 && a[row - 1];\n            if (prev && sameBorder(prev, border)) {\n                a[row] = prev;\n                prev.bottom = bottom;\n            } else {\n                a[row] = {\n                    size: border.size,\n                    color: border.color || \"#000\",\n                    x: x,\n                    top: top,\n                    bottom: bottom\n                };\n            }\n        }\n        function addHoriz(row, col, border, y, left, right) {\n            var a = horiz[row] || (horiz[row] = new Container());\n            var prev = col > 0 && a[col - 1];\n            if (prev && sameBorder(prev, border)) {\n                a[col] = prev;\n                prev.right = right;\n            } else {\n                a[col] = {\n                    size: border.size,\n                    color: border.color || \"#000\",\n                    y: y,\n                    left: left,\n                    right: right\n                };\n            }\n        }\n        return { add: add, horiz: horiz, vert: vert };\n    }\n\n    function drawTabularData(options) {\n        var progress = new $.Deferred();\n        var promise = progress.promise();\n\n        options = clone(options, {\n            dataSource       : null,\n            guidelines       : true,\n            guideColor       : \"#000\",\n            columns          : null,\n            headerBackground : \"#999\",\n            headerColor      : \"#000\",\n            oddBackground    : null,\n            evenBackground   : null,\n            fontFamily       : \"Arial\",\n            fontSize         : 12,\n            paperSize        : \"A4\",\n            margin           : \"1cm\",\n            landscape        : true,\n            fitWidth         : false,\n            scale            : 1,\n            rowHeight        : 20,\n            maxEmpty         : 1,\n            useGridFormat    : true\n        });\n\n        // retrieve fonts; custom fonts should be already loaded\n        kendo.drawing.pdf.defineFont(\n            kendo.drawing.drawDOM.getFontFaces(document)\n        );\n\n        var charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n\n        function textWidth(value) {\n            if (value != null) {\n                var width = 12;         // magic numbers :-/\n                for (var i = value.length; --i >= 0;) {\n                    width += charWidth(value.charAt(i));\n                }\n                return width;\n            }\n            return 0;\n        }\n\n        var border = options.guidelines ? { size: 1, color: options.guideColor } : null;\n\n        function mkCell(data) {\n            if (!border) {\n                return data;\n            }\n            return clone(data, {\n                borderLeft: border,\n                borderTop: border,\n                borderRight: border,\n                borderBottom: border\n            });\n        }\n\n        options.dataSource.fetch(function(){\n            var data = options.dataSource.data();\n            if (!data.length) {\n                return progress.reject(\"Empty dataset\");\n            }\n\n            // this really must be present\n            var columns = options.columns.map(function(col){\n                if (typeof col == \"string\") {\n                    return { title: col, field: col };\n                } else {\n                    return col;\n                }\n            });\n            var columnTitles = columns.map(function(col){\n                return col.title || col.field;\n            });\n            var columnWidths = columnTitles.map(textWidth);\n\n            // prepare data for a Sheet object's fromJSON method\n            var rows = data.map(function(row, rowIndex){\n                return {\n                    cells: columns.map(function(col, colIndex){\n                        var value = row[col.field];\n\n                        // NOTE: value might not be string.  I added option useGridFormat (default\n                        // true), which will use a column's format, if present, to convert the value\n                        // to a string, so that we can measure the width right now.\n                        if (options.useGridFormat) {\n                            if (value != null) {\n                                if (col.format) {\n                                    value = kendo.format(col.format, value);\n                                } else {\n                                    value += \"\";\n                                }\n                            }\n                            // adjust the column widths while we're at it\n                            columnWidths[colIndex] = Math.max(\n                                textWidth(value),\n                                columnWidths[colIndex]\n                            );\n                        }\n\n                        // if options.useGridFormat is false and col.format is present, pass it over\n                        // to the spreadsheet.  In that case we should calculate the widths after\n                        // the spreadsheet is created (XXX to be implemented when someone needs it).\n                        return mkCell({\n                            value: value,\n                            format: options.useGridFormat ? null : col.format,\n                            background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n                        });\n                    })\n                };\n            });\n\n            // insert header line\n            rows.unshift({\n                cells: columnTitles.map(function(label){\n                    return mkCell({\n                        value: label,\n                        background: options.headerBackground,\n                        color: options.headerColor\n                    });\n                })\n            });\n\n            // init a Sheet object.  Note that we have to add one\n            // extra-row and column, because the very last ones can't\n            // have right/bottom borders (known limitation).\n            var sheet = new kendo.spreadsheet.Sheet(\n                rows.length + 1,        // rows\n                columns.length + 1,     // columns\n                options.rowHeight,      // row height\n                50,                     // column width\n                20,                     // header height\n                20,                     // header width,\n                {                       // default cell style\n                    fontFamily: options.fontFamily,\n                    fontSize: options.fontSize,\n                    verticalAlign: \"center\"\n                }\n            );\n\n            // load data\n            sheet.fromJSON({\n                name: \"Sheet1\",\n                rows: rows,\n                columns: columnWidths.map(function(w, i){\n                    return { index: i, width: w };\n                })\n            });\n\n            sheet.draw({\n                paperSize  : options.paperSize,\n                landscape  : options.landscape,\n                margin     : options.margin,\n                guidelines : false, // using borders instead (better contrast)\n                scale      : options.scale,\n                fitWidth   : options.fitWidth,\n                maxEmpty   : options.maxEmpty,\n                headerRows : 1\n            }, progress.resolve.bind(progress));\n        });\n\n        return promise;\n    }\n\n    var CACHE_CHAR_WIDTH = {};\n\n    var charWidthFunction = function(fontFamily, fontSize) {\n        var id = fontSize + \":\" + fontFamily;\n        var func = CACHE_CHAR_WIDTH[id];\n        if (!func) {\n            var span, div = document.createElement(\"div\");\n            div.style.position = \"fixed\";\n            div.style.left = \"-10000px\";\n            div.style.top = \"-10000px\";\n            div.style.fontFamily = fontFamily;\n            div.style.fontSize = fontSize + \"px\";\n            div.style.whiteSpace = \"pre\";\n            for (var i = 32; i < 128; ++i) {\n                span = document.createElement(\"span\");\n                span.appendChild(document.createTextNode(String.fromCharCode(i)));\n                div.appendChild(span);\n            }\n            document.body.appendChild(div);\n            var widths = {};\n            for (i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n                widths[i] = span.offsetWidth;\n            }\n            while ((span = div.firstChild)) {\n                div.removeChild(span);\n            }\n            func = CACHE_CHAR_WIDTH[id] = function(ch) {\n                var code = ch.charCodeAt(0);\n                var width = widths[code];\n                if (width == null) {\n                    // probably not an ASCII character, let's cache its width as well\n                    span = document.createElement(\"span\");\n                    span.appendChild(document.createTextNode(String.fromCharCode(code)));\n                    div.appendChild(span);\n                    width = widths[code] = span.offsetWidth;\n                    div.removeChild(span);\n                }\n                return width;\n            };\n        }\n        return func;\n    };\n\n    spreadsheet.draw = {\n        Borders         : Borders,\n        doLayout        : doLayout,\n        applyIndent     : applyIndent\n    };\n\n    spreadsheet.drawTabularData = drawTabularData;\n\nvar __meta__ = {\n        id: \"spreadsheet\",\n        name: \"Spreadsheet\",\n        category: \"web\",\n        description: \"Spreadsheet component\",\n        depends: [\n            \"core\", \"binder\", \"colorpicker\", \"combobox\", \"data\", \"dom\", \"dropdownlist\",\n            \"menu\", \"ooxml\", \"popup\", \"sortable\", \"tabstrip\", \"toolbar\", \"treeview\",\n            \"window\", \"validator\", \"excel\", \"pdf\", \"drawing\" ]\n    };\n\n    (function(kendo, undefined$1) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n\n        var $ = kendo.jQuery;\n        var keys = $.extend({ F11: 122, B: 66, I: 73, U: 85, N: 78, H: 72, A: 65, PAGEDOWN: 34, PAGEUP: 33, DELETE: 46, R: 82 }, kendo.keys);\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = \".kendoSpreadsheet\";\n\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n\n        var classNames = {\n            wrapper: \"k-widget k-spreadsheet k-spreadsheet-legacy\"\n        };\n\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                Widget.fn.init.call(this, element, options);\n\n                kendo.spreadsheet.loadDeferred();\n\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this.element.attr(\"role\", \"application\");\n\n                this._view = new View(this.element, {\n                    messages: this.options.messages.view,\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n\n                this._workbook = new Workbook(this.options, this._view);\n\n                this._controller = new Controller(this._view, this._workbook);\n\n                this._autoRefresh = true;\n\n                this._bindWorkbookEvents();\n\n                this._view.workbook(this._workbook);\n\n                this._view.enableClipboard(false);\n                this.refresh();\n                this._view.enableClipboard(true);\n\n                this._resizeHandler = function() { this.resize(); }.bind(this);\n                $(window).on(\"resize\" + NS, this._resizeHandler);\n\n                this.element.on(\"keydown\" + NS, this._keyDown.bind(this));\n\n                if (this._showWatermarkOverlay) {\n                    this._showWatermarkOverlay(this.element[0]);\n                }\n            },\n\n            _keyDown: function(e) {\n                var key = e.keyCode;\n\n                if (key === keys.F11 && e.shiftKey) {\n                    this._view.sheetsbar._onAddSelect();\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.PAGEDOWN) {\n                    this._view.sheetsbar.trigger(\"select\", {\n                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex + 1].name(),\n                        isAddButton: false\n                    });\n                } else if (e.altKey && key === keys.PAGEUP) {\n                    this._view.sheetsbar.trigger(\"select\", {\n                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex - 1].name(),\n                        isAddButton: false\n                    });\n                } else if (e.altKey && key === keys.DELETE) {\n                    var closeCallback = function(e) {\n                        var dlg = e.sender;\n\n                        if (dlg.isConfirmed()) {\n                            this._view.sheetsbar.trigger(\"remove\", { name: this.activeSheet()._name(), confirmation: true });\n                        }\n                    }.bind(this);\n\n                    this._view.sheetsbar._openDialog(\"confirmation\", {\n                        close: closeCallback\n                    });\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.R) {\n                    this._view.sheetsbar._createEditor();\n                    e.preventDefault();\n                    return;\n                } else if (e.ctrlKey && key === keys.B) {\n                    $(\"[data-property=bold]\")[0].click();\n                } else if (e.ctrlKey && key === keys.I) {\n                    $(\"[data-property=italic]\")[0].click();\n                } else if (e.ctrlKey && key === keys.U) {\n                    $(\"[data-property=underline]\")[0].click();\n                } else if (e.altKey && key === keys.H) {\n                    this._view.tabstrip.select(0);\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.N) {\n                    this._view.tabstrip.select(1);\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.A) {\n                    this._view.tabstrip.select(2);\n                    e.preventDefault();\n                    return;\n                } else if (key === keys.F10) {\n                    e.preventDefault();\n                    this._view.tabstrip.wrapper.find(\".k-tabstrip-content.k-active .k-toolbar [tabindex=0]\").trigger(\"focus\");\n                }\n            },\n\n            _resize: function() {\n                this.refresh({ layout: true });\n            },\n\n            _workbookChanging: function(e) {\n                if (this.trigger(\"changing\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookChange: function(e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n\n                if (e.recalc && e.ref) {\n                    var range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                    this.trigger(\"change\", { range: range });\n                }\n            },\n\n            _workbookCut: function(e) {\n                this.trigger(\"cut\", e);\n            },\n\n            _workbookCopy: function(e) {\n                this.trigger(\"copy\", e);\n            },\n\n            _workbookPaste: function(e) {\n                this.trigger(\"paste\", e);\n            },\n\n            activeSheet: function(sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n\n            moveSheetToIndex: function(sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n\n            insertSheet: function(options) {\n                return this._workbook.insertSheet(options);\n            },\n\n            sheets: function() {\n                return this._workbook.sheets();\n            },\n\n            removeSheet: function(sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n\n            sheetByName: function(sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n\n            sheetIndex: function(sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n\n            sheetByIndex: function(index) {\n                return this._workbook.sheetByIndex(index);\n            },\n\n            renameSheet: function(sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n\n            refresh: function(reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n\n                    this._workbook.refresh(reason);\n                }\n\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n\n                    this._view.render(reason);\n                    this.trigger(\"render\");\n                }\n\n                return this;\n            },\n\n            openDialog: function(name, options) {\n                return this._view.openDialog(name, options);\n            },\n\n            autoRefresh: function(value) {\n                if (value !== undefined$1) {\n                    this._autoRefresh = value;\n\n                    if (value === true) {\n                        this.refresh();\n                    }\n\n                    return this;\n                }\n\n                return this._autoRefresh;\n            },\n\n            toJSON: function() {\n                return this._workbook.toJSON();\n            },\n\n            fromJSON: function(json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n\n                    this._bindWorkbookEvents();\n\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n\n            saveJSON: function() {\n                return this._workbook.saveJSON();\n            },\n\n            fromFile: function(blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n\n            saveAsPDF: function(options) {\n                this._workbook.saveAsPDF(\n                    $.extend({}, this.options.pdf, options, { workbook: this._workbook })\n                );\n            },\n\n            saveAsExcel: function(options) {\n                this._workbook.saveAsExcel(options);\n            },\n\n            draw: function(options, callback) {\n                this._workbook.draw(options, callback);\n            },\n\n            _workbookExcelExport: function(e) {\n                if (this.trigger(\"excelExport\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookExcelImport: function(e) {\n                if (this.trigger(\"excelImport\", e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n\n            _initProgress: function(deferred) {\n                var loading =\n                    $(\"<div class='k-loading-mask' \" +\n                           \"style='width: 100%; height: 100%; top: 0;'>\" +\n                        \"<div class='k-loading-color'></div>\" +\n                    \"</div>\")\n                    .appendTo(this.element);\n\n                var pb = $(\"<div class='k-loading-progress'>\")\n                .appendTo(loading)\n                .kendoProgressBar({\n                    type: \"chunk\", chunkCount: 10,\n                    min: 0, max: 1, value: 0\n                }).data(\"kendoProgressBar\");\n\n                deferred.progress(function(e) {\n                    pb.value(e.progress);\n                })\n                .always(function() {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n\n            _workbookPdfExport: function(e) {\n                if (this.trigger(\"pdfExport\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookInsertSheet: function(e) {\n                if (this.trigger(\"insertSheet\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookRemoveSheet: function(e) {\n                if (this.trigger(\"removeSheet\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookSelectSheet: function(e) {\n                if (this.trigger(\"selectSheet\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookRenameSheet: function(e) {\n                if (this.trigger(\"renameSheet\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookInsertRow: function(e) {\n                if (this.trigger(\"insertRow\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookInsertColumn: function(e) {\n                if (this.trigger(\"insertColumn\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookDeleteRow: function(e) {\n                if (this.trigger(\"deleteRow\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookDeleteColumn: function(e) {\n                if (this.trigger(\"deleteColumn\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookHideRow: function(e) {\n                if (this.trigger(\"hideRow\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookHideColumn: function(e) {\n                if (this.trigger(\"hideColumn\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookUnhideRow: function(e) {\n                if (this.trigger(\"unhideRow\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookUnhideColumn: function(e) {\n                if (this.trigger(\"unhideColumn\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookSelect: function(e) {\n                this.trigger(\"select\", e);\n            },\n\n            _workbookChangeFormat: function(e) {\n               this.trigger(\"changeFormat\", e);\n            },\n\n            _workbookDataBinding: function(e) {\n                if (this.trigger(\"dataBinding\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookDataBound: function(e) {\n                this.trigger(\"dataBound\", e);\n            },\n\n            _workbookProgress: function(e) {\n                kendo.ui.progress(this.element, e.toggle);\n            },\n\n            _bindWorkbookEvents: function() {\n                this._workbook.bind(\"cut\", this._workbookCut.bind(this));\n                this._workbook.bind(\"copy\", this._workbookCopy.bind(this));\n                this._workbook.bind(\"paste\", this._workbookPaste.bind(this));\n                this._workbook.bind(\"changing\", this._workbookChanging.bind(this));\n                this._workbook.bind(\"change\", this._workbookChange.bind(this));\n                this._workbook.bind(\"excelExport\", this._workbookExcelExport.bind(this));\n                this._workbook.bind(\"excelImport\", this._workbookExcelImport.bind(this));\n                this._workbook.bind(\"pdfExport\", this._workbookPdfExport.bind(this));\n                this._workbook.bind(\"insertSheet\", this._workbookInsertSheet.bind(this));\n                this._workbook.bind(\"removeSheet\", this._workbookRemoveSheet.bind(this));\n                this._workbook.bind(\"selectSheet\", this._workbookSelectSheet.bind(this));\n                this._workbook.bind(\"renameSheet\", this._workbookRenameSheet.bind(this));\n                this._workbook.bind(\"insertRow\", this._workbookInsertRow.bind(this));\n                this._workbook.bind(\"insertColumn\", this._workbookInsertColumn.bind(this));\n                this._workbook.bind(\"deleteRow\", this._workbookDeleteRow.bind(this));\n                this._workbook.bind(\"deleteColumn\", this._workbookDeleteColumn.bind(this));\n                this._workbook.bind(\"hideRow\", this._workbookHideRow.bind(this));\n                this._workbook.bind(\"hideColumn\", this._workbookHideColumn.bind(this));\n                this._workbook.bind(\"unhideRow\", this._workbookUnhideRow.bind(this));\n                this._workbook.bind(\"unhideColumn\", this._workbookUnhideColumn.bind(this));\n                this._workbook.bind(\"select\", this._workbookSelect.bind(this));\n                this._workbook.bind(\"changeFormat\", this._workbookChangeFormat.bind(this));\n                this._workbook.bind(\"dataBinding\", this._workbookDataBinding.bind(this));\n                this._workbook.bind(\"dataBound\", this._workbookDataBound.bind(this));\n                this._workbook.bind(\"progress\", this._workbookProgress.bind(this));\n            },\n\n            destroy: function() {\n                kendo.ui.Widget.fn.destroy.call(this);\n\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n\n                if (this._resizeHandler) {\n                    $(window).off(\"resize\" + NS, this._resizeHandler);\n                }\n            },\n\n            options: {\n                name: \"Spreadsheet\",\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: \"\",\n                    fileName: \"Workbook.xlsx\"\n                },\n                messages: {},\n                pdf: {\n                    // which part of the workbook to be exported\n                    area: \"workbook\",\n                    fileName: \"Workbook.pdf\",\n                    proxyURL: \"\",\n                    // paperSize can be an usual name, i.e. \"A4\", or an array of two Number-s specifying the\n                    // width/height in points (1pt = 1/72in), or strings including unit, i.e. \"10mm\".  Supported\n                    // units are \"mm\", \"cm\", \"in\" and \"pt\".  The default \"auto\" means paper size is determined\n                    // by content.\n                    paperSize: \"a4\",\n                    // True to reverse the paper dimensions if needed such that width is the larger edge.\n                    landscape: true,\n                    // An object containing { left, top, bottom, right } margins with units.\n                    margin: null,\n                    // Optional information for the PDF Info dictionary; all strings except for the date.\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: \"Kendo UI PDF Generator v.\" + kendo.version,\n                    // Creation Date; defaults to new Date()\n                    date: null\n                },\n                defaultCellStyle: {\n                    fontFamily: \"Arial\",\n                    fontSize: 12\n                },\n                useCultureDecimals: false\n            },\n\n            defineName: function(name, value, hidden) {\n                return this._workbook.defineName(name, value, hidden);\n            },\n\n            undefineName: function(name) {\n                return this._workbook.undefineName(name);\n            },\n\n            nameValue: function(name) {\n                return this._workbook.nameValue(name);\n            },\n\n            forEachName: function(func) {\n                return this._workbook.forEachName(func);\n            },\n\n            cellContextMenu: function() {\n                return this._view.cellContextMenu;\n            },\n\n            rowHeaderContextMenu: function() {\n                return this._view.rowHeaderContextMenu;\n            },\n\n            colHeaderContextMenu: function() {\n                return this._view.colHeaderContextMenu;\n            },\n\n            addImage: function(image) {\n                return this._workbook.addImage(image);\n            },\n\n            cleanupImages: function() {\n                return this._workbook.cleanupImages();\n            },\n\n            events: [\n                \"cut\",\n                \"copy\",\n                \"paste\",\n                \"pdfExport\",\n                \"excelExport\",\n                \"excelImport\",\n                \"changing\",\n                \"change\",\n                \"render\",\n                \"removeSheet\",\n                \"selectSheet\",\n                \"renameSheet\",\n                \"insertRow\",\n                \"insertColumn\",\n                \"deleteRow\",\n                \"insertSheet\",\n                \"deleteColumn\",\n                \"hideRow\",\n                \"hideColumn\",\n                \"unhideRow\",\n                \"unhideColumn\",\n                \"select\",\n                \"changeFormat\",\n                \"dataBinding\",\n                \"dataBound\"\n            ]\n        });\n\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    })(window.kendo);\n    var kendo$1 = kendo;\n\nexport { kendo$1 as default };\n"]}