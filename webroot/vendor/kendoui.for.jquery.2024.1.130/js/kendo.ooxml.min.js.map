{"version":3,"file":"kendo.ooxml.min.js","names":["factory","define","amd","kendo","ooxml","createZip","JSZip","Error","$","window","map","current","toString","value","IntlService","Class","extend","dateToJulianDays","y","m","d","register","userImplementation","format","BASE_DATE","dateToSerial","date","hh","mm","ss","ms","time","getHours","getMinutes","getSeconds","getMilliseconds","serial","year","month","packDate","getFullYear","getMonth","getDate","MIME_TYPE","DATA_URL_PREFIX","DATA_URL_OPTIONS","compression","type","BLOB_OPTIONS","ARRAYBUFFER_OPTIONS","toDataURI","content","indexOf","thing","array","parseJSON","JSON","parse","bind","ESC","val","String","replace","repeat","count","func","str","i","foreach","arr","Array","isArray","length","Object","keys","forEach","key","XMLHEAD","RELS","WORKSHEET","ref$1","frozenColumns","frozenRows","columns","defaults","data","index","mergeCells","autoFilter","filter","showGridLines","hyperlinks","validations","defaultCellStyleId","rtl","legacyDrawing","drawing","lastRow","lastCol","hasDisabledCells","ref","fromCharCode","skipCustomHeight","rowHeight","columnWidth","toWidth","column","ci","columnIndex","width","autoWidth","row","ri","level","height","cell","style","formula","src","writeFormula","spreadsheetFilters","sqref","join","operator","error","errorTitle","formula1","formula2","link","DRAWINGS_RELS_XML","rels","rel","numChar","colIndex","letter","Math","floor","rowIndex","$ref","filterRowIndex","options","freezePane","rowSplit","px","Worksheet","init","sharedStrings","styles","borders","this","_strings","_styles","_borders","_validations","_comments","_drawings","drawings","_hyperlinks","rId","relsToXML","comments","sheetIndex","target","WORKSHEET_RELS","toXML","mergedCells","rows","rowData","rowsByIndex","callback","indexRows","_source","cells","push","sorted","sortByIndex","slice","ctx","fillCells","inflate","_readCells","from","to","prototype","hasOwnProperty","call","defaultCellStyle","_hasDisabledCells","disabled","_lookupStyle","_getLastRow","_getLastCol","colSplit","undefined","commentsXML","comment","text","COMMENTS_XML","drawingsXML","images","main","drw","parseRef","topLeftCell","img","image","col","colOffset","pixelsToExcel","offsetX","rowOffset","offsetY","imageId","LEGACY_DRAWING","_lookupString","result","indexes","uniqueCount","json","stringify","_lookupBorder","border","j","cellData","_cell","cellIndex","this$1$1","EMPTY_CELL","borderLeft","left","borderRight","right","borderTop","top","borderBottom","bottom","dBorders","diagonal","add","defStyle","borderId","prop","enable","colSpan","displayValue","max","stripFunnyChars","Number","getTime","cellName","validation","_addValidation","anchor","v","tmp","showErrorMessage","MAP_EXCEL_TYPE","dataType","MAP_EXCEL_OPERATOR","comparerType","allowBlank","allowNulls","showDropDown","showButton","messageTemplate","titleTemplate","countData","last","el","greaterThanOrEqualTo","lessThanOrEqualTo","number","defaultFormats","General","t0","convertColor","color","hex","x","parseInt","exec","trim","parseFloat","maybeRGB","$0","$1","substring","toUpperCase","Workbook","_images","_imgId","_sheets","sheets","imageFilename","mimeType","id","toZIP","zip","docProps","folder","file","creator","lastModifiedBy","created","modified","CORE","Date","toJSON","sheetCount","sheet","title","APP","xl","idx","WORKBOOK_RELS","media","filename","sheetIds","filterNames","userNames","name","state","f","test","quoteSheet","hidden","localSheetId","WORKBOOK","sheetName","toLowerCase","a","split","names","def","localName","worksheets","drawingsRels","sheetRels","commentFiles","drawingFiles","sheetXML","relsXML","name$1","hasFont","underline","bold","italic","fontFamily","fontSize","fonts","fontInPt","fontInPx","formats","fills","background","fi","font","fill","borderTemplate","fontId","fillId","numFmtId","textAlign","verticalAlign","wrap","indent","STYLES","SHARED_STRINGS","CONTENT_TYPES","toDataURL","generateAsync","then","generate","toBlob","Blob","borderSideTemplate","alias","size","diag","items","sort","b","getSpan","topLeft","bottomRight","rowSpan","upperStr","charCodeAt","getcol","round","insertCell","topLeftRef","spanCell","nextRow","insertCellAt","appendCell","startIndex","SPREADSHEET_FILTERS","generators","SPREADSHEET_CUSTOM_FILTER","logic","criteria","op","customOperator","customValue","SPREADSHEET_DYNAMIC_FILTER","dynamicFilterType","SPREADSHEET_TOP_FILTER","SPREADSHEET_VALUE_FILTER","blanks","values","custom","dynamic","eq","gt","gte","lt","lte","ne","doesnotstartwith","doesnotendwith","doesnotcontain","doesnotmatch","esc","quarter1","quarter2","quarter3","quarter4","january","february","march","april","may","june","july","august","september","october","november","december","deepExtend","jQuery","assign","toDataURLAsync","deferred","Deferred","resolve","dataURI","reject","promise"],"sources":["kendo.ooxml.js"],"mappings":"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","sourcesContent":["(function (factory) {\n    typeof define === 'function' && define.amd ? define(['kendo.core'], factory) :\n    factory();\n})((function () {\n    (function () {\n\n    /* global JSZip */\n\n    kendo.ooxml = kendo.ooxml || {};\n\n    kendo.ooxml.createZip = function() {\n        if (typeof JSZip === \"undefined\") {\n           throw new Error(\"JSZip not found. Check http://docs.telerik.com/kendo-ui/framework/excel/introduction#requirements for more details.\");\n        }\n\n        return new JSZip();\n    };\n\n    })();\n\n    /***********************************************************************\n     * WARNING: this file is auto-generated.  If you change it directly,\n     * your modifications will eventually be lost.  The source code is in\n     * `kendo-ooxml` repository, you should make your changes there and\n     * run `src-modules/sync.sh` in this repository.\n     */\n\n    (function($) {\n    /* eslint-disable space-before-blocks, space-before-function-paren */\n\n    window.kendo.ooxml = window.kendo.ooxml || {};\n    var ooxml = kendo.ooxml;\n\n    var map = $.map;\n    var createZip = ooxml.createZip;\n\n    var current = {\n        toString: function (value) { return value; }\n    };\n\n    var IntlService = kendo.Class.extend({\n\n    });\n\n    IntlService.register = function(userImplementation) {\n        current = userImplementation;\n    };\n\n    IntlService.toString = function(value, format) {\n        return current.toString(value, format);\n    };\n\n    // date packing utilities from Kendo Spreadsheet\n\n    // Julian days algorithms from http://www.hermetic.ch/cal_stud/jdn.htm#comp\n    function dateToJulianDays(y, m, d) {\n        return ((1461 * (y + 4800 + ((m - 13) / 12 | 0))) / 4 | 0) +\n            ((367 * (m - 1 - 12 * ((m - 13) / 12 | 0))) / 12 | 0) -\n            ((3 * (((y + 4900 + ((m - 13) / 12 | 0)) / 100 | 0))) / 4 | 0) +\n            d - 32075;\n    }\n\n    // This uses the Google Spreadsheet approach: treat 1899-12-31 as day 1, allowing to avoid\n    // implementing the \"Leap Year Bug\" yet still be Excel compatible for dates starting 1900-03-01.\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n\n    function packTime(hh, mm, ss, ms) {\n        return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n    }\n\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(),\n                              date.getMinutes(),\n                              date.getSeconds(),\n                              date.getMilliseconds());\n        var serial = packDate(date.getFullYear(),\n                                date.getMonth(),\n                                date.getDate());\n        return serial < 0 ? serial - 1 + time : serial + time;\n    }\n\n    var MIME_TYPE = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\n    var DATA_URL_PREFIX = \"data:\" + MIME_TYPE + \";base64,\";\n    var DATA_URL_OPTIONS = { compression: \"DEFLATE\", type: \"base64\" };\n    var BLOB_OPTIONS = { compression: \"DEFLATE\", type: \"blob\" };\n    var ARRAYBUFFER_OPTIONS = { compression: \"DEFLATE\", type: \"arraybuffer\" };\n\n    /* eslint-disable key-spacing, no-confusing-arrow, no-constant-condition, indent, no-nested-ternary, consistent-return */\n\n    function toDataURI(content) {\n        return DATA_URL_PREFIX + content;\n    }\n\n    function indexOf(thing, array) {\n        return array.indexOf(thing);\n    }\n\n    var parseJSON = JSON.parse.bind(JSON);\n\n    function ESC(val) {\n        return String(val)\n            .replace(/&/g, \"&amp;\")\n            .replace(/</g, \"&lt;\")\n            .replace(/>/g, \"&gt;\")\n            .replace(/\\\"/g, \"&quot;\")\n            .replace(/\\'/g, \"&#39;\");\n    }\n\n    function repeat(count, func) {\n        var str = \"\";\n        for (var i = 0; i < count; ++i) {\n            str += func(i);\n        }\n        return str;\n    }\n\n    function foreach(arr, func) {\n        var str = \"\";\n        if (arr != null) {\n            if (Array.isArray(arr)) {\n                for (var i = 0; i < arr.length; ++i) {\n                    str += func(arr[i], i);\n                }\n            } else if (typeof arr == \"object\") {\n                Object.keys(arr).forEach(function (key, i) {\n                    str += func(arr[key], key, i);\n                });\n            }\n        }\n        return str;\n    }\n\n    var XMLHEAD = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r';\n\n    var RELS = XMLHEAD + \"\\n            <Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n               <Relationship Id=\\\"rId3\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\\\" Target=\\\"docProps/app.xml\\\"/>\\n               <Relationship Id=\\\"rId2\\\" Type=\\\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\\\" Target=\\\"docProps/core.xml\\\"/>\\n               <Relationship Id=\\\"rId1\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\\\" Target=\\\"xl/workbook.xml\\\"/>\\n            </Relationships>\";\n\n    var CORE = function (ref) {\n      var creator = ref.creator;\n      var lastModifiedBy = ref.lastModifiedBy;\n      var created = ref.created;\n      var modified = ref.modified;\n\n      return (XMLHEAD + \"\\n <cp:coreProperties xmlns:cp=\\\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\\\"\\n   xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\" xmlns:dcterms=\\\"http://purl.org/dc/terms/\\\"\\n   xmlns:dcmitype=\\\"http://purl.org/dc/dcmitype/\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\">\\n   <dc:creator>\" + (ESC(creator)) + \"</dc:creator>\\n   <cp:lastModifiedBy>\" + (ESC(lastModifiedBy)) + \"</cp:lastModifiedBy>\\n   <dcterms:created xsi:type=\\\"dcterms:W3CDTF\\\">\" + (ESC(created)) + \"</dcterms:created>\\n   <dcterms:modified xsi:type=\\\"dcterms:W3CDTF\\\">\" + (ESC(modified)) + \"</dcterms:modified>\\n</cp:coreProperties>\");\n    };\n\n    var APP = function (ref) {\n      var sheets = ref.sheets;\n\n      return (XMLHEAD + \"\\n<Properties xmlns=\\\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\\\" xmlns:vt=\\\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\\\">\\n  <Application>Microsoft Excel</Application>\\n  <DocSecurity>0</DocSecurity>\\n  <ScaleCrop>false</ScaleCrop>\\n  <HeadingPairs>\\n    <vt:vector size=\\\"2\\\" baseType=\\\"variant\\\">\\n      <vt:variant>\\n        <vt:lpstr>Worksheets</vt:lpstr>\\n      </vt:variant>\\n      <vt:variant>\\n        <vt:i4>\" + (sheets.length) + \"</vt:i4>\\n      </vt:variant>\\n    </vt:vector>\\n  </HeadingPairs>\\n  <TitlesOfParts>\\n    <vt:vector size=\\\"\" + (sheets.length) + \"\\\" baseType=\\\"lpstr\\\">\" + (foreach(sheets, function (sheet, i) { return sheet.options.title\n              ? (\"<vt:lpstr>\" + (ESC(sheet.options.title)) + \"</vt:lpstr>\")\n              : (\"<vt:lpstr>Sheet\" + (i + 1) + \"</vt:lpstr>\"); }\n          )) + \"</vt:vector>\\n  </TitlesOfParts>\\n  <LinksUpToDate>false</LinksUpToDate>\\n  <SharedDoc>false</SharedDoc>\\n  <HyperlinksChanged>false</HyperlinksChanged>\\n  <AppVersion>14.0300</AppVersion>\\n</Properties>\");\n    };\n\n    var CONTENT_TYPES = function (ref) {\n      var sheetCount = ref.sheetCount;\n      var commentFiles = ref.commentFiles;\n      var drawingFiles = ref.drawingFiles;\n\n      return (XMLHEAD + \"\\n<Types xmlns=\\\"http://schemas.openxmlformats.org/package/2006/content-types\\\">\\n  <Default Extension=\\\"png\\\" ContentType=\\\"image/png\\\"/>\\n  <Default Extension=\\\"gif\\\" ContentType=\\\"image/gif\\\"/>\\n  <Default Extension=\\\"jpg\\\" ContentType=\\\"image/jpeg\\\"/>\\n  <Default Extension=\\\"rels\\\" ContentType=\\\"application/vnd.openxmlformats-package.relationships+xml\\\" />\\n  <Default Extension=\\\"xml\\\" ContentType=\\\"application/xml\\\" />\\n  <Default Extension=\\\"vml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.vmlDrawing\\\"/>\\n  <Override PartName=\\\"/xl/workbook.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\\\" />\\n  <Override PartName=\\\"/xl/styles.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\\\"/>\\n  <Override PartName=\\\"/xl/sharedStrings.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\\\"/>\\n  \" + (repeat(sheetCount, function (idx) { return (\"<Override PartName=\\\"/xl/worksheets/sheet\" + (idx + 1) + \".xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\\\" />\"); })) + \"\\n  \" + (foreach(commentFiles, function (filename) { return (\"<Override PartName=\\\"/xl/\" + filename + \"\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\\\"/>\"); })) + \"\\n  \" + (foreach(drawingFiles, function (filename) { return (\"<Override PartName=\\\"/xl/drawings/\" + filename + \"\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.drawing+xml\\\"/>\"); })) + \"\\n  <Override PartName=\\\"/docProps/core.xml\\\" ContentType=\\\"application/vnd.openxmlformats-package.core-properties+xml\\\" />\\n  <Override PartName=\\\"/docProps/app.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.extended-properties+xml\\\" />\\n</Types>\");\n    };\n\n    var WORKBOOK = function (ref) {\n      var sheets = ref.sheets;\n      var filterNames = ref.filterNames;\n      var userNames = ref.userNames;\n\n      return (XMLHEAD + \"\\n<workbook xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\">\\n  <fileVersion appName=\\\"xl\\\" lastEdited=\\\"5\\\" lowestEdited=\\\"5\\\" rupBuild=\\\"9303\\\" />\\n  <workbookPr defaultThemeVersion=\\\"124226\\\" />\\n  <bookViews>\\n    <workbookView xWindow=\\\"240\\\" yWindow=\\\"45\\\" windowWidth=\\\"18195\\\" windowHeight=\\\"7995\\\" />\\n  </bookViews>\\n  <sheets>\\n  \" + (foreach(sheets, function (ref, i) {\n        var options = ref.options;\n\n        var name = options.name || options.title || (\"Sheet\" + (i + 1));\n        var state = options.state || 'visible';\n        return (\"<sheet name=\\\"\" + (ESC(name)) + \"\\\" state=\\\"\" + state + \"\\\" sheetId=\\\"\" + (i + 1) + \"\\\" r:id=\\\"rId\" + (i + 1) + \"\\\" />\");\n      })) + \"\\n  </sheets>\\n  \" + (filterNames.length || userNames.length ? (\"\\n    <definedNames>\\n      \" + (foreach(filterNames, function (f) { return (\"\\n         <definedName name=\\\"_xlnm._FilterDatabase\\\" hidden=\\\"1\\\" localSheetId=\\\"\" + (f.localSheetId) + \"\\\">\" + (ESC(quoteSheet(f.name))) + \"!\" + (ESC(f.from)) + \":\" + (ESC(f.to)) + \"</definedName>\"); })) + \"\\n      \" + (foreach(userNames, function (f) { return (\"\\n         <definedName name=\\\"\" + (f.name) + \"\\\" hidden=\\\"\" + (f.hidden ? 1 : 0) + \"\\\" \" + (f.localSheetId != null ? (\"localSheetId=\\\"\" + (f.localSheetId) + \"\\\"\") : '') + \">\" + (ESC(f.value)) + \"</definedName>\"); })) + \"\\n    </definedNames>\") : '') + \"\\n  <calcPr fullCalcOnLoad=\\\"1\\\" calcId=\\\"145621\\\" />\\n</workbook>\");\n    };\n\n    var WORKSHEET = function (ref$1) {\n      var frozenColumns = ref$1.frozenColumns;\n      var frozenRows = ref$1.frozenRows;\n      var columns = ref$1.columns;\n      var defaults = ref$1.defaults;\n      var data = ref$1.data;\n      var index = ref$1.index;\n      var mergeCells = ref$1.mergeCells;\n      var autoFilter = ref$1.autoFilter;\n      var filter = ref$1.filter;\n      var showGridLines = ref$1.showGridLines;\n      var hyperlinks = ref$1.hyperlinks;\n      var validations = ref$1.validations;\n      var defaultCellStyleId = ref$1.defaultCellStyleId;\n      var rtl = ref$1.rtl;\n      var legacyDrawing = ref$1.legacyDrawing;\n      var drawing = ref$1.drawing;\n      var lastRow = ref$1.lastRow;\n      var lastCol = ref$1.lastCol;\n      var hasDisabledCells = ref$1.hasDisabledCells;\n\n      return (XMLHEAD + \"\\n<worksheet xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" xmlns:mc=\\\"http://schemas.openxmlformats.org/markup-compatibility/2006\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\" xmlns:x14ac=\\\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\\\" mc:Ignorable=\\\"x14ac\\\">\\n   \" + (lastRow && lastCol ? (\"<dimension ref=\\\"A1:\" + (ref(lastRow - 1, lastCol - 1)) + \"\\\" />\") : \"\") + \"\\n\\n   <sheetViews>\\n     <sheetView \" + (rtl ? 'rightToLeft=\"1\"' : '') + \" \" + (index === 0 ? 'tabSelected=\"1\"' : '') + \" workbookViewId=\\\"0\\\" \" + (showGridLines === false ? 'showGridLines=\"0\"' : '') + \">\\n     \" + (frozenRows || frozenColumns ? (\"\\n       <pane state=\\\"frozen\\\"\\n         \" + (frozenColumns ? (\"xSplit=\\\"\" + frozenColumns + \"\\\"\") : '') + \"\\n         \" + (frozenRows ? (\"ySplit=\\\"\" + frozenRows + \"\\\"\") : '') + \"\\n         topLeftCell=\\\"\" + (String.fromCharCode(65 + (frozenColumns || 0)) + ((frozenRows || 0) + 1)) + \"\\\"\\n       />\") : '') + \"\\n     </sheetView>\\n   </sheetViews>\\n\\n   <sheetFormatPr x14ac:dyDescent=\\\"0.25\\\" \" + (!defaults.skipCustomHeight ? 'customHeight=\"1\"' : '') + \" defaultRowHeight=\\\"\" + (defaults.rowHeight ? defaults.rowHeight * 0.75 : 15) + \"\\\"\\n     \" + (defaults.columnWidth ? (\"defaultColWidth=\\\"\" + (toWidth(defaults.columnWidth)) + \"\\\"\") : '') + \" />\\n\\n   \" + (defaultCellStyleId != null || (columns && columns.length > 0) ? (\"\\n     <cols>\\n       \" + (!columns || !columns.length ? (\"\\n         <col min=\\\"1\\\" max=\\\"16384\\\" style=\\\"\" + defaultCellStyleId + \"\\\"\\n              \" + (defaults.columnWidth ? (\"width=\\\"\" + (toWidth(defaults.columnWidth)) + \"\\\"\") : '') + \" /> \") : '') + \"\\n       \" + (foreach(columns, function (column, ci) {\n             var columnIndex = typeof column.index === \"number\" ? column.index + 1 : (ci + 1);\n             if (column.width === 0) {\n               return (\"<col \" + (defaultCellStyleId != null ? (\"style=\\\"\" + defaultCellStyleId + \"\\\"\") : '') + \"\\n                        min=\\\"\" + columnIndex + \"\\\" max=\\\"\" + columnIndex + \"\\\" hidden=\\\"1\\\" customWidth=\\\"1\\\" />\");\n             }\n             return (\"<col \" + (defaultCellStyleId != null ? (\"style=\\\"\" + defaultCellStyleId + \"\\\"\") : '') + \"\\n                      min=\\\"\" + columnIndex + \"\\\" max=\\\"\" + columnIndex + \"\\\" customWidth=\\\"1\\\"\\n                      \" + (column.autoWidth\n                              ? (\"width=\\\"\" + (((column.width * 7 + 5) / 7 * 256) / 256) + \"\\\" bestFit=\\\"1\\\"\")\n                              : (\"width=\\\"\" + (toWidth(column.width)) + \"\\\"\")) + \" />\");\n           })) + \"\\n     </cols>\") : '') + \"\\n\\n   <sheetData>\\n     \" + (foreach(data, function (row, ri) {\n           var rowIndex = typeof row.index === \"number\" ? row.index + 1 : (ri + 1);\n           return (\"\\n         <row r=\\\"\" + rowIndex + \"\\\" x14ac:dyDescent=\\\"0.25\\\"\\n              \" + (row.level ? (\"outlineLevel=\\\"\" + (row.level) + \"\\\"\") : '') + \"\\n              \" + (row.height === 0 ? 'hidden=\"1\"'\n                                     : row.height ? (\"ht=\\\"\" + (toHeight(row.height)) + \"\\\" customHeight=\\\"1\\\"\") : \"\") + \">\\n           \" + (foreach(row.data, function (cell) { return (\"\\n             <c r=\\\"\" + (cell.ref) + \"\\\" \" + (cell.style ? (\"s=\\\"\" + (cell.style) + \"\\\"\") : '') + \" \" + (cell.type ? (\"t=\\\"\" + (cell.type) + \"\\\"\") : '') + \">\\n               \" + (cell.formula != null ? writeFormula(cell.formula) : '') + \"\\n               \" + (cell.value != null ? (\"<v>\" + (ESC(cell.value)) + \"</v>\") : '') + \"\\n             </c>\"); })) + \"\\n         </row>\\n       \");})) + \"\\n   </sheetData>\\n\\n   \" + (hasDisabledCells ? \"<sheetProtection sheet=\\\"1\\\" objects=\\\"1\\\" scenarios=\\\"1\\\"/>\" : '') + \"\\n\\n   \" + (autoFilter ? (\"<autoFilter ref=\\\"\" + (autoFilter.from) + \":\" + (autoFilter.to) + \"\\\"/>\")\n                    : filter ? spreadsheetFilters(filter) : '') + \"\\n\\n   \" + (mergeCells.length ? (\"\\n     <mergeCells count=\\\"\" + (mergeCells.length) + \"\\\">\\n       \" + (foreach(mergeCells, function (ref) { return (\"<mergeCell ref=\\\"\" + ref + \"\\\"/>\"); })) + \"\\n     </mergeCells>\") : '') + \"\\n\\n   \" + (validations.length ? (\"\\n     <dataValidations>\\n       \" + (foreach(validations, function (val) { return (\"\\n         <dataValidation sqref=\\\"\" + (val.sqref.join(\" \")) + \"\\\"\\n                         showErrorMessage=\\\"\" + (val.showErrorMessage) + \"\\\"\\n                         type=\\\"\" + (ESC(val.type)) + \"\\\"\\n                         \" + (val.type !== \"list\" ? (\"operator=\\\"\" + (ESC(val.operator)) + \"\\\"\") : '') + \"\\n                         allowBlank=\\\"\" + (val.allowBlank) + \"\\\"\\n                         showDropDown=\\\"\" + (val.showDropDown) + \"\\\"\\n                         \" + (val.error ? (\"error=\\\"\" + (ESC(val.error)) + \"\\\"\") : '') + \"\\n                         \" + (val.errorTitle ? (\"errorTitle=\\\"\" + (ESC(val.errorTitle)) + \"\\\"\") : '') + \">\\n           \" + (val.formula1 ? (\"<formula1>\" + (ESC(val.formula1)) + \"</formula1>\") : '') + \"\\n           \" + (val.formula2 ? (\"<formula2>\" + (ESC(val.formula2)) + \"</formula2>\") : '') + \"\\n         </dataValidation>\"); })) + \"\\n     </dataValidations>\") : '') + \"\\n\\n   \" + (hyperlinks.length ? (\"\\n     <hyperlinks>\\n       \" + (foreach(hyperlinks, function (link) { return (\"\\n         <hyperlink ref=\\\"\" + (link.ref) + \"\\\" r:id=\\\"\" + (link.rId) + \"\\\"/>\"); })) + \"\\n     </hyperlinks>\") : '') + \"\\n\\n   <pageMargins left=\\\"0.7\\\" right=\\\"0.7\\\" top=\\\"0.75\\\" bottom=\\\"0.75\\\" header=\\\"0.3\\\" footer=\\\"0.3\\\" />\\n   \" + (drawing ? (\"<drawing r:id=\\\"\" + drawing + \"\\\"/>\") : '') + \"\\n   \" + (legacyDrawing ? (\"<legacyDrawing r:id=\\\"\" + legacyDrawing + \"\\\"/>\") : '') + \"\\n</worksheet>\");\n    };\n\n    var WORKBOOK_RELS = function (ref) {\n      var count = ref.count;\n\n      return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (repeat(count, function (idx) { return (\"\\n    <Relationship Id=\\\"rId\" + (idx + 1) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\\\" Target=\\\"worksheets/sheet\" + (idx + 1) + \".xml\\\" />\"); })) + \"\\n  <Relationship Id=\\\"rId\" + (count + 1) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\\\" Target=\\\"styles.xml\\\" />\\n  <Relationship Id=\\\"rId\" + (count + 2) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\\\" Target=\\\"sharedStrings.xml\\\" />\\n</Relationships>\");\n    };\n\n    var WORKSHEET_RELS = function (ref) {\n      var hyperlinks = ref.hyperlinks;\n      var comments = ref.comments;\n      var sheetIndex = ref.sheetIndex;\n      var drawings = ref.drawings;\n\n      return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (foreach(hyperlinks, function (link) { return (\"\\n    <Relationship Id=\\\"\" + (link.rId) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\\\" Target=\\\"\" + (ESC(link.target)) + \"\\\" TargetMode=\\\"External\\\" />\"); })) + \"\\n  \" + (!comments.length ? '' : (\"\\n    <Relationship Id=\\\"comment\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\\\" Target=\\\"../comments\" + sheetIndex + \".xml\\\"/>\\n    <Relationship Id=\\\"vml\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\\\" Target=\\\"../drawings/vmlDrawing\" + sheetIndex + \".vml\\\"/>\")) + \"\\n  \" + (!drawings.length ? '' : (\"\\n    <Relationship Id=\\\"drw\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\\\" Target=\\\"../drawings/drawing\" + sheetIndex + \".xml\\\"/>\")) + \"\\n</Relationships>\");\n    };\n\n    var COMMENTS_XML = function (ref) {\n      var comments = ref.comments;\n\n      return (XMLHEAD + \"\\n<comments xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\">\\n  <authors>\\n    <author></author>\\n  </authors>\\n  <commentList>\\n    \" + (foreach(comments, function (comment) { return (\"\\n      <comment ref=\\\"\" + (comment.ref) + \"\\\" authorId=\\\"0\\\">\\n        <text>\\n          <r>\\n            <rPr>\\n              <sz val=\\\"8\\\"/>\\n              <color indexed=\\\"81\\\"/>\\n              <rFont val=\\\"Tahoma\\\"/>\\n              <charset val=\\\"1\\\"/>\\n            </rPr>\\n            <t>\" + (ESC(comment.text)) + \"</t>\\n          </r>\\n        </text>\\n      </comment>\"); })) + \"\\n  </commentList>\\n</comments>\");\n    };\n\n    var LEGACY_DRAWING = function (ref) {\n      var comments = ref.comments;\n\n      return (\"<xml xmlns:v=\\\"urn:schemas-microsoft-com:vml\\\"\\n     xmlns:o=\\\"urn:schemas-microsoft-com:office:office\\\"\\n     xmlns:x=\\\"urn:schemas-microsoft-com:office:excel\\\">\\n  <v:shapetype coordsize=\\\"21600,21600\\\" id=\\\"_x0000_t202\\\" path=\\\"m,l,21600r21600,l21600,xe\\\">\\n    <v:stroke joinstyle=\\\"miter\\\"/>\\n    <v:path gradientshapeok=\\\"t\\\" o:connecttype=\\\"rect\\\"/>\\n  </v:shapetype>\\n  \" + (foreach(comments, function (comment) { return (\"\\n    <v:shape type=\\\"#_x0000_t202\\\" style=\\\"visibility: hidden\\\" fillcolor=\\\"#ffffe1\\\" o:insetmode=\\\"auto\\\">\\n      <v:shadow on=\\\"t\\\" color=\\\"black\\\" obscured=\\\"t\\\"/>\\n      <x:ClientData ObjectType=\\\"Note\\\">\\n        <x:MoveWithCells/>\\n        <x:SizeWithCells/>\\n        <x:Anchor>\" + (comment.anchor) + \"</x:Anchor>\\n        <x:AutoFill>False</x:AutoFill>\\n        <x:Row>\" + (comment.row) + \"</x:Row>\\n        <x:Column>\" + (comment.col) + \"</x:Column>\\n      </x:ClientData>\\n    </v:shape>\"); })) + \"\\n</xml>\");\n    };\n\n    var DRAWINGS_XML = function (drawings) { return (XMLHEAD + \"\\n<xdr:wsDr xmlns:xdr=\\\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\\\"\\n          xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\"\\n          xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\">\\n  \" + (foreach(drawings, function (drawing, index) { return (\"\\n    <xdr:oneCellAnchor editAs=\\\"oneCell\\\">\\n      <xdr:from>\\n        <xdr:col>\" + (drawing.col) + \"</xdr:col>\\n        <xdr:colOff>\" + (drawing.colOffset) + \"</xdr:colOff>\\n        <xdr:row>\" + (drawing.row) + \"</xdr:row>\\n        <xdr:rowOff>\" + (drawing.rowOffset) + \"</xdr:rowOff>\\n      </xdr:from>\\n      <xdr:ext cx=\\\"\" + (drawing.width) + \"\\\" cy=\\\"\" + (drawing.height) + \"\\\" />\\n      <xdr:pic>\\n        <xdr:nvPicPr>\\n          <xdr:cNvPr id=\\\"\" + (index + 1) + \"\\\" name=\\\"Picture \" + (index + 1) + \"\\\"/>\\n          <xdr:cNvPicPr/>\\n        </xdr:nvPicPr>\\n        <xdr:blipFill>\\n          <a:blip r:embed=\\\"\" + (drawing.imageId) + \"\\\"/>\\n          <a:stretch>\\n            <a:fillRect/>\\n          </a:stretch>\\n        </xdr:blipFill>\\n        <xdr:spPr>\\n          <a:prstGeom prst=\\\"rect\\\">\\n            <a:avLst/>\\n          </a:prstGeom>\\n        </xdr:spPr>\\n      </xdr:pic>\\n      <xdr:clientData/>\\n    </xdr:oneCellAnchor>\"); })) + \"\\n</xdr:wsDr>\"); };\n\n    var DRAWINGS_RELS_XML = function (rels) { return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (foreach(rels, function (rel) { return (\"\\n    <Relationship Id=\\\"\" + (rel.rId) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\\\" Target=\\\"\" + (rel.target) + \"\\\"/>\"); })) + \"\\n</Relationships>\"); };\n\n    var SHARED_STRINGS = function (ref) {\n      var count = ref.count;\n      var uniqueCount = ref.uniqueCount;\n      var indexes = ref.indexes;\n\n      return (XMLHEAD + \"\\n<sst xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" count=\\\"\" + count + \"\\\" uniqueCount=\\\"\" + uniqueCount + \"\\\">\\n  \" + (foreach(Object.keys(indexes), function (index) { return (\"\\n    <si><t xml:space=\\\"preserve\\\">\" + (ESC(index.substring(1))) + \"</t></si>\"); })) + \"\\n</sst>\");\n    };\n\n    var STYLES = function (ref) {\n      var formats = ref.formats;\n      var fonts = ref.fonts;\n      var fills = ref.fills;\n      var borders = ref.borders;\n      var styles = ref.styles;\n\n      return (XMLHEAD + \"\\n<styleSheet\\n    xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\"\\n    xmlns:mc=\\\"http://schemas.openxmlformats.org/markup-compatibility/2006\\\"\\n    mc:Ignorable=\\\"x14ac\\\"\\n    xmlns:x14ac=\\\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\\\">\\n  <numFmts count=\\\"\" + (formats.length) + \"\\\">\\n  \" + (foreach(formats, function (format, fi) { return (\"\\n    <numFmt formatCode=\\\"\" + (ESC(format.format)) + \"\\\" numFmtId=\\\"\" + (165 + fi) + \"\\\" />\"); })) + \"\\n  </numFmts>\\n  <fonts count=\\\"\" + (fonts.length + 1) + \"\\\" x14ac:knownFonts=\\\"1\\\">\\n    <font>\\n       <sz val=\\\"11\\\" />\\n       <color theme=\\\"1\\\" />\\n       <name val=\\\"Calibri\\\" />\\n       <family val=\\\"2\\\" />\\n       <scheme val=\\\"minor\\\" />\\n    </font>\\n    \" + (foreach(fonts, function (font) { return (\"\\n    <font>\\n      \" + (font.bold ? '<b/>' : '') + \"\\n      \" + (font.italic ? '<i/>' : '') + \"\\n      \" + (font.underline ? '<u/>' : '') + \"\\n      <sz val=\\\"\" + (font.fontSize || 11) + \"\\\" />\\n      \" + (font.color ? (\"<color rgb=\\\"\" + (ESC(font.color)) + \"\\\" />\") : '<color theme=\"1\" />') + \"\\n      \" + (font.fontFamily ? (\"\\n        <name val=\\\"\" + (ESC(font.fontFamily)) + \"\\\" />\\n        <family val=\\\"2\\\" />\\n      \") : \"\\n        <name val=\\\"Calibri\\\" />\\n        <family val=\\\"2\\\" />\\n        <scheme val=\\\"minor\\\" />\\n      \") + \"\\n    </font>\"); })) + \"\\n  </fonts>\\n  <fills count=\\\"\" + (fills.length + 2) + \"\\\">\\n      <fill><patternFill patternType=\\\"none\\\"/></fill>\\n      <fill><patternFill patternType=\\\"gray125\\\"/></fill>\\n    \" + (foreach(fills, function (fill) { return (\"\\n      \" + (fill.background ? (\"\\n        <fill>\\n          <patternFill patternType=\\\"solid\\\">\\n              <fgColor rgb=\\\"\" + (ESC(fill.background)) + \"\\\"/>\\n          </patternFill>\\n        </fill>\\n      \") : '')); })) + \"\\n  </fills>\\n  <borders count=\\\"\" + (borders.length + 1) + \"\\\">\\n    <border><left/><right/><top/><bottom/><diagonal/></border>\\n    \" + (foreach(borders, borderTemplate)) + \"\\n  </borders>\\n  <cellStyleXfs count=\\\"1\\\">\\n    <xf borderId=\\\"0\\\" fillId=\\\"0\\\" fontId=\\\"0\\\" />\\n  </cellStyleXfs>\\n  <cellXfs count=\\\"\" + (styles.length + 1) + \"\\\">\\n    <xf numFmtId=\\\"0\\\" fontId=\\\"0\\\" fillId=\\\"0\\\" borderId=\\\"0\\\" xfId=\\\"0\\\" />\\n    \" + (foreach(styles, function (style) { return (\"\\n      <xf xfId=\\\"0\\\"\\n          \" + (style.fontId ? (\"fontId=\\\"\" + (style.fontId) + \"\\\" applyFont=\\\"1\\\"\") : '') + \"\\n          \" + (style.fillId ? (\"fillId=\\\"\" + (style.fillId) + \"\\\" applyFill=\\\"1\\\"\") : '') + \"\\n          \" + (style.numFmtId ? (\"numFmtId=\\\"\" + (style.numFmtId) + \"\\\" applyNumberFormat=\\\"1\\\"\") : '') + \"\\n          \" + (style.textAlign || style.verticalAlign || style.wrap ? 'applyAlignment=\"1\"' : '') + \"\\n          \" + (style.borderId ? (\"borderId=\\\"\" + (style.borderId) + \"\\\" applyBorder=\\\"1\\\"\") : '') + \"\\n          \" + (style.disabled != null ? \"applyProtection=\\\"1\\\"\" : '') + \">\\n        \" + (style.textAlign || style.verticalAlign || style.wrap ? (\"\\n        <alignment\\n          \" + (style.textAlign ? (\"horizontal=\\\"\" + (ESC(style.textAlign)) + \"\\\"\") : '') + \"\\n          \" + (style.verticalAlign ? (\"vertical=\\\"\" + (ESC(style.verticalAlign)) + \"\\\"\") : '') + \"\\n          \" + (style.indent ? (\"indent=\\\"\" + (ESC(style.indent)) + \"\\\"\") : '') + \"\\n          \" + (style.wrap ? 'wrapText=\"1\"' : '') + \" />\\n        \") : '') + \"\\n        \" + (style.disabled != null ? (\"\\n        <protection locked=\\\"\" + (style.disabled ? 1 : 0) + \"\\\" />\\n        \") : '') + \"\\n      </xf>\\n    \"); })) + \"\\n  </cellXfs>\\n  <cellStyles count=\\\"1\\\">\\n    <cellStyle name=\\\"Normal\\\" xfId=\\\"0\\\" builtinId=\\\"0\\\"/>\\n  </cellStyles>\\n  <dxfs count=\\\"0\\\" />\\n  <tableStyles count=\\\"0\\\" defaultTableStyle=\\\"TableStyleMedium2\\\" defaultPivotStyle=\\\"PivotStyleMedium9\\\" />\\n</styleSheet>\");\n    };\n\n    function writeFormula(formula) {\n        if (typeof formula == \"string\") {\n            return (\"<f>\" + (ESC(formula)) + \"</f>\");\n        }\n        // array formulas\n        return (\"<f t=\\\"array\\\" ref=\\\"\" + (formula.ref) + \"\\\">\" + (ESC(formula.src)) + \"</f>\");\n    }\n\n    function numChar(colIndex) {\n       var letter = Math.floor(colIndex / 26) - 1;\n\n       return (letter >= 0 ? numChar(letter) : \"\") + String.fromCharCode(65 + (colIndex % 26));\n    }\n\n    function ref(rowIndex, colIndex) {\n        return numChar(colIndex) + (rowIndex + 1);\n    }\n\n    function $ref(rowIndex, colIndex) {\n        return \"$\" + numChar(colIndex) + \"$\" + (rowIndex + 1);\n    }\n\n    function filterRowIndex(options) {\n        var frozenRows = options.frozenRows || (options.freezePane || {}).rowSplit || 1;\n        return frozenRows - 1;\n    }\n\n    function toWidth(px) {\n        var maximumDigitWidth = 7;\n        return (px / maximumDigitWidth) - (Math.floor(128 / maximumDigitWidth) / 256);\n    }\n\n    function toHeight(px) {\n        return px * 0.75;\n    }\n\n    function stripFunnyChars(value) {\n        return String(value)\n            .replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F]/g, \"\") // leave CRLF in\n            .replace(/\\r?\\n/g, \"\\r\\n\");                   // make sure LF is preceded by CR\n    }\n\n    var Worksheet = kendo.Class.extend({\n        init: function(options, sharedStrings, styles, borders) {\n            this.options = options;\n            this._strings = sharedStrings;\n            this._styles = styles;\n            this._borders = borders;\n            this._validations = {};\n            this._comments = [];\n            this._drawings = options.drawings || [];\n            this._hyperlinks = (this.options.hyperlinks || []).map(\n                function (link, i) { return $.extend({}, link, { rId: (\"link\" + i) }); });\n        },\n\n        relsToXML: function() {\n            var hyperlinks = this._hyperlinks;\n            var comments = this._comments;\n            var drawings = this._drawings;\n\n            if (hyperlinks.length || comments.length || drawings.length) {\n                return WORKSHEET_RELS({\n                    hyperlinks : hyperlinks,\n                    comments   : comments,\n                    sheetIndex : this.options.sheetIndex,\n                    drawings   : drawings\n                });\n            }\n        },\n\n        toXML: function(index) {\n            var this$1$1 = this;\n\n            var mergeCells = this.options.mergedCells || [];\n            var rows = this.options.rows || [];\n            var data = inflate(rows, mergeCells);\n\n            this._readCells(data);\n\n            var autoFilter = this.options.filter;\n            var filter;\n            if (autoFilter && (typeof autoFilter.from === \"number\") && (typeof autoFilter.to === \"number\")) {\n                // Grid enables auto filter\n                autoFilter = {\n                    from: ref(filterRowIndex(this.options), autoFilter.from),\n                    to: ref(filterRowIndex(this.options), autoFilter.to)\n                };\n            } else if (autoFilter && autoFilter.ref && autoFilter.columns) {\n                // this is probably from the Spreadsheet\n                filter = autoFilter;\n                autoFilter = null;\n            }\n\n            var validations = [];\n            for (var i in this._validations) {\n                if (Object.prototype.hasOwnProperty.call(this$1$1._validations, i)) {\n                    validations.push(this$1$1._validations[i]);\n                }\n            }\n\n            var defaultCellStyleId = null;\n            var defaultCellStyle = this.options.defaultCellStyle;\n            if (this._hasDisabledCells) {\n                if (!defaultCellStyle) {\n                    defaultCellStyle = { disabled: false };\n                } else {\n                    defaultCellStyle = $.extend({ disabled: false }, defaultCellStyle);\n                }\n            }\n            if (defaultCellStyle) {\n                defaultCellStyleId = this._lookupStyle(defaultCellStyle);\n            }\n\n            var freezePane = this.options.freezePane || {};\n            var defaults = this.options.defaults || {};\n            var lastRow = this.options.rows ? this._getLastRow() : 1;\n            var lastCol = this.options.rows ? this._getLastCol() : 1;\n\n            return WORKSHEET({\n                frozenColumns: this.options.frozenColumns || freezePane.colSplit,\n                frozenRows: this.options.frozenRows || freezePane.rowSplit,\n                columns: this.options.columns,\n                defaults: defaults,\n                data: data,\n                index: index,\n                mergeCells: mergeCells,\n                autoFilter: autoFilter,\n                filter: filter,\n                showGridLines: this.options.showGridLines,\n                hyperlinks: this._hyperlinks,\n                validations: validations,\n                defaultCellStyleId: defaultCellStyleId,\n                rtl: this.options.rtl !== undefined ? this.options.rtl : defaults.rtl,\n                legacyDrawing: this._comments.length ? (\"vml\" + (this.options.sheetIndex)) : null,\n                drawing: this._drawings.length ? (\"drw\" + (this.options.sheetIndex)) : null,\n                lastRow: lastRow,\n                lastCol: lastCol,\n                hasDisabledCells: this._hasDisabledCells,\n            });\n        },\n\n        commentsXML: function() {\n            if (this._comments.length) {\n                return COMMENTS_XML({ comments: this._comments });\n            }\n        },\n\n        drawingsXML: function(images) {\n            if (this._drawings.length) {\n                var rels = {};\n                var main = this._drawings.map(function (drw) {\n                    var ref = parseRef(drw.topLeftCell);\n                    var img = rels[drw.image];\n                    if (!img) {\n                        img = rels[drw.image] = {\n                            rId: (\"img\" + (drw.image)),\n                            target: images[drw.image].target\n                        };\n                    }\n                    return {\n                        col       : ref.col,\n                        colOffset : pixelsToExcel(drw.offsetX),\n                        row       : ref.row,\n                        rowOffset : pixelsToExcel(drw.offsetY),\n                        width     : pixelsToExcel(drw.width),\n                        height    : pixelsToExcel(drw.height),\n                        imageId   : img.rId\n                    };\n                });\n                return {\n                    main: DRAWINGS_XML(main),\n                    rels: DRAWINGS_RELS_XML(rels)\n                };\n            }\n        },\n\n        legacyDrawing: function() {\n            if (this._comments.length) {\n                return LEGACY_DRAWING({ comments: this._comments });\n            }\n        },\n\n        _lookupString: function(value) {\n            var key = \"$\" + value;\n            var index = this._strings.indexes[key];\n            var result;\n\n            if (index !== undefined) {\n                result = index;\n            } else {\n                result = this._strings.indexes[key] = this._strings.uniqueCount;\n                this._strings.uniqueCount ++;\n            }\n\n            this._strings.count ++;\n\n            return result;\n        },\n\n        _lookupStyle: function(style) {\n            var json = JSON.stringify(style);\n\n            if (json === \"{}\") {\n                return 0;\n            }\n\n            var index = indexOf(json, this._styles);\n\n            if (index < 0) {\n                index = this._styles.push(json) - 1;\n            }\n\n            // There is one default style\n            return index + 1;\n        },\n\n        _lookupBorder: function(border) {\n            var json = JSON.stringify(border);\n            if (json === \"{}\") {\n                return;\n            }\n\n            var index = indexOf(json, this._borders);\n            if (index < 0) {\n                index = this._borders.push(json) - 1;\n            }\n\n            // There is one default border\n            return index + 1;\n        },\n\n        _readCells: function(rowData) {\n            var this$1$1 = this;\n\n            for (var i = 0; i < rowData.length; i++) {\n                var row = rowData[i];\n                var cells = row.cells;\n\n                row.data = [];\n\n                for (var j = 0; j < cells.length; j++) {\n                    var cellData = this$1$1._cell(cells[j], row.index, j);\n                    if (cellData) {\n                        row.data.push(cellData);\n                    }\n                }\n            }\n        },\n\n        _cell: function(data, rowIndex, cellIndex) {\n            var this$1$1 = this;\n\n            if (!data || data === EMPTY_CELL) {\n                return null;\n            }\n\n            var value = data.value;\n\n            var border = {};\n\n            if (data.borderLeft) {\n                border.left = data.borderLeft;\n            }\n\n            if (data.borderRight) {\n                border.right = data.borderRight;\n            }\n\n            if (data.borderTop) {\n                border.top = data.borderTop;\n            }\n\n            if (data.borderBottom) {\n                border.bottom = data.borderBottom;\n            }\n\n            if (data.dBorders) {\n                border.diagonal = data.dBorders;\n            }\n\n            border = this._lookupBorder(border);\n\n            var defStyle = this.options.defaultCellStyle || {};\n            var style = { borderId: border };\n\n            (function (add) {\n                add(\"color\");\n                add(\"background\");\n                add(\"bold\");\n                add(\"italic\");\n                add(\"underline\");\n                if (!add(\"fontFamily\")) { add(\"fontName\", \"fontFamily\"); }\n                add(\"fontSize\");\n                add(\"format\");\n                if (!add(\"textAlign\")) { add(\"hAlign\", \"textAlign\"); }\n                if (!add(\"verticalAlign\")) { add(\"vAlign\", \"verticalAlign\"); }\n                add(\"wrap\");\n                add(\"indent\");\n                if (!add(\"disabled\")) {\n                    if (add(\"enable\")) {\n                        style.disabled = !style.enable;\n                        delete style.enable;\n                    }\n                }\n                if (style.disabled) {\n                    this$1$1._hasDisabledCells = true;\n                }\n            })(function (prop, target) {\n                var val = data[prop];\n                if (val === undefined) {\n                    val = defStyle[prop];\n                }\n                if (val !== undefined) {\n                    style[target || prop] = val;\n                    return true;\n                }\n            });\n\n            var columns = this.options.columns || [];\n\n            var column = columns[cellIndex];\n            var type = typeof value;\n\n            if (column && column.autoWidth && (!data.colSpan || data.colSpan === 1)) {\n                var displayValue = value;\n\n                // XXX: let's not bring kendo.toString in only for this.\n                //      better wait until the spreadsheet engine is available as a separate\n                //      component, then we can use a real Excel-like formatter.\n                //\n                if (type === \"number\") {\n                    // kendo.toString will not behave exactly like the Excel format\n                    // Still, it's the best we have available for estimating the character count.\n                    displayValue = IntlService.toString(value, data.format);\n                }\n\n                column.width = Math.max(column.width || 0, String(displayValue).length);\n            }\n\n            if (type === \"string\") {\n                value = stripFunnyChars(value);\n                value = this._lookupString(value);\n                type = \"s\";\n            } else if (type === \"number\") {\n                type = \"n\";\n            } else if (type === \"boolean\") {\n                type = \"b\";\n                value = Number(value);\n            } else if (value && value.getTime) {\n                type = null;\n                value = dateToSerial(value);\n                if (!style.format) {\n                    style.format = \"mm-dd-yy\";\n                }\n            } else {\n                type = null;\n                value = null;\n            }\n\n            style = this._lookupStyle(style);\n\n            var cellName = ref(rowIndex, cellIndex);\n\n            if (data.validation) {\n                this._addValidation(data.validation, cellName);\n            }\n\n            if (data.comment) {\n                var anchor = [\n                    cellIndex + 1,  // start column\n                    15,             // start column offset\n                    rowIndex,       // start row\n                    10,             // start row offset\n                    cellIndex + 3,  // end column\n                    15,             // end column offset\n                    rowIndex + 3,   // end row\n                    4               // end row offset\n                ];\n                this._comments.push({\n                    ref    : cellName,\n                    text   : data.comment,\n                    row    : rowIndex,\n                    col    : cellIndex,\n                    anchor : anchor.join(\", \")\n                });\n            }\n\n            return {\n                value: value,\n                formula: data.formula,\n                type: type,\n                style: style,\n                ref: cellName\n            };\n        },\n\n        _addValidation: function(v, ref) {\n            var tmp = {\n                showErrorMessage : v.type === \"reject\" ? 1 : 0,\n                formula1         : v.from,\n                formula2         : v.to,\n                type             : MAP_EXCEL_TYPE[v.dataType] || v.dataType,\n                operator         : MAP_EXCEL_OPERATOR[v.comparerType] || v.comparerType,\n                allowBlank       : v.allowNulls ? 1 : 0,\n                showDropDown     : v.showButton ? 0 : 1, // LOL, Excel!\n                error            : v.messageTemplate,\n                errorTitle       : v.titleTemplate\n            };\n            var json = JSON.stringify(tmp);\n            if (!this._validations[json]) {\n                this._validations[json] = tmp;\n                tmp.sqref = [];\n            }\n            this._validations[json].sqref.push(ref);\n        },\n\n        _getLastRow: function() {\n            return countData(this.options.rows);\n        },\n\n        _getLastCol: function() {\n            var last = 0;\n            this.options.rows.forEach(function(row) {\n                if (row.cells) {\n                    last = Math.max(last, countData(row.cells));\n                }\n            });\n            return last;\n        }\n    });\n\n    function countData(data) {\n        var last = data.length;\n        data.forEach(function(el) {\n            if (el.index && el.index >= last) {\n                last = el.index + 1;\n            }\n        });\n        return last;\n    }\n\n    var MAP_EXCEL_OPERATOR = {\n        // includes only what differs; key is our operator, value is Excel\n        // operator.\n        greaterThanOrEqualTo : \"greaterThanOrEqual\",\n        lessThanOrEqualTo    : \"lessThanOrEqual\"\n    };\n\n    var MAP_EXCEL_TYPE = {\n        // eslint-disable-next-line id-denylist\n        number: \"decimal\"\n    };\n\n    var defaultFormats = {\n        \"General\": 0,\n        \"0\": 1,\n        \"0.00\": 2,\n        \"#,##0\": 3,\n        \"#,##0.00\": 4,\n        \"0%\": 9,\n        \"0.00%\": 10,\n        \"0.00E+00\": 11,\n        \"# ?/?\": 12,\n        \"# ??/??\": 13,\n        \"mm-dd-yy\": 14,\n        \"d-mmm-yy\": 15,\n        \"d-mmm\": 16,\n        \"mmm-yy\": 17,\n        \"h:mm AM/PM\": 18,\n        \"h:mm:ss AM/PM\": 19,\n        \"h:mm\": 20,\n        \"h:mm:ss\": 21,\n        \"m/d/yy h:mm\": 22,\n        \"#,##0 ;(#,##0)\": 37,\n        \"#,##0 ;[Red](#,##0)\": 38,\n        \"#,##0.00;(#,##0.00)\": 39,\n        \"#,##0.00;[Red](#,##0.00)\": 40,\n        \"mm:ss\": 45,\n        \"[h]:mm:ss\": 46,\n        \"mmss.0\": 47,\n        \"##0.0E+0\": 48,\n        \"@\": 49,\n        \"[$-404]e/m/d\": 27,\n        \"m/d/yy\": 30,\n        \"t0\": 59,\n        \"t0.00\": 60,\n        \"t#,##0\": 61,\n        \"t#,##0.00\": 62,\n        \"t0%\": 67,\n        \"t0.00%\": 68,\n        \"t# ?/?\": 69,\n        \"t# ??/??\": 70\n    };\n\n    function maybeRGB(value) {\n        function hex(val) {\n            var x = parseInt(val, 10).toString(16);\n            return x.length < 2 ? \"0\" + x : x;\n        }\n\n        var m = /^rgba?\\((\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*([0-9.]+)\\s*)?\\)/i.exec(value.trim());\n        if (m) {\n            var opacity = (m[4] ? parseFloat(m[4]) : 1) * 255 | 0;\n            return \"#\" + hex(opacity) + hex(m[1]) + hex(m[2]) + hex(m[3]);\n        }\n        return value;\n    }\n\n    function convertColor(value) {\n        var color = maybeRGB(value);\n        if (color.length < 6) {\n            color = color.replace(/(\\w)/g, function($0, $1) {\n                return $1 + $1;\n            });\n        }\n\n        color = color.substring(1).toUpperCase();\n\n        if (color.length < 8) {\n            color = \"FF\" + color;\n        }\n\n        return color;\n    }\n\n    var Workbook = kendo.Class.extend({\n        init: function(options) {\n            var this$1$1 = this;\n\n            this.options = options || {};\n            this._strings = {\n                indexes: {},\n                count: 0,\n                uniqueCount: 0\n            };\n            this._styles = [];\n            this._borders = [];\n            this._images = this.options.images;\n            this._imgId = 0;\n\n            this._sheets = map(this.options.sheets || [], function (options, i) {\n                options.defaults = this$1$1.options;\n                options.sheetIndex = i + 1;\n                return new Worksheet(options, this$1$1._strings, this$1$1._styles, this$1$1._borders);\n            });\n        },\n\n        imageFilename: function(mimeType) {\n            var id = ++this._imgId;\n            switch (mimeType) {\n              case \"image/jpg\":\n              case \"image/jpeg\":\n                return (\"image\" + id + \".jpg\");\n              case \"image/png\":\n                return (\"image\" + id + \".png\");\n              case \"image/gif\":\n                return (\"image\" + id + \".gif\");\n              default:\n                return (\"image\" + id + \".bin\"); // XXX: anything better to do here?\n            }\n        },\n\n        toZIP: function() {\n            var this$1$1 = this;\n\n            var zip = createZip();\n\n            var docProps = zip.folder(\"docProps\");\n\n            docProps.file(\"core.xml\", CORE({\n                creator: this.options.creator || \"Kendo UI\",\n                lastModifiedBy: this.options.creator || \"Kendo UI\",\n                created: this.options.date || new Date().toJSON(),\n                modified: this.options.date || new Date().toJSON()\n            }));\n\n            var sheetCount = this._sheets.length;\n\n            docProps.file(\"app.xml\", APP({ sheets: this._sheets }));\n\n            var rels = zip.folder(\"_rels\");\n            rels.file(\".rels\", RELS);\n\n            var xl = zip.folder(\"xl\");\n\n            var xlRels = xl.folder(\"_rels\");\n            xlRels.file(\"workbook.xml.rels\", WORKBOOK_RELS({ count: sheetCount }));\n\n            if (this._images) {\n                var media = xl.folder(\"media\");\n                Object.keys(this._images).forEach(function (id) {\n                    var img = this$1$1._images[id];\n                    var filename = this$1$1.imageFilename(img.type);\n                    media.file(filename, img.data);\n                    img.target = \"../media/\" + filename;\n                });\n            }\n\n            var sheetIds = {};\n            xl.file(\"workbook.xml\", WORKBOOK({\n                sheets: this._sheets,\n                filterNames: map(this._sheets, function(sheet, index) {\n                    var options = sheet.options;\n                    var sheetName = (options.name || options.title || \"Sheet\" + (index + 1));\n                    sheetIds[sheetName.toLowerCase()] = index;\n                    var filter = options.filter;\n                    if (filter) {\n                        if (filter.ref) {\n                            // spreadsheet provides `ref`\n                            var a = filter.ref.split(\":\");\n                            var from = parseRef(a[0]);\n                            var to = parseRef(a[1]);\n                            return {\n                                localSheetId: index,\n                                name: sheetName,\n                                from: $ref(from.row, from.col),\n                                to: $ref(to.row, to.col)\n                            };\n                        } else if (typeof filter.from !== \"undefined\" && typeof filter.to !== \"undefined\") {\n                            // grid does this\n                            return {\n                                localSheetId: index,\n                                name: sheetName,\n                                from: $ref(filterRowIndex(options), filter.from),\n                                to: $ref(filterRowIndex(options), filter.to)\n                            };\n                        }\n                    }\n                }),\n                userNames: map(this.options.names || [], function(def) {\n                    return {\n                        name: def.localName,\n                        localSheetId: def.sheet ? sheetIds[def.sheet.toLowerCase()] : null,\n                        value: def.value,\n                        hidden: def.hidden\n                    };\n                })\n            }));\n\n            var worksheets = xl.folder(\"worksheets\");\n            var drawings = xl.folder(\"drawings\");\n            var drawingsRels = drawings.folder(\"_rels\");\n            var sheetRels = worksheets.folder(\"_rels\");\n            var commentFiles = [];\n            var drawingFiles = [];\n\n            for (var idx = 0; idx < sheetCount; idx++) {\n                var sheet = this$1$1._sheets[idx];\n                var sheetName = \"sheet\" + (idx + 1) + \".xml\";\n                var sheetXML = sheet.toXML(idx); // must be called before relsToXML\n                var relsXML = sheet.relsToXML();\n                var commentsXML = sheet.commentsXML();\n                var legacyDrawing = sheet.legacyDrawing();\n                var drawingsXML = sheet.drawingsXML(this$1$1._images);\n\n                if (relsXML) {\n                    sheetRels.file(sheetName + \".rels\", relsXML);\n                }\n                if (commentsXML) {\n                    var name = \"comments\" + (sheet.options.sheetIndex) + \".xml\";\n                    xl.file(name, commentsXML);\n                    commentFiles.push(name);\n                }\n                if (legacyDrawing) {\n                    drawings.file((\"vmlDrawing\" + (sheet.options.sheetIndex) + \".vml\"), legacyDrawing);\n                }\n                if (drawingsXML) {\n                    var name$1 = \"drawing\" + (sheet.options.sheetIndex) + \".xml\";\n                    drawings.file(name$1, drawingsXML.main);\n                    drawingsRels.file((name$1 + \".rels\"), drawingsXML.rels);\n                    drawingFiles.push(name$1);\n                }\n\n                worksheets.file(sheetName, sheetXML);\n            }\n\n            var borders = map(this._borders, parseJSON);\n\n            var styles = map(this._styles, parseJSON);\n\n            var hasFont = function(style) {\n                return style.underline || style.bold || style.italic || style.color || style.fontFamily || style.fontSize;\n            };\n\n            var convertFontSize = function(value) {\n                var fontInPx = Number(value);\n                var fontInPt;\n\n                if (fontInPx) {\n                    fontInPt = fontInPx * 3 / 4;\n                }\n\n                return fontInPt;\n            };\n\n            var fonts = map(styles, function(style) {\n                if (style.fontSize) {\n                    style.fontSize = convertFontSize(style.fontSize);\n                }\n\n                if (style.color) {\n                    style.color = convertColor(style.color);\n                }\n\n                if (hasFont(style)) {\n                    return style;\n                }\n            });\n\n            var formats = map(styles, function(style) {\n                if (style.format && defaultFormats[style.format] === undefined) {\n                    return style;\n                }\n            });\n\n            var fills = map(styles, function(style) {\n                if (style.background) {\n                    style.background = convertColor(style.background);\n                    return style;\n                }\n            });\n\n            xl.file(\"styles.xml\", STYLES({\n                fonts: fonts,\n                fills: fills,\n                formats: formats,\n                borders: borders,\n                styles: map(styles, function(style) {\n                    var result = {};\n\n                    if (hasFont(style)) {\n                        result.fontId = indexOf(style, fonts) + 1;\n                    }\n\n                    if (style.background) {\n                        result.fillId = indexOf(style, fills) + 2;\n                    }\n\n                    result.textAlign = style.textAlign;\n                    result.indent = style.indent;\n                    result.verticalAlign = style.verticalAlign;\n                    result.wrap = style.wrap;\n                    result.borderId = style.borderId;\n\n                    if (style.format) {\n                        if (defaultFormats[style.format] !== undefined) {\n                            result.numFmtId = defaultFormats[style.format];\n                        } else {\n                            result.numFmtId = 165 + indexOf(style, formats);\n                        }\n                    }\n\n                    if (style.disabled != null) {\n                        result.disabled = style.disabled;\n                    }\n\n                    return result;\n                })\n            }));\n\n            xl.file(\"sharedStrings.xml\", SHARED_STRINGS(this._strings));\n\n            zip.file(\"[Content_Types].xml\", CONTENT_TYPES({\n                sheetCount: sheetCount,\n                commentFiles: commentFiles,\n                drawingFiles: drawingFiles\n            }));\n\n            return zip;\n        },\n\n        toDataURL: function() {\n            var zip = this.toZIP();\n\n            return zip.generateAsync ? zip.generateAsync(DATA_URL_OPTIONS).then(toDataURI) : toDataURI(zip.generate(DATA_URL_OPTIONS));\n        },\n\n        toBlob: function() {\n            var zip = this.toZIP();\n            if (zip.generateAsync) {\n                return zip.generateAsync(BLOB_OPTIONS);\n            }\n            return new Blob([ zip.generate(ARRAYBUFFER_OPTIONS) ], { type: MIME_TYPE });\n        }\n    });\n\n    function borderStyle(width) {\n        var alias = \"thin\";\n\n        if (width === 2) {\n            alias = \"medium\";\n        } else if (width === 3) {\n            alias = \"thick\";\n        }\n\n        return alias;\n    }\n\n    function borderSideTemplate(name, style) {\n        var result = \"\";\n\n        if (style) {\n            result += \"<\" + name + \" style=\\\"\" + borderStyle(style.size) + \"\\\">\";\n            if (style.color) {\n                result += \"<color rgb=\\\"\" + convertColor(style.color) + \"\\\"/>\";\n            }\n            result += \"</\" + name + \">\";\n        }\n\n        return result;\n    }\n\n    function borderTemplate(border) {\n        var diag = border.diagonal ? border.diagonal.type : 0;\n        return (\"<border \" + (diag & 2 ? 'diagonalUp=\"true\"' : '') + \" \" + (diag & 1 ? 'diagonalDown=\"true\"' : '') + \">\\n      \" + (borderSideTemplate(\"left\", border.left)) + \"\\n      \" + (borderSideTemplate(\"right\", border.right)) + \"\\n      \" + (borderSideTemplate(\"top\", border.top)) + \"\\n      \" + (borderSideTemplate(\"bottom\", border.bottom)) + \"\\n      \" + (borderSideTemplate(\"diagonal\", border.diagonal)) + \"\\n    </border>\");\n    }\n\n    var EMPTY_CELL = {};\n    function inflate(rows, mergedCells) {\n        var rowData = [];\n        var rowsByIndex = [];\n\n        indexRows(rows, function(row, index) {\n            var data = {\n                _source: row,\n                index: index,\n                height: row.height,\n                level: row.level,\n                cells: []\n            };\n\n            rowData.push(data);\n            rowsByIndex[index] = data;\n        });\n\n        var sorted = sortByIndex(rowData).slice(0);\n        var ctx = {\n            rowData: rowData,\n            rowsByIndex: rowsByIndex,\n            mergedCells: mergedCells\n        };\n\n        for (var i = 0; i < sorted.length; i++) {\n            fillCells(sorted[i], ctx);\n            delete sorted[i]._source;\n        }\n\n        return sortByIndex(rowData);\n    }\n\n    function indexRows(rows, callback) {\n        for (var i = 0; i < rows.length; i++) {\n            var row = rows[i];\n            if (!row) {\n                continue;\n            }\n\n            var index = row.index;\n            if (typeof index !== \"number\") {\n                index = i;\n            }\n\n            callback(row, index);\n        }\n    }\n\n    function sortByIndex(items) {\n        return items.sort(function(a, b) {\n            return a.index - b.index;\n        });\n    }\n\n    function pushUnique(array, el) {\n        if (array.indexOf(el) < 0) {\n            array.push(el);\n        }\n    }\n\n    function getSpan(mergedCells, ref) {\n        for (var i = 0; i < mergedCells.length; ++i) {\n            var range = mergedCells[i];\n            var a = range.split(\":\");\n            var topLeft = a[0];\n            if (topLeft === ref) {\n                var bottomRight = a[1];\n                topLeft = parseRef(topLeft);\n                bottomRight = parseRef(bottomRight);\n                return {\n                    rowSpan: bottomRight.row - topLeft.row + 1,\n                    colSpan: bottomRight.col - topLeft.col + 1\n                };\n            }\n        }\n    }\n\n    function parseRef(ref) {\n        function getcol(str) {\n            var upperStr = str.toUpperCase();\n            var col = 0;\n            for (var i = 0; i < upperStr.length; ++i) {\n                col = col * 26 + upperStr.charCodeAt(i) - 64;\n            }\n            return col - 1;\n        }\n\n        function getrow(str) {\n            return parseInt(str, 10) - 1;\n        }\n\n        var m = /^([a-z]+)(\\d+)$/i.exec(ref);\n        return {\n            row: getrow(m[2]),\n            col: getcol(m[1])\n        };\n    }\n\n    function pixelsToExcel(px) {\n        return Math.round(px * 9525);\n    }\n\n    function fillCells(data, ctx) {\n        var row = data._source;\n        var rowIndex = data.index;\n        var cells = row.cells;\n        var cellData = data.cells;\n\n        if (!cells) {\n            return;\n        }\n\n        for (var i = 0; i < cells.length; i++) {\n            var cell = cells[i] || EMPTY_CELL;\n\n            var rowSpan = cell.rowSpan || 1;\n            var colSpan = cell.colSpan || 1;\n\n            var cellIndex = insertCell(cellData, cell);\n            var topLeftRef = ref(rowIndex, cellIndex);\n\n            if (rowSpan === 1 && colSpan === 1) {\n                // could still be merged: the spreadsheet does not send\n                // rowSpan/colSpan, but mergedCells is already populated.\n                // https://github.com/telerik/kendo-ui-core/issues/2401\n                var tmp = getSpan(ctx.mergedCells, topLeftRef);\n                if (tmp) {\n                    colSpan = tmp.colSpan;\n                    rowSpan = tmp.rowSpan;\n                }\n            }\n\n            spanCell(cell, cellData, cellIndex, colSpan);\n\n            if (rowSpan > 1 || colSpan > 1) {\n                pushUnique(ctx.mergedCells,\n                           topLeftRef + \":\" + ref(rowIndex + rowSpan - 1,\n                                                  cellIndex + colSpan - 1));\n            }\n\n            if (rowSpan > 1) {\n                for (var ri = rowIndex + 1; ri < rowIndex + rowSpan; ri++) {\n                    var nextRow = ctx.rowsByIndex[ri];\n                    if (!nextRow) {\n                        nextRow = ctx.rowsByIndex[ri] = { index: ri, cells: [] };\n                        ctx.rowData.push(nextRow);\n                    }\n\n                    spanCell(cell, nextRow.cells, cellIndex - 1, colSpan + 1);\n                }\n            }\n        }\n    }\n\n    function insertCell(data, cell) {\n        var index;\n\n        if (typeof cell.index === \"number\") {\n            index = cell.index;\n            insertCellAt(data, cell, cell.index);\n        } else {\n            index = appendCell(data, cell);\n        }\n\n        return index;\n    }\n\n    function insertCellAt(data, cell, index) {\n        data[index] = cell;\n    }\n\n    function appendCell(data, cell) {\n        var index = data.length;\n\n        for (var i = 0; i < data.length + 1; i++) {\n            if (!data[i]) {\n                data[i] = cell;\n                index = i;\n                break;\n            }\n        }\n\n        return index;\n    }\n\n    function spanCell(cell, row, startIndex, colSpan) {\n        for (var i = 1; i < colSpan; i++) {\n            var tmp = {\n                borderTop    : cell.borderTop,\n                borderRight  : cell.borderRight,\n                borderBottom : cell.borderBottom,\n                borderLeft   : cell.borderLeft\n            };\n            insertCellAt(row, tmp, startIndex + i);\n        }\n    }\n\n    var SPREADSHEET_FILTERS = function (ref$1) {\n      var ref = ref$1.ref;\n      var columns = ref$1.columns;\n      var generators = ref$1.generators;\n\n      return (\"\\n<autoFilter ref=\\\"\" + ref + \"\\\">\\n  \" + (foreach(columns, function (col) { return (\"\\n    <filterColumn colId=\\\"\" + (col.index) + \"\\\">\\n      \" + (generators[col.filter](col)) + \"\\n    </filterColumn>\\n  \"); })) + \"\\n</autoFilter>\");\n    };\n\n    var SPREADSHEET_CUSTOM_FILTER = function (ref) {\n      var logic = ref.logic;\n      var criteria = ref.criteria;\n\n      return (\"\\n<customFilters \" + (logic === 'and' ? 'and=\"1\"' : '') + \">\\n\" + (foreach(criteria, function (f) {\n        var op = spreadsheetFilters.customOperator(f);\n        var val = spreadsheetFilters.customValue(f);\n        return (\"<customFilter \" + (op ? (\"operator=\\\"\" + op + \"\\\"\") : '') + \" val=\\\"\" + val + \"\\\"/>\");\n    })) + \"\\n</customFilters>\");\n    };\n\n    var SPREADSHEET_DYNAMIC_FILTER = function (ref) {\n      var type = ref.type;\n\n      return (\"<dynamicFilter type=\\\"\" + (spreadsheetFilters.dynamicFilterType(type)) + \"\\\" />\");\n    };\n\n    var SPREADSHEET_TOP_FILTER = function (ref) {\n      var type = ref.type;\n      var value = ref.value;\n\n      return (\"<top10 percent=\\\"\" + (/percent$/i.test(type) ? 1 : 0) + \"\\\"\\n       top=\\\"\" + (/^top/i.test(type) ? 1 : 0) + \"\\\"\\n       val=\\\"\" + value + \"\\\" />\");\n    };\n\n    var SPREADSHEET_VALUE_FILTER = function (ref) {\n        var blanks = ref.blanks;\n        var values = ref.values;\n\n        return (\"<filters \" + (blanks ? 'blank=\"1\"' : '') + \">\\n    \" + (foreach(values, function (value) { return (\"\\n      <filter val=\\\"\" + value + \"\\\" />\"); })) + \"\\n  </filters>\");\n    };\n\n    function spreadsheetFilters(filter) {\n        return SPREADSHEET_FILTERS({\n            ref: filter.ref,\n            columns: filter.columns,\n            generators: {\n                custom  : SPREADSHEET_CUSTOM_FILTER,\n                dynamic : SPREADSHEET_DYNAMIC_FILTER,\n                top     : SPREADSHEET_TOP_FILTER,\n                value   : SPREADSHEET_VALUE_FILTER\n            }\n        });\n    }\n\n    spreadsheetFilters.customOperator = function(f) {\n        return {\n            eq  : \"equal\",\n            gt  : \"greaterThan\",\n            gte : \"greaterThanOrEqual\",\n            lt  : \"lessThan\",\n            lte : \"lessThanOrEqual\",\n            ne  : \"notEqual\",\n\n            // These are not in the spec, but seems to be how Excel does\n            // it (see customValue below).  For the non-negated versions,\n            // the operator attribute is missing completely.\n            doesnotstartwith: \"notEqual\",\n            doesnotendwith: \"notEqual\",\n            doesnotcontain: \"notEqual\",\n            doesnotmatch: \"notEqual\"\n        }[f.operator.toLowerCase()];\n    };\n\n    function quoteSheet(name) {\n        if (/^\\'/.test(name)) { // assume already quoted, the Spreadsheet does it.\n            return name;\n        }\n        if (/^[a-z_][a-z0-9_]*$/i.test(name)) {\n            return name;        // no need to quote it\n        }\n        return \"'\" + name.replace(/\\x27/g, \"\\\\'\") + \"'\";\n    }\n\n    spreadsheetFilters.customValue = function(f) {\n        function esc(str) {\n            return str.replace(/([*?])/g, \"~$1\");\n        }\n\n        switch (f.operator.toLowerCase()) {\n            case \"startswith\":\n            case \"doesnotstartwith\":\n                return esc(f.value) + \"*\";\n\n            case \"endswith\":\n            case \"doesnotendwith\":\n                return \"*\" + esc(f.value);\n\n            case \"contains\":\n            case \"doesnotcontain\":\n                return \"*\" + esc(f.value) + \"*\";\n\n            default:\n                return f.value;\n        }\n    };\n\n    spreadsheetFilters.dynamicFilterType = function(type) {\n        return {\n            quarter1  : \"Q1\",\n            quarter2  : \"Q2\",\n            quarter3  : \"Q3\",\n            quarter4  : \"Q4\",\n            january   : \"M1\",\n            february  : \"M2\",\n            march     : \"M3\",\n            april     : \"M4\",\n            may       : \"M5\",\n            june      : \"M6\",\n            july      : \"M7\",\n            august    : \"M8\",\n            september : \"M9\",\n            october   : \"M10\",\n            november  : \"M11\",\n            december  : \"M12\"\n        }[type.toLowerCase()] || type;\n    };\n\n    kendo.deepExtend(kendo.ooxml, {\n        IntlService: IntlService,\n        Workbook: Workbook,\n        Worksheet: Worksheet\n    });\n\n    })(window.kendo.jQuery);\n\n    // import * as ooxml from \"/kendo-ooxml/src/main.js\";\n    // kendo.ooxml = ooxml;\n\n    (function ($) {\n\n    var Workbook = kendo.ooxml.Workbook;\n\n    kendo.ooxml.IntlService.register({\n        toString: kendo.toString\n    });\n\n    var toDataURL = Workbook.prototype.toDataURL;\n\n    Object.assign(Workbook.prototype, {\n        toDataURL: function() {\n            var result = toDataURL.call(this);\n            if (typeof result !== 'string') {\n                throw new Error('The toDataURL method can be used only with jsZip 2. Either include jsZip 2 or use the toDataURLAsync method.');\n            }\n\n            return result;\n        },\n\n        toDataURLAsync: function() {\n            var deferred = $.Deferred();\n            var result = toDataURL.call(this);\n            if (typeof result === 'string') {\n                result = deferred.resolve(result);\n            } else if (result && result.then){\n                result.then(function(dataURI) {\n                    deferred.resolve(dataURI);\n                }, function() {\n                    deferred.reject();\n                });\n            }\n\n            return deferred.promise();\n        }\n    });\n\n    })(window.kendo.jQuery);\n\n    var __meta__ = {\n        id: \"ooxml\",\n        name: \"XLSX generation\",\n        category: \"framework\",\n        advanced: true,\n        depends: [ \"core\" ]\n    };\n\n}));\n"]}